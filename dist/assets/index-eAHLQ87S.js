var KL=Object.defineProperty;var XL=(e,t,r)=>t in e?KL(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var my=(e,t,r)=>XL(e,typeof t!="symbol"?t+"":t,r);function YL(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const i=Object.getOwnPropertyDescriptor(n,a);i&&Object.defineProperty(e,a,i.get?i:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function Cs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var py={exports:{}},nd={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kT;function QL(){if(kT)return nd;kT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,a,i){var l=null;if(i!==void 0&&(l=""+i),a.key!==void 0&&(l=""+a.key),"key"in a){i={};for(var c in a)c!=="key"&&(i[c]=a[c])}else i=a;return a=i.ref,{$$typeof:e,type:n,key:l,ref:a!==void 0?a:null,props:i}}return nd.Fragment=t,nd.jsx=r,nd.jsxs=r,nd}var TT;function JL(){return TT||(TT=1,py.exports=QL()),py.exports}var u=JL(),gy={exports:{}},Ft={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AT;function ZL(){if(AT)return Ft;AT=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),v=Symbol.iterator;function x(G){return G===null||typeof G!="object"?null:(G=v&&G[v]||G["@@iterator"],typeof G=="function"?G:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function E(G,P,W){this.props=G,this.context=P,this.refs=_,this.updater=W||y}E.prototype.isReactComponent={},E.prototype.setState=function(G,P){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,P,"setState")},E.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function A(){}A.prototype=E.prototype;function T(G,P,W){this.props=G,this.context=P,this.refs=_,this.updater=W||y}var k=T.prototype=new A;k.constructor=T,b(k,E.prototype),k.isPureReactComponent=!0;var I=Array.isArray;function O(){}var j={H:null,A:null,T:null,S:null},B=Object.prototype.hasOwnProperty;function U(G,P,W){var F=W.ref;return{$$typeof:e,type:G,key:P,ref:F!==void 0?F:null,props:W}}function Y(G,P){return U(G.type,P,G.props)}function te(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function V(G){var P={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(W){return P[W]})}var ge=/\/+/g;function be(G,P){return typeof G=="object"&&G!==null&&G.key!=null?V(""+G.key):P.toString(36)}function ve(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(O,O):(G.status="pending",G.then(function(P){G.status==="pending"&&(G.status="fulfilled",G.value=P)},function(P){G.status==="pending"&&(G.status="rejected",G.reason=P)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function z(G,P,W,F,M){var le=typeof G;(le==="undefined"||le==="boolean")&&(G=null);var pe=!1;if(G===null)pe=!0;else switch(le){case"bigint":case"string":case"number":pe=!0;break;case"object":switch(G.$$typeof){case e:case t:pe=!0;break;case m:return pe=G._init,z(pe(G._payload),P,W,F,M)}}if(pe)return M=M(G),pe=F===""?"."+be(G,0):F,I(M)?(W="",pe!=null&&(W=pe.replace(ge,"$&/")+"/"),z(M,P,W,"",function(ae){return ae})):M!=null&&(te(M)&&(M=Y(M,W+(M.key==null||G&&G.key===M.key?"":(""+M.key).replace(ge,"$&/")+"/")+pe)),P.push(M)),1;pe=0;var Ae=F===""?".":F+":";if(I(G))for(var oe=0;oe<G.length;oe++)F=G[oe],le=Ae+be(F,oe),pe+=z(F,P,W,le,M);else if(oe=x(G),typeof oe=="function")for(G=oe.call(G),oe=0;!(F=G.next()).done;)F=F.value,le=Ae+be(F,oe++),pe+=z(F,P,W,le,M);else if(le==="object"){if(typeof G.then=="function")return z(ve(G),P,W,F,M);throw P=String(G),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return pe}function ue(G,P,W){if(G==null)return G;var F=[],M=0;return z(G,F,"","",function(le){return P.call(W,le,M++)}),F}function se(G){if(G._status===-1){var P=G._result;P=P(),P.then(function(W){(G._status===0||G._status===-1)&&(G._status=1,G._result=W)},function(W){(G._status===0||G._status===-1)&&(G._status=2,G._result=W)}),G._status===-1&&(G._status=0,G._result=P)}if(G._status===1)return G._result.default;throw G._result}var Q=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)},re={map:ue,forEach:function(G,P,W){ue(G,function(){P.apply(this,arguments)},W)},count:function(G){var P=0;return ue(G,function(){P++}),P},toArray:function(G){return ue(G,function(P){return P})||[]},only:function(G){if(!te(G))throw Error("React.Children.only expected to receive a single React element child.");return G}};return Ft.Activity=p,Ft.Children=re,Ft.Component=E,Ft.Fragment=r,Ft.Profiler=a,Ft.PureComponent=T,Ft.StrictMode=n,Ft.Suspense=f,Ft.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=j,Ft.__COMPILER_RUNTIME={__proto__:null,c:function(G){return j.H.useMemoCache(G)}},Ft.cache=function(G){return function(){return G.apply(null,arguments)}},Ft.cacheSignal=function(){return null},Ft.cloneElement=function(G,P,W){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var F=b({},G.props),M=G.key;if(P!=null)for(le in P.key!==void 0&&(M=""+P.key),P)!B.call(P,le)||le==="key"||le==="__self"||le==="__source"||le==="ref"&&P.ref===void 0||(F[le]=P[le]);var le=arguments.length-2;if(le===1)F.children=W;else if(1<le){for(var pe=Array(le),Ae=0;Ae<le;Ae++)pe[Ae]=arguments[Ae+2];F.children=pe}return U(G.type,M,F)},Ft.createContext=function(G){return G={$$typeof:l,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:i,_context:G},G},Ft.createElement=function(G,P,W){var F,M={},le=null;if(P!=null)for(F in P.key!==void 0&&(le=""+P.key),P)B.call(P,F)&&F!=="key"&&F!=="__self"&&F!=="__source"&&(M[F]=P[F]);var pe=arguments.length-2;if(pe===1)M.children=W;else if(1<pe){for(var Ae=Array(pe),oe=0;oe<pe;oe++)Ae[oe]=arguments[oe+2];M.children=Ae}if(G&&G.defaultProps)for(F in pe=G.defaultProps,pe)M[F]===void 0&&(M[F]=pe[F]);return U(G,le,M)},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function(G){return{$$typeof:c,render:G}},Ft.isValidElement=te,Ft.lazy=function(G){return{$$typeof:m,_payload:{_status:-1,_result:G},_init:se}},Ft.memo=function(G,P){return{$$typeof:d,type:G,compare:P===void 0?null:P}},Ft.startTransition=function(G){var P=j.T,W={};j.T=W;try{var F=G(),M=j.S;M!==null&&M(W,F),typeof F=="object"&&F!==null&&typeof F.then=="function"&&F.then(O,Q)}catch(le){Q(le)}finally{P!==null&&W.types!==null&&(P.types=W.types),j.T=P}},Ft.unstable_useCacheRefresh=function(){return j.H.useCacheRefresh()},Ft.use=function(G){return j.H.use(G)},Ft.useActionState=function(G,P,W){return j.H.useActionState(G,P,W)},Ft.useCallback=function(G,P){return j.H.useCallback(G,P)},Ft.useContext=function(G){return j.H.useContext(G)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function(G,P){return j.H.useDeferredValue(G,P)},Ft.useEffect=function(G,P){return j.H.useEffect(G,P)},Ft.useEffectEvent=function(G){return j.H.useEffectEvent(G)},Ft.useId=function(){return j.H.useId()},Ft.useImperativeHandle=function(G,P,W){return j.H.useImperativeHandle(G,P,W)},Ft.useInsertionEffect=function(G,P){return j.H.useInsertionEffect(G,P)},Ft.useLayoutEffect=function(G,P){return j.H.useLayoutEffect(G,P)},Ft.useMemo=function(G,P){return j.H.useMemo(G,P)},Ft.useOptimistic=function(G,P){return j.H.useOptimistic(G,P)},Ft.useReducer=function(G,P,W){return j.H.useReducer(G,P,W)},Ft.useRef=function(G){return j.H.useRef(G)},Ft.useState=function(G){return j.H.useState(G)},Ft.useSyncExternalStore=function(G,P,W){return j.H.useSyncExternalStore(G,P,W)},Ft.useTransition=function(){return j.H.useTransition()},Ft.version="19.2.3",Ft}var jT;function Zu(){return jT||(jT=1,gy.exports=ZL()),gy.exports}var N=Zu();const t_=Cs(N),eB=YL({__proto__:null,default:t_},[N]);var vy={exports:{}},ad={},xy={exports:{}},yy={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OT;function tB(){return OT||(OT=1,(function(e){function t(z,ue){var se=z.length;z.push(ue);e:for(;0<se;){var Q=se-1>>>1,re=z[Q];if(0<a(re,ue))z[Q]=ue,z[se]=re,se=Q;else break e}}function r(z){return z.length===0?null:z[0]}function n(z){if(z.length===0)return null;var ue=z[0],se=z.pop();if(se!==ue){z[0]=se;e:for(var Q=0,re=z.length,G=re>>>1;Q<G;){var P=2*(Q+1)-1,W=z[P],F=P+1,M=z[F];if(0>a(W,se))F<re&&0>a(M,W)?(z[Q]=M,z[F]=se,Q=F):(z[Q]=W,z[P]=se,Q=P);else if(F<re&&0>a(M,se))z[Q]=M,z[F]=se,Q=F;else break e}}return ue}function a(z,ue){var se=z.sortIndex-ue.sortIndex;return se!==0?se:z.id-ue.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var l=Date,c=l.now();e.unstable_now=function(){return l.now()-c}}var f=[],d=[],m=1,p=null,v=3,x=!1,y=!1,b=!1,_=!1,E=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;function k(z){for(var ue=r(d);ue!==null;){if(ue.callback===null)n(d);else if(ue.startTime<=z)n(d),ue.sortIndex=ue.expirationTime,t(f,ue);else break;ue=r(d)}}function I(z){if(b=!1,k(z),!y)if(r(f)!==null)y=!0,O||(O=!0,V());else{var ue=r(d);ue!==null&&ve(I,ue.startTime-z)}}var O=!1,j=-1,B=5,U=-1;function Y(){return _?!0:!(e.unstable_now()-U<B)}function te(){if(_=!1,O){var z=e.unstable_now();U=z;var ue=!0;try{e:{y=!1,b&&(b=!1,A(j),j=-1),x=!0;var se=v;try{t:{for(k(z),p=r(f);p!==null&&!(p.expirationTime>z&&Y());){var Q=p.callback;if(typeof Q=="function"){p.callback=null,v=p.priorityLevel;var re=Q(p.expirationTime<=z);if(z=e.unstable_now(),typeof re=="function"){p.callback=re,k(z),ue=!0;break t}p===r(f)&&n(f),k(z)}else n(f);p=r(f)}if(p!==null)ue=!0;else{var G=r(d);G!==null&&ve(I,G.startTime-z),ue=!1}}break e}finally{p=null,v=se,x=!1}ue=void 0}}finally{ue?V():O=!1}}}var V;if(typeof T=="function")V=function(){T(te)};else if(typeof MessageChannel<"u"){var ge=new MessageChannel,be=ge.port2;ge.port1.onmessage=te,V=function(){be.postMessage(null)}}else V=function(){E(te,0)};function ve(z,ue){j=E(function(){z(e.unstable_now())},ue)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(z){z.callback=null},e.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<z?Math.floor(1e3/z):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_next=function(z){switch(v){case 1:case 2:case 3:var ue=3;break;default:ue=v}var se=v;v=ue;try{return z()}finally{v=se}},e.unstable_requestPaint=function(){_=!0},e.unstable_runWithPriority=function(z,ue){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var se=v;v=z;try{return ue()}finally{v=se}},e.unstable_scheduleCallback=function(z,ue,se){var Q=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?Q+se:Q):se=Q,z){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=se+re,z={id:m++,callback:ue,priorityLevel:z,startTime:se,expirationTime:re,sortIndex:-1},se>Q?(z.sortIndex=se,t(d,z),r(f)===null&&z===r(d)&&(b?(A(j),j=-1):b=!0,ve(I,se-Q))):(z.sortIndex=re,t(f,z),y||x||(y=!0,O||(O=!0,V()))),z},e.unstable_shouldYield=Y,e.unstable_wrapCallback=function(z){var ue=v;return function(){var se=v;v=ue;try{return z.apply(this,arguments)}finally{v=se}}}})(yy)),yy}var CT;function rB(){return CT||(CT=1,xy.exports=tB()),xy.exports}var by={exports:{}},xa={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var DT;function nB(){if(DT)return xa;DT=1;var e=Zu();function t(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var m=2;m<arguments.length;m++)d+="&args[]="+encodeURIComponent(arguments[m])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},a=Symbol.for("react.portal");function i(f,d,m){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:p==null?null:""+p,children:f,containerInfo:d,implementation:m}}var l=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return xa.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,xa.createPortal=function(f,d){var m=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(t(299));return i(f,d,null,m)},xa.flushSync=function(f){var d=l.T,m=n.p;try{if(l.T=null,n.p=2,f)return f()}finally{l.T=d,n.p=m,n.d.f()}},xa.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,n.d.C(f,d))},xa.prefetchDNS=function(f){typeof f=="string"&&n.d.D(f)},xa.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var m=d.as,p=c(m,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,x=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;m==="style"?n.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:p,integrity:v,fetchPriority:x}):m==="script"&&n.d.X(f,{crossOrigin:p,integrity:v,fetchPriority:x,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},xa.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var m=c(d.as,d.crossOrigin);n.d.M(f,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&n.d.M(f)},xa.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var m=d.as,p=c(m,d.crossOrigin);n.d.L(f,m,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},xa.preloadModule=function(f,d){if(typeof f=="string")if(d){var m=c(d.as,d.crossOrigin);n.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else n.d.m(f)},xa.requestFormReset=function(f){n.d.r(f)},xa.unstable_batchedUpdates=function(f,d){return f(d)},xa.useFormState=function(f,d,m){return l.H.useFormState(f,d,m)},xa.useFormStatus=function(){return l.H.useHostTransitionStatus()},xa.version="19.2.3",xa}var IT;function xD(){if(IT)return by.exports;IT=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),by.exports=nB(),by.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PT;function aB(){if(PT)return ad;PT=1;var e=rB(),t=Zu(),r=xD();function n(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)o+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function i(s){var o=s,h=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(h=o.return),s=o.return;while(s)}return o.tag===3?h:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(s.tag===31){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function f(s){if(i(s)!==s)throw Error(n(188))}function d(s){var o=s.alternate;if(!o){if(o=i(s),o===null)throw Error(n(188));return o!==s?null:s}for(var h=s,g=o;;){var w=h.return;if(w===null)break;var S=w.alternate;if(S===null){if(g=w.return,g!==null){h=g;continue}break}if(w.child===S.child){for(S=w.child;S;){if(S===h)return f(w),s;if(S===g)return f(w),o;S=S.sibling}throw Error(n(188))}if(h.return!==g.return)h=w,g=S;else{for(var D=!1,X=w.child;X;){if(X===h){D=!0,h=w,g=S;break}if(X===g){D=!0,g=w,h=S;break}X=X.sibling}if(!D){for(X=S.child;X;){if(X===h){D=!0,h=S,g=w;break}if(X===g){D=!0,g=S,h=w;break}X=X.sibling}if(!D)throw Error(n(189))}}if(h.alternate!==g)throw Error(n(190))}if(h.tag!==3)throw Error(n(188));return h.stateNode.current===h?s:o}function m(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=m(s),o!==null)return o;s=s.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),T=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),O=Symbol.for("react.suspense_list"),j=Symbol.for("react.memo"),B=Symbol.for("react.lazy"),U=Symbol.for("react.activity"),Y=Symbol.for("react.memo_cache_sentinel"),te=Symbol.iterator;function V(s){return s===null||typeof s!="object"?null:(s=te&&s[te]||s["@@iterator"],typeof s=="function"?s:null)}var ge=Symbol.for("react.client.reference");function be(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===ge?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case b:return"Fragment";case E:return"Profiler";case _:return"StrictMode";case I:return"Suspense";case O:return"SuspenseList";case U:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case y:return"Portal";case T:return s.displayName||"Context";case A:return(s._context.displayName||"Context")+".Consumer";case k:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case j:return o=s.displayName||null,o!==null?o:be(s.type)||"Memo";case B:o=s._payload,s=s._init;try{return be(s(o))}catch{}}return null}var ve=Array.isArray,z=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ue=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,se={pending:!1,data:null,method:null,action:null},Q=[],re=-1;function G(s){return{current:s}}function P(s){0>re||(s.current=Q[re],Q[re]=null,re--)}function W(s,o){re++,Q[re]=s.current,s.current=o}var F=G(null),M=G(null),le=G(null),pe=G(null);function Ae(s,o){switch(W(le,o),W(M,s),W(F,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?Xk(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=Xk(o),s=Yk(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}P(F),W(F,s)}function oe(){P(F),P(M),P(le)}function ae(s){s.memoizedState!==null&&W(pe,s);var o=F.current,h=Yk(o,s.type);o!==h&&(W(M,s),W(F,h))}function ze(s){M.current===s&&(P(F),P(M)),pe.current===s&&(P(pe),Zf._currentValue=se)}var q,Je;function qe(s){if(q===void 0)try{throw Error()}catch(h){var o=h.stack.trim().match(/\n( *(at )?)/);q=o&&o[1]||"",Je=-1<h.stack.indexOf(`
    at`)?" (<anonymous>)":-1<h.stack.indexOf("@")?"@unknown:0:0":""}return`
`+q+s+Je}var ot=!1;function Ke(s,o){if(!s||ot)return"";ot=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var g={DetermineComponentFrameRoot:function(){try{if(o){var $e=function(){throw Error()};if(Object.defineProperty($e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct($e,[])}catch(De){var je=De}Reflect.construct(s,[],$e)}else{try{$e.call()}catch(De){je=De}s.call($e.prototype)}}else{try{throw Error()}catch(De){je=De}($e=s())&&typeof $e.catch=="function"&&$e.catch(function(){})}}catch(De){if(De&&je&&typeof De.stack=="string")return[De.stack,je.stack]}return[null,null]}};g.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var w=Object.getOwnPropertyDescriptor(g.DetermineComponentFrameRoot,"name");w&&w.configurable&&Object.defineProperty(g.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=g.DetermineComponentFrameRoot(),D=S[0],X=S[1];if(D&&X){var me=D.split(`
`),ke=X.split(`
`);for(w=g=0;g<me.length&&!me[g].includes("DetermineComponentFrameRoot");)g++;for(;w<ke.length&&!ke[w].includes("DetermineComponentFrameRoot");)w++;if(g===me.length||w===ke.length)for(g=me.length-1,w=ke.length-1;1<=g&&0<=w&&me[g]!==ke[w];)w--;for(;1<=g&&0<=w;g--,w--)if(me[g]!==ke[w]){if(g!==1||w!==1)do if(g--,w--,0>w||me[g]!==ke[w]){var Me=`
`+me[g].replace(" at new "," at ");return s.displayName&&Me.includes("<anonymous>")&&(Me=Me.replace("<anonymous>",s.displayName)),Me}while(1<=g&&0<=w);break}}}finally{ot=!1,Error.prepareStackTrace=h}return(h=s?s.displayName||s.name:"")?qe(h):""}function He(s,o){switch(s.tag){case 26:case 27:case 5:return qe(s.type);case 16:return qe("Lazy");case 13:return s.child!==o&&o!==null?qe("Suspense Fallback"):qe("Suspense");case 19:return qe("SuspenseList");case 0:case 15:return Ke(s.type,!1);case 11:return Ke(s.type.render,!1);case 1:return Ke(s.type,!0);case 31:return qe("Activity");default:return""}}function wt(s){try{var o="",h=null;do o+=He(s,h),h=s,s=s.return;while(s);return o}catch(g){return`
Error generating stack: `+g.message+`
`+g.stack}}var mt=Object.prototype.hasOwnProperty,Ge=e.unstable_scheduleCallback,ut=e.unstable_cancelCallback,ct=e.unstable_shouldYield,dt=e.unstable_requestPaint,at=e.unstable_now,Wt=e.unstable_getCurrentPriorityLevel,Oe=e.unstable_ImmediatePriority,st=e.unstable_UserBlockingPriority,Fe=e.unstable_NormalPriority,nr=e.unstable_LowPriority,St=e.unstable_IdlePriority,Zt=e.log,mr=e.unstable_setDisableYieldValue,er=null,ar=null;function Yr(s){if(typeof Zt=="function"&&mr(s),ar&&typeof ar.setStrictMode=="function")try{ar.setStrictMode(er,s)}catch{}}var Tr=Math.clz32?Math.clz32:$n,Ba=Math.log,ga=Math.LN2;function $n(s){return s>>>=0,s===0?32:31-(Ba(s)/ga|0)|0}var $r=256,ra=262144,zn=4194304;function pr(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Hn(s,o,h){var g=s.pendingLanes;if(g===0)return 0;var w=0,S=s.suspendedLanes,D=s.pingedLanes;s=s.warmLanes;var X=g&134217727;return X!==0?(g=X&~S,g!==0?w=pr(g):(D&=X,D!==0?w=pr(D):h||(h=X&~s,h!==0&&(w=pr(h))))):(X=g&~S,X!==0?w=pr(X):D!==0?w=pr(D):h||(h=g&~s,h!==0&&(w=pr(h)))),w===0?0:o!==0&&o!==w&&(o&S)===0&&(S=w&-w,h=o&-o,S>=h||S===32&&(h&4194048)!==0)?o:w}function lr(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function wn(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zr(){var s=zn;return zn<<=1,(zn&62914560)===0&&(zn=4194304),s}function na(s){for(var o=[],h=0;31>h;h++)o.push(s);return o}function gr(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Oa(s,o,h,g,w,S){var D=s.pendingLanes;s.pendingLanes=h,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=h,s.entangledLanes&=h,s.errorRecoveryDisabledLanes&=h,s.shellSuspendCounter=0;var X=s.entanglements,me=s.expirationTimes,ke=s.hiddenUpdates;for(h=D&~h;0<h;){var Me=31-Tr(h),$e=1<<Me;X[Me]=0,me[Me]=-1;var je=ke[Me];if(je!==null)for(ke[Me]=null,Me=0;Me<je.length;Me++){var De=je[Me];De!==null&&(De.lane&=-536870913)}h&=~$e}g!==0&&pn(s,g,0),S!==0&&w===0&&s.tag!==0&&(s.suspendedLanes|=S&~(D&~o))}function pn(s,o,h){s.pendingLanes|=o,s.suspendedLanes&=~o;var g=31-Tr(o);s.entangledLanes|=o,s.entanglements[g]=s.entanglements[g]|1073741824|h&261930}function Ue(s,o){var h=s.entangledLanes|=o;for(s=s.entanglements;h;){var g=31-Tr(h),w=1<<g;w&o|s[g]&o&&(s[g]|=o),h&=~w}}function Le(s,o){var h=o&-o;return h=(h&42)!==0?1:it(h),(h&(s.suspendedLanes|o))!==0?0:h}function it(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Tt(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function R(){var s=ue.p;return s!==0?s:(s=window.event,s===void 0?32:yT(s.type))}function ee(s,o){var h=ue.p;try{return ue.p=s,o()}finally{ue.p=h}}var K=Math.random().toString(36).slice(2),H="__reactFiber$"+K,Z="__reactProps$"+K,ne="__reactContainer$"+K,L="__reactEvents$"+K,he="__reactListeners$"+K,fe="__reactHandles$"+K,de="__reactResources$"+K,we="__reactMarker$"+K;function Pe(s){delete s[H],delete s[Z],delete s[L],delete s[he],delete s[fe]}function Re(s){var o=s[H];if(o)return o;for(var h=s.parentNode;h;){if(o=h[ne]||h[H]){if(h=o.alternate,o.child!==null||h!==null&&h.child!==null)for(s=nT(s);s!==null;){if(h=s[H])return h;s=nT(s)}return o}s=h,h=s.parentNode}return null}function Ve(s){if(s=s[H]||s[ne]){var o=s.tag;if(o===5||o===6||o===13||o===31||o===26||o===27||o===3)return s}return null}function C(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(n(33))}function J(s){var o=s[de];return o||(o=s[de]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function xe(s){s[we]=!0}var Ee=new Set,Ce={};function Se(s,o){Qe(s,o),Qe(s+"Capture",o)}function Qe(s,o){for(Ce[s]=o,s=0;s<o.length;s++)Ee.add(o[s])}var Xe=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ye={},pt={};function Et(s){return mt.call(pt,s)?!0:mt.call(Ye,s)?!1:Xe.test(s)?pt[s]=!0:(Ye[s]=!0,!1)}function nt(s,o,h){if(Et(o))if(h===null)s.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var g=o.toLowerCase().slice(0,5);if(g!=="data-"&&g!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+h)}}function yt(s,o,h){if(h===null)s.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+h)}}function Rt(s,o,h,g){if(g===null)s.removeAttribute(h);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(h);return}s.setAttributeNS(o,h,""+g)}}function Vt(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Kt(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ht(s,o,h){var g=Object.getOwnPropertyDescriptor(s.constructor.prototype,o);if(!s.hasOwnProperty(o)&&typeof g<"u"&&typeof g.get=="function"&&typeof g.set=="function"){var w=g.get,S=g.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return w.call(this)},set:function(D){h=""+D,S.call(this,D)}}),Object.defineProperty(s,o,{enumerable:g.enumerable}),{getValue:function(){return h},setValue:function(D){h=""+D},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function Lt(s){if(!s._valueTracker){var o=Kt(s)?"checked":"value";s._valueTracker=Ht(s,o,""+s[o])}}function Pr(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var h=o.getValue(),g="";return s&&(g=Kt(s)?s.checked?"true":"false":s.value),s=g,s!==h?(o.setValue(s),!0):!1}function Fr(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var va=/[\n"\\]/g;function ie(s){return s.replace(va,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function ce(s,o,h,g,w,S,D,X){s.name="",D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?s.type=D:s.removeAttribute("type"),o!=null?D==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+Vt(o)):s.value!==""+Vt(o)&&(s.value=""+Vt(o)):D!=="submit"&&D!=="reset"||s.removeAttribute("value"),o!=null?Ar(s,D,Vt(o)):h!=null?Ar(s,D,Vt(h)):g!=null&&s.removeAttribute("value"),w==null&&S!=null&&(s.defaultChecked=!!S),w!=null&&(s.checked=w&&typeof w!="function"&&typeof w!="symbol"),X!=null&&typeof X!="function"&&typeof X!="symbol"&&typeof X!="boolean"?s.name=""+Vt(X):s.removeAttribute("name")}function rt(s,o,h,g,w,S,D,X){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(s.type=S),o!=null||h!=null){if(!(S!=="submit"&&S!=="reset"||o!=null)){Lt(s);return}h=h!=null?""+Vt(h):"",o=o!=null?""+Vt(o):h,X||o===s.value||(s.value=o),s.defaultValue=o}g=g??w,g=typeof g!="function"&&typeof g!="symbol"&&!!g,s.checked=X?s.checked:!!g,s.defaultChecked=!!g,D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"&&(s.name=D),Lt(s)}function Ar(s,o,h){o==="number"&&Fr(s.ownerDocument)===s||s.defaultValue===""+h||(s.defaultValue=""+h)}function vr(s,o,h,g){if(s=s.options,o){o={};for(var w=0;w<h.length;w++)o["$"+h[w]]=!0;for(h=0;h<s.length;h++)w=o.hasOwnProperty("$"+s[h].value),s[h].selected!==w&&(s[h].selected=w),w&&g&&(s[h].defaultSelected=!0)}else{for(h=""+Vt(h),o=null,w=0;w<s.length;w++){if(s[w].value===h){s[w].selected=!0,g&&(s[w].defaultSelected=!0);return}o!==null||s[w].disabled||(o=s[w])}o!==null&&(o.selected=!0)}}function tt(s,o,h){if(o!=null&&(o=""+Vt(o),o!==s.value&&(s.value=o),h==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=h!=null?""+Vt(h):""}function lt(s,o,h,g){if(o==null){if(g!=null){if(h!=null)throw Error(n(92));if(ve(g)){if(1<g.length)throw Error(n(93));g=g[0]}h=g}h==null&&(h=""),o=h}h=Vt(o),s.defaultValue=h,g=s.textContent,g===h&&g!==""&&g!==null&&(s.value=g),Lt(s)}function Mt(s,o){if(o){var h=s.firstChild;if(h&&h===s.lastChild&&h.nodeType===3){h.nodeValue=o;return}}s.textContent=o}var xr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function K0(s,o,h){var g=o.indexOf("--")===0;h==null||typeof h=="boolean"||h===""?g?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":g?s.setProperty(o,h):typeof h!="number"||h===0||xr.has(o)?o==="float"?s.cssFloat=h:s[o]=(""+h).trim():s[o]=h+"px"}function GS(s,o,h){if(o!=null&&typeof o!="object")throw Error(n(62));if(s=s.style,h!=null){for(var g in h)!h.hasOwnProperty(g)||o!=null&&o.hasOwnProperty(g)||(g.indexOf("--")===0?s.setProperty(g,""):g==="float"?s.cssFloat="":s[g]="");for(var w in o)g=o[w],o.hasOwnProperty(w)&&h[w]!==g&&K0(s,w,g)}else for(var S in o)o.hasOwnProperty(S)&&K0(s,S,o[S])}function uv(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var q8=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),W8=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function X0(s){return W8.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function Ps(){}var fv=null;function dv(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Rc=null,Fc=null;function KS(s){var o=Ve(s);if(o&&(s=o.stateNode)){var h=s[Z]||null;e:switch(s=o.stateNode,o.type){case"input":if(ce(s,h.value,h.defaultValue,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name),o=h.name,h.type==="radio"&&o!=null){for(h=s;h.parentNode;)h=h.parentNode;for(h=h.querySelectorAll('input[name="'+ie(""+o)+'"][type="radio"]'),o=0;o<h.length;o++){var g=h[o];if(g!==s&&g.form===s.form){var w=g[Z]||null;if(!w)throw Error(n(90));ce(g,w.value,w.defaultValue,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name)}}for(o=0;o<h.length;o++)g=h[o],g.form===s.form&&Pr(g)}break e;case"textarea":tt(s,h.value,h.defaultValue);break e;case"select":o=h.value,o!=null&&vr(s,!!h.multiple,o,!1)}}}var hv=!1;function XS(s,o,h){if(hv)return s(o,h);hv=!0;try{var g=s(o);return g}finally{if(hv=!1,(Rc!==null||Fc!==null)&&(Rh(),Rc&&(o=Rc,s=Fc,Fc=Rc=null,KS(o),s)))for(o=0;o<s.length;o++)KS(s[o])}}function gf(s,o){var h=s.stateNode;if(h===null)return null;var g=h[Z]||null;if(g===null)return null;h=g[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(s=s.type,g=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!g;break e;default:s=!1}if(s)return null;if(h&&typeof h!="function")throw Error(n(231,o,typeof h));return h}var Ms=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),mv=!1;if(Ms)try{var vf={};Object.defineProperty(vf,"passive",{get:function(){mv=!0}}),window.addEventListener("test",vf,vf),window.removeEventListener("test",vf,vf)}catch{mv=!1}var Tl=null,pv=null,Y0=null;function YS(){if(Y0)return Y0;var s,o=pv,h=o.length,g,w="value"in Tl?Tl.value:Tl.textContent,S=w.length;for(s=0;s<h&&o[s]===w[s];s++);var D=h-s;for(g=1;g<=D&&o[h-g]===w[S-g];g++);return Y0=w.slice(s,1<g?1-g:void 0)}function Q0(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function J0(){return!0}function QS(){return!1}function Ua(s){function o(h,g,w,S,D){this._reactName=h,this._targetInst=w,this.type=g,this.nativeEvent=S,this.target=D,this.currentTarget=null;for(var X in s)s.hasOwnProperty(X)&&(h=s[X],this[X]=h?h(S):S[X]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?J0:QS,this.isPropagationStopped=QS,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var h=this.nativeEvent;h&&(h.preventDefault?h.preventDefault():typeof h.returnValue!="unknown"&&(h.returnValue=!1),this.isDefaultPrevented=J0)},stopPropagation:function(){var h=this.nativeEvent;h&&(h.stopPropagation?h.stopPropagation():typeof h.cancelBubble!="unknown"&&(h.cancelBubble=!0),this.isPropagationStopped=J0)},persist:function(){},isPersistent:J0}),o}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Z0=Ua(So),xf=p({},So,{view:0,detail:0}),V8=Ua(xf),gv,vv,yf,eh=p({},xf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yv,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==yf&&(yf&&s.type==="mousemove"?(gv=s.screenX-yf.screenX,vv=s.screenY-yf.screenY):vv=gv=0,yf=s),gv)},movementY:function(s){return"movementY"in s?s.movementY:vv}}),JS=Ua(eh),G8=p({},eh,{dataTransfer:0}),K8=Ua(G8),X8=p({},xf,{relatedTarget:0}),xv=Ua(X8),Y8=p({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),Q8=Ua(Y8),J8=p({},So,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),Z8=Ua(J8),eF=p({},So,{data:0}),ZS=Ua(eF),tF={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rF={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},nF={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aF(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=nF[s])?!!o[s]:!1}function yv(){return aF}var iF=p({},xf,{key:function(s){if(s.key){var o=tF[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=Q0(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?rF[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yv,charCode:function(s){return s.type==="keypress"?Q0(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?Q0(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),sF=Ua(iF),lF=p({},eh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),eE=Ua(lF),oF=p({},xf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yv}),cF=Ua(oF),uF=p({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),fF=Ua(uF),dF=p({},eh,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),hF=Ua(dF),mF=p({},So,{newState:0,oldState:0}),pF=Ua(mF),gF=[9,13,27,32],bv=Ms&&"CompositionEvent"in window,bf=null;Ms&&"documentMode"in document&&(bf=document.documentMode);var vF=Ms&&"TextEvent"in window&&!bf,tE=Ms&&(!bv||bf&&8<bf&&11>=bf),rE=" ",nE=!1;function aE(s,o){switch(s){case"keyup":return gF.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iE(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Lc=!1;function xF(s,o){switch(s){case"compositionend":return iE(o);case"keypress":return o.which!==32?null:(nE=!0,rE);case"textInput":return s=o.data,s===rE&&nE?null:s;default:return null}}function yF(s,o){if(Lc)return s==="compositionend"||!bv&&aE(s,o)?(s=YS(),Y0=pv=Tl=null,Lc=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return tE&&o.locale!=="ko"?null:o.data;default:return null}}var bF={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function sE(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!bF[s.type]:o==="textarea"}function lE(s,o,h,g){Rc?Fc?Fc.push(g):Fc=[g]:Rc=g,o=Hh(o,"onChange"),0<o.length&&(h=new Z0("onChange","change",null,h,g),s.push({event:h,listeners:o}))}var wf=null,_f=null;function wF(s){Hk(s,0)}function th(s){var o=C(s);if(Pr(o))return s}function oE(s,o){if(s==="change")return o}var cE=!1;if(Ms){var wv;if(Ms){var _v="oninput"in document;if(!_v){var uE=document.createElement("div");uE.setAttribute("oninput","return;"),_v=typeof uE.oninput=="function"}wv=_v}else wv=!1;cE=wv&&(!document.documentMode||9<document.documentMode)}function fE(){wf&&(wf.detachEvent("onpropertychange",dE),_f=wf=null)}function dE(s){if(s.propertyName==="value"&&th(_f)){var o=[];lE(o,_f,s,dv(s)),XS(wF,o)}}function _F(s,o,h){s==="focusin"?(fE(),wf=o,_f=h,wf.attachEvent("onpropertychange",dE)):s==="focusout"&&fE()}function SF(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return th(_f)}function EF(s,o){if(s==="click")return th(o)}function NF(s,o){if(s==="input"||s==="change")return th(o)}function kF(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var Za=typeof Object.is=="function"?Object.is:kF;function Sf(s,o){if(Za(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var h=Object.keys(s),g=Object.keys(o);if(h.length!==g.length)return!1;for(g=0;g<h.length;g++){var w=h[g];if(!mt.call(o,w)||!Za(s[w],o[w]))return!1}return!0}function hE(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function mE(s,o){var h=hE(s);s=0;for(var g;h;){if(h.nodeType===3){if(g=s+h.textContent.length,s<=o&&g>=o)return{node:h,offset:o-s};s=g}e:{for(;h;){if(h.nextSibling){h=h.nextSibling;break e}h=h.parentNode}h=void 0}h=hE(h)}}function pE(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?pE(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function gE(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Fr(s.document);o instanceof s.HTMLIFrameElement;){try{var h=typeof o.contentWindow.location.href=="string"}catch{h=!1}if(h)s=o.contentWindow;else break;o=Fr(s.document)}return o}function Sv(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var TF=Ms&&"documentMode"in document&&11>=document.documentMode,Bc=null,Ev=null,Ef=null,Nv=!1;function vE(s,o,h){var g=h.window===h?h.document:h.nodeType===9?h:h.ownerDocument;Nv||Bc==null||Bc!==Fr(g)||(g=Bc,"selectionStart"in g&&Sv(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Ef&&Sf(Ef,g)||(Ef=g,g=Hh(Ev,"onSelect"),0<g.length&&(o=new Z0("onSelect","select",null,o,h),s.push({event:o,listeners:g}),o.target=Bc)))}function Eo(s,o){var h={};return h[s.toLowerCase()]=o.toLowerCase(),h["Webkit"+s]="webkit"+o,h["Moz"+s]="moz"+o,h}var Uc={animationend:Eo("Animation","AnimationEnd"),animationiteration:Eo("Animation","AnimationIteration"),animationstart:Eo("Animation","AnimationStart"),transitionrun:Eo("Transition","TransitionRun"),transitionstart:Eo("Transition","TransitionStart"),transitioncancel:Eo("Transition","TransitionCancel"),transitionend:Eo("Transition","TransitionEnd")},kv={},xE={};Ms&&(xE=document.createElement("div").style,"AnimationEvent"in window||(delete Uc.animationend.animation,delete Uc.animationiteration.animation,delete Uc.animationstart.animation),"TransitionEvent"in window||delete Uc.transitionend.transition);function No(s){if(kv[s])return kv[s];if(!Uc[s])return s;var o=Uc[s],h;for(h in o)if(o.hasOwnProperty(h)&&h in xE)return kv[s]=o[h];return s}var yE=No("animationend"),bE=No("animationiteration"),wE=No("animationstart"),AF=No("transitionrun"),jF=No("transitionstart"),OF=No("transitioncancel"),_E=No("transitionend"),SE=new Map,Tv="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Tv.push("scrollEnd");function Gi(s,o){SE.set(s,o),Se(o,[s])}var rh=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},wi=[],$c=0,Av=0;function nh(){for(var s=$c,o=Av=$c=0;o<s;){var h=wi[o];wi[o++]=null;var g=wi[o];wi[o++]=null;var w=wi[o];wi[o++]=null;var S=wi[o];if(wi[o++]=null,g!==null&&w!==null){var D=g.pending;D===null?w.next=w:(w.next=D.next,D.next=w),g.pending=w}S!==0&&EE(h,w,S)}}function ah(s,o,h,g){wi[$c++]=s,wi[$c++]=o,wi[$c++]=h,wi[$c++]=g,Av|=g,s.lanes|=g,s=s.alternate,s!==null&&(s.lanes|=g)}function jv(s,o,h,g){return ah(s,o,h,g),ih(s)}function ko(s,o){return ah(s,null,null,o),ih(s)}function EE(s,o,h){s.lanes|=h;var g=s.alternate;g!==null&&(g.lanes|=h);for(var w=!1,S=s.return;S!==null;)S.childLanes|=h,g=S.alternate,g!==null&&(g.childLanes|=h),S.tag===22&&(s=S.stateNode,s===null||s._visibility&1||(w=!0)),s=S,S=S.return;return s.tag===3?(S=s.stateNode,w&&o!==null&&(w=31-Tr(h),s=S.hiddenUpdates,g=s[w],g===null?s[w]=[o]:g.push(o),o.lane=h|536870912),S):null}function ih(s){if(50<Vf)throw Vf=0,Lx=null,Error(n(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var zc={};function CF(s,o,h,g){this.tag=s,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ei(s,o,h,g){return new CF(s,o,h,g)}function Ov(s){return s=s.prototype,!(!s||!s.isReactComponent)}function Rs(s,o){var h=s.alternate;return h===null?(h=ei(s.tag,o,s.key,s.mode),h.elementType=s.elementType,h.type=s.type,h.stateNode=s.stateNode,h.alternate=s,s.alternate=h):(h.pendingProps=o,h.type=s.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=s.flags&65011712,h.childLanes=s.childLanes,h.lanes=s.lanes,h.child=s.child,h.memoizedProps=s.memoizedProps,h.memoizedState=s.memoizedState,h.updateQueue=s.updateQueue,o=s.dependencies,h.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},h.sibling=s.sibling,h.index=s.index,h.ref=s.ref,h.refCleanup=s.refCleanup,h}function NE(s,o){s.flags&=65011714;var h=s.alternate;return h===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=h.childLanes,s.lanes=h.lanes,s.child=h.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=h.memoizedProps,s.memoizedState=h.memoizedState,s.updateQueue=h.updateQueue,s.type=h.type,o=h.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function sh(s,o,h,g,w,S){var D=0;if(g=s,typeof s=="function")Ov(s)&&(D=1);else if(typeof s=="string")D=RL(s,h,F.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case U:return s=ei(31,h,o,w),s.elementType=U,s.lanes=S,s;case b:return To(h.children,w,S,o);case _:D=8,w|=24;break;case E:return s=ei(12,h,o,w|2),s.elementType=E,s.lanes=S,s;case I:return s=ei(13,h,o,w),s.elementType=I,s.lanes=S,s;case O:return s=ei(19,h,o,w),s.elementType=O,s.lanes=S,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case T:D=10;break e;case A:D=9;break e;case k:D=11;break e;case j:D=14;break e;case B:D=16,g=null;break e}D=29,h=Error(n(130,s===null?"null":typeof s,"")),g=null}return o=ei(D,h,o,w),o.elementType=s,o.type=g,o.lanes=S,o}function To(s,o,h,g){return s=ei(7,s,g,o),s.lanes=h,s}function Cv(s,o,h){return s=ei(6,s,null,o),s.lanes=h,s}function kE(s){var o=ei(18,null,null,0);return o.stateNode=s,o}function Dv(s,o,h){return o=ei(4,s.children!==null?s.children:[],s.key,o),o.lanes=h,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var TE=new WeakMap;function _i(s,o){if(typeof s=="object"&&s!==null){var h=TE.get(s);return h!==void 0?h:(o={value:s,source:o,stack:wt(o)},TE.set(s,o),o)}return{value:s,source:o,stack:wt(o)}}var Hc=[],qc=0,lh=null,Nf=0,Si=[],Ei=0,Al=null,hs=1,ms="";function Fs(s,o){Hc[qc++]=Nf,Hc[qc++]=lh,lh=s,Nf=o}function AE(s,o,h){Si[Ei++]=hs,Si[Ei++]=ms,Si[Ei++]=Al,Al=s;var g=hs;s=ms;var w=32-Tr(g)-1;g&=~(1<<w),h+=1;var S=32-Tr(o)+w;if(30<S){var D=w-w%5;S=(g&(1<<D)-1).toString(32),g>>=D,w-=D,hs=1<<32-Tr(o)+w|h<<w|g,ms=S+s}else hs=1<<S|h<<w|g,ms=s}function Iv(s){s.return!==null&&(Fs(s,1),AE(s,1,0))}function Pv(s){for(;s===lh;)lh=Hc[--qc],Hc[qc]=null,Nf=Hc[--qc],Hc[qc]=null;for(;s===Al;)Al=Si[--Ei],Si[Ei]=null,ms=Si[--Ei],Si[Ei]=null,hs=Si[--Ei],Si[Ei]=null}function jE(s,o){Si[Ei++]=hs,Si[Ei++]=ms,Si[Ei++]=Al,hs=o.id,ms=o.overflow,Al=s}var aa=null,Hr=null,tr=!1,jl=null,Ni=!1,Mv=Error(n(519));function Ol(s){var o=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw kf(_i(o,s)),Mv}function OE(s){var o=s.stateNode,h=s.type,g=s.memoizedProps;switch(o[H]=s,o[Z]=g,h){case"dialog":Yt("cancel",o),Yt("close",o);break;case"iframe":case"object":case"embed":Yt("load",o);break;case"video":case"audio":for(h=0;h<Kf.length;h++)Yt(Kf[h],o);break;case"source":Yt("error",o);break;case"img":case"image":case"link":Yt("error",o),Yt("load",o);break;case"details":Yt("toggle",o);break;case"input":Yt("invalid",o),rt(o,g.value,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name,!0);break;case"select":Yt("invalid",o);break;case"textarea":Yt("invalid",o),lt(o,g.value,g.defaultValue,g.children)}h=g.children,typeof h!="string"&&typeof h!="number"&&typeof h!="bigint"||o.textContent===""+h||g.suppressHydrationWarning===!0||Gk(o.textContent,h)?(g.popover!=null&&(Yt("beforetoggle",o),Yt("toggle",o)),g.onScroll!=null&&Yt("scroll",o),g.onScrollEnd!=null&&Yt("scrollend",o),g.onClick!=null&&(o.onclick=Ps),o=!0):o=!1,o||Ol(s,!0)}function CE(s){for(aa=s.return;aa;)switch(aa.tag){case 5:case 31:case 13:Ni=!1;return;case 27:case 3:Ni=!0;return;default:aa=aa.return}}function Wc(s){if(s!==aa)return!1;if(!tr)return CE(s),tr=!0,!1;var o=s.tag,h;if((h=o!==3&&o!==27)&&((h=o===5)&&(h=s.type,h=!(h!=="form"&&h!=="button")||Zx(s.type,s.memoizedProps)),h=!h),h&&Hr&&Ol(s),CE(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Hr=rT(s)}else if(o===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(317));Hr=rT(s)}else o===27?(o=Hr,ql(s.type)?(s=ay,ay=null,Hr=s):Hr=o):Hr=aa?Ti(s.stateNode.nextSibling):null;return!0}function Ao(){Hr=aa=null,tr=!1}function Rv(){var s=jl;return s!==null&&(qa===null?qa=s:qa.push.apply(qa,s),jl=null),s}function kf(s){jl===null?jl=[s]:jl.push(s)}var Fv=G(null),jo=null,Ls=null;function Cl(s,o,h){W(Fv,o._currentValue),o._currentValue=h}function Bs(s){s._currentValue=Fv.current,P(Fv)}function Lv(s,o,h){for(;s!==null;){var g=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),s===h)break;s=s.return}}function Bv(s,o,h,g){var w=s.child;for(w!==null&&(w.return=s);w!==null;){var S=w.dependencies;if(S!==null){var D=w.child;S=S.firstContext;e:for(;S!==null;){var X=S;S=w;for(var me=0;me<o.length;me++)if(X.context===o[me]){S.lanes|=h,X=S.alternate,X!==null&&(X.lanes|=h),Lv(S.return,h,s),g||(D=null);break e}S=X.next}}else if(w.tag===18){if(D=w.return,D===null)throw Error(n(341));D.lanes|=h,S=D.alternate,S!==null&&(S.lanes|=h),Lv(D,h,s),D=null}else D=w.child;if(D!==null)D.return=w;else for(D=w;D!==null;){if(D===s){D=null;break}if(w=D.sibling,w!==null){w.return=D.return,D=w;break}D=D.return}w=D}}function Vc(s,o,h,g){s=null;for(var w=o,S=!1;w!==null;){if(!S){if((w.flags&524288)!==0)S=!0;else if((w.flags&262144)!==0)break}if(w.tag===10){var D=w.alternate;if(D===null)throw Error(n(387));if(D=D.memoizedProps,D!==null){var X=w.type;Za(w.pendingProps.value,D.value)||(s!==null?s.push(X):s=[X])}}else if(w===pe.current){if(D=w.alternate,D===null)throw Error(n(387));D.memoizedState.memoizedState!==w.memoizedState.memoizedState&&(s!==null?s.push(Zf):s=[Zf])}w=w.return}s!==null&&Bv(o,s,h,g),o.flags|=262144}function oh(s){for(s=s.firstContext;s!==null;){if(!Za(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Oo(s){jo=s,Ls=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function ia(s){return DE(jo,s)}function ch(s,o){return jo===null&&Oo(s),DE(s,o)}function DE(s,o){var h=o._currentValue;if(o={context:o,memoizedValue:h,next:null},Ls===null){if(s===null)throw Error(n(308));Ls=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else Ls=Ls.next=o;return h}var DF=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(h,g){s.push(g)}};this.abort=function(){o.aborted=!0,s.forEach(function(h){return h()})}},IF=e.unstable_scheduleCallback,PF=e.unstable_NormalPriority,_n={$$typeof:T,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uv(){return{controller:new DF,data:new Map,refCount:0}}function Tf(s){s.refCount--,s.refCount===0&&IF(PF,function(){s.controller.abort()})}var Af=null,$v=0,Gc=0,Kc=null;function MF(s,o){if(Af===null){var h=Af=[];$v=0,Gc=qx(),Kc={status:"pending",value:void 0,then:function(g){h.push(g)}}}return $v++,o.then(IE,IE),o}function IE(){if(--$v===0&&Af!==null){Kc!==null&&(Kc.status="fulfilled");var s=Af;Af=null,Gc=0,Kc=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function RF(s,o){var h=[],g={status:"pending",value:null,reason:null,then:function(w){h.push(w)}};return s.then(function(){g.status="fulfilled",g.value=o;for(var w=0;w<h.length;w++)(0,h[w])(o)},function(w){for(g.status="rejected",g.reason=w,w=0;w<h.length;w++)(0,h[w])(void 0)}),g}var PE=z.S;z.S=function(s,o){vk=at(),typeof o=="object"&&o!==null&&typeof o.then=="function"&&MF(s,o),PE!==null&&PE(s,o)};var Co=G(null);function zv(){var s=Co.current;return s!==null?s:Mr.pooledCache}function uh(s,o){o===null?W(Co,Co.current):W(Co,o.pool)}function ME(){var s=zv();return s===null?null:{parent:_n._currentValue,pool:s}}var Xc=Error(n(460)),Hv=Error(n(474)),fh=Error(n(542)),dh={then:function(){}};function RE(s){return s=s.status,s==="fulfilled"||s==="rejected"}function FE(s,o,h){switch(h=s[h],h===void 0?s.push(o):h!==o&&(o.then(Ps,Ps),o=h),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,BE(s),s;default:if(typeof o.status=="string")o.then(Ps,Ps);else{if(s=Mr,s!==null&&100<s.shellSuspendCounter)throw Error(n(482));s=o,s.status="pending",s.then(function(g){if(o.status==="pending"){var w=o;w.status="fulfilled",w.value=g}},function(g){if(o.status==="pending"){var w=o;w.status="rejected",w.reason=g}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,BE(s),s}throw Io=o,Xc}}function Do(s){try{var o=s._init;return o(s._payload)}catch(h){throw h!==null&&typeof h=="object"&&typeof h.then=="function"?(Io=h,Xc):h}}var Io=null;function LE(){if(Io===null)throw Error(n(459));var s=Io;return Io=null,s}function BE(s){if(s===Xc||s===fh)throw Error(n(483))}var Yc=null,jf=0;function hh(s){var o=jf;return jf+=1,Yc===null&&(Yc=[]),FE(Yc,s,o)}function Of(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function mh(s,o){throw o.$$typeof===v?Error(n(525)):(s=Object.prototype.toString.call(o),Error(n(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function UE(s){function o(_e,ye){if(s){var Ne=_e.deletions;Ne===null?(_e.deletions=[ye],_e.flags|=16):Ne.push(ye)}}function h(_e,ye){if(!s)return null;for(;ye!==null;)o(_e,ye),ye=ye.sibling;return null}function g(_e){for(var ye=new Map;_e!==null;)_e.key!==null?ye.set(_e.key,_e):ye.set(_e.index,_e),_e=_e.sibling;return ye}function w(_e,ye){return _e=Rs(_e,ye),_e.index=0,_e.sibling=null,_e}function S(_e,ye,Ne){return _e.index=Ne,s?(Ne=_e.alternate,Ne!==null?(Ne=Ne.index,Ne<ye?(_e.flags|=67108866,ye):Ne):(_e.flags|=67108866,ye)):(_e.flags|=1048576,ye)}function D(_e){return s&&_e.alternate===null&&(_e.flags|=67108866),_e}function X(_e,ye,Ne,Be){return ye===null||ye.tag!==6?(ye=Cv(Ne,_e.mode,Be),ye.return=_e,ye):(ye=w(ye,Ne),ye.return=_e,ye)}function me(_e,ye,Ne,Be){var Nt=Ne.type;return Nt===b?Me(_e,ye,Ne.props.children,Be,Ne.key):ye!==null&&(ye.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===B&&Do(Nt)===ye.type)?(ye=w(ye,Ne.props),Of(ye,Ne),ye.return=_e,ye):(ye=sh(Ne.type,Ne.key,Ne.props,null,_e.mode,Be),Of(ye,Ne),ye.return=_e,ye)}function ke(_e,ye,Ne,Be){return ye===null||ye.tag!==4||ye.stateNode.containerInfo!==Ne.containerInfo||ye.stateNode.implementation!==Ne.implementation?(ye=Dv(Ne,_e.mode,Be),ye.return=_e,ye):(ye=w(ye,Ne.children||[]),ye.return=_e,ye)}function Me(_e,ye,Ne,Be,Nt){return ye===null||ye.tag!==7?(ye=To(Ne,_e.mode,Be,Nt),ye.return=_e,ye):(ye=w(ye,Ne),ye.return=_e,ye)}function $e(_e,ye,Ne){if(typeof ye=="string"&&ye!==""||typeof ye=="number"||typeof ye=="bigint")return ye=Cv(""+ye,_e.mode,Ne),ye.return=_e,ye;if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case x:return Ne=sh(ye.type,ye.key,ye.props,null,_e.mode,Ne),Of(Ne,ye),Ne.return=_e,Ne;case y:return ye=Dv(ye,_e.mode,Ne),ye.return=_e,ye;case B:return ye=Do(ye),$e(_e,ye,Ne)}if(ve(ye)||V(ye))return ye=To(ye,_e.mode,Ne,null),ye.return=_e,ye;if(typeof ye.then=="function")return $e(_e,hh(ye),Ne);if(ye.$$typeof===T)return $e(_e,ch(_e,ye),Ne);mh(_e,ye)}return null}function je(_e,ye,Ne,Be){var Nt=ye!==null?ye.key:null;if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return Nt!==null?null:X(_e,ye,""+Ne,Be);if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case x:return Ne.key===Nt?me(_e,ye,Ne,Be):null;case y:return Ne.key===Nt?ke(_e,ye,Ne,Be):null;case B:return Ne=Do(Ne),je(_e,ye,Ne,Be)}if(ve(Ne)||V(Ne))return Nt!==null?null:Me(_e,ye,Ne,Be,null);if(typeof Ne.then=="function")return je(_e,ye,hh(Ne),Be);if(Ne.$$typeof===T)return je(_e,ye,ch(_e,Ne),Be);mh(_e,Ne)}return null}function De(_e,ye,Ne,Be,Nt){if(typeof Be=="string"&&Be!==""||typeof Be=="number"||typeof Be=="bigint")return _e=_e.get(Ne)||null,X(ye,_e,""+Be,Nt);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case x:return _e=_e.get(Be.key===null?Ne:Be.key)||null,me(ye,_e,Be,Nt);case y:return _e=_e.get(Be.key===null?Ne:Be.key)||null,ke(ye,_e,Be,Nt);case B:return Be=Do(Be),De(_e,ye,Ne,Be,Nt)}if(ve(Be)||V(Be))return _e=_e.get(Ne)||null,Me(ye,_e,Be,Nt,null);if(typeof Be.then=="function")return De(_e,ye,Ne,hh(Be),Nt);if(Be.$$typeof===T)return De(_e,ye,Ne,ch(ye,Be),Nt);mh(ye,Be)}return null}function ht(_e,ye,Ne,Be){for(var Nt=null,or=null,vt=ye,$t=ye=0,Jt=null;vt!==null&&$t<Ne.length;$t++){vt.index>$t?(Jt=vt,vt=null):Jt=vt.sibling;var cr=je(_e,vt,Ne[$t],Be);if(cr===null){vt===null&&(vt=Jt);break}s&&vt&&cr.alternate===null&&o(_e,vt),ye=S(cr,ye,$t),or===null?Nt=cr:or.sibling=cr,or=cr,vt=Jt}if($t===Ne.length)return h(_e,vt),tr&&Fs(_e,$t),Nt;if(vt===null){for(;$t<Ne.length;$t++)vt=$e(_e,Ne[$t],Be),vt!==null&&(ye=S(vt,ye,$t),or===null?Nt=vt:or.sibling=vt,or=vt);return tr&&Fs(_e,$t),Nt}for(vt=g(vt);$t<Ne.length;$t++)Jt=De(vt,_e,$t,Ne[$t],Be),Jt!==null&&(s&&Jt.alternate!==null&&vt.delete(Jt.key===null?$t:Jt.key),ye=S(Jt,ye,$t),or===null?Nt=Jt:or.sibling=Jt,or=Jt);return s&&vt.forEach(function(Xl){return o(_e,Xl)}),tr&&Fs(_e,$t),Nt}function At(_e,ye,Ne,Be){if(Ne==null)throw Error(n(151));for(var Nt=null,or=null,vt=ye,$t=ye=0,Jt=null,cr=Ne.next();vt!==null&&!cr.done;$t++,cr=Ne.next()){vt.index>$t?(Jt=vt,vt=null):Jt=vt.sibling;var Xl=je(_e,vt,cr.value,Be);if(Xl===null){vt===null&&(vt=Jt);break}s&&vt&&Xl.alternate===null&&o(_e,vt),ye=S(Xl,ye,$t),or===null?Nt=Xl:or.sibling=Xl,or=Xl,vt=Jt}if(cr.done)return h(_e,vt),tr&&Fs(_e,$t),Nt;if(vt===null){for(;!cr.done;$t++,cr=Ne.next())cr=$e(_e,cr.value,Be),cr!==null&&(ye=S(cr,ye,$t),or===null?Nt=cr:or.sibling=cr,or=cr);return tr&&Fs(_e,$t),Nt}for(vt=g(vt);!cr.done;$t++,cr=Ne.next())cr=De(vt,_e,$t,cr.value,Be),cr!==null&&(s&&cr.alternate!==null&&vt.delete(cr.key===null?$t:cr.key),ye=S(cr,ye,$t),or===null?Nt=cr:or.sibling=cr,or=cr);return s&&vt.forEach(function(GL){return o(_e,GL)}),tr&&Fs(_e,$t),Nt}function Cr(_e,ye,Ne,Be){if(typeof Ne=="object"&&Ne!==null&&Ne.type===b&&Ne.key===null&&(Ne=Ne.props.children),typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case x:e:{for(var Nt=Ne.key;ye!==null;){if(ye.key===Nt){if(Nt=Ne.type,Nt===b){if(ye.tag===7){h(_e,ye.sibling),Be=w(ye,Ne.props.children),Be.return=_e,_e=Be;break e}}else if(ye.elementType===Nt||typeof Nt=="object"&&Nt!==null&&Nt.$$typeof===B&&Do(Nt)===ye.type){h(_e,ye.sibling),Be=w(ye,Ne.props),Of(Be,Ne),Be.return=_e,_e=Be;break e}h(_e,ye);break}else o(_e,ye);ye=ye.sibling}Ne.type===b?(Be=To(Ne.props.children,_e.mode,Be,Ne.key),Be.return=_e,_e=Be):(Be=sh(Ne.type,Ne.key,Ne.props,null,_e.mode,Be),Of(Be,Ne),Be.return=_e,_e=Be)}return D(_e);case y:e:{for(Nt=Ne.key;ye!==null;){if(ye.key===Nt)if(ye.tag===4&&ye.stateNode.containerInfo===Ne.containerInfo&&ye.stateNode.implementation===Ne.implementation){h(_e,ye.sibling),Be=w(ye,Ne.children||[]),Be.return=_e,_e=Be;break e}else{h(_e,ye);break}else o(_e,ye);ye=ye.sibling}Be=Dv(Ne,_e.mode,Be),Be.return=_e,_e=Be}return D(_e);case B:return Ne=Do(Ne),Cr(_e,ye,Ne,Be)}if(ve(Ne))return ht(_e,ye,Ne,Be);if(V(Ne)){if(Nt=V(Ne),typeof Nt!="function")throw Error(n(150));return Ne=Nt.call(Ne),At(_e,ye,Ne,Be)}if(typeof Ne.then=="function")return Cr(_e,ye,hh(Ne),Be);if(Ne.$$typeof===T)return Cr(_e,ye,ch(_e,Ne),Be);mh(_e,Ne)}return typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint"?(Ne=""+Ne,ye!==null&&ye.tag===6?(h(_e,ye.sibling),Be=w(ye,Ne),Be.return=_e,_e=Be):(h(_e,ye),Be=Cv(Ne,_e.mode,Be),Be.return=_e,_e=Be),D(_e)):h(_e,ye)}return function(_e,ye,Ne,Be){try{jf=0;var Nt=Cr(_e,ye,Ne,Be);return Yc=null,Nt}catch(vt){if(vt===Xc||vt===fh)throw vt;var or=ei(29,vt,null,_e.mode);return or.lanes=Be,or.return=_e,or}finally{}}}var Po=UE(!0),$E=UE(!1),Dl=!1;function qv(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Wv(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Il(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Pl(s,o,h){var g=s.updateQueue;if(g===null)return null;if(g=g.shared,(dr&2)!==0){var w=g.pending;return w===null?o.next=o:(o.next=w.next,w.next=o),g.pending=o,o=ih(s),EE(s,null,h),o}return ah(s,g,o,h),ih(s)}function Cf(s,o,h){if(o=o.updateQueue,o!==null&&(o=o.shared,(h&4194048)!==0)){var g=o.lanes;g&=s.pendingLanes,h|=g,o.lanes=h,Ue(s,h)}}function Vv(s,o){var h=s.updateQueue,g=s.alternate;if(g!==null&&(g=g.updateQueue,h===g)){var w=null,S=null;if(h=h.firstBaseUpdate,h!==null){do{var D={lane:h.lane,tag:h.tag,payload:h.payload,callback:null,next:null};S===null?w=S=D:S=S.next=D,h=h.next}while(h!==null);S===null?w=S=o:S=S.next=o}else w=S=o;h={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:S,shared:g.shared,callbacks:g.callbacks},s.updateQueue=h;return}s=h.lastBaseUpdate,s===null?h.firstBaseUpdate=o:s.next=o,h.lastBaseUpdate=o}var Gv=!1;function Df(){if(Gv){var s=Kc;if(s!==null)throw s}}function If(s,o,h,g){Gv=!1;var w=s.updateQueue;Dl=!1;var S=w.firstBaseUpdate,D=w.lastBaseUpdate,X=w.shared.pending;if(X!==null){w.shared.pending=null;var me=X,ke=me.next;me.next=null,D===null?S=ke:D.next=ke,D=me;var Me=s.alternate;Me!==null&&(Me=Me.updateQueue,X=Me.lastBaseUpdate,X!==D&&(X===null?Me.firstBaseUpdate=ke:X.next=ke,Me.lastBaseUpdate=me))}if(S!==null){var $e=w.baseState;D=0,Me=ke=me=null,X=S;do{var je=X.lane&-536870913,De=je!==X.lane;if(De?(Qt&je)===je:(g&je)===je){je!==0&&je===Gc&&(Gv=!0),Me!==null&&(Me=Me.next={lane:0,tag:X.tag,payload:X.payload,callback:null,next:null});e:{var ht=s,At=X;je=o;var Cr=h;switch(At.tag){case 1:if(ht=At.payload,typeof ht=="function"){$e=ht.call(Cr,$e,je);break e}$e=ht;break e;case 3:ht.flags=ht.flags&-65537|128;case 0:if(ht=At.payload,je=typeof ht=="function"?ht.call(Cr,$e,je):ht,je==null)break e;$e=p({},$e,je);break e;case 2:Dl=!0}}je=X.callback,je!==null&&(s.flags|=64,De&&(s.flags|=8192),De=w.callbacks,De===null?w.callbacks=[je]:De.push(je))}else De={lane:je,tag:X.tag,payload:X.payload,callback:X.callback,next:null},Me===null?(ke=Me=De,me=$e):Me=Me.next=De,D|=je;if(X=X.next,X===null){if(X=w.shared.pending,X===null)break;De=X,X=De.next,De.next=null,w.lastBaseUpdate=De,w.shared.pending=null}}while(!0);Me===null&&(me=$e),w.baseState=me,w.firstBaseUpdate=ke,w.lastBaseUpdate=Me,S===null&&(w.shared.lanes=0),Bl|=D,s.lanes=D,s.memoizedState=$e}}function zE(s,o){if(typeof s!="function")throw Error(n(191,s));s.call(o)}function HE(s,o){var h=s.callbacks;if(h!==null)for(s.callbacks=null,s=0;s<h.length;s++)zE(h[s],o)}var Qc=G(null),ph=G(0);function qE(s,o){s=Ks,W(ph,s),W(Qc,o),Ks=s|o.baseLanes}function Kv(){W(ph,Ks),W(Qc,Qc.current)}function Xv(){Ks=ph.current,P(Qc),P(ph)}var ti=G(null),ki=null;function Ml(s){var o=s.alternate;W(gn,gn.current&1),W(ti,s),ki===null&&(o===null||Qc.current!==null||o.memoizedState!==null)&&(ki=s)}function Yv(s){W(gn,gn.current),W(ti,s),ki===null&&(ki=s)}function WE(s){s.tag===22?(W(gn,gn.current),W(ti,s),ki===null&&(ki=s)):Rl()}function Rl(){W(gn,gn.current),W(ti,ti.current)}function ri(s){P(ti),ki===s&&(ki=null),P(gn)}var gn=G(0);function gh(s){for(var o=s;o!==null;){if(o.tag===13){var h=o.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||ry(h)||ny(h)))return o}else if(o.tag===19&&(o.memoizedProps.revealOrder==="forwards"||o.memoizedProps.revealOrder==="backwards"||o.memoizedProps.revealOrder==="unstable_legacy-backwards"||o.memoizedProps.revealOrder==="together")){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Us=0,Bt=null,jr=null,Sn=null,vh=!1,Jc=!1,Mo=!1,xh=0,Pf=0,Zc=null,FF=0;function an(){throw Error(n(321))}function Qv(s,o){if(o===null)return!1;for(var h=0;h<o.length&&h<s.length;h++)if(!Za(s[h],o[h]))return!1;return!0}function Jv(s,o,h,g,w,S){return Us=S,Bt=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,z.H=s===null||s.memoizedState===null?AN:hx,Mo=!1,S=h(g,w),Mo=!1,Jc&&(S=GE(o,h,g,w)),VE(s),S}function VE(s){z.H=Ff;var o=jr!==null&&jr.next!==null;if(Us=0,Sn=jr=Bt=null,vh=!1,Pf=0,Zc=null,o)throw Error(n(300));s===null||En||(s=s.dependencies,s!==null&&oh(s)&&(En=!0))}function GE(s,o,h,g){Bt=s;var w=0;do{if(Jc&&(Zc=null),Pf=0,Jc=!1,25<=w)throw Error(n(301));if(w+=1,Sn=jr=null,s.updateQueue!=null){var S=s.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}z.H=jN,S=o(h,g)}while(Jc);return S}function LF(){var s=z.H,o=s.useState()[0];return o=typeof o.then=="function"?Mf(o):o,s=s.useState()[0],(jr!==null?jr.memoizedState:null)!==s&&(Bt.flags|=1024),o}function Zv(){var s=xh!==0;return xh=0,s}function ex(s,o,h){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~h}function tx(s){if(vh){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}vh=!1}Us=0,Sn=jr=Bt=null,Jc=!1,Pf=xh=0,Zc=null}function Ca(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Sn===null?Bt.memoizedState=Sn=s:Sn=Sn.next=s,Sn}function vn(){if(jr===null){var s=Bt.alternate;s=s!==null?s.memoizedState:null}else s=jr.next;var o=Sn===null?Bt.memoizedState:Sn.next;if(o!==null)Sn=o,jr=s;else{if(s===null)throw Bt.alternate===null?Error(n(467)):Error(n(310));jr=s,s={memoizedState:jr.memoizedState,baseState:jr.baseState,baseQueue:jr.baseQueue,queue:jr.queue,next:null},Sn===null?Bt.memoizedState=Sn=s:Sn=Sn.next=s}return Sn}function yh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mf(s){var o=Pf;return Pf+=1,Zc===null&&(Zc=[]),s=FE(Zc,s,o),o=Bt,(Sn===null?o.memoizedState:Sn.next)===null&&(o=o.alternate,z.H=o===null||o.memoizedState===null?AN:hx),s}function bh(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Mf(s);if(s.$$typeof===T)return ia(s)}throw Error(n(438,String(s)))}function rx(s){var o=null,h=Bt.updateQueue;if(h!==null&&(o=h.memoCache),o==null){var g=Bt.alternate;g!==null&&(g=g.updateQueue,g!==null&&(g=g.memoCache,g!=null&&(o={data:g.data.map(function(w){return w.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),h===null&&(h=yh(),Bt.updateQueue=h),h.memoCache=o,h=o.data[o.index],h===void 0)for(h=o.data[o.index]=Array(s),g=0;g<s;g++)h[g]=Y;return o.index++,h}function $s(s,o){return typeof o=="function"?o(s):o}function wh(s){var o=vn();return nx(o,jr,s)}function nx(s,o,h){var g=s.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=h;var w=s.baseQueue,S=g.pending;if(S!==null){if(w!==null){var D=w.next;w.next=S.next,S.next=D}o.baseQueue=w=S,g.pending=null}if(S=s.baseState,w===null)s.memoizedState=S;else{o=w.next;var X=D=null,me=null,ke=o,Me=!1;do{var $e=ke.lane&-536870913;if($e!==ke.lane?(Qt&$e)===$e:(Us&$e)===$e){var je=ke.revertLane;if(je===0)me!==null&&(me=me.next={lane:0,revertLane:0,gesture:null,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),$e===Gc&&(Me=!0);else if((Us&je)===je){ke=ke.next,je===Gc&&(Me=!0);continue}else $e={lane:0,revertLane:ke.revertLane,gesture:null,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null},me===null?(X=me=$e,D=S):me=me.next=$e,Bt.lanes|=je,Bl|=je;$e=ke.action,Mo&&h(S,$e),S=ke.hasEagerState?ke.eagerState:h(S,$e)}else je={lane:$e,revertLane:ke.revertLane,gesture:ke.gesture,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null},me===null?(X=me=je,D=S):me=me.next=je,Bt.lanes|=$e,Bl|=$e;ke=ke.next}while(ke!==null&&ke!==o);if(me===null?D=S:me.next=X,!Za(S,s.memoizedState)&&(En=!0,Me&&(h=Kc,h!==null)))throw h;s.memoizedState=S,s.baseState=D,s.baseQueue=me,g.lastRenderedState=S}return w===null&&(g.lanes=0),[s.memoizedState,g.dispatch]}function ax(s){var o=vn(),h=o.queue;if(h===null)throw Error(n(311));h.lastRenderedReducer=s;var g=h.dispatch,w=h.pending,S=o.memoizedState;if(w!==null){h.pending=null;var D=w=w.next;do S=s(S,D.action),D=D.next;while(D!==w);Za(S,o.memoizedState)||(En=!0),o.memoizedState=S,o.baseQueue===null&&(o.baseState=S),h.lastRenderedState=S}return[S,g]}function KE(s,o,h){var g=Bt,w=vn(),S=tr;if(S){if(h===void 0)throw Error(n(407));h=h()}else h=o();var D=!Za((jr||w).memoizedState,h);if(D&&(w.memoizedState=h,En=!0),w=w.queue,lx(QE.bind(null,g,w,s),[s]),w.getSnapshot!==o||D||Sn!==null&&Sn.memoizedState.tag&1){if(g.flags|=2048,eu(9,{destroy:void 0},YE.bind(null,g,w,h,o),null),Mr===null)throw Error(n(349));S||(Us&127)!==0||XE(g,o,h)}return h}function XE(s,o,h){s.flags|=16384,s={getSnapshot:o,value:h},o=Bt.updateQueue,o===null?(o=yh(),Bt.updateQueue=o,o.stores=[s]):(h=o.stores,h===null?o.stores=[s]:h.push(s))}function YE(s,o,h,g){o.value=h,o.getSnapshot=g,JE(o)&&ZE(s)}function QE(s,o,h){return h(function(){JE(o)&&ZE(s)})}function JE(s){var o=s.getSnapshot;s=s.value;try{var h=o();return!Za(s,h)}catch{return!0}}function ZE(s){var o=ko(s,2);o!==null&&Wa(o,s,2)}function ix(s){var o=Ca();if(typeof s=="function"){var h=s;if(s=h(),Mo){Yr(!0);try{h()}finally{Yr(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:s},o}function eN(s,o,h,g){return s.baseState=h,nx(s,jr,typeof g=="function"?g:$s)}function BF(s,o,h,g,w){if(Eh(s))throw Error(n(485));if(s=o.action,s!==null){var S={payload:w,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(D){S.listeners.push(D)}};z.T!==null?h(!0):S.isTransition=!1,g(S),h=o.pending,h===null?(S.next=o.pending=S,tN(o,S)):(S.next=h.next,o.pending=h.next=S)}}function tN(s,o){var h=o.action,g=o.payload,w=s.state;if(o.isTransition){var S=z.T,D={};z.T=D;try{var X=h(w,g),me=z.S;me!==null&&me(D,X),rN(s,o,X)}catch(ke){sx(s,o,ke)}finally{S!==null&&D.types!==null&&(S.types=D.types),z.T=S}}else try{S=h(w,g),rN(s,o,S)}catch(ke){sx(s,o,ke)}}function rN(s,o,h){h!==null&&typeof h=="object"&&typeof h.then=="function"?h.then(function(g){nN(s,o,g)},function(g){return sx(s,o,g)}):nN(s,o,h)}function nN(s,o,h){o.status="fulfilled",o.value=h,aN(o),s.state=h,o=s.pending,o!==null&&(h=o.next,h===o?s.pending=null:(h=h.next,o.next=h,tN(s,h)))}function sx(s,o,h){var g=s.pending;if(s.pending=null,g!==null){g=g.next;do o.status="rejected",o.reason=h,aN(o),o=o.next;while(o!==g)}s.action=null}function aN(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function iN(s,o){return o}function sN(s,o){if(tr){var h=Mr.formState;if(h!==null){e:{var g=Bt;if(tr){if(Hr){t:{for(var w=Hr,S=Ni;w.nodeType!==8;){if(!S){w=null;break t}if(w=Ti(w.nextSibling),w===null){w=null;break t}}S=w.data,w=S==="F!"||S==="F"?w:null}if(w){Hr=Ti(w.nextSibling),g=w.data==="F!";break e}}Ol(g)}g=!1}g&&(o=h[0])}}return h=Ca(),h.memoizedState=h.baseState=o,g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:iN,lastRenderedState:o},h.queue=g,h=NN.bind(null,Bt,g),g.dispatch=h,g=ix(!1),S=dx.bind(null,Bt,!1,g.queue),g=Ca(),w={state:o,dispatch:null,action:s,pending:null},g.queue=w,h=BF.bind(null,Bt,w,S,h),w.dispatch=h,g.memoizedState=s,[o,h,!1]}function lN(s){var o=vn();return oN(o,jr,s)}function oN(s,o,h){if(o=nx(s,o,iN)[0],s=wh($s)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var g=Mf(o)}catch(D){throw D===Xc?fh:D}else g=o;o=vn();var w=o.queue,S=w.dispatch;return h!==o.memoizedState&&(Bt.flags|=2048,eu(9,{destroy:void 0},UF.bind(null,w,h),null)),[g,S,s]}function UF(s,o){s.action=o}function cN(s){var o=vn(),h=jr;if(h!==null)return oN(o,h,s);vn(),o=o.memoizedState,h=vn();var g=h.queue.dispatch;return h.memoizedState=s,[o,g,!1]}function eu(s,o,h,g){return s={tag:s,create:h,deps:g,inst:o,next:null},o=Bt.updateQueue,o===null&&(o=yh(),Bt.updateQueue=o),h=o.lastEffect,h===null?o.lastEffect=s.next=s:(g=h.next,h.next=s,s.next=g,o.lastEffect=s),s}function uN(){return vn().memoizedState}function _h(s,o,h,g){var w=Ca();Bt.flags|=s,w.memoizedState=eu(1|o,{destroy:void 0},h,g===void 0?null:g)}function Sh(s,o,h,g){var w=vn();g=g===void 0?null:g;var S=w.memoizedState.inst;jr!==null&&g!==null&&Qv(g,jr.memoizedState.deps)?w.memoizedState=eu(o,S,h,g):(Bt.flags|=s,w.memoizedState=eu(1|o,S,h,g))}function fN(s,o){_h(8390656,8,s,o)}function lx(s,o){Sh(2048,8,s,o)}function $F(s){Bt.flags|=4;var o=Bt.updateQueue;if(o===null)o=yh(),Bt.updateQueue=o,o.events=[s];else{var h=o.events;h===null?o.events=[s]:h.push(s)}}function dN(s){var o=vn().memoizedState;return $F({ref:o,nextImpl:s}),function(){if((dr&2)!==0)throw Error(n(440));return o.impl.apply(void 0,arguments)}}function hN(s,o){return Sh(4,2,s,o)}function mN(s,o){return Sh(4,4,s,o)}function pN(s,o){if(typeof o=="function"){s=s();var h=o(s);return function(){typeof h=="function"?h():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function gN(s,o,h){h=h!=null?h.concat([s]):null,Sh(4,4,pN.bind(null,o,s),h)}function ox(){}function vN(s,o){var h=vn();o=o===void 0?null:o;var g=h.memoizedState;return o!==null&&Qv(o,g[1])?g[0]:(h.memoizedState=[s,o],s)}function xN(s,o){var h=vn();o=o===void 0?null:o;var g=h.memoizedState;if(o!==null&&Qv(o,g[1]))return g[0];if(g=s(),Mo){Yr(!0);try{s()}finally{Yr(!1)}}return h.memoizedState=[g,o],g}function cx(s,o,h){return h===void 0||(Us&1073741824)!==0&&(Qt&261930)===0?s.memoizedState=o:(s.memoizedState=h,s=yk(),Bt.lanes|=s,Bl|=s,h)}function yN(s,o,h,g){return Za(h,o)?h:Qc.current!==null?(s=cx(s,h,g),Za(s,o)||(En=!0),s):(Us&42)===0||(Us&1073741824)!==0&&(Qt&261930)===0?(En=!0,s.memoizedState=h):(s=yk(),Bt.lanes|=s,Bl|=s,o)}function bN(s,o,h,g,w){var S=ue.p;ue.p=S!==0&&8>S?S:8;var D=z.T,X={};z.T=X,dx(s,!1,o,h);try{var me=w(),ke=z.S;if(ke!==null&&ke(X,me),me!==null&&typeof me=="object"&&typeof me.then=="function"){var Me=RF(me,g);Rf(s,o,Me,ii(s))}else Rf(s,o,g,ii(s))}catch($e){Rf(s,o,{then:function(){},status:"rejected",reason:$e},ii())}finally{ue.p=S,D!==null&&X.types!==null&&(D.types=X.types),z.T=D}}function zF(){}function ux(s,o,h,g){if(s.tag!==5)throw Error(n(476));var w=wN(s).queue;bN(s,w,o,se,h===null?zF:function(){return _N(s),h(g)})}function wN(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:se,baseState:se,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:se},next:null};var h={};return o.next={memoizedState:h,baseState:h,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:$s,lastRenderedState:h},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function _N(s){var o=wN(s);o.next===null&&(o=s.alternate.memoizedState),Rf(s,o.next.queue,{},ii())}function fx(){return ia(Zf)}function SN(){return vn().memoizedState}function EN(){return vn().memoizedState}function HF(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var h=ii();s=Il(h);var g=Pl(o,s,h);g!==null&&(Wa(g,o,h),Cf(g,o,h)),o={cache:Uv()},s.payload=o;return}o=o.return}}function qF(s,o,h){var g=ii();h={lane:g,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Eh(s)?kN(o,h):(h=jv(s,o,h,g),h!==null&&(Wa(h,s,g),TN(h,o,g)))}function NN(s,o,h){var g=ii();Rf(s,o,h,g)}function Rf(s,o,h,g){var w={lane:g,revertLane:0,gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null};if(Eh(s))kN(o,w);else{var S=s.alternate;if(s.lanes===0&&(S===null||S.lanes===0)&&(S=o.lastRenderedReducer,S!==null))try{var D=o.lastRenderedState,X=S(D,h);if(w.hasEagerState=!0,w.eagerState=X,Za(X,D))return ah(s,o,w,0),Mr===null&&nh(),!1}catch{}finally{}if(h=jv(s,o,w,g),h!==null)return Wa(h,s,g),TN(h,o,g),!0}return!1}function dx(s,o,h,g){if(g={lane:2,revertLane:qx(),gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Eh(s)){if(o)throw Error(n(479))}else o=jv(s,h,g,2),o!==null&&Wa(o,s,2)}function Eh(s){var o=s.alternate;return s===Bt||o!==null&&o===Bt}function kN(s,o){Jc=vh=!0;var h=s.pending;h===null?o.next=o:(o.next=h.next,h.next=o),s.pending=o}function TN(s,o,h){if((h&4194048)!==0){var g=o.lanes;g&=s.pendingLanes,h|=g,o.lanes=h,Ue(s,h)}}var Ff={readContext:ia,use:bh,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useLayoutEffect:an,useInsertionEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useSyncExternalStore:an,useId:an,useHostTransitionStatus:an,useFormState:an,useActionState:an,useOptimistic:an,useMemoCache:an,useCacheRefresh:an};Ff.useEffectEvent=an;var AN={readContext:ia,use:bh,useCallback:function(s,o){return Ca().memoizedState=[s,o===void 0?null:o],s},useContext:ia,useEffect:fN,useImperativeHandle:function(s,o,h){h=h!=null?h.concat([s]):null,_h(4194308,4,pN.bind(null,o,s),h)},useLayoutEffect:function(s,o){return _h(4194308,4,s,o)},useInsertionEffect:function(s,o){_h(4,2,s,o)},useMemo:function(s,o){var h=Ca();o=o===void 0?null:o;var g=s();if(Mo){Yr(!0);try{s()}finally{Yr(!1)}}return h.memoizedState=[g,o],g},useReducer:function(s,o,h){var g=Ca();if(h!==void 0){var w=h(o);if(Mo){Yr(!0);try{h(o)}finally{Yr(!1)}}}else w=o;return g.memoizedState=g.baseState=w,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:w},g.queue=s,s=s.dispatch=qF.bind(null,Bt,s),[g.memoizedState,s]},useRef:function(s){var o=Ca();return s={current:s},o.memoizedState=s},useState:function(s){s=ix(s);var o=s.queue,h=NN.bind(null,Bt,o);return o.dispatch=h,[s.memoizedState,h]},useDebugValue:ox,useDeferredValue:function(s,o){var h=Ca();return cx(h,s,o)},useTransition:function(){var s=ix(!1);return s=bN.bind(null,Bt,s.queue,!0,!1),Ca().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,h){var g=Bt,w=Ca();if(tr){if(h===void 0)throw Error(n(407));h=h()}else{if(h=o(),Mr===null)throw Error(n(349));(Qt&127)!==0||XE(g,o,h)}w.memoizedState=h;var S={value:h,getSnapshot:o};return w.queue=S,fN(QE.bind(null,g,S,s),[s]),g.flags|=2048,eu(9,{destroy:void 0},YE.bind(null,g,S,h,o),null),h},useId:function(){var s=Ca(),o=Mr.identifierPrefix;if(tr){var h=ms,g=hs;h=(g&~(1<<32-Tr(g)-1)).toString(32)+h,o="_"+o+"R_"+h,h=xh++,0<h&&(o+="H"+h.toString(32)),o+="_"}else h=FF++,o="_"+o+"r_"+h.toString(32)+"_";return s.memoizedState=o},useHostTransitionStatus:fx,useFormState:sN,useActionState:sN,useOptimistic:function(s){var o=Ca();o.memoizedState=o.baseState=s;var h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=h,o=dx.bind(null,Bt,!0,h),h.dispatch=o,[s,o]},useMemoCache:rx,useCacheRefresh:function(){return Ca().memoizedState=HF.bind(null,Bt)},useEffectEvent:function(s){var o=Ca(),h={impl:s};return o.memoizedState=h,function(){if((dr&2)!==0)throw Error(n(440));return h.impl.apply(void 0,arguments)}}},hx={readContext:ia,use:bh,useCallback:vN,useContext:ia,useEffect:lx,useImperativeHandle:gN,useInsertionEffect:hN,useLayoutEffect:mN,useMemo:xN,useReducer:wh,useRef:uN,useState:function(){return wh($s)},useDebugValue:ox,useDeferredValue:function(s,o){var h=vn();return yN(h,jr.memoizedState,s,o)},useTransition:function(){var s=wh($s)[0],o=vn().memoizedState;return[typeof s=="boolean"?s:Mf(s),o]},useSyncExternalStore:KE,useId:SN,useHostTransitionStatus:fx,useFormState:lN,useActionState:lN,useOptimistic:function(s,o){var h=vn();return eN(h,jr,s,o)},useMemoCache:rx,useCacheRefresh:EN};hx.useEffectEvent=dN;var jN={readContext:ia,use:bh,useCallback:vN,useContext:ia,useEffect:lx,useImperativeHandle:gN,useInsertionEffect:hN,useLayoutEffect:mN,useMemo:xN,useReducer:ax,useRef:uN,useState:function(){return ax($s)},useDebugValue:ox,useDeferredValue:function(s,o){var h=vn();return jr===null?cx(h,s,o):yN(h,jr.memoizedState,s,o)},useTransition:function(){var s=ax($s)[0],o=vn().memoizedState;return[typeof s=="boolean"?s:Mf(s),o]},useSyncExternalStore:KE,useId:SN,useHostTransitionStatus:fx,useFormState:cN,useActionState:cN,useOptimistic:function(s,o){var h=vn();return jr!==null?eN(h,jr,s,o):(h.baseState=s,[s,h.queue.dispatch])},useMemoCache:rx,useCacheRefresh:EN};jN.useEffectEvent=dN;function mx(s,o,h,g){o=s.memoizedState,h=h(g,o),h=h==null?o:p({},o,h),s.memoizedState=h,s.lanes===0&&(s.updateQueue.baseState=h)}var px={enqueueSetState:function(s,o,h){s=s._reactInternals;var g=ii(),w=Il(g);w.payload=o,h!=null&&(w.callback=h),o=Pl(s,w,g),o!==null&&(Wa(o,s,g),Cf(o,s,g))},enqueueReplaceState:function(s,o,h){s=s._reactInternals;var g=ii(),w=Il(g);w.tag=1,w.payload=o,h!=null&&(w.callback=h),o=Pl(s,w,g),o!==null&&(Wa(o,s,g),Cf(o,s,g))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var h=ii(),g=Il(h);g.tag=2,o!=null&&(g.callback=o),o=Pl(s,g,h),o!==null&&(Wa(o,s,h),Cf(o,s,h))}};function ON(s,o,h,g,w,S,D){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(g,S,D):o.prototype&&o.prototype.isPureReactComponent?!Sf(h,g)||!Sf(w,S):!0}function CN(s,o,h,g){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(h,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(h,g),o.state!==s&&px.enqueueReplaceState(o,o.state,null)}function Ro(s,o){var h=o;if("ref"in o){h={};for(var g in o)g!=="ref"&&(h[g]=o[g])}if(s=s.defaultProps){h===o&&(h=p({},h));for(var w in s)h[w]===void 0&&(h[w]=s[w])}return h}function DN(s){rh(s)}function IN(s){console.error(s)}function PN(s){rh(s)}function Nh(s,o){try{var h=s.onUncaughtError;h(o.value,{componentStack:o.stack})}catch(g){setTimeout(function(){throw g})}}function MN(s,o,h){try{var g=s.onCaughtError;g(h.value,{componentStack:h.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(w){setTimeout(function(){throw w})}}function gx(s,o,h){return h=Il(h),h.tag=3,h.payload={element:null},h.callback=function(){Nh(s,o)},h}function RN(s){return s=Il(s),s.tag=3,s}function FN(s,o,h,g){var w=h.type.getDerivedStateFromError;if(typeof w=="function"){var S=g.value;s.payload=function(){return w(S)},s.callback=function(){MN(o,h,g)}}var D=h.stateNode;D!==null&&typeof D.componentDidCatch=="function"&&(s.callback=function(){MN(o,h,g),typeof w!="function"&&(Ul===null?Ul=new Set([this]):Ul.add(this));var X=g.stack;this.componentDidCatch(g.value,{componentStack:X!==null?X:""})})}function WF(s,o,h,g,w){if(h.flags|=32768,g!==null&&typeof g=="object"&&typeof g.then=="function"){if(o=h.alternate,o!==null&&Vc(o,h,w,!0),h=ti.current,h!==null){switch(h.tag){case 31:case 13:return ki===null?Fh():h.alternate===null&&sn===0&&(sn=3),h.flags&=-257,h.flags|=65536,h.lanes=w,g===dh?h.flags|=16384:(o=h.updateQueue,o===null?h.updateQueue=new Set([g]):o.add(g),$x(s,g,w)),!1;case 22:return h.flags|=65536,g===dh?h.flags|=16384:(o=h.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([g])},h.updateQueue=o):(h=o.retryQueue,h===null?o.retryQueue=new Set([g]):h.add(g)),$x(s,g,w)),!1}throw Error(n(435,h.tag))}return $x(s,g,w),Fh(),!1}if(tr)return o=ti.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=w,g!==Mv&&(s=Error(n(422),{cause:g}),kf(_i(s,h)))):(g!==Mv&&(o=Error(n(423),{cause:g}),kf(_i(o,h))),s=s.current.alternate,s.flags|=65536,w&=-w,s.lanes|=w,g=_i(g,h),w=gx(s.stateNode,g,w),Vv(s,w),sn!==4&&(sn=2)),!1;var S=Error(n(520),{cause:g});if(S=_i(S,h),Wf===null?Wf=[S]:Wf.push(S),sn!==4&&(sn=2),o===null)return!0;g=_i(g,h),h=o;do{switch(h.tag){case 3:return h.flags|=65536,s=w&-w,h.lanes|=s,s=gx(h.stateNode,g,s),Vv(h,s),!1;case 1:if(o=h.type,S=h.stateNode,(h.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(Ul===null||!Ul.has(S))))return h.flags|=65536,w&=-w,h.lanes|=w,w=RN(w),FN(w,s,h,g),Vv(h,w),!1}h=h.return}while(h!==null);return!1}var vx=Error(n(461)),En=!1;function sa(s,o,h,g){o.child=s===null?$E(o,null,h,g):Po(o,s.child,h,g)}function LN(s,o,h,g,w){h=h.render;var S=o.ref;if("ref"in g){var D={};for(var X in g)X!=="ref"&&(D[X]=g[X])}else D=g;return Oo(o),g=Jv(s,o,h,D,S,w),X=Zv(),s!==null&&!En?(ex(s,o,w),zs(s,o,w)):(tr&&X&&Iv(o),o.flags|=1,sa(s,o,g,w),o.child)}function BN(s,o,h,g,w){if(s===null){var S=h.type;return typeof S=="function"&&!Ov(S)&&S.defaultProps===void 0&&h.compare===null?(o.tag=15,o.type=S,UN(s,o,S,g,w)):(s=sh(h.type,null,g,o,o.mode,w),s.ref=o.ref,s.return=o,o.child=s)}if(S=s.child,!Nx(s,w)){var D=S.memoizedProps;if(h=h.compare,h=h!==null?h:Sf,h(D,g)&&s.ref===o.ref)return zs(s,o,w)}return o.flags|=1,s=Rs(S,g),s.ref=o.ref,s.return=o,o.child=s}function UN(s,o,h,g,w){if(s!==null){var S=s.memoizedProps;if(Sf(S,g)&&s.ref===o.ref)if(En=!1,o.pendingProps=g=S,Nx(s,w))(s.flags&131072)!==0&&(En=!0);else return o.lanes=s.lanes,zs(s,o,w)}return xx(s,o,h,g,w)}function $N(s,o,h,g){var w=g.children,S=s!==null?s.memoizedState:null;if(s===null&&o.stateNode===null&&(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),g.mode==="hidden"){if((o.flags&128)!==0){if(S=S!==null?S.baseLanes|h:h,s!==null){for(g=o.child=s.child,w=0;g!==null;)w=w|g.lanes|g.childLanes,g=g.sibling;g=w&~S}else g=0,o.child=null;return zN(s,o,S,h,g)}if((h&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&uh(o,S!==null?S.cachePool:null),S!==null?qE(o,S):Kv(),WE(o);else return g=o.lanes=536870912,zN(s,o,S!==null?S.baseLanes|h:h,h,g)}else S!==null?(uh(o,S.cachePool),qE(o,S),Rl(),o.memoizedState=null):(s!==null&&uh(o,null),Kv(),Rl());return sa(s,o,w,h),o.child}function Lf(s,o){return s!==null&&s.tag===22||o.stateNode!==null||(o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),o.sibling}function zN(s,o,h,g,w){var S=zv();return S=S===null?null:{parent:_n._currentValue,pool:S},o.memoizedState={baseLanes:h,cachePool:S},s!==null&&uh(o,null),Kv(),WE(o),s!==null&&Vc(s,o,g,!0),o.childLanes=w,null}function kh(s,o){return o=Ah({mode:o.mode,children:o.children},s.mode),o.ref=s.ref,s.child=o,o.return=s,o}function HN(s,o,h){return Po(o,s.child,null,h),s=kh(o,o.pendingProps),s.flags|=2,ri(o),o.memoizedState=null,s}function VF(s,o,h){var g=o.pendingProps,w=(o.flags&128)!==0;if(o.flags&=-129,s===null){if(tr){if(g.mode==="hidden")return s=kh(o,g),o.lanes=536870912,Lf(null,s);if(Yv(o),(s=Hr)?(s=tT(s,Ni),s=s!==null&&s.data==="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:Al!==null?{id:hs,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},h=kE(s),h.return=o,o.child=h,aa=o,Hr=null)):s=null,s===null)throw Ol(o);return o.lanes=536870912,null}return kh(o,g)}var S=s.memoizedState;if(S!==null){var D=S.dehydrated;if(Yv(o),w)if(o.flags&256)o.flags&=-257,o=HN(s,o,h);else if(o.memoizedState!==null)o.child=s.child,o.flags|=128,o=null;else throw Error(n(558));else if(En||Vc(s,o,h,!1),w=(h&s.childLanes)!==0,En||w){if(g=Mr,g!==null&&(D=Le(g,h),D!==0&&D!==S.retryLane))throw S.retryLane=D,ko(s,D),Wa(g,s,D),vx;Fh(),o=HN(s,o,h)}else s=S.treeContext,Hr=Ti(D.nextSibling),aa=o,tr=!0,jl=null,Ni=!1,s!==null&&jE(o,s),o=kh(o,g),o.flags|=4096;return o}return s=Rs(s.child,{mode:g.mode,children:g.children}),s.ref=o.ref,o.child=s,s.return=o,s}function Th(s,o){var h=o.ref;if(h===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof h!="function"&&typeof h!="object")throw Error(n(284));(s===null||s.ref!==h)&&(o.flags|=4194816)}}function xx(s,o,h,g,w){return Oo(o),h=Jv(s,o,h,g,void 0,w),g=Zv(),s!==null&&!En?(ex(s,o,w),zs(s,o,w)):(tr&&g&&Iv(o),o.flags|=1,sa(s,o,h,w),o.child)}function qN(s,o,h,g,w,S){return Oo(o),o.updateQueue=null,h=GE(o,g,h,w),VE(s),g=Zv(),s!==null&&!En?(ex(s,o,S),zs(s,o,S)):(tr&&g&&Iv(o),o.flags|=1,sa(s,o,h,S),o.child)}function WN(s,o,h,g,w){if(Oo(o),o.stateNode===null){var S=zc,D=h.contextType;typeof D=="object"&&D!==null&&(S=ia(D)),S=new h(g,S),o.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=px,o.stateNode=S,S._reactInternals=o,S=o.stateNode,S.props=g,S.state=o.memoizedState,S.refs={},qv(o),D=h.contextType,S.context=typeof D=="object"&&D!==null?ia(D):zc,S.state=o.memoizedState,D=h.getDerivedStateFromProps,typeof D=="function"&&(mx(o,h,D,g),S.state=o.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(D=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),D!==S.state&&px.enqueueReplaceState(S,S.state,null),If(o,g,S,w),Df(),S.state=o.memoizedState),typeof S.componentDidMount=="function"&&(o.flags|=4194308),g=!0}else if(s===null){S=o.stateNode;var X=o.memoizedProps,me=Ro(h,X);S.props=me;var ke=S.context,Me=h.contextType;D=zc,typeof Me=="object"&&Me!==null&&(D=ia(Me));var $e=h.getDerivedStateFromProps;Me=typeof $e=="function"||typeof S.getSnapshotBeforeUpdate=="function",X=o.pendingProps!==X,Me||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(X||ke!==D)&&CN(o,S,g,D),Dl=!1;var je=o.memoizedState;S.state=je,If(o,g,S,w),Df(),ke=o.memoizedState,X||je!==ke||Dl?(typeof $e=="function"&&(mx(o,h,$e,g),ke=o.memoizedState),(me=Dl||ON(o,h,me,g,je,ke,D))?(Me||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(o.flags|=4194308)):(typeof S.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=ke),S.props=g,S.state=ke,S.context=D,g=me):(typeof S.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{S=o.stateNode,Wv(s,o),D=o.memoizedProps,Me=Ro(h,D),S.props=Me,$e=o.pendingProps,je=S.context,ke=h.contextType,me=zc,typeof ke=="object"&&ke!==null&&(me=ia(ke)),X=h.getDerivedStateFromProps,(ke=typeof X=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(D!==$e||je!==me)&&CN(o,S,g,me),Dl=!1,je=o.memoizedState,S.state=je,If(o,g,S,w),Df();var De=o.memoizedState;D!==$e||je!==De||Dl||s!==null&&s.dependencies!==null&&oh(s.dependencies)?(typeof X=="function"&&(mx(o,h,X,g),De=o.memoizedState),(Me=Dl||ON(o,h,Me,g,je,De,me)||s!==null&&s.dependencies!==null&&oh(s.dependencies))?(ke||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(g,De,me),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(g,De,me)),typeof S.componentDidUpdate=="function"&&(o.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof S.componentDidUpdate!="function"||D===s.memoizedProps&&je===s.memoizedState||(o.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===s.memoizedProps&&je===s.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=De),S.props=g,S.state=De,S.context=me,g=Me):(typeof S.componentDidUpdate!="function"||D===s.memoizedProps&&je===s.memoizedState||(o.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||D===s.memoizedProps&&je===s.memoizedState||(o.flags|=1024),g=!1)}return S=g,Th(s,o),g=(o.flags&128)!==0,S||g?(S=o.stateNode,h=g&&typeof h.getDerivedStateFromError!="function"?null:S.render(),o.flags|=1,s!==null&&g?(o.child=Po(o,s.child,null,w),o.child=Po(o,null,h,w)):sa(s,o,h,w),o.memoizedState=S.state,s=o.child):s=zs(s,o,w),s}function VN(s,o,h,g){return Ao(),o.flags|=256,sa(s,o,h,g),o.child}var yx={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bx(s){return{baseLanes:s,cachePool:ME()}}function wx(s,o,h){return s=s!==null?s.childLanes&~h:0,o&&(s|=ai),s}function GN(s,o,h){var g=o.pendingProps,w=!1,S=(o.flags&128)!==0,D;if((D=S)||(D=s!==null&&s.memoizedState===null?!1:(gn.current&2)!==0),D&&(w=!0,o.flags&=-129),D=(o.flags&32)!==0,o.flags&=-33,s===null){if(tr){if(w?Ml(o):Rl(),(s=Hr)?(s=tT(s,Ni),s=s!==null&&s.data!=="&"?s:null,s!==null&&(o.memoizedState={dehydrated:s,treeContext:Al!==null?{id:hs,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},h=kE(s),h.return=o,o.child=h,aa=o,Hr=null)):s=null,s===null)throw Ol(o);return ny(s)?o.lanes=32:o.lanes=536870912,null}var X=g.children;return g=g.fallback,w?(Rl(),w=o.mode,X=Ah({mode:"hidden",children:X},w),g=To(g,w,h,null),X.return=o,g.return=o,X.sibling=g,o.child=X,g=o.child,g.memoizedState=bx(h),g.childLanes=wx(s,D,h),o.memoizedState=yx,Lf(null,g)):(Ml(o),_x(o,X))}var me=s.memoizedState;if(me!==null&&(X=me.dehydrated,X!==null)){if(S)o.flags&256?(Ml(o),o.flags&=-257,o=Sx(s,o,h)):o.memoizedState!==null?(Rl(),o.child=s.child,o.flags|=128,o=null):(Rl(),X=g.fallback,w=o.mode,g=Ah({mode:"visible",children:g.children},w),X=To(X,w,h,null),X.flags|=2,g.return=o,X.return=o,g.sibling=X,o.child=g,Po(o,s.child,null,h),g=o.child,g.memoizedState=bx(h),g.childLanes=wx(s,D,h),o.memoizedState=yx,o=Lf(null,g));else if(Ml(o),ny(X)){if(D=X.nextSibling&&X.nextSibling.dataset,D)var ke=D.dgst;D=ke,g=Error(n(419)),g.stack="",g.digest=D,kf({value:g,source:null,stack:null}),o=Sx(s,o,h)}else if(En||Vc(s,o,h,!1),D=(h&s.childLanes)!==0,En||D){if(D=Mr,D!==null&&(g=Le(D,h),g!==0&&g!==me.retryLane))throw me.retryLane=g,ko(s,g),Wa(D,s,g),vx;ry(X)||Fh(),o=Sx(s,o,h)}else ry(X)?(o.flags|=192,o.child=s.child,o=null):(s=me.treeContext,Hr=Ti(X.nextSibling),aa=o,tr=!0,jl=null,Ni=!1,s!==null&&jE(o,s),o=_x(o,g.children),o.flags|=4096);return o}return w?(Rl(),X=g.fallback,w=o.mode,me=s.child,ke=me.sibling,g=Rs(me,{mode:"hidden",children:g.children}),g.subtreeFlags=me.subtreeFlags&65011712,ke!==null?X=Rs(ke,X):(X=To(X,w,h,null),X.flags|=2),X.return=o,g.return=o,g.sibling=X,o.child=g,Lf(null,g),g=o.child,X=s.child.memoizedState,X===null?X=bx(h):(w=X.cachePool,w!==null?(me=_n._currentValue,w=w.parent!==me?{parent:me,pool:me}:w):w=ME(),X={baseLanes:X.baseLanes|h,cachePool:w}),g.memoizedState=X,g.childLanes=wx(s,D,h),o.memoizedState=yx,Lf(s.child,g)):(Ml(o),h=s.child,s=h.sibling,h=Rs(h,{mode:"visible",children:g.children}),h.return=o,h.sibling=null,s!==null&&(D=o.deletions,D===null?(o.deletions=[s],o.flags|=16):D.push(s)),o.child=h,o.memoizedState=null,h)}function _x(s,o){return o=Ah({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Ah(s,o){return s=ei(22,s,null,o),s.lanes=0,s}function Sx(s,o,h){return Po(o,s.child,null,h),s=_x(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function KN(s,o,h){s.lanes|=o;var g=s.alternate;g!==null&&(g.lanes|=o),Lv(s.return,o,h)}function Ex(s,o,h,g,w,S){var D=s.memoizedState;D===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:h,tailMode:w,treeForkCount:S}:(D.isBackwards=o,D.rendering=null,D.renderingStartTime=0,D.last=g,D.tail=h,D.tailMode=w,D.treeForkCount=S)}function XN(s,o,h){var g=o.pendingProps,w=g.revealOrder,S=g.tail;g=g.children;var D=gn.current,X=(D&2)!==0;if(X?(D=D&1|2,o.flags|=128):D&=1,W(gn,D),sa(s,o,g,h),g=tr?Nf:0,!X&&s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&KN(s,h,o);else if(s.tag===19)KN(s,h,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(w){case"forwards":for(h=o.child,w=null;h!==null;)s=h.alternate,s!==null&&gh(s)===null&&(w=h),h=h.sibling;h=w,h===null?(w=o.child,o.child=null):(w=h.sibling,h.sibling=null),Ex(o,!1,w,h,S,g);break;case"backwards":case"unstable_legacy-backwards":for(h=null,w=o.child,o.child=null;w!==null;){if(s=w.alternate,s!==null&&gh(s)===null){o.child=w;break}s=w.sibling,w.sibling=h,h=w,w=s}Ex(o,!0,h,null,S,g);break;case"together":Ex(o,!1,null,null,void 0,g);break;default:o.memoizedState=null}return o.child}function zs(s,o,h){if(s!==null&&(o.dependencies=s.dependencies),Bl|=o.lanes,(h&o.childLanes)===0)if(s!==null){if(Vc(s,o,h,!1),(h&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(n(153));if(o.child!==null){for(s=o.child,h=Rs(s,s.pendingProps),o.child=h,h.return=o;s.sibling!==null;)s=s.sibling,h=h.sibling=Rs(s,s.pendingProps),h.return=o;h.sibling=null}return o.child}function Nx(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&oh(s)))}function GF(s,o,h){switch(o.tag){case 3:Ae(o,o.stateNode.containerInfo),Cl(o,_n,s.memoizedState.cache),Ao();break;case 27:case 5:ae(o);break;case 4:Ae(o,o.stateNode.containerInfo);break;case 10:Cl(o,o.type,o.memoizedProps.value);break;case 31:if(o.memoizedState!==null)return o.flags|=128,Yv(o),null;break;case 13:var g=o.memoizedState;if(g!==null)return g.dehydrated!==null?(Ml(o),o.flags|=128,null):(h&o.child.childLanes)!==0?GN(s,o,h):(Ml(o),s=zs(s,o,h),s!==null?s.sibling:null);Ml(o);break;case 19:var w=(s.flags&128)!==0;if(g=(h&o.childLanes)!==0,g||(Vc(s,o,h,!1),g=(h&o.childLanes)!==0),w){if(g)return XN(s,o,h);o.flags|=128}if(w=o.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),W(gn,gn.current),g)break;return null;case 22:return o.lanes=0,$N(s,o,h,o.pendingProps);case 24:Cl(o,_n,s.memoizedState.cache)}return zs(s,o,h)}function YN(s,o,h){if(s!==null)if(s.memoizedProps!==o.pendingProps)En=!0;else{if(!Nx(s,h)&&(o.flags&128)===0)return En=!1,GF(s,o,h);En=(s.flags&131072)!==0}else En=!1,tr&&(o.flags&1048576)!==0&&AE(o,Nf,o.index);switch(o.lanes=0,o.tag){case 16:e:{var g=o.pendingProps;if(s=Do(o.elementType),o.type=s,typeof s=="function")Ov(s)?(g=Ro(s,g),o.tag=1,o=WN(null,o,s,g,h)):(o.tag=0,o=xx(null,o,s,g,h));else{if(s!=null){var w=s.$$typeof;if(w===k){o.tag=11,o=LN(null,o,s,g,h);break e}else if(w===j){o.tag=14,o=BN(null,o,s,g,h);break e}}throw o=be(s)||s,Error(n(306,o,""))}}return o;case 0:return xx(s,o,o.type,o.pendingProps,h);case 1:return g=o.type,w=Ro(g,o.pendingProps),WN(s,o,g,w,h);case 3:e:{if(Ae(o,o.stateNode.containerInfo),s===null)throw Error(n(387));g=o.pendingProps;var S=o.memoizedState;w=S.element,Wv(s,o),If(o,g,null,h);var D=o.memoizedState;if(g=D.cache,Cl(o,_n,g),g!==S.cache&&Bv(o,[_n],h,!0),Df(),g=D.element,S.isDehydrated)if(S={element:g,isDehydrated:!1,cache:D.cache},o.updateQueue.baseState=S,o.memoizedState=S,o.flags&256){o=VN(s,o,g,h);break e}else if(g!==w){w=_i(Error(n(424)),o),kf(w),o=VN(s,o,g,h);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Hr=Ti(s.firstChild),aa=o,tr=!0,jl=null,Ni=!0,h=$E(o,null,g,h),o.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling}else{if(Ao(),g===w){o=zs(s,o,h);break e}sa(s,o,g,h)}o=o.child}return o;case 26:return Th(s,o),s===null?(h=lT(o.type,null,o.pendingProps,null))?o.memoizedState=h:tr||(h=o.type,s=o.pendingProps,g=qh(le.current).createElement(h),g[H]=o,g[Z]=s,la(g,h,s),xe(g),o.stateNode=g):o.memoizedState=lT(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return ae(o),s===null&&tr&&(g=o.stateNode=aT(o.type,o.pendingProps,le.current),aa=o,Ni=!0,w=Hr,ql(o.type)?(ay=w,Hr=Ti(g.firstChild)):Hr=w),sa(s,o,o.pendingProps.children,h),Th(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&tr&&((w=g=Hr)&&(g=SL(g,o.type,o.pendingProps,Ni),g!==null?(o.stateNode=g,aa=o,Hr=Ti(g.firstChild),Ni=!1,w=!0):w=!1),w||Ol(o)),ae(o),w=o.type,S=o.pendingProps,D=s!==null?s.memoizedProps:null,g=S.children,Zx(w,S)?g=null:D!==null&&Zx(w,D)&&(o.flags|=32),o.memoizedState!==null&&(w=Jv(s,o,LF,null,null,h),Zf._currentValue=w),Th(s,o),sa(s,o,g,h),o.child;case 6:return s===null&&tr&&((s=h=Hr)&&(h=EL(h,o.pendingProps,Ni),h!==null?(o.stateNode=h,aa=o,Hr=null,s=!0):s=!1),s||Ol(o)),null;case 13:return GN(s,o,h);case 4:return Ae(o,o.stateNode.containerInfo),g=o.pendingProps,s===null?o.child=Po(o,null,g,h):sa(s,o,g,h),o.child;case 11:return LN(s,o,o.type,o.pendingProps,h);case 7:return sa(s,o,o.pendingProps,h),o.child;case 8:return sa(s,o,o.pendingProps.children,h),o.child;case 12:return sa(s,o,o.pendingProps.children,h),o.child;case 10:return g=o.pendingProps,Cl(o,o.type,g.value),sa(s,o,g.children,h),o.child;case 9:return w=o.type._context,g=o.pendingProps.children,Oo(o),w=ia(w),g=g(w),o.flags|=1,sa(s,o,g,h),o.child;case 14:return BN(s,o,o.type,o.pendingProps,h);case 15:return UN(s,o,o.type,o.pendingProps,h);case 19:return XN(s,o,h);case 31:return VF(s,o,h);case 22:return $N(s,o,h,o.pendingProps);case 24:return Oo(o),g=ia(_n),s===null?(w=zv(),w===null&&(w=Mr,S=Uv(),w.pooledCache=S,S.refCount++,S!==null&&(w.pooledCacheLanes|=h),w=S),o.memoizedState={parent:g,cache:w},qv(o),Cl(o,_n,w)):((s.lanes&h)!==0&&(Wv(s,o),If(o,null,null,h),Df()),w=s.memoizedState,S=o.memoizedState,w.parent!==g?(w={parent:g,cache:g},o.memoizedState=w,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=w),Cl(o,_n,g)):(g=S.cache,Cl(o,_n,g),g!==w.cache&&Bv(o,[_n],h,!0))),sa(s,o,o.pendingProps.children,h),o.child;case 29:throw o.pendingProps}throw Error(n(156,o.tag))}function Hs(s){s.flags|=4}function kx(s,o,h,g,w){if((o=(s.mode&32)!==0)&&(o=!1),o){if(s.flags|=16777216,(w&335544128)===w)if(s.stateNode.complete)s.flags|=8192;else if(Sk())s.flags|=8192;else throw Io=dh,Hv}else s.flags&=-16777217}function QN(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!dT(o))if(Sk())s.flags|=8192;else throw Io=dh,Hv}function jh(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?zr():536870912,s.lanes|=o,au|=o)}function Bf(s,o){if(!tr)switch(s.tailMode){case"hidden":o=s.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s.tail=null:h.sibling=null;break;case"collapsed":h=s.tail;for(var g=null;h!==null;)h.alternate!==null&&(g=h),h=h.sibling;g===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:g.sibling=null}}function qr(s){var o=s.alternate!==null&&s.alternate.child===s.child,h=0,g=0;if(o)for(var w=s.child;w!==null;)h|=w.lanes|w.childLanes,g|=w.subtreeFlags&65011712,g|=w.flags&65011712,w.return=s,w=w.sibling;else for(w=s.child;w!==null;)h|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=s,w=w.sibling;return s.subtreeFlags|=g,s.childLanes=h,o}function KF(s,o,h){var g=o.pendingProps;switch(Pv(o),o.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qr(o),null;case 1:return qr(o),null;case 3:return h=o.stateNode,g=null,s!==null&&(g=s.memoizedState.cache),o.memoizedState.cache!==g&&(o.flags|=2048),Bs(_n),oe(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(s===null||s.child===null)&&(Wc(o)?Hs(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,Rv())),qr(o),null;case 26:var w=o.type,S=o.memoizedState;return s===null?(Hs(o),S!==null?(qr(o),QN(o,S)):(qr(o),kx(o,w,null,g,h))):S?S!==s.memoizedState?(Hs(o),qr(o),QN(o,S)):(qr(o),o.flags&=-16777217):(s=s.memoizedProps,s!==g&&Hs(o),qr(o),kx(o,w,s,g,h)),null;case 27:if(ze(o),h=le.current,w=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==g&&Hs(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return qr(o),null}s=F.current,Wc(o)?OE(o):(s=aT(w,g,h),o.stateNode=s,Hs(o))}return qr(o),null;case 5:if(ze(o),w=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==g&&Hs(o);else{if(!g){if(o.stateNode===null)throw Error(n(166));return qr(o),null}if(S=F.current,Wc(o))OE(o);else{var D=qh(le.current);switch(S){case 1:S=D.createElementNS("http://www.w3.org/2000/svg",w);break;case 2:S=D.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;default:switch(w){case"svg":S=D.createElementNS("http://www.w3.org/2000/svg",w);break;case"math":S=D.createElementNS("http://www.w3.org/1998/Math/MathML",w);break;case"script":S=D.createElement("div"),S.innerHTML="<script><\/script>",S=S.removeChild(S.firstChild);break;case"select":S=typeof g.is=="string"?D.createElement("select",{is:g.is}):D.createElement("select"),g.multiple?S.multiple=!0:g.size&&(S.size=g.size);break;default:S=typeof g.is=="string"?D.createElement(w,{is:g.is}):D.createElement(w)}}S[H]=o,S[Z]=g;e:for(D=o.child;D!==null;){if(D.tag===5||D.tag===6)S.appendChild(D.stateNode);else if(D.tag!==4&&D.tag!==27&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===o)break e;for(;D.sibling===null;){if(D.return===null||D.return===o)break e;D=D.return}D.sibling.return=D.return,D=D.sibling}o.stateNode=S;e:switch(la(S,w,g),w){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}g&&Hs(o)}}return qr(o),kx(o,o.type,s===null?null:s.memoizedProps,o.pendingProps,h),null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==g&&Hs(o);else{if(typeof g!="string"&&o.stateNode===null)throw Error(n(166));if(s=le.current,Wc(o)){if(s=o.stateNode,h=o.memoizedProps,g=null,w=aa,w!==null)switch(w.tag){case 27:case 5:g=w.memoizedProps}s[H]=o,s=!!(s.nodeValue===h||g!==null&&g.suppressHydrationWarning===!0||Gk(s.nodeValue,h)),s||Ol(o,!0)}else s=qh(s).createTextNode(g),s[H]=o,o.stateNode=s}return qr(o),null;case 31:if(h=o.memoizedState,s===null||s.memoizedState!==null){if(g=Wc(o),h!==null){if(s===null){if(!g)throw Error(n(318));if(s=o.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(n(557));s[H]=o}else Ao(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;qr(o),s=!1}else h=Rv(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=h),s=!0;if(!s)return o.flags&256?(ri(o),o):(ri(o),null);if((o.flags&128)!==0)throw Error(n(558))}return qr(o),null;case 13:if(g=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(w=Wc(o),g!==null&&g.dehydrated!==null){if(s===null){if(!w)throw Error(n(318));if(w=o.memoizedState,w=w!==null?w.dehydrated:null,!w)throw Error(n(317));w[H]=o}else Ao(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;qr(o),w=!1}else w=Rv(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=w),w=!0;if(!w)return o.flags&256?(ri(o),o):(ri(o),null)}return ri(o),(o.flags&128)!==0?(o.lanes=h,o):(h=g!==null,s=s!==null&&s.memoizedState!==null,h&&(g=o.child,w=null,g.alternate!==null&&g.alternate.memoizedState!==null&&g.alternate.memoizedState.cachePool!==null&&(w=g.alternate.memoizedState.cachePool.pool),S=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(S=g.memoizedState.cachePool.pool),S!==w&&(g.flags|=2048)),h!==s&&h&&(o.child.flags|=8192),jh(o,o.updateQueue),qr(o),null);case 4:return oe(),s===null&&Kx(o.stateNode.containerInfo),qr(o),null;case 10:return Bs(o.type),qr(o),null;case 19:if(P(gn),g=o.memoizedState,g===null)return qr(o),null;if(w=(o.flags&128)!==0,S=g.rendering,S===null)if(w)Bf(g,!1);else{if(sn!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(S=gh(s),S!==null){for(o.flags|=128,Bf(g,!1),s=S.updateQueue,o.updateQueue=s,jh(o,s),o.subtreeFlags=0,s=h,h=o.child;h!==null;)NE(h,s),h=h.sibling;return W(gn,gn.current&1|2),tr&&Fs(o,g.treeForkCount),o.child}s=s.sibling}g.tail!==null&&at()>Ph&&(o.flags|=128,w=!0,Bf(g,!1),o.lanes=4194304)}else{if(!w)if(s=gh(S),s!==null){if(o.flags|=128,w=!0,s=s.updateQueue,o.updateQueue=s,jh(o,s),Bf(g,!0),g.tail===null&&g.tailMode==="hidden"&&!S.alternate&&!tr)return qr(o),null}else 2*at()-g.renderingStartTime>Ph&&h!==536870912&&(o.flags|=128,w=!0,Bf(g,!1),o.lanes=4194304);g.isBackwards?(S.sibling=o.child,o.child=S):(s=g.last,s!==null?s.sibling=S:o.child=S,g.last=S)}return g.tail!==null?(s=g.tail,g.rendering=s,g.tail=s.sibling,g.renderingStartTime=at(),s.sibling=null,h=gn.current,W(gn,w?h&1|2:h&1),tr&&Fs(o,g.treeForkCount),s):(qr(o),null);case 22:case 23:return ri(o),Xv(),g=o.memoizedState!==null,s!==null?s.memoizedState!==null!==g&&(o.flags|=8192):g&&(o.flags|=8192),g?(h&536870912)!==0&&(o.flags&128)===0&&(qr(o),o.subtreeFlags&6&&(o.flags|=8192)):qr(o),h=o.updateQueue,h!==null&&jh(o,h.retryQueue),h=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),g=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(g=o.memoizedState.cachePool.pool),g!==h&&(o.flags|=2048),s!==null&&P(Co),null;case 24:return h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),Bs(_n),qr(o),null;case 25:return null;case 30:return null}throw Error(n(156,o.tag))}function XF(s,o){switch(Pv(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return Bs(_n),oe(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return ze(o),null;case 31:if(o.memoizedState!==null){if(ri(o),o.alternate===null)throw Error(n(340));Ao()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 13:if(ri(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Ao()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return P(gn),null;case 4:return oe(),null;case 10:return Bs(o.type),null;case 22:case 23:return ri(o),Xv(),s!==null&&P(Co),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return Bs(_n),null;case 25:return null;default:return null}}function JN(s,o){switch(Pv(o),o.tag){case 3:Bs(_n),oe();break;case 26:case 27:case 5:ze(o);break;case 4:oe();break;case 31:o.memoizedState!==null&&ri(o);break;case 13:ri(o);break;case 19:P(gn);break;case 10:Bs(o.type);break;case 22:case 23:ri(o),Xv(),s!==null&&P(Co);break;case 24:Bs(_n)}}function Uf(s,o){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var w=g.next;h=w;do{if((h.tag&s)===s){g=void 0;var S=h.create,D=h.inst;g=S(),D.destroy=g}h=h.next}while(h!==w)}}catch(X){br(o,o.return,X)}}function Fl(s,o,h){try{var g=o.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var S=w.next;g=S;do{if((g.tag&s)===s){var D=g.inst,X=D.destroy;if(X!==void 0){D.destroy=void 0,w=o;var me=h,ke=X;try{ke()}catch(Me){br(w,me,Me)}}}g=g.next}while(g!==S)}}catch(Me){br(o,o.return,Me)}}function ZN(s){var o=s.updateQueue;if(o!==null){var h=s.stateNode;try{HE(o,h)}catch(g){br(s,s.return,g)}}}function ek(s,o,h){h.props=Ro(s.type,s.memoizedProps),h.state=s.memoizedState;try{h.componentWillUnmount()}catch(g){br(s,o,g)}}function $f(s,o){try{var h=s.ref;if(h!==null){switch(s.tag){case 26:case 27:case 5:var g=s.stateNode;break;case 30:g=s.stateNode;break;default:g=s.stateNode}typeof h=="function"?s.refCleanup=h(g):h.current=g}}catch(w){br(s,o,w)}}function ps(s,o){var h=s.ref,g=s.refCleanup;if(h!==null)if(typeof g=="function")try{g()}catch(w){br(s,o,w)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof h=="function")try{h(null)}catch(w){br(s,o,w)}else h.current=null}function tk(s){var o=s.type,h=s.memoizedProps,g=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":h.autoFocus&&g.focus();break e;case"img":h.src?g.src=h.src:h.srcSet&&(g.srcset=h.srcSet)}}catch(w){br(s,s.return,w)}}function Tx(s,o,h){try{var g=s.stateNode;vL(g,s.type,h,o),g[Z]=o}catch(w){br(s,s.return,w)}}function rk(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&ql(s.type)||s.tag===4}function Ax(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||rk(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&ql(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function jx(s,o,h){var g=s.tag;if(g===5||g===6)s=s.stateNode,o?(h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h).insertBefore(s,o):(o=h.nodeType===9?h.body:h.nodeName==="HTML"?h.ownerDocument.body:h,o.appendChild(s),h=h._reactRootContainer,h!=null||o.onclick!==null||(o.onclick=Ps));else if(g!==4&&(g===27&&ql(s.type)&&(h=s.stateNode,o=null),s=s.child,s!==null))for(jx(s,o,h),s=s.sibling;s!==null;)jx(s,o,h),s=s.sibling}function Oh(s,o,h){var g=s.tag;if(g===5||g===6)s=s.stateNode,o?h.insertBefore(s,o):h.appendChild(s);else if(g!==4&&(g===27&&ql(s.type)&&(h=s.stateNode),s=s.child,s!==null))for(Oh(s,o,h),s=s.sibling;s!==null;)Oh(s,o,h),s=s.sibling}function nk(s){var o=s.stateNode,h=s.memoizedProps;try{for(var g=s.type,w=o.attributes;w.length;)o.removeAttributeNode(w[0]);la(o,g,h),o[H]=s,o[Z]=h}catch(S){br(s,s.return,S)}}var qs=!1,Nn=!1,Ox=!1,ak=typeof WeakSet=="function"?WeakSet:Set,qn=null;function YF(s,o){if(s=s.containerInfo,Qx=Qh,s=gE(s),Sv(s)){if("selectionStart"in s)var h={start:s.selectionStart,end:s.selectionEnd};else e:{h=(h=s.ownerDocument)&&h.defaultView||window;var g=h.getSelection&&h.getSelection();if(g&&g.rangeCount!==0){h=g.anchorNode;var w=g.anchorOffset,S=g.focusNode;g=g.focusOffset;try{h.nodeType,S.nodeType}catch{h=null;break e}var D=0,X=-1,me=-1,ke=0,Me=0,$e=s,je=null;t:for(;;){for(var De;$e!==h||w!==0&&$e.nodeType!==3||(X=D+w),$e!==S||g!==0&&$e.nodeType!==3||(me=D+g),$e.nodeType===3&&(D+=$e.nodeValue.length),(De=$e.firstChild)!==null;)je=$e,$e=De;for(;;){if($e===s)break t;if(je===h&&++ke===w&&(X=D),je===S&&++Me===g&&(me=D),(De=$e.nextSibling)!==null)break;$e=je,je=$e.parentNode}$e=De}h=X===-1||me===-1?null:{start:X,end:me}}else h=null}h=h||{start:0,end:0}}else h=null;for(Jx={focusedElem:s,selectionRange:h},Qh=!1,qn=o;qn!==null;)if(o=qn,s=o.child,(o.subtreeFlags&1028)!==0&&s!==null)s.return=o,qn=s;else for(;qn!==null;){switch(o=qn,S=o.alternate,s=o.flags,o.tag){case 0:if((s&4)!==0&&(s=o.updateQueue,s=s!==null?s.events:null,s!==null))for(h=0;h<s.length;h++)w=s[h],w.ref.impl=w.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&S!==null){s=void 0,h=o,w=S.memoizedProps,S=S.memoizedState,g=h.stateNode;try{var ht=Ro(h.type,w);s=g.getSnapshotBeforeUpdate(ht,S),g.__reactInternalSnapshotBeforeUpdate=s}catch(At){br(h,h.return,At)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,h=s.nodeType,h===9)ty(s);else if(h===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":ty(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(n(163))}if(s=o.sibling,s!==null){s.return=o.return,qn=s;break}qn=o.return}}function ik(s,o,h){var g=h.flags;switch(h.tag){case 0:case 11:case 15:Vs(s,h),g&4&&Uf(5,h);break;case 1:if(Vs(s,h),g&4)if(s=h.stateNode,o===null)try{s.componentDidMount()}catch(D){br(h,h.return,D)}else{var w=Ro(h.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(w,o,s.__reactInternalSnapshotBeforeUpdate)}catch(D){br(h,h.return,D)}}g&64&&ZN(h),g&512&&$f(h,h.return);break;case 3:if(Vs(s,h),g&64&&(s=h.updateQueue,s!==null)){if(o=null,h.child!==null)switch(h.child.tag){case 27:case 5:o=h.child.stateNode;break;case 1:o=h.child.stateNode}try{HE(s,o)}catch(D){br(h,h.return,D)}}break;case 27:o===null&&g&4&&nk(h);case 26:case 5:Vs(s,h),o===null&&g&4&&tk(h),g&512&&$f(h,h.return);break;case 12:Vs(s,h);break;case 31:Vs(s,h),g&4&&ok(s,h);break;case 13:Vs(s,h),g&4&&ck(s,h),g&64&&(s=h.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(h=iL.bind(null,h),NL(s,h))));break;case 22:if(g=h.memoizedState!==null||qs,!g){o=o!==null&&o.memoizedState!==null||Nn,w=qs;var S=Nn;qs=g,(Nn=o)&&!S?Gs(s,h,(h.subtreeFlags&8772)!==0):Vs(s,h),qs=w,Nn=S}break;case 30:break;default:Vs(s,h)}}function sk(s){var o=s.alternate;o!==null&&(s.alternate=null,sk(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&Pe(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Qr=null,$a=!1;function Ws(s,o,h){for(h=h.child;h!==null;)lk(s,o,h),h=h.sibling}function lk(s,o,h){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(er,h)}catch{}switch(h.tag){case 26:Nn||ps(h,o),Ws(s,o,h),h.memoizedState?h.memoizedState.count--:h.stateNode&&(h=h.stateNode,h.parentNode.removeChild(h));break;case 27:Nn||ps(h,o);var g=Qr,w=$a;ql(h.type)&&(Qr=h.stateNode,$a=!1),Ws(s,o,h),Yf(h.stateNode),Qr=g,$a=w;break;case 5:Nn||ps(h,o);case 6:if(g=Qr,w=$a,Qr=null,Ws(s,o,h),Qr=g,$a=w,Qr!==null)if($a)try{(Qr.nodeType===9?Qr.body:Qr.nodeName==="HTML"?Qr.ownerDocument.body:Qr).removeChild(h.stateNode)}catch(S){br(h,o,S)}else try{Qr.removeChild(h.stateNode)}catch(S){br(h,o,S)}break;case 18:Qr!==null&&($a?(s=Qr,Zk(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,h.stateNode),du(s)):Zk(Qr,h.stateNode));break;case 4:g=Qr,w=$a,Qr=h.stateNode.containerInfo,$a=!0,Ws(s,o,h),Qr=g,$a=w;break;case 0:case 11:case 14:case 15:Fl(2,h,o),Nn||Fl(4,h,o),Ws(s,o,h);break;case 1:Nn||(ps(h,o),g=h.stateNode,typeof g.componentWillUnmount=="function"&&ek(h,o,g)),Ws(s,o,h);break;case 21:Ws(s,o,h);break;case 22:Nn=(g=Nn)||h.memoizedState!==null,Ws(s,o,h),Nn=g;break;default:Ws(s,o,h)}}function ok(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{du(s)}catch(h){br(o,o.return,h)}}}function ck(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{du(s)}catch(h){br(o,o.return,h)}}function QF(s){switch(s.tag){case 31:case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new ak),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new ak),o;default:throw Error(n(435,s.tag))}}function Ch(s,o){var h=QF(s);o.forEach(function(g){if(!h.has(g)){h.add(g);var w=sL.bind(null,s,g);g.then(w,w)}})}function za(s,o){var h=o.deletions;if(h!==null)for(var g=0;g<h.length;g++){var w=h[g],S=s,D=o,X=D;e:for(;X!==null;){switch(X.tag){case 27:if(ql(X.type)){Qr=X.stateNode,$a=!1;break e}break;case 5:Qr=X.stateNode,$a=!1;break e;case 3:case 4:Qr=X.stateNode.containerInfo,$a=!0;break e}X=X.return}if(Qr===null)throw Error(n(160));lk(S,D,w),Qr=null,$a=!1,S=w.alternate,S!==null&&(S.return=null),w.return=null}if(o.subtreeFlags&13886)for(o=o.child;o!==null;)uk(o,s),o=o.sibling}var Ki=null;function uk(s,o){var h=s.alternate,g=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:za(o,s),Ha(s),g&4&&(Fl(3,s,s.return),Uf(3,s),Fl(5,s,s.return));break;case 1:za(o,s),Ha(s),g&512&&(Nn||h===null||ps(h,h.return)),g&64&&qs&&(s=s.updateQueue,s!==null&&(g=s.callbacks,g!==null&&(h=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=h===null?g:h.concat(g))));break;case 26:var w=Ki;if(za(o,s),Ha(s),g&512&&(Nn||h===null||ps(h,h.return)),g&4){var S=h!==null?h.memoizedState:null;if(g=s.memoizedState,h===null)if(g===null)if(s.stateNode===null){e:{g=s.type,h=s.memoizedProps,w=w.ownerDocument||w;t:switch(g){case"title":S=w.getElementsByTagName("title")[0],(!S||S[we]||S[H]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=w.createElement(g),w.head.insertBefore(S,w.querySelector("head > title"))),la(S,g,h),S[H]=s,xe(S),g=S;break e;case"link":var D=uT("link","href",w).get(g+(h.href||""));if(D){for(var X=0;X<D.length;X++)if(S=D[X],S.getAttribute("href")===(h.href==null||h.href===""?null:h.href)&&S.getAttribute("rel")===(h.rel==null?null:h.rel)&&S.getAttribute("title")===(h.title==null?null:h.title)&&S.getAttribute("crossorigin")===(h.crossOrigin==null?null:h.crossOrigin)){D.splice(X,1);break t}}S=w.createElement(g),la(S,g,h),w.head.appendChild(S);break;case"meta":if(D=uT("meta","content",w).get(g+(h.content||""))){for(X=0;X<D.length;X++)if(S=D[X],S.getAttribute("content")===(h.content==null?null:""+h.content)&&S.getAttribute("name")===(h.name==null?null:h.name)&&S.getAttribute("property")===(h.property==null?null:h.property)&&S.getAttribute("http-equiv")===(h.httpEquiv==null?null:h.httpEquiv)&&S.getAttribute("charset")===(h.charSet==null?null:h.charSet)){D.splice(X,1);break t}}S=w.createElement(g),la(S,g,h),w.head.appendChild(S);break;default:throw Error(n(468,g))}S[H]=s,xe(S),g=S}s.stateNode=g}else fT(w,s.type,s.stateNode);else s.stateNode=cT(w,g,s.memoizedProps);else S!==g?(S===null?h.stateNode!==null&&(h=h.stateNode,h.parentNode.removeChild(h)):S.count--,g===null?fT(w,s.type,s.stateNode):cT(w,g,s.memoizedProps)):g===null&&s.stateNode!==null&&Tx(s,s.memoizedProps,h.memoizedProps)}break;case 27:za(o,s),Ha(s),g&512&&(Nn||h===null||ps(h,h.return)),h!==null&&g&4&&Tx(s,s.memoizedProps,h.memoizedProps);break;case 5:if(za(o,s),Ha(s),g&512&&(Nn||h===null||ps(h,h.return)),s.flags&32){w=s.stateNode;try{Mt(w,"")}catch(ht){br(s,s.return,ht)}}g&4&&s.stateNode!=null&&(w=s.memoizedProps,Tx(s,w,h!==null?h.memoizedProps:w)),g&1024&&(Ox=!0);break;case 6:if(za(o,s),Ha(s),g&4){if(s.stateNode===null)throw Error(n(162));g=s.memoizedProps,h=s.stateNode;try{h.nodeValue=g}catch(ht){br(s,s.return,ht)}}break;case 3:if(Gh=null,w=Ki,Ki=Wh(o.containerInfo),za(o,s),Ki=w,Ha(s),g&4&&h!==null&&h.memoizedState.isDehydrated)try{du(o.containerInfo)}catch(ht){br(s,s.return,ht)}Ox&&(Ox=!1,fk(s));break;case 4:g=Ki,Ki=Wh(s.stateNode.containerInfo),za(o,s),Ha(s),Ki=g;break;case 12:za(o,s),Ha(s);break;case 31:za(o,s),Ha(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Ch(s,g)));break;case 13:za(o,s),Ha(s),s.child.flags&8192&&s.memoizedState!==null!=(h!==null&&h.memoizedState!==null)&&(Ih=at()),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Ch(s,g)));break;case 22:w=s.memoizedState!==null;var me=h!==null&&h.memoizedState!==null,ke=qs,Me=Nn;if(qs=ke||w,Nn=Me||me,za(o,s),Nn=Me,qs=ke,Ha(s),g&8192)e:for(o=s.stateNode,o._visibility=w?o._visibility&-2:o._visibility|1,w&&(h===null||me||qs||Nn||Fo(s)),h=null,o=s;;){if(o.tag===5||o.tag===26){if(h===null){me=h=o;try{if(S=me.stateNode,w)D=S.style,typeof D.setProperty=="function"?D.setProperty("display","none","important"):D.display="none";else{X=me.stateNode;var $e=me.memoizedProps.style,je=$e!=null&&$e.hasOwnProperty("display")?$e.display:null;X.style.display=je==null||typeof je=="boolean"?"":(""+je).trim()}}catch(ht){br(me,me.return,ht)}}}else if(o.tag===6){if(h===null){me=o;try{me.stateNode.nodeValue=w?"":me.memoizedProps}catch(ht){br(me,me.return,ht)}}}else if(o.tag===18){if(h===null){me=o;try{var De=me.stateNode;w?eT(De,!0):eT(me.stateNode,!1)}catch(ht){br(me,me.return,ht)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;h===o&&(h=null),o=o.return}h===o&&(h=null),o.sibling.return=o.return,o=o.sibling}g&4&&(g=s.updateQueue,g!==null&&(h=g.retryQueue,h!==null&&(g.retryQueue=null,Ch(s,h))));break;case 19:za(o,s),Ha(s),g&4&&(g=s.updateQueue,g!==null&&(s.updateQueue=null,Ch(s,g)));break;case 30:break;case 21:break;default:za(o,s),Ha(s)}}function Ha(s){var o=s.flags;if(o&2){try{for(var h,g=s.return;g!==null;){if(rk(g)){h=g;break}g=g.return}if(h==null)throw Error(n(160));switch(h.tag){case 27:var w=h.stateNode,S=Ax(s);Oh(s,S,w);break;case 5:var D=h.stateNode;h.flags&32&&(Mt(D,""),h.flags&=-33);var X=Ax(s);Oh(s,X,D);break;case 3:case 4:var me=h.stateNode.containerInfo,ke=Ax(s);jx(s,ke,me);break;default:throw Error(n(161))}}catch(Me){br(s,s.return,Me)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function fk(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;fk(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function Vs(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)ik(s,o.alternate,o),o=o.sibling}function Fo(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Fl(4,o,o.return),Fo(o);break;case 1:ps(o,o.return);var h=o.stateNode;typeof h.componentWillUnmount=="function"&&ek(o,o.return,h),Fo(o);break;case 27:Yf(o.stateNode);case 26:case 5:ps(o,o.return),Fo(o);break;case 22:o.memoizedState===null&&Fo(o);break;case 30:Fo(o);break;default:Fo(o)}s=s.sibling}}function Gs(s,o,h){for(h=h&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var g=o.alternate,w=s,S=o,D=S.flags;switch(S.tag){case 0:case 11:case 15:Gs(w,S,h),Uf(4,S);break;case 1:if(Gs(w,S,h),g=S,w=g.stateNode,typeof w.componentDidMount=="function")try{w.componentDidMount()}catch(ke){br(g,g.return,ke)}if(g=S,w=g.updateQueue,w!==null){var X=g.stateNode;try{var me=w.shared.hiddenCallbacks;if(me!==null)for(w.shared.hiddenCallbacks=null,w=0;w<me.length;w++)zE(me[w],X)}catch(ke){br(g,g.return,ke)}}h&&D&64&&ZN(S),$f(S,S.return);break;case 27:nk(S);case 26:case 5:Gs(w,S,h),h&&g===null&&D&4&&tk(S),$f(S,S.return);break;case 12:Gs(w,S,h);break;case 31:Gs(w,S,h),h&&D&4&&ok(w,S);break;case 13:Gs(w,S,h),h&&D&4&&ck(w,S);break;case 22:S.memoizedState===null&&Gs(w,S,h),$f(S,S.return);break;case 30:break;default:Gs(w,S,h)}o=o.sibling}}function Cx(s,o){var h=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==h&&(s!=null&&s.refCount++,h!=null&&Tf(h))}function Dx(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Tf(s))}function Xi(s,o,h,g){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)dk(s,o,h,g),o=o.sibling}function dk(s,o,h,g){var w=o.flags;switch(o.tag){case 0:case 11:case 15:Xi(s,o,h,g),w&2048&&Uf(9,o);break;case 1:Xi(s,o,h,g);break;case 3:Xi(s,o,h,g),w&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&Tf(s)));break;case 12:if(w&2048){Xi(s,o,h,g),s=o.stateNode;try{var S=o.memoizedProps,D=S.id,X=S.onPostCommit;typeof X=="function"&&X(D,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(me){br(o,o.return,me)}}else Xi(s,o,h,g);break;case 31:Xi(s,o,h,g);break;case 13:Xi(s,o,h,g);break;case 23:break;case 22:S=o.stateNode,D=o.alternate,o.memoizedState!==null?S._visibility&2?Xi(s,o,h,g):zf(s,o):S._visibility&2?Xi(s,o,h,g):(S._visibility|=2,tu(s,o,h,g,(o.subtreeFlags&10256)!==0||!1)),w&2048&&Cx(D,o);break;case 24:Xi(s,o,h,g),w&2048&&Dx(o.alternate,o);break;default:Xi(s,o,h,g)}}function tu(s,o,h,g,w){for(w=w&&((o.subtreeFlags&10256)!==0||!1),o=o.child;o!==null;){var S=s,D=o,X=h,me=g,ke=D.flags;switch(D.tag){case 0:case 11:case 15:tu(S,D,X,me,w),Uf(8,D);break;case 23:break;case 22:var Me=D.stateNode;D.memoizedState!==null?Me._visibility&2?tu(S,D,X,me,w):zf(S,D):(Me._visibility|=2,tu(S,D,X,me,w)),w&&ke&2048&&Cx(D.alternate,D);break;case 24:tu(S,D,X,me,w),w&&ke&2048&&Dx(D.alternate,D);break;default:tu(S,D,X,me,w)}o=o.sibling}}function zf(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var h=s,g=o,w=g.flags;switch(g.tag){case 22:zf(h,g),w&2048&&Cx(g.alternate,g);break;case 24:zf(h,g),w&2048&&Dx(g.alternate,g);break;default:zf(h,g)}o=o.sibling}}var Hf=8192;function ru(s,o,h){if(s.subtreeFlags&Hf)for(s=s.child;s!==null;)hk(s,o,h),s=s.sibling}function hk(s,o,h){switch(s.tag){case 26:ru(s,o,h),s.flags&Hf&&s.memoizedState!==null&&FL(h,Ki,s.memoizedState,s.memoizedProps);break;case 5:ru(s,o,h);break;case 3:case 4:var g=Ki;Ki=Wh(s.stateNode.containerInfo),ru(s,o,h),Ki=g;break;case 22:s.memoizedState===null&&(g=s.alternate,g!==null&&g.memoizedState!==null?(g=Hf,Hf=16777216,ru(s,o,h),Hf=g):ru(s,o,h));break;default:ru(s,o,h)}}function mk(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function qf(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];qn=g,gk(g,s)}mk(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)pk(s),s=s.sibling}function pk(s){switch(s.tag){case 0:case 11:case 15:qf(s),s.flags&2048&&Fl(9,s,s.return);break;case 3:qf(s);break;case 12:qf(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Dh(s)):qf(s);break;default:qf(s)}}function Dh(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var h=0;h<o.length;h++){var g=o[h];qn=g,gk(g,s)}mk(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Fl(8,o,o.return),Dh(o);break;case 22:h=o.stateNode,h._visibility&2&&(h._visibility&=-3,Dh(o));break;default:Dh(o)}s=s.sibling}}function gk(s,o){for(;qn!==null;){var h=qn;switch(h.tag){case 0:case 11:case 15:Fl(8,h,o);break;case 23:case 22:if(h.memoizedState!==null&&h.memoizedState.cachePool!==null){var g=h.memoizedState.cachePool.pool;g!=null&&g.refCount++}break;case 24:Tf(h.memoizedState.cache)}if(g=h.child,g!==null)g.return=h,qn=g;else e:for(h=s;qn!==null;){g=qn;var w=g.sibling,S=g.return;if(sk(g),g===h){qn=null;break e}if(w!==null){w.return=S,qn=w;break e}qn=S}}}var JF={getCacheForType:function(s){var o=ia(_n),h=o.data.get(s);return h===void 0&&(h=s(),o.data.set(s,h)),h},cacheSignal:function(){return ia(_n).controller.signal}},ZF=typeof WeakMap=="function"?WeakMap:Map,dr=0,Mr=null,Xt=null,Qt=0,yr=0,ni=null,Ll=!1,nu=!1,Ix=!1,Ks=0,sn=0,Bl=0,Lo=0,Px=0,ai=0,au=0,Wf=null,qa=null,Mx=!1,Ih=0,vk=0,Ph=1/0,Mh=null,Ul=null,Dn=0,$l=null,iu=null,Xs=0,Rx=0,Fx=null,xk=null,Vf=0,Lx=null;function ii(){return(dr&2)!==0&&Qt!==0?Qt&-Qt:z.T!==null?qx():R()}function yk(){if(ai===0)if((Qt&536870912)===0||tr){var s=ra;ra<<=1,(ra&3932160)===0&&(ra=262144),ai=s}else ai=536870912;return s=ti.current,s!==null&&(s.flags|=32),ai}function Wa(s,o,h){(s===Mr&&(yr===2||yr===9)||s.cancelPendingCommit!==null)&&(su(s,0),zl(s,Qt,ai,!1)),gr(s,h),((dr&2)===0||s!==Mr)&&(s===Mr&&((dr&2)===0&&(Lo|=h),sn===4&&zl(s,Qt,ai,!1)),gs(s))}function bk(s,o,h){if((dr&6)!==0)throw Error(n(327));var g=!h&&(o&127)===0&&(o&s.expiredLanes)===0||lr(s,o),w=g?rL(s,o):Ux(s,o,!0),S=g;do{if(w===0){nu&&!g&&zl(s,o,0,!1);break}else{if(h=s.current.alternate,S&&!eL(h)){w=Ux(s,o,!1),S=!1;continue}if(w===2){if(S=o,s.errorRecoveryDisabledLanes&S)var D=0;else D=s.pendingLanes&-536870913,D=D!==0?D:D&536870912?536870912:0;if(D!==0){o=D;e:{var X=s;w=Wf;var me=X.current.memoizedState.isDehydrated;if(me&&(su(X,D).flags|=256),D=Ux(X,D,!1),D!==2){if(Ix&&!me){X.errorRecoveryDisabledLanes|=S,Lo|=S,w=4;break e}S=qa,qa=w,S!==null&&(qa===null?qa=S:qa.push.apply(qa,S))}w=D}if(S=!1,w!==2)continue}}if(w===1){su(s,0),zl(s,o,0,!0);break}e:{switch(g=s,S=w,S){case 0:case 1:throw Error(n(345));case 4:if((o&4194048)!==o)break;case 6:zl(g,o,ai,!Ll);break e;case 2:qa=null;break;case 3:case 5:break;default:throw Error(n(329))}if((o&62914560)===o&&(w=Ih+300-at(),10<w)){if(zl(g,o,ai,!Ll),Hn(g,0,!0)!==0)break e;Xs=o,g.timeoutHandle=Qk(wk.bind(null,g,h,qa,Mh,Mx,o,ai,Lo,au,Ll,S,"Throttled",-0,0),w);break e}wk(g,h,qa,Mh,Mx,o,ai,Lo,au,Ll,S,null,-0,0)}}break}while(!0);gs(s)}function wk(s,o,h,g,w,S,D,X,me,ke,Me,$e,je,De){if(s.timeoutHandle=-1,$e=o.subtreeFlags,$e&8192||($e&16785408)===16785408){$e={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ps},hk(o,S,$e);var ht=(S&62914560)===S?Ih-at():(S&4194048)===S?vk-at():0;if(ht=LL($e,ht),ht!==null){Xs=S,s.cancelPendingCommit=ht(jk.bind(null,s,o,S,h,g,w,D,X,me,Me,$e,null,je,De)),zl(s,S,D,!ke);return}}jk(s,o,S,h,g,w,D,X,me)}function eL(s){for(var o=s;;){var h=o.tag;if((h===0||h===11||h===15)&&o.flags&16384&&(h=o.updateQueue,h!==null&&(h=h.stores,h!==null)))for(var g=0;g<h.length;g++){var w=h[g],S=w.getSnapshot;w=w.value;try{if(!Za(S(),w))return!1}catch{return!1}}if(h=o.child,o.subtreeFlags&16384&&h!==null)h.return=o,o=h;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function zl(s,o,h,g){o&=~Px,o&=~Lo,s.suspendedLanes|=o,s.pingedLanes&=~o,g&&(s.warmLanes|=o),g=s.expirationTimes;for(var w=o;0<w;){var S=31-Tr(w),D=1<<S;g[S]=-1,w&=~D}h!==0&&pn(s,h,o)}function Rh(){return(dr&6)===0?(Gf(0),!1):!0}function Bx(){if(Xt!==null){if(yr===0)var s=Xt.return;else s=Xt,Ls=jo=null,tx(s),Yc=null,jf=0,s=Xt;for(;s!==null;)JN(s.alternate,s),s=s.return;Xt=null}}function su(s,o){var h=s.timeoutHandle;h!==-1&&(s.timeoutHandle=-1,bL(h)),h=s.cancelPendingCommit,h!==null&&(s.cancelPendingCommit=null,h()),Xs=0,Bx(),Mr=s,Xt=h=Rs(s.current,null),Qt=o,yr=0,ni=null,Ll=!1,nu=lr(s,o),Ix=!1,au=ai=Px=Lo=Bl=sn=0,qa=Wf=null,Mx=!1,(o&8)!==0&&(o|=o&32);var g=s.entangledLanes;if(g!==0)for(s=s.entanglements,g&=o;0<g;){var w=31-Tr(g),S=1<<w;o|=s[w],g&=~S}return Ks=o,nh(),h}function _k(s,o){Bt=null,z.H=Ff,o===Xc||o===fh?(o=LE(),yr=3):o===Hv?(o=LE(),yr=4):yr=o===vx?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ni=o,Xt===null&&(sn=1,Nh(s,_i(o,s.current)))}function Sk(){var s=ti.current;return s===null?!0:(Qt&4194048)===Qt?ki===null:(Qt&62914560)===Qt||(Qt&536870912)!==0?s===ki:!1}function Ek(){var s=z.H;return z.H=Ff,s===null?Ff:s}function Nk(){var s=z.A;return z.A=JF,s}function Fh(){sn=4,Ll||(Qt&4194048)!==Qt&&ti.current!==null||(nu=!0),(Bl&134217727)===0&&(Lo&134217727)===0||Mr===null||zl(Mr,Qt,ai,!1)}function Ux(s,o,h){var g=dr;dr|=2;var w=Ek(),S=Nk();(Mr!==s||Qt!==o)&&(Mh=null,su(s,o)),o=!1;var D=sn;e:do try{if(yr!==0&&Xt!==null){var X=Xt,me=ni;switch(yr){case 8:Bx(),D=6;break e;case 3:case 2:case 9:case 6:ti.current===null&&(o=!0);var ke=yr;if(yr=0,ni=null,lu(s,X,me,ke),h&&nu){D=0;break e}break;default:ke=yr,yr=0,ni=null,lu(s,X,me,ke)}}tL(),D=sn;break}catch(Me){_k(s,Me)}while(!0);return o&&s.shellSuspendCounter++,Ls=jo=null,dr=g,z.H=w,z.A=S,Xt===null&&(Mr=null,Qt=0,nh()),D}function tL(){for(;Xt!==null;)kk(Xt)}function rL(s,o){var h=dr;dr|=2;var g=Ek(),w=Nk();Mr!==s||Qt!==o?(Mh=null,Ph=at()+500,su(s,o)):nu=lr(s,o);e:do try{if(yr!==0&&Xt!==null){o=Xt;var S=ni;t:switch(yr){case 1:yr=0,ni=null,lu(s,o,S,1);break;case 2:case 9:if(RE(S)){yr=0,ni=null,Tk(o);break}o=function(){yr!==2&&yr!==9||Mr!==s||(yr=7),gs(s)},S.then(o,o);break e;case 3:yr=7;break e;case 4:yr=5;break e;case 7:RE(S)?(yr=0,ni=null,Tk(o)):(yr=0,ni=null,lu(s,o,S,7));break;case 5:var D=null;switch(Xt.tag){case 26:D=Xt.memoizedState;case 5:case 27:var X=Xt;if(D?dT(D):X.stateNode.complete){yr=0,ni=null;var me=X.sibling;if(me!==null)Xt=me;else{var ke=X.return;ke!==null?(Xt=ke,Lh(ke)):Xt=null}break t}}yr=0,ni=null,lu(s,o,S,5);break;case 6:yr=0,ni=null,lu(s,o,S,6);break;case 8:Bx(),sn=6;break e;default:throw Error(n(462))}}nL();break}catch(Me){_k(s,Me)}while(!0);return Ls=jo=null,z.H=g,z.A=w,dr=h,Xt!==null?0:(Mr=null,Qt=0,nh(),sn)}function nL(){for(;Xt!==null&&!ct();)kk(Xt)}function kk(s){var o=YN(s.alternate,s,Ks);s.memoizedProps=s.pendingProps,o===null?Lh(s):Xt=o}function Tk(s){var o=s,h=o.alternate;switch(o.tag){case 15:case 0:o=qN(h,o,o.pendingProps,o.type,void 0,Qt);break;case 11:o=qN(h,o,o.pendingProps,o.type.render,o.ref,Qt);break;case 5:tx(o);default:JN(h,o),o=Xt=NE(o,Ks),o=YN(h,o,Ks)}s.memoizedProps=s.pendingProps,o===null?Lh(s):Xt=o}function lu(s,o,h,g){Ls=jo=null,tx(o),Yc=null,jf=0;var w=o.return;try{if(WF(s,w,o,h,Qt)){sn=1,Nh(s,_i(h,s.current)),Xt=null;return}}catch(S){if(w!==null)throw Xt=w,S;sn=1,Nh(s,_i(h,s.current)),Xt=null;return}o.flags&32768?(tr||g===1?s=!0:nu||(Qt&536870912)!==0?s=!1:(Ll=s=!0,(g===2||g===9||g===3||g===6)&&(g=ti.current,g!==null&&g.tag===13&&(g.flags|=16384))),Ak(o,s)):Lh(o)}function Lh(s){var o=s;do{if((o.flags&32768)!==0){Ak(o,Ll);return}s=o.return;var h=KF(o.alternate,o,Ks);if(h!==null){Xt=h;return}if(o=o.sibling,o!==null){Xt=o;return}Xt=o=s}while(o!==null);sn===0&&(sn=5)}function Ak(s,o){do{var h=XF(s.alternate,s);if(h!==null){h.flags&=32767,Xt=h;return}if(h=s.return,h!==null&&(h.flags|=32768,h.subtreeFlags=0,h.deletions=null),!o&&(s=s.sibling,s!==null)){Xt=s;return}Xt=s=h}while(s!==null);sn=6,Xt=null}function jk(s,o,h,g,w,S,D,X,me){s.cancelPendingCommit=null;do Bh();while(Dn!==0);if((dr&6)!==0)throw Error(n(327));if(o!==null){if(o===s.current)throw Error(n(177));if(S=o.lanes|o.childLanes,S|=Av,Oa(s,h,S,D,X,me),s===Mr&&(Xt=Mr=null,Qt=0),iu=o,$l=s,Xs=h,Rx=S,Fx=w,xk=g,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,lL(Fe,function(){return Pk(),null})):(s.callbackNode=null,s.callbackPriority=0),g=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||g){g=z.T,z.T=null,w=ue.p,ue.p=2,D=dr,dr|=4;try{YF(s,o,h)}finally{dr=D,ue.p=w,z.T=g}}Dn=1,Ok(),Ck(),Dk()}}function Ok(){if(Dn===1){Dn=0;var s=$l,o=iu,h=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||h){h=z.T,z.T=null;var g=ue.p;ue.p=2;var w=dr;dr|=4;try{uk(o,s);var S=Jx,D=gE(s.containerInfo),X=S.focusedElem,me=S.selectionRange;if(D!==X&&X&&X.ownerDocument&&pE(X.ownerDocument.documentElement,X)){if(me!==null&&Sv(X)){var ke=me.start,Me=me.end;if(Me===void 0&&(Me=ke),"selectionStart"in X)X.selectionStart=ke,X.selectionEnd=Math.min(Me,X.value.length);else{var $e=X.ownerDocument||document,je=$e&&$e.defaultView||window;if(je.getSelection){var De=je.getSelection(),ht=X.textContent.length,At=Math.min(me.start,ht),Cr=me.end===void 0?At:Math.min(me.end,ht);!De.extend&&At>Cr&&(D=Cr,Cr=At,At=D);var _e=mE(X,At),ye=mE(X,Cr);if(_e&&ye&&(De.rangeCount!==1||De.anchorNode!==_e.node||De.anchorOffset!==_e.offset||De.focusNode!==ye.node||De.focusOffset!==ye.offset)){var Ne=$e.createRange();Ne.setStart(_e.node,_e.offset),De.removeAllRanges(),At>Cr?(De.addRange(Ne),De.extend(ye.node,ye.offset)):(Ne.setEnd(ye.node,ye.offset),De.addRange(Ne))}}}}for($e=[],De=X;De=De.parentNode;)De.nodeType===1&&$e.push({element:De,left:De.scrollLeft,top:De.scrollTop});for(typeof X.focus=="function"&&X.focus(),X=0;X<$e.length;X++){var Be=$e[X];Be.element.scrollLeft=Be.left,Be.element.scrollTop=Be.top}}Qh=!!Qx,Jx=Qx=null}finally{dr=w,ue.p=g,z.T=h}}s.current=o,Dn=2}}function Ck(){if(Dn===2){Dn=0;var s=$l,o=iu,h=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||h){h=z.T,z.T=null;var g=ue.p;ue.p=2;var w=dr;dr|=4;try{ik(s,o.alternate,o)}finally{dr=w,ue.p=g,z.T=h}}Dn=3}}function Dk(){if(Dn===4||Dn===3){Dn=0,dt();var s=$l,o=iu,h=Xs,g=xk;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?Dn=5:(Dn=0,iu=$l=null,Ik(s,s.pendingLanes));var w=s.pendingLanes;if(w===0&&(Ul=null),Tt(h),o=o.stateNode,ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(er,o,void 0,(o.current.flags&128)===128)}catch{}if(g!==null){o=z.T,w=ue.p,ue.p=2,z.T=null;try{for(var S=s.onRecoverableError,D=0;D<g.length;D++){var X=g[D];S(X.value,{componentStack:X.stack})}}finally{z.T=o,ue.p=w}}(Xs&3)!==0&&Bh(),gs(s),w=s.pendingLanes,(h&261930)!==0&&(w&42)!==0?s===Lx?Vf++:(Vf=0,Lx=s):Vf=0,Gf(0)}}function Ik(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,Tf(o)))}function Bh(){return Ok(),Ck(),Dk(),Pk()}function Pk(){if(Dn!==5)return!1;var s=$l,o=Rx;Rx=0;var h=Tt(Xs),g=z.T,w=ue.p;try{ue.p=32>h?32:h,z.T=null,h=Fx,Fx=null;var S=$l,D=Xs;if(Dn=0,iu=$l=null,Xs=0,(dr&6)!==0)throw Error(n(331));var X=dr;if(dr|=4,pk(S.current),dk(S,S.current,D,h),dr=X,Gf(0,!1),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(er,S)}catch{}return!0}finally{ue.p=w,z.T=g,Ik(s,o)}}function Mk(s,o,h){o=_i(h,o),o=gx(s.stateNode,o,2),s=Pl(s,o,2),s!==null&&(gr(s,2),gs(s))}function br(s,o,h){if(s.tag===3)Mk(s,s,h);else for(;o!==null;){if(o.tag===3){Mk(o,s,h);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Ul===null||!Ul.has(g))){s=_i(h,s),h=RN(2),g=Pl(o,h,2),g!==null&&(FN(h,g,o,s),gr(g,2),gs(g));break}}o=o.return}}function $x(s,o,h){var g=s.pingCache;if(g===null){g=s.pingCache=new ZF;var w=new Set;g.set(o,w)}else w=g.get(o),w===void 0&&(w=new Set,g.set(o,w));w.has(h)||(Ix=!0,w.add(h),s=aL.bind(null,s,o,h),o.then(s,s))}function aL(s,o,h){var g=s.pingCache;g!==null&&g.delete(o),s.pingedLanes|=s.suspendedLanes&h,s.warmLanes&=~h,Mr===s&&(Qt&h)===h&&(sn===4||sn===3&&(Qt&62914560)===Qt&&300>at()-Ih?(dr&2)===0&&su(s,0):Px|=h,au===Qt&&(au=0)),gs(s)}function Rk(s,o){o===0&&(o=zr()),s=ko(s,o),s!==null&&(gr(s,o),gs(s))}function iL(s){var o=s.memoizedState,h=0;o!==null&&(h=o.retryLane),Rk(s,h)}function sL(s,o){var h=0;switch(s.tag){case 31:case 13:var g=s.stateNode,w=s.memoizedState;w!==null&&(h=w.retryLane);break;case 19:g=s.stateNode;break;case 22:g=s.stateNode._retryCache;break;default:throw Error(n(314))}g!==null&&g.delete(o),Rk(s,h)}function lL(s,o){return Ge(s,o)}var Uh=null,ou=null,zx=!1,$h=!1,Hx=!1,Hl=0;function gs(s){s!==ou&&s.next===null&&(ou===null?Uh=ou=s:ou=ou.next=s),$h=!0,zx||(zx=!0,cL())}function Gf(s,o){if(!Hx&&$h){Hx=!0;do for(var h=!1,g=Uh;g!==null;){if(s!==0){var w=g.pendingLanes;if(w===0)var S=0;else{var D=g.suspendedLanes,X=g.pingedLanes;S=(1<<31-Tr(42|s)+1)-1,S&=w&~(D&~X),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(h=!0,Uk(g,S))}else S=Qt,S=Hn(g,g===Mr?S:0,g.cancelPendingCommit!==null||g.timeoutHandle!==-1),(S&3)===0||lr(g,S)||(h=!0,Uk(g,S));g=g.next}while(h);Hx=!1}}function oL(){Fk()}function Fk(){$h=zx=!1;var s=0;Hl!==0&&yL()&&(s=Hl);for(var o=at(),h=null,g=Uh;g!==null;){var w=g.next,S=Lk(g,o);S===0?(g.next=null,h===null?Uh=w:h.next=w,w===null&&(ou=h)):(h=g,(s!==0||(S&3)!==0)&&($h=!0)),g=w}Dn!==0&&Dn!==5||Gf(s),Hl!==0&&(Hl=0)}function Lk(s,o){for(var h=s.suspendedLanes,g=s.pingedLanes,w=s.expirationTimes,S=s.pendingLanes&-62914561;0<S;){var D=31-Tr(S),X=1<<D,me=w[D];me===-1?((X&h)===0||(X&g)!==0)&&(w[D]=wn(X,o)):me<=o&&(s.expiredLanes|=X),S&=~X}if(o=Mr,h=Qt,h=Hn(s,s===o?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g=s.callbackNode,h===0||s===o&&(yr===2||yr===9)||s.cancelPendingCommit!==null)return g!==null&&g!==null&&ut(g),s.callbackNode=null,s.callbackPriority=0;if((h&3)===0||lr(s,h)){if(o=h&-h,o===s.callbackPriority)return o;switch(g!==null&&ut(g),Tt(h)){case 2:case 8:h=st;break;case 32:h=Fe;break;case 268435456:h=St;break;default:h=Fe}return g=Bk.bind(null,s),h=Ge(h,g),s.callbackPriority=o,s.callbackNode=h,o}return g!==null&&g!==null&&ut(g),s.callbackPriority=2,s.callbackNode=null,2}function Bk(s,o){if(Dn!==0&&Dn!==5)return s.callbackNode=null,s.callbackPriority=0,null;var h=s.callbackNode;if(Bh()&&s.callbackNode!==h)return null;var g=Qt;return g=Hn(s,s===Mr?g:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),g===0?null:(bk(s,g,o),Lk(s,at()),s.callbackNode!=null&&s.callbackNode===h?Bk.bind(null,s):null)}function Uk(s,o){if(Bh())return null;bk(s,o,!0)}function cL(){wL(function(){(dr&6)!==0?Ge(Oe,oL):Fk()})}function qx(){if(Hl===0){var s=Gc;s===0&&(s=$r,$r<<=1,($r&261888)===0&&($r=256)),Hl=s}return Hl}function $k(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:X0(""+s)}function zk(s,o){var h=o.ownerDocument.createElement("input");return h.name=o.name,h.value=o.value,s.id&&h.setAttribute("form",s.id),o.parentNode.insertBefore(h,o),s=new FormData(s),h.parentNode.removeChild(h),s}function uL(s,o,h,g,w){if(o==="submit"&&h&&h.stateNode===w){var S=$k((w[Z]||null).action),D=g.submitter;D&&(o=(o=D[Z]||null)?$k(o.formAction):D.getAttribute("formAction"),o!==null&&(S=o,D=null));var X=new Z0("action","action",null,g,w);s.push({event:X,listeners:[{instance:null,listener:function(){if(g.defaultPrevented){if(Hl!==0){var me=D?zk(w,D):new FormData(w);ux(h,{pending:!0,data:me,method:w.method,action:S},null,me)}}else typeof S=="function"&&(X.preventDefault(),me=D?zk(w,D):new FormData(w),ux(h,{pending:!0,data:me,method:w.method,action:S},S,me))},currentTarget:w}]})}}for(var Wx=0;Wx<Tv.length;Wx++){var Vx=Tv[Wx],fL=Vx.toLowerCase(),dL=Vx[0].toUpperCase()+Vx.slice(1);Gi(fL,"on"+dL)}Gi(yE,"onAnimationEnd"),Gi(bE,"onAnimationIteration"),Gi(wE,"onAnimationStart"),Gi("dblclick","onDoubleClick"),Gi("focusin","onFocus"),Gi("focusout","onBlur"),Gi(AF,"onTransitionRun"),Gi(jF,"onTransitionStart"),Gi(OF,"onTransitionCancel"),Gi(_E,"onTransitionEnd"),Qe("onMouseEnter",["mouseout","mouseover"]),Qe("onMouseLeave",["mouseout","mouseover"]),Qe("onPointerEnter",["pointerout","pointerover"]),Qe("onPointerLeave",["pointerout","pointerover"]),Se("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Se("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Se("onBeforeInput",["compositionend","keypress","textInput","paste"]),Se("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Se("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),hL=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kf));function Hk(s,o){o=(o&4)!==0;for(var h=0;h<s.length;h++){var g=s[h],w=g.event;g=g.listeners;e:{var S=void 0;if(o)for(var D=g.length-1;0<=D;D--){var X=g[D],me=X.instance,ke=X.currentTarget;if(X=X.listener,me!==S&&w.isPropagationStopped())break e;S=X,w.currentTarget=ke;try{S(w)}catch(Me){rh(Me)}w.currentTarget=null,S=me}else for(D=0;D<g.length;D++){if(X=g[D],me=X.instance,ke=X.currentTarget,X=X.listener,me!==S&&w.isPropagationStopped())break e;S=X,w.currentTarget=ke;try{S(w)}catch(Me){rh(Me)}w.currentTarget=null,S=me}}}}function Yt(s,o){var h=o[L];h===void 0&&(h=o[L]=new Set);var g=s+"__bubble";h.has(g)||(qk(o,s,2,!1),h.add(g))}function Gx(s,o,h){var g=0;o&&(g|=4),qk(h,s,g,o)}var zh="_reactListening"+Math.random().toString(36).slice(2);function Kx(s){if(!s[zh]){s[zh]=!0,Ee.forEach(function(h){h!=="selectionchange"&&(hL.has(h)||Gx(h,!1,s),Gx(h,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[zh]||(o[zh]=!0,Gx("selectionchange",!1,o))}}function qk(s,o,h,g){switch(yT(o)){case 2:var w=$L;break;case 8:w=zL;break;default:w=cy}h=w.bind(null,o,h,s),w=void 0,!mv||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(w=!0),g?w!==void 0?s.addEventListener(o,h,{capture:!0,passive:w}):s.addEventListener(o,h,!0):w!==void 0?s.addEventListener(o,h,{passive:w}):s.addEventListener(o,h,!1)}function Xx(s,o,h,g,w){var S=g;if((o&1)===0&&(o&2)===0&&g!==null)e:for(;;){if(g===null)return;var D=g.tag;if(D===3||D===4){var X=g.stateNode.containerInfo;if(X===w)break;if(D===4)for(D=g.return;D!==null;){var me=D.tag;if((me===3||me===4)&&D.stateNode.containerInfo===w)return;D=D.return}for(;X!==null;){if(D=Re(X),D===null)return;if(me=D.tag,me===5||me===6||me===26||me===27){g=S=D;continue e}X=X.parentNode}}g=g.return}XS(function(){var ke=S,Me=dv(h),$e=[];e:{var je=SE.get(s);if(je!==void 0){var De=Z0,ht=s;switch(s){case"keypress":if(Q0(h)===0)break e;case"keydown":case"keyup":De=sF;break;case"focusin":ht="focus",De=xv;break;case"focusout":ht="blur",De=xv;break;case"beforeblur":case"afterblur":De=xv;break;case"click":if(h.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":De=JS;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":De=K8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":De=cF;break;case yE:case bE:case wE:De=Q8;break;case _E:De=fF;break;case"scroll":case"scrollend":De=V8;break;case"wheel":De=hF;break;case"copy":case"cut":case"paste":De=Z8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":De=eE;break;case"toggle":case"beforetoggle":De=pF}var At=(o&4)!==0,Cr=!At&&(s==="scroll"||s==="scrollend"),_e=At?je!==null?je+"Capture":null:je;At=[];for(var ye=ke,Ne;ye!==null;){var Be=ye;if(Ne=Be.stateNode,Be=Be.tag,Be!==5&&Be!==26&&Be!==27||Ne===null||_e===null||(Be=gf(ye,_e),Be!=null&&At.push(Xf(ye,Be,Ne))),Cr)break;ye=ye.return}0<At.length&&(je=new De(je,ht,null,h,Me),$e.push({event:je,listeners:At}))}}if((o&7)===0){e:{if(je=s==="mouseover"||s==="pointerover",De=s==="mouseout"||s==="pointerout",je&&h!==fv&&(ht=h.relatedTarget||h.fromElement)&&(Re(ht)||ht[ne]))break e;if((De||je)&&(je=Me.window===Me?Me:(je=Me.ownerDocument)?je.defaultView||je.parentWindow:window,De?(ht=h.relatedTarget||h.toElement,De=ke,ht=ht?Re(ht):null,ht!==null&&(Cr=i(ht),At=ht.tag,ht!==Cr||At!==5&&At!==27&&At!==6)&&(ht=null)):(De=null,ht=ke),De!==ht)){if(At=JS,Be="onMouseLeave",_e="onMouseEnter",ye="mouse",(s==="pointerout"||s==="pointerover")&&(At=eE,Be="onPointerLeave",_e="onPointerEnter",ye="pointer"),Cr=De==null?je:C(De),Ne=ht==null?je:C(ht),je=new At(Be,ye+"leave",De,h,Me),je.target=Cr,je.relatedTarget=Ne,Be=null,Re(Me)===ke&&(At=new At(_e,ye+"enter",ht,h,Me),At.target=Ne,At.relatedTarget=Cr,Be=At),Cr=Be,De&&ht)t:{for(At=mL,_e=De,ye=ht,Ne=0,Be=_e;Be;Be=At(Be))Ne++;Be=0;for(var Nt=ye;Nt;Nt=At(Nt))Be++;for(;0<Ne-Be;)_e=At(_e),Ne--;for(;0<Be-Ne;)ye=At(ye),Be--;for(;Ne--;){if(_e===ye||ye!==null&&_e===ye.alternate){At=_e;break t}_e=At(_e),ye=At(ye)}At=null}else At=null;De!==null&&Wk($e,je,De,At,!1),ht!==null&&Cr!==null&&Wk($e,Cr,ht,At,!0)}}e:{if(je=ke?C(ke):window,De=je.nodeName&&je.nodeName.toLowerCase(),De==="select"||De==="input"&&je.type==="file")var or=oE;else if(sE(je))if(cE)or=NF;else{or=SF;var vt=_F}else De=je.nodeName,!De||De.toLowerCase()!=="input"||je.type!=="checkbox"&&je.type!=="radio"?ke&&uv(ke.elementType)&&(or=oE):or=EF;if(or&&(or=or(s,ke))){lE($e,or,h,Me);break e}vt&&vt(s,je,ke),s==="focusout"&&ke&&je.type==="number"&&ke.memoizedProps.value!=null&&Ar(je,"number",je.value)}switch(vt=ke?C(ke):window,s){case"focusin":(sE(vt)||vt.contentEditable==="true")&&(Bc=vt,Ev=ke,Ef=null);break;case"focusout":Ef=Ev=Bc=null;break;case"mousedown":Nv=!0;break;case"contextmenu":case"mouseup":case"dragend":Nv=!1,vE($e,h,Me);break;case"selectionchange":if(TF)break;case"keydown":case"keyup":vE($e,h,Me)}var $t;if(bv)e:{switch(s){case"compositionstart":var Jt="onCompositionStart";break e;case"compositionend":Jt="onCompositionEnd";break e;case"compositionupdate":Jt="onCompositionUpdate";break e}Jt=void 0}else Lc?aE(s,h)&&(Jt="onCompositionEnd"):s==="keydown"&&h.keyCode===229&&(Jt="onCompositionStart");Jt&&(tE&&h.locale!=="ko"&&(Lc||Jt!=="onCompositionStart"?Jt==="onCompositionEnd"&&Lc&&($t=YS()):(Tl=Me,pv="value"in Tl?Tl.value:Tl.textContent,Lc=!0)),vt=Hh(ke,Jt),0<vt.length&&(Jt=new ZS(Jt,s,null,h,Me),$e.push({event:Jt,listeners:vt}),$t?Jt.data=$t:($t=iE(h),$t!==null&&(Jt.data=$t)))),($t=vF?xF(s,h):yF(s,h))&&(Jt=Hh(ke,"onBeforeInput"),0<Jt.length&&(vt=new ZS("onBeforeInput","beforeinput",null,h,Me),$e.push({event:vt,listeners:Jt}),vt.data=$t)),uL($e,s,ke,h,Me)}Hk($e,o)})}function Xf(s,o,h){return{instance:s,listener:o,currentTarget:h}}function Hh(s,o){for(var h=o+"Capture",g=[];s!==null;){var w=s,S=w.stateNode;if(w=w.tag,w!==5&&w!==26&&w!==27||S===null||(w=gf(s,h),w!=null&&g.unshift(Xf(s,w,S)),w=gf(s,o),w!=null&&g.push(Xf(s,w,S))),s.tag===3)return g;s=s.return}return[]}function mL(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Wk(s,o,h,g,w){for(var S=o._reactName,D=[];h!==null&&h!==g;){var X=h,me=X.alternate,ke=X.stateNode;if(X=X.tag,me!==null&&me===g)break;X!==5&&X!==26&&X!==27||ke===null||(me=ke,w?(ke=gf(h,S),ke!=null&&D.unshift(Xf(h,ke,me))):w||(ke=gf(h,S),ke!=null&&D.push(Xf(h,ke,me)))),h=h.return}D.length!==0&&s.push({event:o,listeners:D})}var pL=/\r\n?/g,gL=/\u0000|\uFFFD/g;function Vk(s){return(typeof s=="string"?s:""+s).replace(pL,`
`).replace(gL,"")}function Gk(s,o){return o=Vk(o),Vk(s)===o}function Or(s,o,h,g,w,S){switch(h){case"children":typeof g=="string"?o==="body"||o==="textarea"&&g===""||Mt(s,g):(typeof g=="number"||typeof g=="bigint")&&o!=="body"&&Mt(s,""+g);break;case"className":yt(s,"class",g);break;case"tabIndex":yt(s,"tabindex",g);break;case"dir":case"role":case"viewBox":case"width":case"height":yt(s,h,g);break;case"style":GS(s,g,S);break;case"data":if(o!=="object"){yt(s,"data",g);break}case"src":case"href":if(g===""&&(o!=="a"||h!=="href")){s.removeAttribute(h);break}if(g==null||typeof g=="function"||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(h);break}g=X0(""+g),s.setAttribute(h,g);break;case"action":case"formAction":if(typeof g=="function"){s.setAttribute(h,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(h==="formAction"?(o!=="input"&&Or(s,o,"name",w.name,w,null),Or(s,o,"formEncType",w.formEncType,w,null),Or(s,o,"formMethod",w.formMethod,w,null),Or(s,o,"formTarget",w.formTarget,w,null)):(Or(s,o,"encType",w.encType,w,null),Or(s,o,"method",w.method,w,null),Or(s,o,"target",w.target,w,null)));if(g==null||typeof g=="symbol"||typeof g=="boolean"){s.removeAttribute(h);break}g=X0(""+g),s.setAttribute(h,g);break;case"onClick":g!=null&&(s.onclick=Ps);break;case"onScroll":g!=null&&Yt("scroll",s);break;case"onScrollEnd":g!=null&&Yt("scrollend",s);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(h=g.__html,h!=null){if(w.children!=null)throw Error(n(60));s.innerHTML=h}}break;case"multiple":s.multiple=g&&typeof g!="function"&&typeof g!="symbol";break;case"muted":s.muted=g&&typeof g!="function"&&typeof g!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(g==null||typeof g=="function"||typeof g=="boolean"||typeof g=="symbol"){s.removeAttribute("xlink:href");break}h=X0(""+g),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",h);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(h,""+g):s.removeAttribute(h);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":g&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(h,""):s.removeAttribute(h);break;case"capture":case"download":g===!0?s.setAttribute(h,""):g!==!1&&g!=null&&typeof g!="function"&&typeof g!="symbol"?s.setAttribute(h,g):s.removeAttribute(h);break;case"cols":case"rows":case"size":case"span":g!=null&&typeof g!="function"&&typeof g!="symbol"&&!isNaN(g)&&1<=g?s.setAttribute(h,g):s.removeAttribute(h);break;case"rowSpan":case"start":g==null||typeof g=="function"||typeof g=="symbol"||isNaN(g)?s.removeAttribute(h):s.setAttribute(h,g);break;case"popover":Yt("beforetoggle",s),Yt("toggle",s),nt(s,"popover",g);break;case"xlinkActuate":Rt(s,"http://www.w3.org/1999/xlink","xlink:actuate",g);break;case"xlinkArcrole":Rt(s,"http://www.w3.org/1999/xlink","xlink:arcrole",g);break;case"xlinkRole":Rt(s,"http://www.w3.org/1999/xlink","xlink:role",g);break;case"xlinkShow":Rt(s,"http://www.w3.org/1999/xlink","xlink:show",g);break;case"xlinkTitle":Rt(s,"http://www.w3.org/1999/xlink","xlink:title",g);break;case"xlinkType":Rt(s,"http://www.w3.org/1999/xlink","xlink:type",g);break;case"xmlBase":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:base",g);break;case"xmlLang":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:lang",g);break;case"xmlSpace":Rt(s,"http://www.w3.org/XML/1998/namespace","xml:space",g);break;case"is":nt(s,"is",g);break;case"innerText":case"textContent":break;default:(!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(h=q8.get(h)||h,nt(s,h,g))}}function Yx(s,o,h,g,w,S){switch(h){case"style":GS(s,g,S);break;case"dangerouslySetInnerHTML":if(g!=null){if(typeof g!="object"||!("__html"in g))throw Error(n(61));if(h=g.__html,h!=null){if(w.children!=null)throw Error(n(60));s.innerHTML=h}}break;case"children":typeof g=="string"?Mt(s,g):(typeof g=="number"||typeof g=="bigint")&&Mt(s,""+g);break;case"onScroll":g!=null&&Yt("scroll",s);break;case"onScrollEnd":g!=null&&Yt("scrollend",s);break;case"onClick":g!=null&&(s.onclick=Ps);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ce.hasOwnProperty(h))e:{if(h[0]==="o"&&h[1]==="n"&&(w=h.endsWith("Capture"),o=h.slice(2,w?h.length-7:void 0),S=s[Z]||null,S=S!=null?S[h]:null,typeof S=="function"&&s.removeEventListener(o,S,w),typeof g=="function")){typeof S!="function"&&S!==null&&(h in s?s[h]=null:s.hasAttribute(h)&&s.removeAttribute(h)),s.addEventListener(o,g,w);break e}h in s?s[h]=g:g===!0?s.setAttribute(h,""):nt(s,h,g)}}}function la(s,o,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yt("error",s),Yt("load",s);var g=!1,w=!1,S;for(S in h)if(h.hasOwnProperty(S)){var D=h[S];if(D!=null)switch(S){case"src":g=!0;break;case"srcSet":w=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Or(s,o,S,D,h,null)}}w&&Or(s,o,"srcSet",h.srcSet,h,null),g&&Or(s,o,"src",h.src,h,null);return;case"input":Yt("invalid",s);var X=S=D=w=null,me=null,ke=null;for(g in h)if(h.hasOwnProperty(g)){var Me=h[g];if(Me!=null)switch(g){case"name":w=Me;break;case"type":D=Me;break;case"checked":me=Me;break;case"defaultChecked":ke=Me;break;case"value":S=Me;break;case"defaultValue":X=Me;break;case"children":case"dangerouslySetInnerHTML":if(Me!=null)throw Error(n(137,o));break;default:Or(s,o,g,Me,h,null)}}rt(s,S,X,me,ke,D,w,!1);return;case"select":Yt("invalid",s),g=D=S=null;for(w in h)if(h.hasOwnProperty(w)&&(X=h[w],X!=null))switch(w){case"value":S=X;break;case"defaultValue":D=X;break;case"multiple":g=X;default:Or(s,o,w,X,h,null)}o=S,h=D,s.multiple=!!g,o!=null?vr(s,!!g,o,!1):h!=null&&vr(s,!!g,h,!0);return;case"textarea":Yt("invalid",s),S=w=g=null;for(D in h)if(h.hasOwnProperty(D)&&(X=h[D],X!=null))switch(D){case"value":g=X;break;case"defaultValue":w=X;break;case"children":S=X;break;case"dangerouslySetInnerHTML":if(X!=null)throw Error(n(91));break;default:Or(s,o,D,X,h,null)}lt(s,g,w,S);return;case"option":for(me in h)if(h.hasOwnProperty(me)&&(g=h[me],g!=null))switch(me){case"selected":s.selected=g&&typeof g!="function"&&typeof g!="symbol";break;default:Or(s,o,me,g,h,null)}return;case"dialog":Yt("beforetoggle",s),Yt("toggle",s),Yt("cancel",s),Yt("close",s);break;case"iframe":case"object":Yt("load",s);break;case"video":case"audio":for(g=0;g<Kf.length;g++)Yt(Kf[g],s);break;case"image":Yt("error",s),Yt("load",s);break;case"details":Yt("toggle",s);break;case"embed":case"source":case"link":Yt("error",s),Yt("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ke in h)if(h.hasOwnProperty(ke)&&(g=h[ke],g!=null))switch(ke){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,o));default:Or(s,o,ke,g,h,null)}return;default:if(uv(o)){for(Me in h)h.hasOwnProperty(Me)&&(g=h[Me],g!==void 0&&Yx(s,o,Me,g,h,void 0));return}}for(X in h)h.hasOwnProperty(X)&&(g=h[X],g!=null&&Or(s,o,X,g,h,null))}function vL(s,o,h,g){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var w=null,S=null,D=null,X=null,me=null,ke=null,Me=null;for(De in h){var $e=h[De];if(h.hasOwnProperty(De)&&$e!=null)switch(De){case"checked":break;case"value":break;case"defaultValue":me=$e;default:g.hasOwnProperty(De)||Or(s,o,De,null,g,$e)}}for(var je in g){var De=g[je];if($e=h[je],g.hasOwnProperty(je)&&(De!=null||$e!=null))switch(je){case"type":S=De;break;case"name":w=De;break;case"checked":ke=De;break;case"defaultChecked":Me=De;break;case"value":D=De;break;case"defaultValue":X=De;break;case"children":case"dangerouslySetInnerHTML":if(De!=null)throw Error(n(137,o));break;default:De!==$e&&Or(s,o,je,De,g,$e)}}ce(s,D,X,me,ke,Me,S,w);return;case"select":De=D=X=je=null;for(S in h)if(me=h[S],h.hasOwnProperty(S)&&me!=null)switch(S){case"value":break;case"multiple":De=me;default:g.hasOwnProperty(S)||Or(s,o,S,null,g,me)}for(w in g)if(S=g[w],me=h[w],g.hasOwnProperty(w)&&(S!=null||me!=null))switch(w){case"value":je=S;break;case"defaultValue":X=S;break;case"multiple":D=S;default:S!==me&&Or(s,o,w,S,g,me)}o=X,h=D,g=De,je!=null?vr(s,!!h,je,!1):!!g!=!!h&&(o!=null?vr(s,!!h,o,!0):vr(s,!!h,h?[]:"",!1));return;case"textarea":De=je=null;for(X in h)if(w=h[X],h.hasOwnProperty(X)&&w!=null&&!g.hasOwnProperty(X))switch(X){case"value":break;case"children":break;default:Or(s,o,X,null,g,w)}for(D in g)if(w=g[D],S=h[D],g.hasOwnProperty(D)&&(w!=null||S!=null))switch(D){case"value":je=w;break;case"defaultValue":De=w;break;case"children":break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(n(91));break;default:w!==S&&Or(s,o,D,w,g,S)}tt(s,je,De);return;case"option":for(var ht in h)if(je=h[ht],h.hasOwnProperty(ht)&&je!=null&&!g.hasOwnProperty(ht))switch(ht){case"selected":s.selected=!1;break;default:Or(s,o,ht,null,g,je)}for(me in g)if(je=g[me],De=h[me],g.hasOwnProperty(me)&&je!==De&&(je!=null||De!=null))switch(me){case"selected":s.selected=je&&typeof je!="function"&&typeof je!="symbol";break;default:Or(s,o,me,je,g,De)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var At in h)je=h[At],h.hasOwnProperty(At)&&je!=null&&!g.hasOwnProperty(At)&&Or(s,o,At,null,g,je);for(ke in g)if(je=g[ke],De=h[ke],g.hasOwnProperty(ke)&&je!==De&&(je!=null||De!=null))switch(ke){case"children":case"dangerouslySetInnerHTML":if(je!=null)throw Error(n(137,o));break;default:Or(s,o,ke,je,g,De)}return;default:if(uv(o)){for(var Cr in h)je=h[Cr],h.hasOwnProperty(Cr)&&je!==void 0&&!g.hasOwnProperty(Cr)&&Yx(s,o,Cr,void 0,g,je);for(Me in g)je=g[Me],De=h[Me],!g.hasOwnProperty(Me)||je===De||je===void 0&&De===void 0||Yx(s,o,Me,je,g,De);return}}for(var _e in h)je=h[_e],h.hasOwnProperty(_e)&&je!=null&&!g.hasOwnProperty(_e)&&Or(s,o,_e,null,g,je);for($e in g)je=g[$e],De=h[$e],!g.hasOwnProperty($e)||je===De||je==null&&De==null||Or(s,o,$e,je,g,De)}function Kk(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function xL(){if(typeof performance.getEntriesByType=="function"){for(var s=0,o=0,h=performance.getEntriesByType("resource"),g=0;g<h.length;g++){var w=h[g],S=w.transferSize,D=w.initiatorType,X=w.duration;if(S&&X&&Kk(D)){for(D=0,X=w.responseEnd,g+=1;g<h.length;g++){var me=h[g],ke=me.startTime;if(ke>X)break;var Me=me.transferSize,$e=me.initiatorType;Me&&Kk($e)&&(me=me.responseEnd,D+=Me*(me<X?1:(X-ke)/(me-ke)))}if(--g,o+=8*(S+D)/(w.duration/1e3),s++,10<s)break}}if(0<s)return o/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var Qx=null,Jx=null;function qh(s){return s.nodeType===9?s:s.ownerDocument}function Xk(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Yk(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Zx(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var ey=null;function yL(){var s=window.event;return s&&s.type==="popstate"?s===ey?!1:(ey=s,!0):(ey=null,!1)}var Qk=typeof setTimeout=="function"?setTimeout:void 0,bL=typeof clearTimeout=="function"?clearTimeout:void 0,Jk=typeof Promise=="function"?Promise:void 0,wL=typeof queueMicrotask=="function"?queueMicrotask:typeof Jk<"u"?function(s){return Jk.resolve(null).then(s).catch(_L)}:Qk;function _L(s){setTimeout(function(){throw s})}function ql(s){return s==="head"}function Zk(s,o){var h=o,g=0;do{var w=h.nextSibling;if(s.removeChild(h),w&&w.nodeType===8)if(h=w.data,h==="/$"||h==="/&"){if(g===0){s.removeChild(w),du(o);return}g--}else if(h==="$"||h==="$?"||h==="$~"||h==="$!"||h==="&")g++;else if(h==="html")Yf(s.ownerDocument.documentElement);else if(h==="head"){h=s.ownerDocument.head,Yf(h);for(var S=h.firstChild;S;){var D=S.nextSibling,X=S.nodeName;S[we]||X==="SCRIPT"||X==="STYLE"||X==="LINK"&&S.rel.toLowerCase()==="stylesheet"||h.removeChild(S),S=D}}else h==="body"&&Yf(s.ownerDocument.body);h=w}while(h);du(o)}function eT(s,o){var h=s;s=0;do{var g=h.nextSibling;if(h.nodeType===1?o?(h._stashedDisplay=h.style.display,h.style.display="none"):(h.style.display=h._stashedDisplay||"",h.getAttribute("style")===""&&h.removeAttribute("style")):h.nodeType===3&&(o?(h._stashedText=h.nodeValue,h.nodeValue=""):h.nodeValue=h._stashedText||""),g&&g.nodeType===8)if(h=g.data,h==="/$"){if(s===0)break;s--}else h!=="$"&&h!=="$?"&&h!=="$~"&&h!=="$!"||s++;h=g}while(h)}function ty(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var h=o;switch(o=o.nextSibling,h.nodeName){case"HTML":case"HEAD":case"BODY":ty(h),Pe(h);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(h.rel.toLowerCase()==="stylesheet")continue}s.removeChild(h)}}function SL(s,o,h,g){for(;s.nodeType===1;){var w=h;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!g&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(g){if(!s[we])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(S=s.getAttribute("rel"),S==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(S!==w.rel||s.getAttribute("href")!==(w.href==null||w.href===""?null:w.href)||s.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin)||s.getAttribute("title")!==(w.title==null?null:w.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(S=s.getAttribute("src"),(S!==(w.src==null?null:w.src)||s.getAttribute("type")!==(w.type==null?null:w.type)||s.getAttribute("crossorigin")!==(w.crossOrigin==null?null:w.crossOrigin))&&S&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var S=w.name==null?null:""+w.name;if(w.type==="hidden"&&s.getAttribute("name")===S)return s}else return s;if(s=Ti(s.nextSibling),s===null)break}return null}function EL(s,o,h){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!h||(s=Ti(s.nextSibling),s===null))return null;return s}function tT(s,o){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!o||(s=Ti(s.nextSibling),s===null))return null;return s}function ry(s){return s.data==="$?"||s.data==="$~"}function ny(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function NL(s,o){var h=s.ownerDocument;if(s.data==="$~")s._reactRetry=o;else if(s.data!=="$?"||h.readyState!=="loading")o();else{var g=function(){o(),h.removeEventListener("DOMContentLoaded",g)};h.addEventListener("DOMContentLoaded",g),s._reactRetry=g}}function Ti(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"||o==="F!"||o==="F")break;if(o==="/$"||o==="/&")return null}}return s}var ay=null;function rT(s){s=s.nextSibling;for(var o=0;s;){if(s.nodeType===8){var h=s.data;if(h==="/$"||h==="/&"){if(o===0)return Ti(s.nextSibling);o--}else h!=="$"&&h!=="$!"&&h!=="$?"&&h!=="$~"&&h!=="&"||o++}s=s.nextSibling}return null}function nT(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var h=s.data;if(h==="$"||h==="$!"||h==="$?"||h==="$~"||h==="&"){if(o===0)return s;o--}else h!=="/$"&&h!=="/&"||o++}s=s.previousSibling}return null}function aT(s,o,h){switch(o=qh(h),s){case"html":if(s=o.documentElement,!s)throw Error(n(452));return s;case"head":if(s=o.head,!s)throw Error(n(453));return s;case"body":if(s=o.body,!s)throw Error(n(454));return s;default:throw Error(n(451))}}function Yf(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);Pe(s)}var Ai=new Map,iT=new Set;function Wh(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Ys=ue.d;ue.d={f:kL,r:TL,D:AL,C:jL,L:OL,m:CL,X:IL,S:DL,M:PL};function kL(){var s=Ys.f(),o=Rh();return s||o}function TL(s){var o=Ve(s);o!==null&&o.tag===5&&o.type==="form"?_N(o):Ys.r(s)}var cu=typeof document>"u"?null:document;function sT(s,o,h){var g=cu;if(g&&typeof o=="string"&&o){var w=ie(o);w='link[rel="'+s+'"][href="'+w+'"]',typeof h=="string"&&(w+='[crossorigin="'+h+'"]'),iT.has(w)||(iT.add(w),s={rel:s,crossOrigin:h,href:o},g.querySelector(w)===null&&(o=g.createElement("link"),la(o,"link",s),xe(o),g.head.appendChild(o)))}}function AL(s){Ys.D(s),sT("dns-prefetch",s,null)}function jL(s,o){Ys.C(s,o),sT("preconnect",s,o)}function OL(s,o,h){Ys.L(s,o,h);var g=cu;if(g&&s&&o){var w='link[rel="preload"][as="'+ie(o)+'"]';o==="image"&&h&&h.imageSrcSet?(w+='[imagesrcset="'+ie(h.imageSrcSet)+'"]',typeof h.imageSizes=="string"&&(w+='[imagesizes="'+ie(h.imageSizes)+'"]')):w+='[href="'+ie(s)+'"]';var S=w;switch(o){case"style":S=uu(s);break;case"script":S=fu(s)}Ai.has(S)||(s=p({rel:"preload",href:o==="image"&&h&&h.imageSrcSet?void 0:s,as:o},h),Ai.set(S,s),g.querySelector(w)!==null||o==="style"&&g.querySelector(Qf(S))||o==="script"&&g.querySelector(Jf(S))||(o=g.createElement("link"),la(o,"link",s),xe(o),g.head.appendChild(o)))}}function CL(s,o){Ys.m(s,o);var h=cu;if(h&&s){var g=o&&typeof o.as=="string"?o.as:"script",w='link[rel="modulepreload"][as="'+ie(g)+'"][href="'+ie(s)+'"]',S=w;switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=fu(s)}if(!Ai.has(S)&&(s=p({rel:"modulepreload",href:s},o),Ai.set(S,s),h.querySelector(w)===null)){switch(g){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(h.querySelector(Jf(S)))return}g=h.createElement("link"),la(g,"link",s),xe(g),h.head.appendChild(g)}}}function DL(s,o,h){Ys.S(s,o,h);var g=cu;if(g&&s){var w=J(g).hoistableStyles,S=uu(s);o=o||"default";var D=w.get(S);if(!D){var X={loading:0,preload:null};if(D=g.querySelector(Qf(S)))X.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":o},h),(h=Ai.get(S))&&iy(s,h);var me=D=g.createElement("link");xe(me),la(me,"link",s),me._p=new Promise(function(ke,Me){me.onload=ke,me.onerror=Me}),me.addEventListener("load",function(){X.loading|=1}),me.addEventListener("error",function(){X.loading|=2}),X.loading|=4,Vh(D,o,g)}D={type:"stylesheet",instance:D,count:1,state:X},w.set(S,D)}}}function IL(s,o){Ys.X(s,o);var h=cu;if(h&&s){var g=J(h).hoistableScripts,w=fu(s),S=g.get(w);S||(S=h.querySelector(Jf(w)),S||(s=p({src:s,async:!0},o),(o=Ai.get(w))&&sy(s,o),S=h.createElement("script"),xe(S),la(S,"link",s),h.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},g.set(w,S))}}function PL(s,o){Ys.M(s,o);var h=cu;if(h&&s){var g=J(h).hoistableScripts,w=fu(s),S=g.get(w);S||(S=h.querySelector(Jf(w)),S||(s=p({src:s,async:!0,type:"module"},o),(o=Ai.get(w))&&sy(s,o),S=h.createElement("script"),xe(S),la(S,"link",s),h.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},g.set(w,S))}}function lT(s,o,h,g){var w=(w=le.current)?Wh(w):null;if(!w)throw Error(n(446));switch(s){case"meta":case"title":return null;case"style":return typeof h.precedence=="string"&&typeof h.href=="string"?(o=uu(h.href),h=J(w).hoistableStyles,g=h.get(o),g||(g={type:"style",instance:null,count:0,state:null},h.set(o,g)),g):{type:"void",instance:null,count:0,state:null};case"link":if(h.rel==="stylesheet"&&typeof h.href=="string"&&typeof h.precedence=="string"){s=uu(h.href);var S=J(w).hoistableStyles,D=S.get(s);if(D||(w=w.ownerDocument||w,D={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(s,D),(S=w.querySelector(Qf(s)))&&!S._p&&(D.instance=S,D.state.loading=5),Ai.has(s)||(h={rel:"preload",as:"style",href:h.href,crossOrigin:h.crossOrigin,integrity:h.integrity,media:h.media,hrefLang:h.hrefLang,referrerPolicy:h.referrerPolicy},Ai.set(s,h),S||ML(w,s,h,D.state))),o&&g===null)throw Error(n(528,""));return D}if(o&&g!==null)throw Error(n(529,""));return null;case"script":return o=h.async,h=h.src,typeof h=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=fu(h),h=J(w).hoistableScripts,g=h.get(o),g||(g={type:"script",instance:null,count:0,state:null},h.set(o,g)),g):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,s))}}function uu(s){return'href="'+ie(s)+'"'}function Qf(s){return'link[rel="stylesheet"]['+s+"]"}function oT(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function ML(s,o,h,g){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?g.loading=1:(o=s.createElement("link"),g.preload=o,o.addEventListener("load",function(){return g.loading|=1}),o.addEventListener("error",function(){return g.loading|=2}),la(o,"link",h),xe(o),s.head.appendChild(o))}function fu(s){return'[src="'+ie(s)+'"]'}function Jf(s){return"script[async]"+s}function cT(s,o,h){if(o.count++,o.instance===null)switch(o.type){case"style":var g=s.querySelector('style[data-href~="'+ie(h.href)+'"]');if(g)return o.instance=g,xe(g),g;var w=p({},h,{"data-href":h.href,"data-precedence":h.precedence,href:null,precedence:null});return g=(s.ownerDocument||s).createElement("style"),xe(g),la(g,"style",w),Vh(g,h.precedence,s),o.instance=g;case"stylesheet":w=uu(h.href);var S=s.querySelector(Qf(w));if(S)return o.state.loading|=4,o.instance=S,xe(S),S;g=oT(h),(w=Ai.get(w))&&iy(g,w),S=(s.ownerDocument||s).createElement("link"),xe(S);var D=S;return D._p=new Promise(function(X,me){D.onload=X,D.onerror=me}),la(S,"link",g),o.state.loading|=4,Vh(S,h.precedence,s),o.instance=S;case"script":return S=fu(h.src),(w=s.querySelector(Jf(S)))?(o.instance=w,xe(w),w):(g=h,(w=Ai.get(S))&&(g=p({},h),sy(g,w)),s=s.ownerDocument||s,w=s.createElement("script"),xe(w),la(w,"link",g),s.head.appendChild(w),o.instance=w);case"void":return null;default:throw Error(n(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(g=o.instance,o.state.loading|=4,Vh(g,h.precedence,s));return o.instance}function Vh(s,o,h){for(var g=h.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),w=g.length?g[g.length-1]:null,S=w,D=0;D<g.length;D++){var X=g[D];if(X.dataset.precedence===o)S=X;else if(S!==w)break}S?S.parentNode.insertBefore(s,S.nextSibling):(o=h.nodeType===9?h.head:h,o.insertBefore(s,o.firstChild))}function iy(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function sy(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Gh=null;function uT(s,o,h){if(Gh===null){var g=new Map,w=Gh=new Map;w.set(h,g)}else w=Gh,g=w.get(h),g||(g=new Map,w.set(h,g));if(g.has(s))return g;for(g.set(s,null),h=h.getElementsByTagName(s),w=0;w<h.length;w++){var S=h[w];if(!(S[we]||S[H]||s==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var D=S.getAttribute(o)||"";D=s+D;var X=g.get(D);X?X.push(S):g.set(D,[S])}}return g}function fT(s,o,h){s=s.ownerDocument||s,s.head.insertBefore(h,o==="title"?s.querySelector("head > title"):null)}function RL(s,o,h){if(h===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function dT(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function FL(s,o,h,g){if(h.type==="stylesheet"&&(typeof g.media!="string"||matchMedia(g.media).matches!==!1)&&(h.state.loading&4)===0){if(h.instance===null){var w=uu(g.href),S=o.querySelector(Qf(w));if(S){o=S._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(s.count++,s=Kh.bind(s),o.then(s,s)),h.state.loading|=4,h.instance=S,xe(S);return}S=o.ownerDocument||o,g=oT(g),(w=Ai.get(w))&&iy(g,w),S=S.createElement("link"),xe(S);var D=S;D._p=new Promise(function(X,me){D.onload=X,D.onerror=me}),la(S,"link",g),h.instance=S}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(h,o),(o=h.state.preload)&&(h.state.loading&3)===0&&(s.count++,h=Kh.bind(s),o.addEventListener("load",h),o.addEventListener("error",h))}}var ly=0;function LL(s,o){return s.stylesheets&&s.count===0&&Yh(s,s.stylesheets),0<s.count||0<s.imgCount?function(h){var g=setTimeout(function(){if(s.stylesheets&&Yh(s,s.stylesheets),s.unsuspend){var S=s.unsuspend;s.unsuspend=null,S()}},6e4+o);0<s.imgBytes&&ly===0&&(ly=62500*xL());var w=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&Yh(s,s.stylesheets),s.unsuspend)){var S=s.unsuspend;s.unsuspend=null,S()}},(s.imgBytes>ly?50:800)+o);return s.unsuspend=h,function(){s.unsuspend=null,clearTimeout(g),clearTimeout(w)}}:null}function Kh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Yh(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var Xh=null;function Yh(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,Xh=new Map,o.forEach(BL,s),Xh=null,Kh.call(s))}function BL(s,o){if(!(o.state.loading&4)){var h=Xh.get(s);if(h)var g=h.get(null);else{h=new Map,Xh.set(s,h);for(var w=s.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<w.length;S++){var D=w[S];(D.nodeName==="LINK"||D.getAttribute("media")!=="not all")&&(h.set(D.dataset.precedence,D),g=D)}g&&h.set(null,g)}w=o.instance,D=w.getAttribute("data-precedence"),S=h.get(D)||g,S===g&&h.set(null,w),h.set(D,w),this.count++,g=Kh.bind(this),w.addEventListener("load",g),w.addEventListener("error",g),S?S.parentNode.insertBefore(w,S.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(w,s.firstChild)),o.state.loading|=4}}var Zf={$$typeof:T,Provider:null,Consumer:null,_currentValue:se,_currentValue2:se,_threadCount:0};function UL(s,o,h,g,w,S,D,X,me){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=na(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=na(0),this.hiddenUpdates=na(null),this.identifierPrefix=g,this.onUncaughtError=w,this.onCaughtError=S,this.onRecoverableError=D,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=me,this.incompleteTransitions=new Map}function hT(s,o,h,g,w,S,D,X,me,ke,Me,$e){return s=new UL(s,o,h,D,me,ke,Me,$e,X),o=1,S===!0&&(o|=24),S=ei(3,null,null,o),s.current=S,S.stateNode=s,o=Uv(),o.refCount++,s.pooledCache=o,o.refCount++,S.memoizedState={element:g,isDehydrated:h,cache:o},qv(S),s}function mT(s){return s?(s=zc,s):zc}function pT(s,o,h,g,w,S){w=mT(w),g.context===null?g.context=w:g.pendingContext=w,g=Il(o),g.payload={element:h},S=S===void 0?null:S,S!==null&&(g.callback=S),h=Pl(s,g,o),h!==null&&(Wa(h,s,o),Cf(h,s,o))}function gT(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var h=s.retryLane;s.retryLane=h!==0&&h<o?h:o}}function oy(s,o){gT(s,o),(s=s.alternate)&&gT(s,o)}function vT(s){if(s.tag===13||s.tag===31){var o=ko(s,67108864);o!==null&&Wa(o,s,67108864),oy(s,67108864)}}function xT(s){if(s.tag===13||s.tag===31){var o=ii();o=it(o);var h=ko(s,o);h!==null&&Wa(h,s,o),oy(s,o)}}var Qh=!0;function $L(s,o,h,g){var w=z.T;z.T=null;var S=ue.p;try{ue.p=2,cy(s,o,h,g)}finally{ue.p=S,z.T=w}}function zL(s,o,h,g){var w=z.T;z.T=null;var S=ue.p;try{ue.p=8,cy(s,o,h,g)}finally{ue.p=S,z.T=w}}function cy(s,o,h,g){if(Qh){var w=uy(g);if(w===null)Xx(s,o,g,Jh,h),bT(s,g);else if(qL(w,s,o,h,g))g.stopPropagation();else if(bT(s,g),o&4&&-1<HL.indexOf(s)){for(;w!==null;){var S=Ve(w);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var D=pr(S.pendingLanes);if(D!==0){var X=S;for(X.pendingLanes|=2,X.entangledLanes|=2;D;){var me=1<<31-Tr(D);X.entanglements[1]|=me,D&=~me}gs(S),(dr&6)===0&&(Ph=at()+500,Gf(0))}}break;case 31:case 13:X=ko(S,2),X!==null&&Wa(X,S,2),Rh(),oy(S,2)}if(S=uy(g),S===null&&Xx(s,o,g,Jh,h),S===w)break;w=S}w!==null&&g.stopPropagation()}else Xx(s,o,g,null,h)}}function uy(s){return s=dv(s),fy(s)}var Jh=null;function fy(s){if(Jh=null,s=Re(s),s!==null){var o=i(s);if(o===null)s=null;else{var h=o.tag;if(h===13){if(s=l(o),s!==null)return s;s=null}else if(h===31){if(s=c(o),s!==null)return s;s=null}else if(h===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Jh=s,null}function yT(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wt()){case Oe:return 2;case st:return 8;case Fe:case nr:return 32;case St:return 268435456;default:return 32}default:return 32}}var dy=!1,Wl=null,Vl=null,Gl=null,ed=new Map,td=new Map,Kl=[],HL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function bT(s,o){switch(s){case"focusin":case"focusout":Wl=null;break;case"dragenter":case"dragleave":Vl=null;break;case"mouseover":case"mouseout":Gl=null;break;case"pointerover":case"pointerout":ed.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":td.delete(o.pointerId)}}function rd(s,o,h,g,w,S){return s===null||s.nativeEvent!==S?(s={blockedOn:o,domEventName:h,eventSystemFlags:g,nativeEvent:S,targetContainers:[w]},o!==null&&(o=Ve(o),o!==null&&vT(o)),s):(s.eventSystemFlags|=g,o=s.targetContainers,w!==null&&o.indexOf(w)===-1&&o.push(w),s)}function qL(s,o,h,g,w){switch(o){case"focusin":return Wl=rd(Wl,s,o,h,g,w),!0;case"dragenter":return Vl=rd(Vl,s,o,h,g,w),!0;case"mouseover":return Gl=rd(Gl,s,o,h,g,w),!0;case"pointerover":var S=w.pointerId;return ed.set(S,rd(ed.get(S)||null,s,o,h,g,w)),!0;case"gotpointercapture":return S=w.pointerId,td.set(S,rd(td.get(S)||null,s,o,h,g,w)),!0}return!1}function wT(s){var o=Re(s.target);if(o!==null){var h=i(o);if(h!==null){if(o=h.tag,o===13){if(o=l(h),o!==null){s.blockedOn=o,ee(s.priority,function(){xT(h)});return}}else if(o===31){if(o=c(h),o!==null){s.blockedOn=o,ee(s.priority,function(){xT(h)});return}}else if(o===3&&h.stateNode.current.memoizedState.isDehydrated){s.blockedOn=h.tag===3?h.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Zh(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var h=uy(s.nativeEvent);if(h===null){h=s.nativeEvent;var g=new h.constructor(h.type,h);fv=g,h.target.dispatchEvent(g),fv=null}else return o=Ve(h),o!==null&&vT(o),s.blockedOn=h,!1;o.shift()}return!0}function _T(s,o,h){Zh(s)&&h.delete(o)}function WL(){dy=!1,Wl!==null&&Zh(Wl)&&(Wl=null),Vl!==null&&Zh(Vl)&&(Vl=null),Gl!==null&&Zh(Gl)&&(Gl=null),ed.forEach(_T),td.forEach(_T)}function em(s,o){s.blockedOn===o&&(s.blockedOn=null,dy||(dy=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,WL)))}var tm=null;function ST(s){tm!==s&&(tm=s,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){tm===s&&(tm=null);for(var o=0;o<s.length;o+=3){var h=s[o],g=s[o+1],w=s[o+2];if(typeof g!="function"){if(fy(g||h)===null)continue;break}var S=Ve(h);S!==null&&(s.splice(o,3),o-=3,ux(S,{pending:!0,data:w,method:h.method,action:g},g,w))}}))}function du(s){function o(me){return em(me,s)}Wl!==null&&em(Wl,s),Vl!==null&&em(Vl,s),Gl!==null&&em(Gl,s),ed.forEach(o),td.forEach(o);for(var h=0;h<Kl.length;h++){var g=Kl[h];g.blockedOn===s&&(g.blockedOn=null)}for(;0<Kl.length&&(h=Kl[0],h.blockedOn===null);)wT(h),h.blockedOn===null&&Kl.shift();if(h=(s.ownerDocument||s).$$reactFormReplay,h!=null)for(g=0;g<h.length;g+=3){var w=h[g],S=h[g+1],D=w[Z]||null;if(typeof S=="function")D||ST(h);else if(D){var X=null;if(S&&S.hasAttribute("formAction")){if(w=S,D=S[Z]||null)X=D.formAction;else if(fy(w)!==null)continue}else X=D.action;typeof X=="function"?h[g+1]=X:(h.splice(g,3),g-=3),ST(h)}}}function ET(){function s(S){S.canIntercept&&S.info==="react-transition"&&S.intercept({handler:function(){return new Promise(function(D){return w=D})},focusReset:"manual",scroll:"manual"})}function o(){w!==null&&(w(),w=null),g||setTimeout(h,20)}function h(){if(!g&&!navigation.transition){var S=navigation.currentEntry;S&&S.url!=null&&navigation.navigate(S.url,{state:S.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var g=!1,w=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",o),navigation.addEventListener("navigateerror",o),setTimeout(h,100),function(){g=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",o),navigation.removeEventListener("navigateerror",o),w!==null&&(w(),w=null)}}}function hy(s){this._internalRoot=s}rm.prototype.render=hy.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(n(409));var h=o.current,g=ii();pT(h,g,s,o,null,null)},rm.prototype.unmount=hy.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;pT(s.current,2,null,s,null,null),Rh(),o[ne]=null}};function rm(s){this._internalRoot=s}rm.prototype.unstable_scheduleHydration=function(s){if(s){var o=R();s={blockedOn:null,target:s,priority:o};for(var h=0;h<Kl.length&&o!==0&&o<Kl[h].priority;h++);Kl.splice(h,0,s),h===0&&wT(s)}};var NT=t.version;if(NT!=="19.2.3")throw Error(n(527,NT,"19.2.3"));ue.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(n(188)):(s=Object.keys(s).join(","),Error(n(268,s)));return s=d(o),s=s!==null?m(s):null,s=s===null?null:s.stateNode,s};var VL={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nm.isDisabled&&nm.supportsFiber)try{er=nm.inject(VL),ar=nm}catch{}}return ad.createRoot=function(s,o){if(!a(s))throw Error(n(299));var h=!1,g="",w=DN,S=IN,D=PN;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(w=o.onUncaughtError),o.onCaughtError!==void 0&&(S=o.onCaughtError),o.onRecoverableError!==void 0&&(D=o.onRecoverableError)),o=hT(s,1,!1,null,null,h,g,null,w,S,D,ET),s[ne]=o.current,Kx(s),new hy(o)},ad.hydrateRoot=function(s,o,h){if(!a(s))throw Error(n(299));var g=!1,w="",S=DN,D=IN,X=PN,me=null;return h!=null&&(h.unstable_strictMode===!0&&(g=!0),h.identifierPrefix!==void 0&&(w=h.identifierPrefix),h.onUncaughtError!==void 0&&(S=h.onUncaughtError),h.onCaughtError!==void 0&&(D=h.onCaughtError),h.onRecoverableError!==void 0&&(X=h.onRecoverableError),h.formState!==void 0&&(me=h.formState)),o=hT(s,1,!0,o,h??null,g,w,me,S,D,X,ET),o.context=mT(null),h=o.current,g=ii(),g=it(g),w=Il(g),w.callback=null,Pl(h,w,g),h=g,o.current.lanes=h,gr(o,h),gs(o),s[ne]=o.current,Kx(s),new rm(o)},ad.version="19.2.3",ad}var MT;function iB(){if(MT)return vy.exports;MT=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),vy.exports=aB(),vy.exports}var sB=iB();const lB=Cs(sB),oB=({onLogin:e,users:t})=>{const[r,n]=N.useState(""),[a,i]=N.useState(""),[l,c]=N.useState(""),f=localStorage.getItem("wf_logo_url")||"https://logo.clearbit.com/daltexcorp.com",d=m=>{m.preventDefault(),c("");const p=t.find(v=>v.username===r&&v.password===a);p?e(p):c("Invalid username or password")};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-100 to-slate-200 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md overflow-hidden p-8 md:p-10 border border-white/50",children:[u.jsxs("div",{className:"flex flex-col items-center justify-center mb-8",children:[u.jsxs("div",{className:"w-32 h-32 flex items-center justify-center mb-4 relative",children:[u.jsx("div",{className:"absolute inset-0 bg-blue-50 rounded-full opacity-50 blur-xl"}),u.jsx("img",{src:f,alt:"Daltex Logo",className:"w-full h-full object-contain relative z-10 drop-shadow-sm",onError:m=>{const p=m.currentTarget;p.onerror=null,p.src="https://ui-avatars.com/api/?name=Daltex&background=0D8ABC&color=fff&size=128&font-size=0.4"}})]}),u.jsxs("h1",{className:"text-3xl font-extrabold text-slate-800 text-center tracking-tight",children:["Daltex ",u.jsx("span",{className:"text-blue-600",children:"Maintenance"})]}),u.jsx("p",{className:"text-slate-500 text-sm font-medium tracking-wide uppercase mt-1",children:"Management System"})]}),u.jsxs("div",{children:[l&&u.jsxs("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 text-red-700 rounded-r shadow-sm text-sm",children:[u.jsx("p",{className:"font-bold",children:"Error"}),u.jsx("p",{children:l})]}),u.jsxs("form",{onSubmit:d,className:"space-y-5",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 ml-1",children:"Username"}),u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),u.jsx("input",{type:"text",value:r,onChange:m=>n(m.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all bg-slate-50 focus:bg-white",placeholder:"Enter your username"})]})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("label",{className:"block text-sm font-semibold text-slate-700 ml-1",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center text-gray-400",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),u.jsx("input",{type:"password",value:a,onChange:m=>i(m.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all bg-slate-50 focus:bg-white",placeholder:""})]})]}),u.jsx("button",{type:"submit",className:"w-full py-3.5 bg-blue-600 text-white rounded-xl font-bold text-lg shadow-lg shadow-blue-600/30 hover:bg-blue-700 hover:shadow-blue-600/50 transition-all transform hover:-translate-y-0.5 active:translate-y-0",children:"Sign In"})]}),u.jsxs("div",{className:"mt-8 pt-6 border-t border-slate-100 text-center text-xs text-slate-400",children:[u.jsx("p",{className:"mb-2 font-medium",children:"System Access Only"}),u.jsxs("div",{className:"flex flex-wrap justify-center gap-3 opacity-75",children:[u.jsxs("span",{className:"bg-slate-100 px-2 py-1 rounded",children:["Admin: ",u.jsx("strong",{children:"admin"})]}),u.jsxs("span",{className:"bg-slate-100 px-2 py-1 rounded",children:["User: ",u.jsx("strong",{children:"operator"})]})]})]})]})]})})},Ob=[{id:"dashboard",label:"Home Page",icon:"",roles:["admin","user","warehouse_manager","maintenance_manager","maintenance_engineer","warehouse_supervisor"]},{id:"maintenance-planning",label:"Maintenance Planning",icon:"",roles:["admin","maintenance_manager","maintenance_engineer"]},{id:"asset-management",label:"Asset Management",icon:"",roles:["admin","maintenance_manager","maintenance_engineer"]},{id:"mro-management",label:"MRO Management",icon:"",roles:["admin","warehouse_manager","maintenance_manager","maintenance_engineer","warehouse_supervisor"]},{id:"material-forecast",label:"Forecast Planning",icon:"",roles:["admin","warehouse_manager","maintenance_manager","maintenance_engineer"]},{id:"agri-work-order",label:"Work Orders",icon:"",roles:["admin","warehouse_manager","maintenance_manager","user"]},{id:"issue-form",label:"Issue Requests",icon:"",roles:["admin","user","maintenance_manager","maintenance_engineer"]},{id:"history",label:"Inventory",icon:"",roles:["admin","user","warehouse_manager","maintenance_manager","maintenance_engineer","warehouse_supervisor"]},{id:"stock-approval",label:"Approvals",icon:"",roles:["admin","warehouse_manager","warehouse_supervisor"]},{id:"ai-assistant",label:"Maintenance AI",icon:"",roles:["admin","warehouse_manager","maintenance_manager"]},{id:"master-data",label:"Master Data",icon:"",roles:["admin"]},{id:"settings",label:"Settings",icon:"",roles:["admin"]}],RT=[{username:"admin",name:"Admin User",role:"admin",email:"admin@daltex.com",password:"admin"}],cB=[],uB=[],fB=[],dB=[{id:"MP-001",name:"Periodic Maintenance ( )"},{id:"MP-002",name:"Preventive Maintenance ( )"},{id:"MP-003",name:"Sudden Breakdown (  )"},{id:"MP-004",name:"Repair Maintenance ( )"},{id:"MP-005",name:"Overhauls ()"},{id:"MP-006",name:"Annual Maintenance ( )"},{id:"MP-007",name:"Investment Project ( )"}],hB=[],mB=[],pB=[],gB=[],vB=[],xB=[],yB=[],bB=[],wB=({currentView:e,setCurrentView:t,currentUser:r,onLogout:n,isOpen:a,onClose:i,isDbConnected:l=!0})=>{const[c,f]=N.useState(()=>{try{const j=localStorage.getItem("wf_sidebar_order");if(j){const B=JSON.parse(j);return[...Ob].sort((Y,te)=>{let V=B.indexOf(Y.id),ge=B.indexOf(te.id);return V===-1&&(V=999),ge===-1&&(ge=999),V-ge})}}catch(j){console.error(j)}return Ob}),[d,m]=N.useState(()=>localStorage.getItem("wf_logo_url")||"https://logo.clearbit.com/daltexcorp.com"),p=N.useRef(null),v=N.useRef(null),[x,y]=N.useState(!1),b=c.filter(j=>(r==null?void 0:r.role)==="admin"?j.roles.includes("admin"):!(r!=null&&r.allowedMenus)||r.allowedMenus.length===0?!1:r.allowedMenus.includes(j.id)),_=j=>{t(j),i()},E=(j,B)=>{p.current=B,y(!0),j.dataTransfer.effectAllowed="move",j.dataTransfer.setDragImage(j.currentTarget,20,20);const U=j.currentTarget;setTimeout(()=>{U.classList.add("opacity-50")},0)},A=(j,B)=>{v.current=B},T=j=>{if(j.currentTarget.classList.remove("opacity-50"),y(!1),p.current===null||v.current===null){p.current=null,v.current=null;return}const B=b[p.current],U=b[v.current];if(B.id===U.id)return;const Y=[...c],te=Y.findIndex(ge=>ge.id===B.id),V=Y.findIndex(ge=>ge.id===U.id);Y.splice(te,1),Y.splice(V,0,B),f(Y),localStorage.setItem("wf_sidebar_order",JSON.stringify(Y.map(ge=>ge.id))),p.current=null,v.current=null},k=j=>{j.preventDefault()},I=((r==null?void 0:r.username)||"U").substring(0,2).toUpperCase(),O=((r==null?void 0:r.role)||"user").replace("_"," ");return u.jsxs(u.Fragment,{children:[a&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 md:hidden backdrop-blur-sm",onClick:i}),u.jsxs("aside",{className:`
        fixed md:static inset-y-0 left-0 z-30
        w-60 bg-[#00695c] text-white min-h-screen flex flex-col shadow-2xl font-cairo
        transition-transform duration-300 ease-in-out
        ${a?"translate-x-0":"-translate-x-full md:translate-x-0"}
      `,style:{fontFamily:'"Cairo", "Sakkal Majalla", sans-serif'},children:[u.jsxs("div",{className:"pt-6 pb-4 flex flex-col items-center text-center px-4 border-b border-yellow-400/30",children:[u.jsx("div",{className:"bg-white p-2 rounded-xl shadow-lg mb-3 w-20 h-20 flex items-center justify-center overflow-hidden",children:u.jsx("img",{src:d,alt:"Daltex Logo",className:"w-full h-full object-contain",onError:j=>{const B=j.currentTarget;B.onerror=null,B.src="https://ui-avatars.com/api/?name=Daltex&background=0D8ABC&color=fff&size=128&font-size=0.4"}})}),u.jsx("h1",{className:"text-xl font-bold text-[#FFD700] tracking-wide mb-0 drop-shadow-sm uppercase",children:"DALTEX"}),u.jsx("p",{className:"text-[10px] text-gray-200",children:"Maintenance System"})]}),u.jsx("nav",{className:"flex-1 w-full mt-2 overflow-y-auto",children:b.map((j,B)=>{const U=e===j.id;return u.jsx("button",{draggable:!0,onDragStart:Y=>E(Y,B),onDragEnter:Y=>A(Y,B),onDragEnd:T,onDragOver:k,onClick:()=>_(j.id),className:`
                  w-full flex items-center justify-between px-4 py-3
                  border-b border-yellow-400/30 transition-all duration-200 group
                  ${U?"bg-[#00C853] text-white shadow-md font-bold":"text-white hover:bg-[#004d40] hover:pl-5"}
                  ${x?"cursor-grabbing":"cursor-grab active:cursor-grabbing"}
                `,children:u.jsxs("div",{className:"flex items-center gap-3 w-full",children:[u.jsx("span",{className:"text-lg w-6 text-center",children:j.icon}),u.jsx("span",{className:"text-sm tracking-wide text-left flex-1 font-semibold",children:j.label}),j.id==="agri-work-order"&&u.jsx("span",{className:"text-[#FFD700] font-bold text-sm drop-shadow-sm",children:"1274"}),j.id==="issue-form"&&u.jsx("span",{className:"text-[#FFD700] font-bold text-sm drop-shadow-sm",children:"228"}),j.id==="history"&&u.jsx("span",{className:"text-[#FFD700] font-bold text-sm drop-shadow-sm",children:"815"})]})},j.id)})}),u.jsxs("div",{className:"bg-[#FFD700] text-[#00695c] py-2 px-3",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[u.jsx("div",{className:"w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm shrink-0 border-2 border-[#00695c] bg-white text-[#00695c]",children:I}),u.jsxs("div",{className:"overflow-hidden flex-1",children:[u.jsx("p",{className:"text-sm font-bold truncate leading-tight",children:(r==null?void 0:r.name)||"Guest"}),u.jsx("p",{className:"text-[10px] font-semibold capitalize leading-tight opacity-90",children:O})]}),u.jsx("div",{className:`w-3 h-3 rounded-full shadow-inner ${l?"bg-[#00C853] animate-pulse":"bg-red-500"}`,title:l?"Connected to Database":"Database Offline"})]}),u.jsx("button",{onClick:n,className:"w-full py-1 border border-[#00695c] rounded text-xs text-[#00695c] hover:bg-[#00695c] hover:text-white font-bold transition uppercase tracking-wider",children:"Sign Out"})]})]})]})},_B=()=>null,yD=async(e,t=!1)=>{var n,a;const r=_B();if(!r)return console.warn("Missing OpenAI API Key"),null;try{const i=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify({model:"gpt-4o-mini",messages:e,response_format:t?{type:"json_object"}:void 0})});if(!i.ok){const c=await i.text();return console.error("OpenAI API Error:",c),null}return((a=(n=(await i.json()).choices[0])==null?void 0:n.message)==null?void 0:a.content)||null}catch(i){return console.error("OpenAI Network Error:",i),null}},SB=async e=>await yD([{role:"user",content:e}])||"Unable to generate response. Please check API key.",EB=async e=>{const t=e.slice(0,50).map(a=>({item:a.itemName,qty:a.quantity,machine:a.machineName,loc:a.locationId,date:a.timestamp.split("T")[0]})),r=`Analyze this warehouse issue log data: ${JSON.stringify(t)}.
  Provide 3 concise, actionable operational insights or patterns you detect (e.g., high consumption machines, frequent items).
  Format as a bulleted list. Keep it professional.`;return await yD([{role:"user",content:r}])||"No insights generated."};function bD(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=bD(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function kr(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=bD(e))&&(n&&(n+=" "),n+=t);return n}var NB=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function r_(e){if(typeof e!="string")return!1;var t=NB;return t.includes(e)}var kB=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],TB=new Set(kB);function wD(e){return typeof e!="string"?!1:TB.has(e)}function _D(e){return typeof e=="string"&&e.startsWith("data-")}function cs(e){if(typeof e!="object"||e===null)return{};var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(wD(r)||_D(r))&&(t[r]=e[r]);return t}function Pd(e){if(e==null)return null;if(N.isValidElement(e)&&typeof e.props=="object"&&e.props!==null){var t=e.props;return cs(t)}return typeof e=="object"&&!Array.isArray(e)?cs(e):null}function $i(e){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(wD(r)||_D(r)||r_(r))&&(t[r]=e[r]);return t}var AB=["children","width","height","viewBox","className","style","title","desc"];function Cb(){return Cb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cb.apply(null,arguments)}function jB(e,t){if(e==null)return{};var r,n,a=OB(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function OB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var n_=N.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:l,style:c,title:f,desc:d}=e,m=jB(e,AB),p=i||{width:n,height:a,x:0,y:0},v=kr("recharts-surface",l);return N.createElement("svg",Cb({},$i(m),{className:v,width:n,height:a,style:c,viewBox:"".concat(p.x," ").concat(p.y," ").concat(p.width," ").concat(p.height),ref:t}),N.createElement("title",null,f),N.createElement("desc",null,d),r)}),CB=["children","className"];function Db(){return Db=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Db.apply(null,arguments)}function DB(e,t){if(e==null)return{};var r,n,a=IB(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function IB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Fa=N.forwardRef((e,t)=>{var{children:r,className:n}=e,a=DB(e,CB),i=kr("recharts-layer",n);return N.createElement("g",Db({className:i},$i(a),{ref:t}),r)}),a_=xD(),SD=N.createContext(null),PB=()=>N.useContext(SD);function Br(e){return function(){return e}}const ED=Math.cos,qm=Math.sin,fs=Math.sqrt,Wm=Math.PI,rg=2*Wm,Ib=Math.PI,Pb=2*Ib,zo=1e-6,MB=Pb-zo;function ND(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function RB(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return ND;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class FB{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?ND:RB(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,l){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+l}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let l=this._x1,c=this._y1,f=n-t,d=a-r,m=l-t,p=c-r,v=m*m+p*p;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(v>zo)if(!(Math.abs(p*f-d*m)>zo)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let x=n-l,y=a-c,b=f*f+d*d,_=x*x+y*y,E=Math.sqrt(b),A=Math.sqrt(v),T=i*Math.tan((Ib-Math.acos((b+v-_)/(2*E*A)))/2),k=T/A,I=T/E;Math.abs(k-1)>zo&&this._append`L${t+k*m},${r+k*p}`,this._append`A${i},${i},0,0,${+(p*x>m*y)},${this._x1=t+I*f},${this._y1=r+I*d}`}}arc(t,r,n,a,i,l){if(t=+t,r=+r,n=+n,l=!!l,n<0)throw new Error(`negative radius: ${n}`);let c=n*Math.cos(a),f=n*Math.sin(a),d=t+c,m=r+f,p=1^l,v=l?a-i:i-a;this._x1===null?this._append`M${d},${m}`:(Math.abs(this._x1-d)>zo||Math.abs(this._y1-m)>zo)&&this._append`L${d},${m}`,n&&(v<0&&(v=v%Pb+Pb),v>MB?this._append`A${n},${n},0,1,${p},${t-c},${r-f}A${n},${n},0,1,${p},${this._x1=d},${this._y1=m}`:v>zo&&this._append`A${n},${n},0,${+(v>=Ib)},${p},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function i_(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new FB(t)}function s_(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function kD(e){this._context=e}kD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ng(e){return new kD(e)}function TD(e){return e[0]}function AD(e){return e[1]}function jD(e,t){var r=Br(!0),n=null,a=ng,i=null,l=i_(c);e=typeof e=="function"?e:e===void 0?TD:Br(e),t=typeof t=="function"?t:t===void 0?AD:Br(t);function c(f){var d,m=(f=s_(f)).length,p,v=!1,x;for(n==null&&(i=a(x=l())),d=0;d<=m;++d)!(d<m&&r(p=f[d],d,f))===v&&((v=!v)?i.lineStart():i.lineEnd()),v&&i.point(+e(p,d,f),+t(p,d,f));if(x)return i=null,x+""||null}return c.x=function(f){return arguments.length?(e=typeof f=="function"?f:Br(+f),c):e},c.y=function(f){return arguments.length?(t=typeof f=="function"?f:Br(+f),c):t},c.defined=function(f){return arguments.length?(r=typeof f=="function"?f:Br(!!f),c):r},c.curve=function(f){return arguments.length?(a=f,n!=null&&(i=a(n)),c):a},c.context=function(f){return arguments.length?(f==null?n=i=null:i=a(n=f),c):n},c}function am(e,t,r){var n=null,a=Br(!0),i=null,l=ng,c=null,f=i_(d);e=typeof e=="function"?e:e===void 0?TD:Br(+e),t=typeof t=="function"?t:Br(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?AD:Br(+r);function d(p){var v,x,y,b=(p=s_(p)).length,_,E=!1,A,T=new Array(b),k=new Array(b);for(i==null&&(c=l(A=f())),v=0;v<=b;++v){if(!(v<b&&a(_=p[v],v,p))===E)if(E=!E)x=v,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),y=v-1;y>=x;--y)c.point(T[y],k[y]);c.lineEnd(),c.areaEnd()}E&&(T[v]=+e(_,v,p),k[v]=+t(_,v,p),c.point(n?+n(_,v,p):T[v],r?+r(_,v,p):k[v]))}if(A)return c=null,A+""||null}function m(){return jD().defined(a).curve(l).context(i)}return d.x=function(p){return arguments.length?(e=typeof p=="function"?p:Br(+p),n=null,d):e},d.x0=function(p){return arguments.length?(e=typeof p=="function"?p:Br(+p),d):e},d.x1=function(p){return arguments.length?(n=p==null?null:typeof p=="function"?p:Br(+p),d):n},d.y=function(p){return arguments.length?(t=typeof p=="function"?p:Br(+p),r=null,d):t},d.y0=function(p){return arguments.length?(t=typeof p=="function"?p:Br(+p),d):t},d.y1=function(p){return arguments.length?(r=p==null?null:typeof p=="function"?p:Br(+p),d):r},d.lineX0=d.lineY0=function(){return m().x(e).y(t)},d.lineY1=function(){return m().x(e).y(r)},d.lineX1=function(){return m().x(n).y(t)},d.defined=function(p){return arguments.length?(a=typeof p=="function"?p:Br(!!p),d):a},d.curve=function(p){return arguments.length?(l=p,i!=null&&(c=l(i)),d):l},d.context=function(p){return arguments.length?(p==null?i=c=null:c=l(i=p),d):i},d}class OD{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function LB(e){return new OD(e,!0)}function BB(e){return new OD(e,!1)}const l_={draw(e,t){const r=fs(t/Wm);e.moveTo(r,0),e.arc(0,0,r,0,rg)}},UB={draw(e,t){const r=fs(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},CD=fs(1/3),$B=CD*2,zB={draw(e,t){const r=fs(t/$B),n=r*CD;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},HB={draw(e,t){const r=fs(t),n=-r/2;e.rect(n,n,r,r)}},qB=.8908130915292852,DD=qm(Wm/10)/qm(7*Wm/10),WB=qm(rg/10)*DD,VB=-ED(rg/10)*DD,GB={draw(e,t){const r=fs(t*qB),n=WB*r,a=VB*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const l=rg*i/5,c=ED(l),f=qm(l);e.lineTo(f*r,-c*r),e.lineTo(c*n-f*a,f*n+c*a)}e.closePath()}},wy=fs(3),KB={draw(e,t){const r=-fs(t/(wy*3));e.moveTo(0,r*2),e.lineTo(-wy*r,-r),e.lineTo(wy*r,-r),e.closePath()}},ji=-.5,Oi=fs(3)/2,Mb=1/fs(12),XB=(Mb/2+1)*3,YB={draw(e,t){const r=fs(t/XB),n=r/2,a=r*Mb,i=n,l=r*Mb+r,c=-i,f=l;e.moveTo(n,a),e.lineTo(i,l),e.lineTo(c,f),e.lineTo(ji*n-Oi*a,Oi*n+ji*a),e.lineTo(ji*i-Oi*l,Oi*i+ji*l),e.lineTo(ji*c-Oi*f,Oi*c+ji*f),e.lineTo(ji*n+Oi*a,ji*a-Oi*n),e.lineTo(ji*i+Oi*l,ji*l-Oi*i),e.lineTo(ji*c+Oi*f,ji*f-Oi*c),e.closePath()}};function QB(e,t){let r=null,n=i_(a);e=typeof e=="function"?e:Br(e||l_),t=typeof t=="function"?t:Br(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Br(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Br(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Vm(){}function Gm(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function ID(e){this._context=e}ID.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Gm(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Gm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function JB(e){return new ID(e)}function PD(e){this._context=e}PD.prototype={areaStart:Vm,areaEnd:Vm,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Gm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function ZB(e){return new PD(e)}function MD(e){this._context=e}MD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Gm(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function e7(e){return new MD(e)}function RD(e){this._context=e}RD.prototype={areaStart:Vm,areaEnd:Vm,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function t7(e){return new RD(e)}function FT(e){return e<0?-1:1}function LT(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),l=(r-e._y1)/(a||n<0&&-0),c=(i*a+l*n)/(n+a);return(FT(i)+FT(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(c))||0}function BT(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function _y(e,t,r){var n=e._x0,a=e._y0,i=e._x1,l=e._y1,c=(i-n)/3;e._context.bezierCurveTo(n+c,a+c*t,i-c,l-c*r,i,l)}function Km(e){this._context=e}Km.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:_y(this,this._t0,BT(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,_y(this,BT(this,r=LT(this,e,t)),r);break;default:_y(this,this._t0,r=LT(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function FD(e){this._context=new LD(e)}(FD.prototype=Object.create(Km.prototype)).point=function(e,t){Km.prototype.point.call(this,t,e)};function LD(e){this._context=e}LD.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function r7(e){return new Km(e)}function n7(e){return new FD(e)}function BD(e){this._context=e}BD.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=UT(e),a=UT(t),i=0,l=1;l<r;++i,++l)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[l],t[l]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function UT(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),l=new Array(r);for(a[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,l[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,l[t]-=n*l[t-1];for(a[r-1]=l[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(l[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function a7(e){return new BD(e)}function ag(e,t){this._context=e,this._t=t}ag.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function i7(e){return new ag(e,.5)}function s7(e){return new ag(e,0)}function l7(e){return new ag(e,1)}function fc(e,t){if((l=e.length)>1)for(var r=1,n,a,i=e[t[0]],l,c=i.length;r<l;++r)for(a=i,i=e[t[r]],n=0;n<c;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function Rb(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function o7(e,t){return e[t]}function c7(e){const t=[];return t.key=e,t}function u7(){var e=Br([]),t=Rb,r=fc,n=o7;function a(i){var l=Array.from(e.apply(this,arguments),c7),c,f=l.length,d=-1,m;for(const p of i)for(c=0,++d;c<f;++c)(l[c][d]=[0,+n(p,l[c].key,d,i)]).data=p;for(c=0,m=s_(t(l));c<f;++c)l[m[c]].index=c;return r(l,m),l}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Br(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Br(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?Rb:typeof i=="function"?i:Br(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??fc,a):r},a}function f7(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,l;a<i;++a){for(l=r=0;r<n;++r)l+=e[r][a][1]||0;if(l)for(r=0;r<n;++r)e[r][a][1]/=l}fc(e,t)}}function d7(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var l=0,c=0;l<a;++l)c+=e[l][r][1]||0;n[r][1]+=n[r][0]=-c/2}fc(e,t)}}function h7(e,t){if(!(!((l=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,l;n<i;++n){for(var c=0,f=0,d=0;c<l;++c){for(var m=e[t[c]],p=m[n][1]||0,v=m[n-1][1]||0,x=(p-v)/2,y=0;y<c;++y){var b=e[t[y]],_=b[n][1]||0,E=b[n-1][1]||0;x+=_-E}f+=p,d+=x*p}a[n-1][1]+=a[n-1][0]=r,f&&(r-=d/f)}a[n-1][1]+=a[n-1][0]=r,fc(e,t)}}var Sy={},Ey={},$T;function m7(){return $T||($T=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(Ey)),Ey}var Ny={},zT;function UD(){return zT||(zT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Ny)),Ny}var ky={},HT;function o_(){return HT||(HT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(ky)),ky}var Ty={},Ay={},qT;function p7(){return qT||(qT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(r==null)return"";if(typeof r=="string")return r;if(Array.isArray(r))return r.map(t).join(",");const n=String(r);return n==="0"&&Object.is(Number(r),-0)?"-0":n}e.toString=t})(Ay)),Ay}var WT;function c_(){return WT||(WT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=p7(),r=o_();function n(a){if(Array.isArray(a))return a.map(r.toKey);if(typeof a=="symbol")return[a];a=t.toString(a);const i=[],l=a.length;if(l===0)return i;let c=0,f="",d="",m=!1;for(a.charCodeAt(0)===46&&(i.push(""),c++);c<l;){const p=a[c];d?p==="\\"&&c+1<l?(c++,f+=a[c]):p===d?d="":f+=p:m?p==='"'||p==="'"?d=p:p==="]"?(m=!1,i.push(f),f=""):f+=p:p==="["?(m=!0,f&&(i.push(f),f="")):p==="."?f&&(i.push(f),f=""):f+=p,c++}return f&&i.push(f),i}e.toPath=n})(Ty)),Ty}var VT;function u_(){return VT||(VT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m7(),r=UD(),n=o_(),a=c_();function i(c,f,d){if(c==null)return d;switch(typeof f){case"string":{if(t.isUnsafeProperty(f))return d;const m=c[f];return m===void 0?r.isDeepKey(f)?i(c,a.toPath(f),d):d:m}case"number":case"symbol":{typeof f=="number"&&(f=n.toKey(f));const m=c[f];return m===void 0?d:m}default:{if(Array.isArray(f))return l(c,f,d);if(Object.is(f==null?void 0:f.valueOf(),-0)?f="-0":f=String(f),t.isUnsafeProperty(f))return d;const m=c[f];return m===void 0?d:m}}}function l(c,f,d){if(f.length===0)return d;let m=c;for(let p=0;p<f.length;p++){if(m==null||t.isUnsafeProperty(f[p]))return d;m=m[f[p]]}return m===void 0?d:m}e.get=i})(Sy)),Sy}var jy,GT;function g7(){return GT||(GT=1,jy=u_().get),jy}var v7=g7();const dc=Cs(v7);var x7=4;function ro(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:x7,r=10**t,n=Math.round(e*r)/r;return Object.is(n,-0)?0:n}function cn(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.reduce((a,i,l)=>{var c=r[l-1];return typeof c=="string"?a+c+i:c!==void 0?a+ro(c)+i:a+i},"")}var Yn=e=>e===0?0:e>0?1:-1,Ts=e=>typeof e=="number"&&e!=+e,hc=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,gt=e=>(typeof e=="number"||e instanceof Number)&&!Ts(e),As=e=>gt(e)||typeof e=="string",y7=0,Md=e=>{var t=++y7;return"".concat(e||"").concat(t)},ka=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!gt(t)&&typeof t!="string")return n;var i;if(hc(t)){if(r==null)return n;var l=t.indexOf("%");i=r*parseFloat(t.slice(0,l))/100}else i=+t;return Ts(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},$D=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[String(e[n])])r[String(e[n])]=!0;else return!0;return!1};function Pn(e,t,r){return gt(e)&&gt(t)?ro(e+r*(t-e)):t}function b7(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):dc(n,t))===r)}var Jn=e=>e===null||typeof e>"u",g0=e=>Jn(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1));function Ga(e){return e!=null}function ef(){}var w7=["type","size","sizeType"];function Fb(){return Fb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Fb.apply(null,arguments)}function KT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function XT(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?KT(Object(r),!0).forEach(function(n){_7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):KT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _7(e,t,r){return(t=S7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function S7(e){var t=E7(e,"string");return typeof t=="symbol"?t:t+""}function E7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function N7(e,t){if(e==null)return{};var r,n,a=k7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function k7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var zD={symbolCircle:l_,symbolCross:UB,symbolDiamond:zB,symbolSquare:HB,symbolStar:GB,symbolTriangle:KB,symbolWye:YB},T7=Math.PI/180,A7=e=>{var t="symbol".concat(g0(e));return zD[t]||l_},j7=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*T7;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},O7=(e,t)=>{zD["symbol".concat(g0(e))]=t},f_=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=N7(e,w7),i=XT(XT({},a),{},{type:t,size:r,sizeType:n}),l="circle";typeof t=="string"&&(l=t);var c=()=>{var v=A7(l),x=QB().type(v).size(j7(r,n,l)),y=x();if(y!==null)return y},{className:f,cx:d,cy:m}=i,p=$i(i);return gt(d)&&gt(m)&&gt(r)?N.createElement("path",Fb({},p,{className:kr("recharts-symbols",f),transform:"translate(".concat(d,", ").concat(m,")"),d:c()})):null};f_.registerSymbol=O7;var HD=e=>"radius"in e&&"startAngle"in e&&"endAngle"in e,C7=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(N.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{r_(a)&&(n[a]=(i=>r[a](r,i)))}),n},D7=(e,t,r)=>n=>(e(t,r,n),null),v0=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];r_(a)&&typeof i=="function"&&(n||(n={}),n[a]=D7(i,t,r))}),n};function YT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function I7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YT(Object(r),!0).forEach(function(n){P7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function P7(e,t,r){return(t=M7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function M7(e){var t=R7(e,"string");return typeof t=="symbol"?t:t+""}function R7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zn(e,t){var r=I7({},e),n=t,a=Object.keys(t),i=a.reduce((l,c)=>(l[c]===void 0&&n[c]!==void 0&&(l[c]=n[c]),l),r);return i}function Xm(){return Xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xm.apply(null,arguments)}function QT(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function F7(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?QT(Object(r),!0).forEach(function(n){L7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):QT(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function L7(e,t,r){return(t=B7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function B7(e){var t=U7(e,"string");return typeof t=="symbol"?t:t+""}function U7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ri=32,$7={align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"};function z7(e){var{data:t,iconType:r,inactiveColor:n}=e,a=Ri/2,i=Ri/6,l=Ri/3,c=t.inactive?n:t.color,f=r??t.type;if(f==="none")return null;if(f==="plainline"){var d;return N.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:(d=t.payload)===null||d===void 0?void 0:d.strokeDasharray,x1:0,y1:a,x2:Ri,y2:a,className:"recharts-legend-icon"})}if(f==="line")return N.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(a,"h").concat(l,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(2*l,",").concat(a,`
            H`).concat(Ri,"M").concat(2*l,",").concat(a,`
            A`).concat(i,",").concat(i,",0,1,1,").concat(l,",").concat(a),className:"recharts-legend-icon"});if(f==="rect")return N.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(Ri/8,"h").concat(Ri,"v").concat(Ri*3/4,"h").concat(-Ri,"z"),className:"recharts-legend-icon"});if(N.isValidElement(t.legendIcon)){var m=F7({},t);return delete m.legendIcon,N.cloneElement(t.legendIcon,m)}return N.createElement(f_,{fill:c,cx:a,cy:a,size:Ri,sizeType:"diameter",type:f})}function H7(e){var{payload:t,iconSize:r,layout:n,formatter:a,inactiveColor:i,iconType:l}=e,c={x:0,y:0,width:Ri,height:Ri},f={display:n==="horizontal"?"inline-block":"block",marginRight:10},d={display:"inline-block",verticalAlign:"middle",marginRight:4};return t.map((m,p)=>{var v=m.formatter||a,x=kr({"recharts-legend-item":!0,["legend-item-".concat(p)]:!0,inactive:m.inactive});if(m.type==="none")return null;var y=m.inactive?i:m.color,b=v?v(m.value,m,p):m.value;return N.createElement("li",Xm({className:x,style:f,key:"legend-item-".concat(p)},v0(e,m,p)),N.createElement(n_,{width:r,height:r,viewBox:c,style:d,"aria-label":"".concat(b," legend icon")},N.createElement(z7,{data:m,iconType:l,inactiveColor:i})),N.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},b))})}var q7=e=>{var t=Zn(e,$7),{payload:r,layout:n,align:a}=t;if(!r||!r.length)return null;var i={padding:0,margin:0,textAlign:n==="horizontal"?a:"left"};return N.createElement("ul",{className:"recharts-default-legend",style:i},N.createElement(H7,Xm({},t,{payload:r})))},Oy={},Cy={},JT;function W7(){return JT||(JT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const l=r[i],c=n(l,i,r);a.has(c)||a.set(c,l)}return Array.from(a.values())}e.uniqBy=t})(Cy)),Cy}var Dy={},ZT;function V7(){return ZT||(ZT=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return function(...a){return r.apply(this,a.slice(0,n))}}e.ary=t})(Dy)),Dy}var Iy={},eA;function qD(){return eA||(eA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Iy)),Iy}var Py={},My={},Ry={},tA;function G7(){return tA||(tA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(Ry)),Ry}var rA;function d_(){return rA||(rA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G7();function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(My)),My}var Fy={},nA;function K7(){return nA||(nA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(Fy)),Fy}var aA;function X7(){return aA||(aA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=d_(),r=K7();function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(Py)),Py}var Ly={},By={},iA;function Y7(){return iA||(iA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u_();function r(n){return function(a){return t.get(a,n)}}e.property=r})(By)),By}var Uy={},$y={},zy={},Hy={},sA;function WD(){return sA||(sA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Hy)),Hy}var qy={},lA;function VD(){return lA||(lA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(qy)),qy}var Wy={},oA;function GD(){return oA||(oA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.isEqualsSameValueZero=t})(Wy)),Wy}var cA;function Q7(){return cA||(cA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WD(),r=VD(),n=GD();function a(m,p,v){return typeof v!="function"?a(m,p,()=>{}):i(m,p,function x(y,b,_,E,A,T){const k=v(y,b,_,E,A,T);return k!==void 0?!!k:i(y,b,x,T)},new Map)}function i(m,p,v,x){if(p===m)return!0;switch(typeof p){case"object":return l(m,p,v,x);case"function":return Object.keys(p).length>0?i(m,{...p},v,x):n.isEqualsSameValueZero(m,p);default:return t.isObject(m)?typeof p=="string"?p==="":!0:n.isEqualsSameValueZero(m,p)}}function l(m,p,v,x){if(p==null)return!0;if(Array.isArray(p))return f(m,p,v,x);if(p instanceof Map)return c(m,p,v,x);if(p instanceof Set)return d(m,p,v,x);const y=Object.keys(p);if(m==null||r.isPrimitive(m))return y.length===0;if(y.length===0)return!0;if(x!=null&&x.has(p))return x.get(p)===m;x==null||x.set(p,m);try{for(let b=0;b<y.length;b++){const _=y[b];if(!r.isPrimitive(m)&&!(_ in m)||p[_]===void 0&&m[_]!==void 0||p[_]===null&&m[_]!==null||!v(m[_],p[_],_,m,p,x))return!1}return!0}finally{x==null||x.delete(p)}}function c(m,p,v,x){if(p.size===0)return!0;if(!(m instanceof Map))return!1;for(const[y,b]of p.entries()){const _=m.get(y);if(v(_,b,y,m,p,x)===!1)return!1}return!0}function f(m,p,v,x){if(p.length===0)return!0;if(!Array.isArray(m))return!1;const y=new Set;for(let b=0;b<p.length;b++){const _=p[b];let E=!1;for(let A=0;A<m.length;A++){if(y.has(A))continue;const T=m[A];let k=!1;if(v(T,_,b,m,p,x)&&(k=!0),k){y.add(A),E=!0;break}}if(!E)return!1}return!0}function d(m,p,v,x){return p.size===0?!0:m instanceof Set?f([...m],[...p],v,x):!1}e.isMatchWith=a,e.isSetMatch=d})(zy)),zy}var uA;function KD(){return uA||(uA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Q7();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r})($y)),$y}var Vy={},Gy={},Ky={},fA;function J7(){return fA||(fA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Ky)),Ky}var Xy={},dA;function h_(){return dA||(dA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Xy)),Xy}var Yy={},hA;function XD(){return hA||(hA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",l="[object Symbol]",c="[object Date]",f="[object Map]",d="[object Set]",m="[object Array]",p="[object Function]",v="[object ArrayBuffer]",x="[object Object]",y="[object Error]",b="[object DataView]",_="[object Uint8Array]",E="[object Uint8ClampedArray]",A="[object Uint16Array]",T="[object Uint32Array]",k="[object BigUint64Array]",I="[object Int8Array]",O="[object Int16Array]",j="[object Int32Array]",B="[object BigInt64Array]",U="[object Float32Array]",Y="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=v,e.arrayTag=m,e.bigInt64ArrayTag=B,e.bigUint64ArrayTag=k,e.booleanTag=a,e.dataViewTag=b,e.dateTag=c,e.errorTag=y,e.float32ArrayTag=U,e.float64ArrayTag=Y,e.functionTag=p,e.int16ArrayTag=O,e.int32ArrayTag=j,e.int8ArrayTag=I,e.mapTag=f,e.numberTag=n,e.objectTag=x,e.regexpTag=t,e.setTag=d,e.stringTag=r,e.symbolTag=l,e.uint16ArrayTag=A,e.uint32ArrayTag=T,e.uint8ArrayTag=_,e.uint8ClampedArrayTag=E})(Yy)),Yy}var Qy={},mA;function Z7(){return mA||(mA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(Qy)),Qy}var pA;function YD(){return pA||(pA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=J7(),r=h_(),n=XD(),a=VD(),i=Z7();function l(m,p){return c(m,void 0,m,new Map,p)}function c(m,p,v,x=new Map,y=void 0){const b=y==null?void 0:y(m,p,v,x);if(b!==void 0)return b;if(a.isPrimitive(m))return m;if(x.has(m))return x.get(m);if(Array.isArray(m)){const _=new Array(m.length);x.set(m,_);for(let E=0;E<m.length;E++)_[E]=c(m[E],E,v,x,y);return Object.hasOwn(m,"index")&&(_.index=m.index),Object.hasOwn(m,"input")&&(_.input=m.input),_}if(m instanceof Date)return new Date(m.getTime());if(m instanceof RegExp){const _=new RegExp(m.source,m.flags);return _.lastIndex=m.lastIndex,_}if(m instanceof Map){const _=new Map;x.set(m,_);for(const[E,A]of m)_.set(E,c(A,E,v,x,y));return _}if(m instanceof Set){const _=new Set;x.set(m,_);for(const E of m)_.add(c(E,void 0,v,x,y));return _}if(typeof Buffer<"u"&&Buffer.isBuffer(m))return m.subarray();if(i.isTypedArray(m)){const _=new(Object.getPrototypeOf(m)).constructor(m.length);x.set(m,_);for(let E=0;E<m.length;E++)_[E]=c(m[E],E,v,x,y);return _}if(m instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&m instanceof SharedArrayBuffer)return m.slice(0);if(m instanceof DataView){const _=new DataView(m.buffer.slice(0),m.byteOffset,m.byteLength);return x.set(m,_),f(_,m,v,x,y),_}if(typeof File<"u"&&m instanceof File){const _=new File([m],m.name,{type:m.type});return x.set(m,_),f(_,m,v,x,y),_}if(typeof Blob<"u"&&m instanceof Blob){const _=new Blob([m],{type:m.type});return x.set(m,_),f(_,m,v,x,y),_}if(m instanceof Error){const _=new m.constructor;return x.set(m,_),_.message=m.message,_.name=m.name,_.stack=m.stack,_.cause=m.cause,f(_,m,v,x,y),_}if(m instanceof Boolean){const _=new Boolean(m.valueOf());return x.set(m,_),f(_,m,v,x,y),_}if(m instanceof Number){const _=new Number(m.valueOf());return x.set(m,_),f(_,m,v,x,y),_}if(m instanceof String){const _=new String(m.valueOf());return x.set(m,_),f(_,m,v,x,y),_}if(typeof m=="object"&&d(m)){const _=Object.create(Object.getPrototypeOf(m));return x.set(m,_),f(_,m,v,x,y),_}return m}function f(m,p,v=m,x,y){const b=[...Object.keys(p),...t.getSymbols(p)];for(let _=0;_<b.length;_++){const E=b[_],A=Object.getOwnPropertyDescriptor(m,E);(A==null||A.writable)&&(m[E]=c(p[E],E,v,x,y))}}function d(m){switch(r.getTag(m)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=l,e.cloneDeepWithImpl=c,e.copyProperties=f})(Gy)),Gy}var gA;function eU(){return gA||(gA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YD();function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(Vy)),Vy}var vA;function tU(){return vA||(vA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KD(),r=eU();function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(Uy)),Uy}var Jy={},Zy={},e1={},xA;function rU(){return xA||(xA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=YD(),r=h_(),n=XD();function a(i,l){return t.cloneDeepWith(i,(c,f,d,m)=>{const p=l==null?void 0:l(c,f,d,m);if(p!==void 0)return p;if(typeof i=="object"){if(r.getTag(i)===n.objectTag&&typeof i.constructor!="function"){const v={};return m.set(i,v),t.copyProperties(v,i,d,m),v}switch(Object.prototype.toString.call(i)){case n.numberTag:case n.stringTag:case n.booleanTag:{const v=new i.constructor(i==null?void 0:i.valueOf());return t.copyProperties(v,i),v}case n.argumentsTag:{const v={};return t.copyProperties(v,i),v.length=i.length,v[Symbol.iterator]=i[Symbol.iterator],v}default:return}}})}e.cloneDeepWith=a})(e1)),e1}var yA;function nU(){return yA||(yA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=rU();function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Zy)),Zy}var t1={},r1={},bA;function QD(){return bA||(bA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(r1)),r1}var n1={},wA;function aU(){return wA||(wA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h_();function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(n1)),n1}var _A;function iU(){return _A||(_A=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=UD(),r=QD(),n=aU(),a=c_();function i(l,c){let f;if(Array.isArray(c)?f=c:typeof c=="string"&&t.isDeepKey(c)&&(l==null?void 0:l[c])==null?f=a.toPath(c):f=[c],f.length===0)return!1;let d=l;for(let m=0;m<f.length;m++){const p=f[m];if((d==null||!Object.hasOwn(d,p))&&!((Array.isArray(d)||n.isArguments(d))&&r.isIndex(p)&&p<d.length))return!1;d=d[p]}return!0}e.has=i})(t1)),t1}var SA;function sU(){return SA||(SA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=KD(),r=o_(),n=nU(),a=u_(),i=iU();function l(c,f){switch(typeof c){case"object":{Object.is(c==null?void 0:c.valueOf(),-0)&&(c="-0");break}case"number":{c=r.toKey(c);break}}return f=n.cloneDeep(f),function(d){const m=a.get(d,c);return m===void 0?i.has(d,c):f===void 0?m===void 0:t.isMatch(m,f)}}e.matchesProperty=l})(Jy)),Jy}var EA;function lU(){return EA||(EA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qD(),r=Y7(),n=tU(),a=sU();function i(l){if(l==null)return t.identity;switch(typeof l){case"function":return l;case"object":return Array.isArray(l)&&l.length===2?a.matchesProperty(l[0],l[1]):n.matches(l);case"string":case"symbol":case"number":return r.property(l)}}e.iteratee=i})(Ly)),Ly}var NA;function oU(){return NA||(NA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=W7(),r=V7(),n=qD(),a=X7(),i=lU();function l(c,f=n.identity){return a.isArrayLikeObject(c)?t.uniqBy(Array.from(c),r.ary(i.iteratee(f),1)):[]}e.uniqBy=l})(Oy)),Oy}var a1,kA;function cU(){return kA||(kA=1,a1=oU().uniqBy),a1}var uU=cU();const TA=Cs(uU);function JD(e,t,r){return t===!0?TA(e,r):typeof t=="function"?TA(e,t):e}var i1={exports:{}},s1={},l1={exports:{}},o1={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AA;function fU(){if(AA)return o1;AA=1;var e=Zu();function t(p,v){return p===v&&(p!==0||1/p===1/v)||p!==p&&v!==v}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,a=e.useEffect,i=e.useLayoutEffect,l=e.useDebugValue;function c(p,v){var x=v(),y=n({inst:{value:x,getSnapshot:v}}),b=y[0].inst,_=y[1];return i(function(){b.value=x,b.getSnapshot=v,f(b)&&_({inst:b})},[p,x,v]),a(function(){return f(b)&&_({inst:b}),p(function(){f(b)&&_({inst:b})})},[p]),l(x),x}function f(p){var v=p.getSnapshot;p=p.value;try{var x=v();return!r(p,x)}catch{return!0}}function d(p,v){return v()}var m=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:c;return o1.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:m,o1}var jA;function dU(){return jA||(jA=1,l1.exports=fU()),l1.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OA;function hU(){if(OA)return s1;OA=1;var e=Zu(),t=dU();function r(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var n=typeof Object.is=="function"?Object.is:r,a=t.useSyncExternalStore,i=e.useRef,l=e.useEffect,c=e.useMemo,f=e.useDebugValue;return s1.useSyncExternalStoreWithSelector=function(d,m,p,v,x){var y=i(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=c(function(){function E(O){if(!A){if(A=!0,T=O,O=v(O),x!==void 0&&b.hasValue){var j=b.value;if(x(j,O))return k=j}return k=O}if(j=k,n(T,O))return j;var B=v(O);return x!==void 0&&x(j,B)?(T=O,j):(T=O,k=B)}var A=!1,T,k,I=p===void 0?null:p;return[function(){return E(m())},I===null?void 0:function(){return E(I())}]},[m,p,v,x]);var _=a(d,y[0],y[1]);return l(function(){b.hasValue=!0,b.value=_},[_]),f(_),_},s1}var CA;function mU(){return CA||(CA=1,i1.exports=hU()),i1.exports}var pU=mU(),m_=N.createContext(null),gU=e=>e,Ur=()=>{var e=N.useContext(m_);return e?e.store.dispatch:gU},Fm=()=>{},vU=()=>Fm,xU=(e,t)=>e===t;function xt(e){var t=N.useContext(m_),r=N.useMemo(()=>t?n=>{if(n!=null)return e(n)}:Fm,[t,e]);return pU.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:vU,t?t.store.getState:Fm,t?t.store.getState:Fm,r,xU)}function yU(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function bU(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function wU(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var DA=e=>Array.isArray(e)?e:[e];function _U(e){const t=Array.isArray(e[0])?e[0]:e;return wU(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function SU(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var EU=class{constructor(e){this.value=e}deref(){return this.value}},NU=typeof WeakRef<"u"?WeakRef:EU,kU=0,IA=1;function im(){return{s:kU,v:void 0,o:null,p:null}}function ZD(e,t={}){let r=im();const{resultEqualityCheck:n}=t;let a,i=0;function l(){var p;let c=r;const{length:f}=arguments;for(let v=0,x=f;v<x;v++){const y=arguments[v];if(typeof y=="function"||typeof y=="object"&&y!==null){let b=c.o;b===null&&(c.o=b=new WeakMap);const _=b.get(y);_===void 0?(c=im(),b.set(y,c)):c=_}else{let b=c.p;b===null&&(c.p=b=new Map);const _=b.get(y);_===void 0?(c=im(),b.set(y,c)):c=_}}const d=c;let m;if(c.s===IA)m=c.v;else if(m=e.apply(null,arguments),i++,n){const v=((p=a==null?void 0:a.deref)==null?void 0:p.call(a))??a;v!=null&&n(v,m)&&(m=v,i!==0&&i--),a=typeof m=="object"&&m!==null||typeof m=="function"?new NU(m):m}return d.s=IA,d.v=m,m}return l.clearCache=()=>{r=im(),l.resetResultsCount()},l.resultsCount=()=>i,l.resetResultsCount=()=>{i=0},l}function TU(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,l=0,c,f={},d=a.pop();typeof d=="object"&&(f=d,d=a.pop()),yU(d,`createSelector expects an output function after the inputs, but received: [${typeof d}]`);const m={...r,...f},{memoize:p,memoizeOptions:v=[],argsMemoize:x=ZD,argsMemoizeOptions:y=[]}=m,b=DA(v),_=DA(y),E=_U(a),A=p(function(){return i++,d.apply(null,arguments)},...b),T=x(function(){l++;const I=SU(E,arguments);return c=A.apply(null,I),c},..._);return Object.assign(T,{resultFunc:d,memoizedResultFunc:A,dependencies:E,dependencyRecomputations:()=>l,resetDependencyRecomputations:()=>{l=0},lastResult:()=>c,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:p,argsMemoize:x})};return Object.assign(n,{withTypes:()=>n}),n}var Te=TU(ZD),AU=Object.assign((e,t=Te)=>{bU(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((l,c,f)=>(l[r[f]]=c,l),{}))},{withTypes:()=>AU}),c1={},u1={},f1={},PA;function jU(){return PA||(PA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const l=t(n),c=t(a);if(l===c&&l===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?c-l:l-c}return 0};e.compareValues=r})(f1)),f1}var d1={},h1={},MA;function eI(){return MA||(MA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(h1)),h1}var RA;function OU(){return RA||(RA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eI(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,l){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||l!=null&&Object.hasOwn(l,i)}e.isKey=a})(d1)),d1}var FA;function CU(){return FA||(FA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=jU(),r=OU(),n=c_();function a(i,l,c,f){if(i==null)return[];c=f?void 0:c,Array.isArray(i)||(i=Object.values(i)),Array.isArray(l)||(l=l==null?[null]:[l]),l.length===0&&(l=[null]),Array.isArray(c)||(c=c==null?[]:[c]),c=c.map(x=>String(x));const d=(x,y)=>{let b=x;for(let _=0;_<y.length&&b!=null;++_)b=b[y[_]];return b},m=(x,y)=>y==null||x==null?y:typeof x=="object"&&"key"in x?Object.hasOwn(y,x.key)?y[x.key]:d(y,x.path):typeof x=="function"?x(y):Array.isArray(x)?d(y,x):typeof y=="object"?y[x]:y,p=l.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||r.isKey(x)?x:{key:x,path:n.toPath(x)}));return i.map(x=>({original:x,criteria:p.map(y=>m(y,x))})).slice().sort((x,y)=>{for(let b=0;b<p.length;b++){const _=t.compareValues(x.criteria[b],y.criteria[b],c[b]);if(_!==0)return _}return 0}).map(x=>x.original)}e.orderBy=a})(u1)),u1}var m1={},LA;function DU(){return LA||(LA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),l=(c,f)=>{for(let d=0;d<c.length;d++){const m=c[d];Array.isArray(m)&&f<i?l(m,f+1):a.push(m)}};return l(r,0),a}e.flatten=t})(m1)),m1}var p1={},BA;function tI(){return BA||(BA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=QD(),r=d_(),n=WD(),a=GD();function i(l,c,f){return n.isObject(f)&&(typeof c=="number"&&r.isArrayLike(f)&&t.isIndex(c)&&c<f.length||typeof c=="string"&&c in f)?a.isEqualsSameValueZero(f[c],l):!1}e.isIterateeCall=i})(p1)),p1}var UA;function IU(){return UA||(UA=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=CU(),r=DU(),n=tI();function a(i,...l){const c=l.length;return c>1&&n.isIterateeCall(i,l[0],l[1])?l=[]:c>2&&n.isIterateeCall(l[0],l[1],l[2])&&(l=[l[0]]),t.orderBy(i,r.flatten(l),["asc"])}e.sortBy=a})(c1)),c1}var g1,$A;function PU(){return $A||($A=1,g1=IU().sortBy),g1}var MU=PU();const ig=Cs(MU);var rI=e=>e.legend.settings,RU=e=>e.legend.size,FU=e=>e.legend.payload,LU=Te([FU,rI],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?ig(n,r):n});function BU(){return xt(LU)}var sm=1;function nI(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=N.useState({height:0,left:0,top:0,width:0}),n=N.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),l={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(l.height-t.height)>sm||Math.abs(l.left-t.left)>sm||Math.abs(l.top-t.top)>sm||Math.abs(l.width-t.width)>sm)&&r({height:l.height,left:l.left,top:l.top,width:l.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function fa(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var UU=typeof Symbol=="function"&&Symbol.observable||"@@observable",zA=UU,v1=()=>Math.random().toString(36).substring(7).split("").join("."),$U={INIT:`@@redux/INIT${v1()}`,REPLACE:`@@redux/REPLACE${v1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${v1()}`},Ym=$U;function p_(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function aI(e,t,r){if(typeof e!="function")throw new Error(fa(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(fa(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(fa(1));return r(aI)(e,t)}let n=e,a=t,i=new Map,l=i,c=0,f=!1;function d(){l===i&&(l=new Map,i.forEach((_,E)=>{l.set(E,_)}))}function m(){if(f)throw new Error(fa(3));return a}function p(_){if(typeof _!="function")throw new Error(fa(4));if(f)throw new Error(fa(5));let E=!0;d();const A=c++;return l.set(A,_),function(){if(E){if(f)throw new Error(fa(6));E=!1,d(),l.delete(A),i=null}}}function v(_){if(!p_(_))throw new Error(fa(7));if(typeof _.type>"u")throw new Error(fa(8));if(typeof _.type!="string")throw new Error(fa(17));if(f)throw new Error(fa(9));try{f=!0,a=n(a,_)}finally{f=!1}return(i=l).forEach(A=>{A()}),_}function x(_){if(typeof _!="function")throw new Error(fa(10));n=_,v({type:Ym.REPLACE})}function y(){const _=p;return{subscribe(E){if(typeof E!="object"||E===null)throw new Error(fa(11));function A(){const k=E;k.next&&k.next(m())}return A(),{unsubscribe:_(A)}},[zA](){return this}}}return v({type:Ym.INIT}),{dispatch:v,subscribe:p,getState:m,replaceReducer:x,[zA]:y}}function zU(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Ym.INIT})>"u")throw new Error(fa(12));if(typeof r(void 0,{type:Ym.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(fa(13))})}function iI(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const l=t[i];typeof e[l]=="function"&&(r[l]=e[l])}const n=Object.keys(r);let a;try{zU(r)}catch(i){a=i}return function(l={},c){if(a)throw a;let f=!1;const d={};for(let m=0;m<n.length;m++){const p=n[m],v=r[p],x=l[p],y=v(x,c);if(typeof y>"u")throw c&&c.type,new Error(fa(14));d[p]=y,f=f||y!==x}return f=f||n.length!==Object.keys(l).length,f?d:l}}function Qm(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function HU(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(fa(15))};const l={getState:a.getState,dispatch:(f,...d)=>i(f,...d)},c=e.map(f=>f(l));return i=Qm(...c)(a.dispatch),{...a,dispatch:i}}}function sI(e){return p_(e)&&"type"in e&&typeof e.type=="string"}var lI=Symbol.for("immer-nothing"),HA=Symbol.for("immer-draftable"),La=Symbol.for("immer-state");function es(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var vi=Object,zu=vi.getPrototypeOf,Jm="constructor",sg="prototype",Lb="configurable",Zm="enumerable",Lm="writable",Rd="value",ol=e=>!!e&&!!e[La];function us(e){var t;return e?oI(e)||og(e)||!!e[HA]||!!((t=e[Jm])!=null&&t[HA])||cg(e)||ug(e):!1}var qU=vi[sg][Jm].toString(),qA=new WeakMap;function oI(e){if(!e||!g_(e))return!1;const t=zu(e);if(t===null||t===vi[sg])return!0;const r=vi.hasOwnProperty.call(t,Jm)&&t[Jm];if(r===Object)return!0;if(!ku(r))return!1;let n=qA.get(r);return n===void 0&&(n=Function.toString.call(r),qA.set(r,n)),n===qU}function lg(e,t,r=!0){x0(e)===0?(r?Reflect.ownKeys(e):vi.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function x0(e){const t=e[La];return t?t.type_:og(e)?1:cg(e)?2:ug(e)?3:0}var WA=(e,t,r=x0(e))=>r===2?e.has(t):vi[sg].hasOwnProperty.call(e,t),Bb=(e,t,r=x0(e))=>r===2?e.get(t):e[t],ep=(e,t,r,n=x0(e))=>{n===2?e.set(t,r):n===3?e.add(r):e[t]=r};function WU(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}var og=Array.isArray,cg=e=>e instanceof Map,ug=e=>e instanceof Set,g_=e=>typeof e=="object",ku=e=>typeof e=="function",x1=e=>typeof e=="boolean";function VU(e){const t=+e;return Number.isInteger(t)&&String(t)===e}var Js=e=>e.copy_||e.base_,v_=e=>e.modified_?e.copy_:e.base_;function Ub(e,t){if(cg(e))return new Map(e);if(ug(e))return new Set(e);if(og(e))return Array[sg].slice.call(e);const r=oI(e);if(t===!0||t==="class_only"&&!r){const n=vi.getOwnPropertyDescriptors(e);delete n[La];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const l=a[i],c=n[l];c[Lm]===!1&&(c[Lm]=!0,c[Lb]=!0),(c.get||c.set)&&(n[l]={[Lb]:!0,[Lm]:!0,[Zm]:c[Zm],[Rd]:e[l]})}return vi.create(zu(e),n)}else{const n=zu(e);if(n!==null&&r)return{...e};const a=vi.create(n);return vi.assign(a,e)}}function x_(e,t=!1){return fg(e)||ol(e)||!us(e)||(x0(e)>1&&vi.defineProperties(e,{set:lm,add:lm,clear:lm,delete:lm}),vi.freeze(e),t&&lg(e,(r,n)=>{x_(n,!0)},!1)),e}function GU(){es(2)}var lm={[Rd]:GU};function fg(e){return e===null||!g_(e)?!0:vi.isFrozen(e)}var tp="MapSet",$b="Patches",VA="ArrayMethods",cI={};function mc(e){const t=cI[e];return t||es(0,e),t}var GA=e=>!!cI[e],Fd,uI=()=>Fd,KU=(e,t)=>({drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0,handledSet_:new Set,processedForPatches_:new Set,mapSetPlugin_:GA(tp)?mc(tp):void 0,arrayMethodsPlugin_:GA(VA)?mc(VA):void 0});function KA(e,t){t&&(e.patchPlugin_=mc($b),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function zb(e){Hb(e),e.drafts_.forEach(XU),e.drafts_=null}function Hb(e){e===Fd&&(Fd=e.parent_)}var XA=e=>Fd=KU(Fd,e);function XU(e){const t=e[La];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function YA(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];if(e!==void 0&&e!==r){r[La].modified_&&(zb(t),es(4)),us(e)&&(e=QA(t,e));const{patchPlugin_:a}=t;a&&a.generateReplacementPatches_(r[La].base_,e,t)}else e=QA(t,r);return YU(t,e,!0),zb(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==lI?e:void 0}function QA(e,t){if(fg(t))return t;const r=t[La];if(!r)return rp(t,e.handledSet_,e);if(!dg(r,e))return t;if(!r.modified_)return r.base_;if(!r.finalized_){const{callbacks_:n}=r;if(n)for(;n.length>0;)n.pop()(e);hI(r,e)}return r.copy_}function YU(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&x_(t,r)}function fI(e){e.finalized_=!0,e.scope_.unfinalizedDrafts_--}var dg=(e,t)=>e.scope_===t,QU=[];function dI(e,t,r,n){const a=Js(e),i=e.type_;if(n!==void 0&&Bb(a,n,i)===t){ep(a,n,r,i);return}if(!e.draftLocations_){const c=e.draftLocations_=new Map;lg(a,(f,d)=>{if(ol(d)){const m=c.get(d)||[];m.push(f),c.set(d,m)}})}const l=e.draftLocations_.get(t)??QU;for(const c of l)ep(a,c,r,i)}function JU(e,t,r){e.callbacks_.push(function(a){var c;const i=t;if(!i||!dg(i,a))return;(c=a.mapSetPlugin_)==null||c.fixSetContents(i);const l=v_(i);dI(e,i.draft_??i,l,r),hI(i,a)})}function hI(e,t){var n;if(e.modified_&&!e.finalized_&&(e.type_===3||e.type_===1&&e.allIndicesReassigned_||(((n=e.assigned_)==null?void 0:n.size)??0)>0)){const{patchPlugin_:a}=t;if(a){const i=a.getPath(e);i&&a.generatePatches_(e,i,t)}fI(e)}}function ZU(e,t,r){const{scope_:n}=e;if(ol(r)){const a=r[La];dg(a,n)&&a.callbacks_.push(function(){Bm(e);const l=v_(a);dI(e,r,l,t)})}else us(r)&&e.callbacks_.push(function(){const i=Js(e);e.type_===3?i.has(r)&&rp(r,n.handledSet_,n):Bb(i,t,e.type_)===r&&n.drafts_.length>1&&(e.assigned_.get(t)??!1)===!0&&e.copy_&&rp(Bb(e.copy_,t,e.type_),n.handledSet_,n)})}function rp(e,t,r){return!r.immer_.autoFreeze_&&r.unfinalizedDrafts_<1||ol(e)||t.has(e)||!us(e)||fg(e)||(t.add(e),lg(e,(n,a)=>{if(ol(a)){const i=a[La];if(dg(i,r)){const l=v_(i);ep(e,n,l,e.type_),fI(i)}}else us(a)&&rp(a,t,r)})),e}function e9(e,t){const r=og(e),n={type_:r?1:0,scope_:t?t.scope_:uI(),modified_:!1,finalized_:!1,assigned_:void 0,parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1,callbacks_:void 0};let a=n,i=np;r&&(a=[n],i=Ld);const{revoke:l,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=l,[c,n]}var np={get(e,t){if(t===La)return e;let r=e.scope_.arrayMethodsPlugin_;const n=e.type_===1&&typeof t=="string";if(n&&r!=null&&r.isArrayOperationMethod(t))return r.createMethodInterceptor(e,t);const a=Js(e);if(!WA(a,t,e.type_))return t9(e,a,t);const i=a[t];if(e.finalized_||!us(i)||n&&e.operationMethod&&(r!=null&&r.isMutatingArrayMethod(e.operationMethod))&&VU(t))return i;if(i===y1(e.base_,t)){Bm(e);const l=e.type_===1?+t:t,c=Wb(e.scope_,i,e,l);return e.copy_[l]=c}return i},has(e,t){return t in Js(e)},ownKeys(e){return Reflect.ownKeys(Js(e))},set(e,t,r){const n=mI(Js(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=y1(Js(e),t),i=a==null?void 0:a[La];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_.set(t,!1),!0;if(WU(r,a)&&(r!==void 0||WA(e.base_,t,e.type_)))return!0;Bm(e),qb(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_.set(t,!0),ZU(e,t,r)),!0},deleteProperty(e,t){return Bm(e),y1(e.base_,t)!==void 0||t in e.base_?(e.assigned_.set(t,!1),qb(e)):e.assigned_.delete(t),e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Js(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{[Lm]:!0,[Lb]:e.type_!==1||t!=="length",[Zm]:n[Zm],[Rd]:r[t]}},defineProperty(){es(11)},getPrototypeOf(e){return zu(e.base_)},setPrototypeOf(){es(12)}},Ld={};for(let e in np){let t=np[e];Ld[e]=function(){const r=arguments;return r[0]=r[0][0],t.apply(this,r)}}Ld.deleteProperty=function(e,t){return Ld.set.call(this,e,t,void 0)};Ld.set=function(e,t,r){return np.set.call(this,e[0],t,r,e[0])};function y1(e,t){const r=e[La];return(r?Js(r):e)[t]}function t9(e,t,r){var a;const n=mI(t,r);return n?Rd in n?n[Rd]:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function mI(e,t){if(!(t in e))return;let r=zu(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=zu(r)}}function qb(e){e.modified_||(e.modified_=!0,e.parent_&&qb(e.parent_))}function Bm(e){e.copy_||(e.assigned_=new Map,e.copy_=Ub(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var r9=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!1,this.produce=(r,n,a)=>{if(ku(r)&&!ku(n)){const l=n;n=r;const c=this;return function(d=l,...m){return c.produce(d,p=>n.call(this,p,...m))}}ku(n)||es(6),a!==void 0&&!ku(a)&&es(7);let i;if(us(r)){const l=XA(this),c=Wb(l,r,void 0);let f=!0;try{i=n(c),f=!1}finally{f?zb(l):Hb(l)}return KA(l,a),YA(i,l)}else if(!r||!g_(r)){if(i=n(r),i===void 0&&(i=r),i===lI&&(i=void 0),this.autoFreeze_&&x_(i,!0),a){const l=[],c=[];mc($b).generateReplacementPatches_(r,i,{patches_:l,inversePatches_:c}),a(l,c)}return i}else es(1,r)},this.produceWithPatches=(r,n)=>{if(ku(r))return(c,...f)=>this.produceWithPatches(c,d=>r(d,...f));let a,i;return[this.produce(r,n,(c,f)=>{a=c,i=f}),a,i]},x1(t==null?void 0:t.autoFreeze)&&this.setAutoFreeze(t.autoFreeze),x1(t==null?void 0:t.useStrictShallowCopy)&&this.setUseStrictShallowCopy(t.useStrictShallowCopy),x1(t==null?void 0:t.useStrictIteration)&&this.setUseStrictIteration(t.useStrictIteration)}createDraft(t){us(t)||es(8),ol(t)&&(t=ss(t));const r=XA(this),n=Wb(r,t,void 0);return n[La].isManual_=!0,Hb(r),n}finishDraft(t,r){const n=t&&t[La];(!n||!n.isManual_)&&es(9);const{scope_:a}=n;return KA(a,r),YA(void 0,a)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}setUseStrictIteration(t){this.useStrictIteration_=t}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(t,r){let n;for(n=r.length-1;n>=0;n--){const i=r[n];if(i.path.length===0&&i.op==="replace"){t=i.value;break}}n>-1&&(r=r.slice(n+1));const a=mc($b).applyPatches_;return ol(t)?a(t,r):this.produce(t,i=>a(i,r))}};function Wb(e,t,r,n){const[a,i]=cg(t)?mc(tp).proxyMap_(t,r):ug(t)?mc(tp).proxySet_(t,r):e9(t,r);return((r==null?void 0:r.scope_)??uI()).drafts_.push(a),i.callbacks_=(r==null?void 0:r.callbacks_)??[],i.key_=n,r&&n!==void 0?JU(r,i,n):i.callbacks_.push(function(f){var m;(m=f.mapSetPlugin_)==null||m.fixSetContents(i);const{patchPlugin_:d}=f;i.modified_&&d&&d.generatePatches_(i,[],f)}),a}function ss(e){return ol(e)||es(10,e),pI(e)}function pI(e){if(!us(e)||fg(e))return e;const t=e[La];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Ub(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Ub(e,!0);return lg(r,(a,i)=>{ep(r,a,pI(i))},n),t&&(t.finalized_=!1),r}var n9=new r9,gI=n9.produce;function vI(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var a9=vI(),i9=vI,s9=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Qm:Qm.apply(null,arguments)};function zi(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(xi(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>sI(n)&&n.type===e,r}var xI=class gd extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,gd.prototype)}static get[Symbol.species](){return gd}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new gd(...t[0].concat(this)):new gd(...t.concat(this))}};function JA(e){return us(e)?gI(e,()=>{}):e}function om(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function l9(e){return typeof e=="boolean"}var o9=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let l=new xI;return r&&(l9(r)?l.push(a9):l.push(i9(r.extraArgument))),l},yI="RTK_autoBatch",Jr=()=>e=>({payload:e,meta:{[yI]:!0}}),ZA=e=>t=>{setTimeout(t,e)},bI=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,l=!1;const c=new Set,f=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:ZA(10):e.type==="callback"?e.queueNotification:ZA(e.timeout),d=()=>{l=!1,i&&(i=!1,c.forEach(m=>m()))};return Object.assign({},n,{subscribe(m){const p=()=>a&&m(),v=n.subscribe(p);return c.add(m),()=>{v(),c.delete(m)}},dispatch(m){var p;try{return a=!((p=m==null?void 0:m.meta)!=null&&p[yI]),i=!a,i&&(l||(l=!0,f(d))),n.dispatch(m)}finally{a=!0}}})},c9=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new xI(e);return n&&a.push(bI(typeof n=="object"?n:void 0)),a};function u9(e){const t=o9(),{reducer:r=void 0,middleware:n,devTools:a=!0,preloadedState:i=void 0,enhancers:l=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(p_(r))c=iI(r);else throw new Error(xi(1));let f;typeof n=="function"?f=n(t):f=t();let d=Qm;a&&(d=s9({trace:!1,...typeof a=="object"&&a}));const m=HU(...f),p=c9(m);let v=typeof l=="function"?l(p):p();const x=d(...v);return aI(c,i,x)}function wI(e){const t={},r=[];let n;const a={addCase(i,l){const c=typeof i=="string"?i:i.type;if(!c)throw new Error(xi(28));if(c in t)throw new Error(xi(29));return t[c]=l,a},addAsyncThunk(i,l){return l.pending&&(t[i.pending.type]=l.pending),l.rejected&&(t[i.rejected.type]=l.rejected),l.fulfilled&&(t[i.fulfilled.type]=l.fulfilled),l.settled&&r.push({matcher:i.settled,reducer:l.settled}),a},addMatcher(i,l){return r.push({matcher:i,reducer:l}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function f9(e){return typeof e=="function"}function d9(e,t){let[r,n,a]=wI(t),i;if(f9(e))i=()=>JA(e());else{const c=JA(e);i=()=>c}function l(c=i(),f){let d=[r[f.type],...n.filter(({matcher:m})=>m(f)).map(({reducer:m})=>m)];return d.filter(m=>!!m).length===0&&(d=[a]),d.reduce((m,p)=>{if(p)if(ol(m)){const x=p(m,f);return x===void 0?m:x}else{if(us(m))return gI(m,v=>p(v,f));{const v=p(m,f);if(v===void 0){if(m===null)return m;throw Error("A case reducer on a non-draftable value must not return undefined")}return v}}return m},c)}return l.getInitialState=i,l}var h9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",m9=(e=21)=>{let t="",r=e;for(;r--;)t+=h9[Math.random()*64|0];return t},p9=Symbol.for("rtk-slice-createasyncthunk");function g9(e,t){return`${e}/${t}`}function v9({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[p9];return function(a){const{name:i,reducerPath:l=i}=a;if(!i)throw new Error(xi(11));const c=(typeof a.reducers=="function"?a.reducers(y9()):a.reducers)||{},f=Object.keys(c),d={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},m={addCase(k,I){const O=typeof k=="string"?k:k.type;if(!O)throw new Error(xi(12));if(O in d.sliceCaseReducersByType)throw new Error(xi(13));return d.sliceCaseReducersByType[O]=I,m},addMatcher(k,I){return d.sliceMatchers.push({matcher:k,reducer:I}),m},exposeAction(k,I){return d.actionCreators[k]=I,m},exposeCaseReducer(k,I){return d.sliceCaseReducersByName[k]=I,m}};f.forEach(k=>{const I=c[k],O={reducerName:k,type:g9(i,k),createNotation:typeof a.reducers=="function"};w9(I)?S9(O,I,m,t):b9(O,I,m)});function p(){const[k={},I=[],O=void 0]=typeof a.extraReducers=="function"?wI(a.extraReducers):[a.extraReducers],j={...k,...d.sliceCaseReducersByType};return d9(a.initialState,B=>{for(let U in j)B.addCase(U,j[U]);for(let U of d.sliceMatchers)B.addMatcher(U.matcher,U.reducer);for(let U of I)B.addMatcher(U.matcher,U.reducer);O&&B.addDefaultCase(O)})}const v=k=>k,x=new Map,y=new WeakMap;let b;function _(k,I){return b||(b=p()),b(k,I)}function E(){return b||(b=p()),b.getInitialState()}function A(k,I=!1){function O(B){let U=B[k];return typeof U>"u"&&I&&(U=om(y,O,E)),U}function j(B=v){const U=om(x,I,()=>new WeakMap);return om(U,B,()=>{const Y={};for(const[te,V]of Object.entries(a.selectors??{}))Y[te]=x9(V,B,()=>om(y,B,E),I);return Y})}return{reducerPath:k,getSelectors:j,get selectors(){return j(O)},selectSlice:O}}const T={name:i,reducer:_,actions:d.actionCreators,caseReducers:d.sliceCaseReducersByName,getInitialState:E,...A(l),injectInto(k,{reducerPath:I,...O}={}){const j=I??l;return k.inject({reducerPath:j,reducer:_},O),{...T,...A(j,!0)}}};return T}}function x9(e,t,r,n){function a(i,...l){let c=t(i);return typeof c>"u"&&n&&(c=r()),e(c,...l)}return a.unwrapped=e,a}var Qa=v9();function y9(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function b9({type:e,reducerName:t,createNotation:r},n,a){let i,l;if("reducer"in n){if(r&&!_9(n))throw new Error(xi(17));i=n.reducer,l=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,l?zi(e,l):zi(e))}function w9(e){return e._reducerDefinitionType==="asyncThunk"}function _9(e){return e._reducerDefinitionType==="reducerWithPrepare"}function S9({type:e,reducerName:t},r,n,a){if(!a)throw new Error(xi(18));const{payloadCreator:i,fulfilled:l,pending:c,rejected:f,settled:d,options:m}=r,p=a(e,i,m);n.exposeAction(t,p),l&&n.addCase(p.fulfilled,l),c&&n.addCase(p.pending,c),f&&n.addCase(p.rejected,f),d&&n.addMatcher(p.settled,d),n.exposeCaseReducer(t,{fulfilled:l||cm,pending:c||cm,rejected:f||cm,settled:d||cm})}function cm(){}var E9="task",_I="listener",SI="completed",y_="cancelled",N9=`task-${y_}`,k9=`task-${SI}`,Vb=`${_I}-${y_}`,T9=`${_I}-${SI}`,hg=class{constructor(e){my(this,"name","TaskAbortError");my(this,"message");this.code=e,this.message=`${E9} ${y_} (reason: ${e})`}},b_=(e,t)=>{if(typeof e!="function")throw new TypeError(xi(32))},ap=()=>{},EI=(e,t=ap)=>(e.catch(t),e),NI=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),rc=e=>{if(e.aborted)throw new hg(e.reason)};function kI(e,t){let r=ap;return new Promise((n,a)=>{const i=()=>a(new hg(e.reason));if(e.aborted){i();return}r=NI(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=ap})}var A9=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof hg?"cancelled":"rejected",error:r}}finally{t==null||t()}},ip=e=>t=>EI(kI(e,t).then(r=>(rc(e),r))),TI=e=>{const t=ip(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Mu}=Object,ej={},mg="listenerMiddleware",j9=(e,t)=>{const r=n=>NI(e,()=>n.abort(e.reason));return(n,a)=>{b_(n);const i=new AbortController;r(i);const l=A9(async()=>{rc(e),rc(i.signal);const c=await n({pause:ip(i.signal),delay:TI(i.signal),signal:i.signal});return rc(i.signal),c},()=>i.abort(k9));return a!=null&&a.autoJoin&&t.push(l.catch(ap)),{result:ip(e)(l),cancel(){i.abort(N9)}}}},O9=(e,t)=>{const r=async(n,a)=>{rc(t);let i=()=>{};const c=[new Promise((f,d)=>{let m=e({predicate:n,effect:(p,v)=>{v.unsubscribe(),f([p,v.getState(),v.getOriginalState()])}});i=()=>{m(),d()}})];a!=null&&c.push(new Promise(f=>setTimeout(f,a,null)));try{const f=await kI(t,Promise.race(c));return rc(t),f}finally{i()}};return(n,a)=>EI(r(n,a))},AI=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=zi(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(xi(21));return b_(i),{predicate:a,type:t,effect:i}},jI=Mu(e=>{const{type:t,predicate:r,effect:n}=AI(e);return{id:m9(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(xi(22))}}},{withTypes:()=>jI}),tj=(e,t)=>{const{type:r,effect:n,predicate:a}=AI(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},Gb=e=>{e.pending.forEach(t=>{t.abort(Vb)})},C9=(e,t)=>()=>{for(const r of t.keys())Gb(r);e.clear()},rj=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},OI=Mu(zi(`${mg}/add`),{withTypes:()=>OI}),D9=zi(`${mg}/removeAll`),CI=Mu(zi(`${mg}/remove`),{withTypes:()=>CI}),I9=(...e)=>{console.error(`${mg}/error`,...e)},y0=(e={})=>{const t=new Map,r=new Map,n=x=>{const y=r.get(x)??0;r.set(x,y+1)},a=x=>{const y=r.get(x)??1;y===1?r.delete(x):r.set(x,y-1)},{extra:i,onError:l=I9}=e;b_(l);const c=x=>(x.unsubscribe=()=>t.delete(x.id),t.set(x.id,x),y=>{x.unsubscribe(),y!=null&&y.cancelActive&&Gb(x)}),f=x=>{const y=tj(t,x)??jI(x);return c(y)};Mu(f,{withTypes:()=>f});const d=x=>{const y=tj(t,x);return y&&(y.unsubscribe(),x.cancelActive&&Gb(y)),!!y};Mu(d,{withTypes:()=>d});const m=async(x,y,b,_)=>{const E=new AbortController,A=O9(f,E.signal),T=[];try{x.pending.add(E),n(x),await Promise.resolve(x.effect(y,Mu({},b,{getOriginalState:_,condition:(k,I)=>A(k,I).then(Boolean),take:A,delay:TI(E.signal),pause:ip(E.signal),extra:i,signal:E.signal,fork:j9(E.signal,T),unsubscribe:x.unsubscribe,subscribe:()=>{t.set(x.id,x)},cancelActiveListeners:()=>{x.pending.forEach((k,I,O)=>{k!==E&&(k.abort(Vb),O.delete(k))})},cancel:()=>{E.abort(Vb),x.pending.delete(E)},throwIfCancelled:()=>{rc(E.signal)}})))}catch(k){k instanceof hg||rj(l,k,{raisedBy:"effect"})}finally{await Promise.all(T),E.abort(T9),a(x),x.pending.delete(E)}},p=C9(t,r);return{middleware:x=>y=>b=>{if(!sI(b))return y(b);if(OI.match(b))return f(b.payload);if(D9.match(b)){p();return}if(CI.match(b))return d(b.payload);let _=x.getState();const E=()=>{if(_===ej)throw new Error(xi(23));return _};let A;try{if(A=y(b),t.size>0){const T=x.getState(),k=Array.from(t.values());for(const I of k){let O=!1;try{O=I.predicate(b,T,_)}catch(j){O=!1,rj(l,j,{raisedBy:"predicate"})}O&&m(I,b,x,E)}}}finally{_=ej}return A},startListening:f,stopListening:d,clearListeners:p}};function xi(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var P9={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},DI=Qa({name:"chartLayout",initialState:P9,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){var r,n,a,i;e.margin.top=(r=t.payload.top)!==null&&r!==void 0?r:0,e.margin.right=(n=t.payload.right)!==null&&n!==void 0?n:0,e.margin.bottom=(a=t.payload.bottom)!==null&&a!==void 0?a:0,e.margin.left=(i=t.payload.left)!==null&&i!==void 0?i:0},setScale(e,t){e.scale=t.payload}}}),{setMargin:M9,setLayout:R9,setChartSize:F9,setScale:L9}=DI.actions,B9=DI.reducer;function II(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function rr(e){return Number.isFinite(e)}function js(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function nj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Cu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nj(Object(r),!0).forEach(function(n){U9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function U9(e,t,r){return(t=$9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $9(e){var t=z9(e,"string");return typeof t=="symbol"?t:t+""}function z9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Gr(e,t,r){return Jn(e)||Jn(t)?r:As(t)?dc(e,t,r):typeof t=="function"?t(e):r}var H9=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:l,layout:c}=t;if((c==="vertical"||c==="horizontal"&&l==="middle")&&i!=="center"&&gt(e[i]))return Cu(Cu({},e),{},{[i]:e[i]+(n||0)});if((c==="horizontal"||c==="vertical"&&i==="center")&&l!=="middle"&&gt(e[l]))return Cu(Cu({},e),{},{[l]:e[l]+(a||0)})}return e},po=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",PI=(e,t,r,n)=>{if(n)return e.map(c=>c.coordinate);var a,i,l=e.map(c=>(c.coordinate===t&&(a=!0),c.coordinate===r&&(i=!0),c.coordinate));return a||l.push(t),i||l.push(r),l},MI=(e,t,r)=>{if(!e)return null;var{duplicateDomain:n,type:a,range:i,scale:l,realScaleType:c,isCategorical:f,categoricalDomain:d,tickCount:m,ticks:p,niceTicks:v,axisType:x}=e;if(!l)return null;var y=c==="scaleBand"&&l.bandwidth?l.bandwidth()/2:2,b=a==="category"&&l.bandwidth?l.bandwidth()/y:0;if(b=x==="angleAxis"&&i&&i.length>=2?Yn(i[0]-i[1])*2*b:b,p||v){var _=(p||v||[]).map((E,A)=>{var T=n?n.indexOf(E):E,k=l.map(T);return rr(k)?{coordinate:k+b,value:E,offset:b,index:A}:null}).filter(Ga);return _}return f&&d?d.map((E,A)=>{var T=l.map(E);return rr(T)?{coordinate:T+b,value:E,index:A,offset:b}:null}).filter(Ga):l.ticks&&m!=null?l.ticks(m).map((E,A)=>{var T=l.map(E);return rr(T)?{coordinate:T+b,value:E,index:A,offset:b}:null}).filter(Ga):l.domain().map((E,A)=>{var T=l.map(E);return rr(T)?{coordinate:T+b,value:n?n[E]:E,index:A,offset:b}:null}).filter(Ga)},q9=(e,t)=>{if(!t||t.length!==2||!gt(t[0])||!gt(t[1]))return e;var r=Math.min(t[0],t[1]),n=Math.max(t[0],t[1]),a=[e[0],e[1]];return(!gt(e[0])||e[0]<r)&&(a[0]=r),(!gt(e[1])||e[1]>n)&&(a[1]=n),a[0]>n&&(a[0]=n),a[1]<r&&(a[1]=r),a},W9=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,l=0,c=0;c<r;++c){var f=e[c],d=f==null?void 0:f[a];if(d!=null){var m=d[1],p=d[0],v=Ts(m)?p:m;v>=0?(d[0]=i,i+=v,d[1]=i):(d[0]=l,l+=v,d[1]=l)}}}},V9=e=>{var t,r=e.length;if(!(r<=0)){var n=(t=e[0])===null||t===void 0?void 0:t.length;if(!(n==null||n<=0))for(var a=0;a<n;++a)for(var i=0,l=0;l<r;++l){var c=e[l],f=c==null?void 0:c[a];if(f!=null){var d=Ts(f[1])?f[0]:f[1];d>=0?(f[0]=i,i+=d,f[1]=i):(f[0]=0,f[1]=0)}}}},G9={sign:W9,expand:f7,none:fc,silhouette:d7,wiggle:h7,positive:V9},K9=(e,t,r)=>{var n,a=(n=G9[r])!==null&&n!==void 0?n:fc,i=u7().keys(t).value((c,f)=>Number(Gr(c,f,0))).order(Rb).offset(a),l=i(e);return l.forEach((c,f)=>{c.forEach((d,m)=>{var p=Gr(e[m],t[f],0);Array.isArray(p)&&p.length===2&&gt(p[0])&&gt(p[1])&&(d[0]=p[0],d[1]=p[1])})}),l};function X9(e){return e==null?void 0:String(e)}var aj=e=>{var{axis:t,ticks:r,offset:n,bandSize:a,entry:i,index:l}=e;if(t.type==="category")return r[l]?r[l].coordinate+n:null;var c=Gr(i,t.dataKey,t.scale.domain()[l]);if(Jn(c))return null;var f=t.scale.map(c);return gt(f)?f-a/2+n:null},Y9=e=>{var{numericAxis:t}=e,r=t.scale.domain();if(t.type==="number"){var n=Math.min(r[0],r[1]),a=Math.max(r[0],r[1]);return n<=0&&a>=0?0:a<0?a:n}return r[0]},Q9=e=>{var t=e.flat(2).filter(gt);return[Math.min(...t),Math.max(...t)]},J9=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Z9=(e,t,r)=>{if(e!=null)return J9(Object.keys(e).reduce((n,a)=>{var i=e[a];if(!i)return n;var{stackedData:l}=i,c=l.reduce((f,d)=>{var m=II(d,t,r),p=Q9(m);return!rr(p[0])||!rr(p[1])?f:[Math.min(f[0],p[0]),Math.max(f[1],p[1])]},[1/0,-1/0]);return[Math.min(c[0],n[0]),Math.max(c[1],n[1])]},[1/0,-1/0]))},ij=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,sj=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,sp=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();if(!r||n>0)return n}if(e&&t&&t.length>=2){for(var a=ig(t,m=>m.coordinate),i=1/0,l=1,c=a.length;l<c;l++){var f=a[l],d=a[l-1];i=Math.min(((f==null?void 0:f.coordinate)||0)-((d==null?void 0:d.coordinate)||0),i)}return i===1/0?0:i}return r?void 0:0};function lj(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return Cu(Cu({},t),{},{dataKey:r,payload:n,value:a,name:i})}function pg(e,t){if(e)return String(e);if(typeof t=="string")return t}var e$=(e,t)=>{if(t==="horizontal")return e.chartX;if(t==="vertical")return e.chartY},t$=(e,t)=>t==="centric"?e.angle:e.radius,gl=e=>e.layout.width,vl=e=>e.layout.height,r$=e=>e.layout.scale,RI=e=>e.layout.margin,gg=Te(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),vg=Te(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),FI="data-recharts-item-index",LI="data-recharts-item-id",b0=60;function oj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function um(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oj(Object(r),!0).forEach(function(n){n$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n$(e,t,r){return(t=a$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a$(e){var t=i$(e,"string");return typeof t=="symbol"?t:t+""}function i$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s$=e=>e.brush.height;function l$(e){var t=vg(e);return t.reduce((r,n)=>{if(n.orientation==="left"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:b0;return r+a}return r},0)}function o$(e){var t=vg(e);return t.reduce((r,n)=>{if(n.orientation==="right"&&!n.mirror&&!n.hide){var a=typeof n.width=="number"?n.width:b0;return r+a}return r},0)}function c$(e){var t=gg(e);return t.reduce((r,n)=>n.orientation==="top"&&!n.mirror&&!n.hide?r+n.height:r,0)}function u$(e){var t=gg(e);return t.reduce((r,n)=>n.orientation==="bottom"&&!n.mirror&&!n.hide?r+n.height:r,0)}var Ln=Te([gl,vl,RI,s$,l$,o$,c$,u$,rI,RU],(e,t,r,n,a,i,l,c,f,d)=>{var m={left:(r.left||0)+a,right:(r.right||0)+i},p={top:(r.top||0)+l,bottom:(r.bottom||0)+c},v=um(um({},p),m),x=v.bottom;v.bottom+=n,v=H9(v,f,d);var y=e-v.left-v.right,b=t-v.top-v.bottom;return um(um({brushBottom:x},v),{},{width:Math.max(y,0),height:Math.max(b,0)})}),f$=Te(Ln,e=>({x:e.left,y:e.top,width:e.width,height:e.height})),w_=Te(gl,vl,(e,t)=>({x:0,y:0,width:e,height:t})),d$=N.createContext(null),Ja=()=>N.useContext(d$)!=null,xg=e=>e.brush,yg=Te([xg,Ln,RI],(e,t,r)=>({height:e.height,x:gt(e.x)?e.x:t.left,y:gt(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:gt(e.width)?e.width:t.width})),b1={},w1={},_1={},cj;function h$(){return cj||(cj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let l,c=null;const f=i!=null&&i.includes("leading"),d=i==null||i.includes("trailing"),m=()=>{c!==null&&(r.apply(l,c),l=void 0,c=null)},p=()=>{d&&m(),b()};let v=null;const x=()=>{v!=null&&clearTimeout(v),v=setTimeout(()=>{v=null,p()},n)},y=()=>{v!==null&&(clearTimeout(v),v=null)},b=()=>{y(),l=void 0,c=null},_=()=>{m()},E=function(...A){if(a!=null&&a.aborted)return;l=this,c=A;const T=v==null;x(),f&&T&&m()};return E.schedule=x,E.cancel=b,E.flush=_,a==null||a.addEventListener("abort",b,{once:!0}),E}e.debounce=t})(_1)),_1}var uj;function m$(){return uj||(uj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=h$();function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:l=!1,trailing:c=!0,maxWait:f}=i,d=Array(2);l&&(d[0]="leading"),c&&(d[1]="trailing");let m,p=null;const v=t.debounce(function(...b){m=n.apply(this,b),p=null},a,{edges:d}),x=function(...b){return f!=null&&(p===null&&(p=Date.now()),Date.now()-p>=f)?(m=n.apply(this,b),p=Date.now(),v.cancel(),v.schedule(),m):(v.apply(this,b),m)},y=()=>(v.flush(),m);return x.cancel=v.cancel,x.flush=y,x}e.debounce=r})(w1)),w1}var fj;function p$(){return fj||(fj=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=m$();function r(n,a=0,i={}){const{leading:l=!0,trailing:c=!0}=i;return t.debounce(n,a,{leading:l,maxWait:a,trailing:c})}e.throttle=r})(b1)),b1}var S1,dj;function g$(){return dj||(dj=1,S1=p$().throttle),S1}var v$=g$();const x$=Cs(v$);var lp=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];if(typeof console<"u"&&console.warn&&(r===void 0&&console.warn("LogUtils requires an error message argument"),!t))if(r===void 0)console.warn("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=0;console.warn(r.replace(/%s/g,()=>a[l++]))}},Ss={width:"100%",height:"100%",debounce:0,minWidth:0,initialDimension:{width:-1,height:-1}},BI=(e,t,r)=>{var{width:n=Ss.width,height:a=Ss.height,aspect:i,maxHeight:l}=r,c=hc(n)?e:Number(n),f=hc(a)?t:Number(a);return i&&i>0&&(c?f=c/i:f&&(c=f*i),l&&f!=null&&f>l&&(f=l)),{calculatedWidth:c,calculatedHeight:f}},y$={width:0,height:0,overflow:"visible"},b$={width:0,overflowX:"visible"},w$={height:0,overflowY:"visible"},_$={},S$=e=>{var{width:t,height:r}=e,n=hc(t),a=hc(r);return n&&a?y$:n?b$:a?w$:_$};function E$(e){var{width:t,height:r,aspect:n}=e,a=t,i=r;return a===void 0&&i===void 0?(a=Ss.width,i=Ss.height):a===void 0?a=n&&n>0?void 0:Ss.width:i===void 0&&(i=n&&n>0?void 0:Ss.height),{width:a,height:i}}function Kb(){return Kb=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Kb.apply(null,arguments)}function hj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hj(Object(r),!0).forEach(function(n){N$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function N$(e,t,r){return(t=k$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k$(e){var t=T$(e,"string");return typeof t=="symbol"?t:t+""}function T$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UI=N.createContext(Ss.initialDimension);function A$(e){return js(e.width)&&js(e.height)}function $I(e){var{children:t,width:r,height:n}=e,a=N.useMemo(()=>({width:r,height:n}),[r,n]);return A$(a)?N.createElement(UI.Provider,{value:a},t):null}var __=()=>N.useContext(UI),j$=N.forwardRef((e,t)=>{var{aspect:r,initialDimension:n=Ss.initialDimension,width:a,height:i,minWidth:l=Ss.minWidth,minHeight:c,maxHeight:f,children:d,debounce:m=Ss.debounce,id:p,className:v,onResize:x,style:y={}}=e,b=N.useRef(null),_=N.useRef();_.current=x,N.useImperativeHandle(t,()=>b.current);var[E,A]=N.useState({containerWidth:n.width,containerHeight:n.height}),T=N.useCallback((B,U)=>{A(Y=>{var te=Math.round(B),V=Math.round(U);return Y.containerWidth===te&&Y.containerHeight===V?Y:{containerWidth:te,containerHeight:V}})},[]);N.useEffect(()=>{if(b.current==null||typeof ResizeObserver>"u")return ef;var B=V=>{var ge,be=V[0];if(be!=null){var{width:ve,height:z}=be.contentRect;T(ve,z),(ge=_.current)===null||ge===void 0||ge.call(_,ve,z)}};m>0&&(B=x$(B,m,{trailing:!0,leading:!1}));var U=new ResizeObserver(B),{width:Y,height:te}=b.current.getBoundingClientRect();return T(Y,te),U.observe(b.current),()=>{U.disconnect()}},[T,m]);var{containerWidth:k,containerHeight:I}=E;lp(!r||r>0,"The aspect(%s) must be greater than zero.",r);var{calculatedWidth:O,calculatedHeight:j}=BI(k,I,{width:a,height:i,aspect:r,maxHeight:f});return lp(O!=null&&O>0||j!=null&&j>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,O,j,a,i,l,c,r),N.createElement("div",{id:p?"".concat(p):void 0,className:kr("recharts-responsive-container",v),style:mj(mj({},y),{},{width:a,height:i,minWidth:l,minHeight:c,maxHeight:f}),ref:b},N.createElement("div",{style:S$({width:a,height:i})},N.createElement($I,{width:O,height:j},d)))}),nc=N.forwardRef((e,t)=>{var r=__();if(js(r.width)&&js(r.height))return e.children;var{width:n,height:a}=E$({width:e.width,height:e.height,aspect:e.aspect}),{calculatedWidth:i,calculatedHeight:l}=BI(void 0,void 0,{width:n,height:a,aspect:e.aspect,maxHeight:e.maxHeight});return gt(i)&&gt(l)?N.createElement($I,{width:i,height:l},e.children):N.createElement(j$,Kb({},e,{width:n,height:a,ref:t}))});function S_(e){if(e)return{x:e.x,y:e.y,upperWidth:"upperWidth"in e?e.upperWidth:e.width,lowerWidth:"lowerWidth"in e?e.lowerWidth:e.width,width:e.width,height:e.height}}var bg=()=>{var e,t=Ja(),r=xt(f$),n=xt(yg),a=(e=xt(xg))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},O$={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},zI=()=>{var e;return(e=xt(Ln))!==null&&e!==void 0?e:O$},E_=()=>xt(gl),N_=()=>xt(vl),C$=()=>xt(e=>e.layout.margin),hr=e=>e.layout.layoutType,tf=()=>xt(hr),HI=()=>{var e=tf();if(e==="horizontal"||e==="vertical")return e},qI=e=>{var t=e.layout.layoutType;if(t==="centric"||t==="radial")return t},D$=()=>{var e=tf();return e!==void 0},w0=e=>{var t=Ur(),r=Ja(),{width:n,height:a}=e,i=__(),l=n,c=a;return i&&(l=i.width>0?i.width:n,c=i.height>0?i.height:a),N.useEffect(()=>{!r&&js(l)&&js(c)&&t(F9({width:l,height:c}))},[t,r,l,c]),null},WI=Symbol.for("immer-nothing"),pj=Symbol.for("immer-draftable"),yi=Symbol.for("immer-state");function ts(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Bd=Object.getPrototypeOf;function Hu(e){return!!e&&!!e[yi]}function pc(e){var t;return e?VI(e)||Array.isArray(e)||!!e[pj]||!!((t=e.constructor)!=null&&t[pj])||_0(e)||_g(e):!1}var I$=Object.prototype.constructor.toString(),gj=new WeakMap;function VI(e){if(!e||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);if(t===null||t===Object.prototype)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;if(r===Object)return!0;if(typeof r!="function")return!1;let n=gj.get(r);return n===void 0&&(n=Function.toString.call(r),gj.set(r,n)),n===I$}function op(e,t,r=!0){wg(e)===0?(r?Reflect.ownKeys(e):Object.keys(e)).forEach(a=>{t(a,e[a],e)}):e.forEach((n,a)=>t(a,n,e))}function wg(e){const t=e[yi];return t?t.type_:Array.isArray(e)?1:_0(e)?2:_g(e)?3:0}function Xb(e,t){return wg(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function GI(e,t,r){const n=wg(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function P$(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function _0(e){return e instanceof Map}function _g(e){return e instanceof Set}function Ho(e){return e.copy_||e.base_}function Yb(e,t){if(_0(e))return new Map(e);if(_g(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=VI(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[yi];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const l=a[i],c=n[l];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(n[l]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[l]})}return Object.create(Bd(e),n)}else{const n=Bd(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function k_(e,t=!1){return Sg(e)||Hu(e)||!pc(e)||(wg(e)>1&&Object.defineProperties(e,{set:fm,add:fm,clear:fm,delete:fm}),Object.freeze(e),t&&Object.values(e).forEach(r=>k_(r,!0))),e}function M$(){ts(2)}var fm={value:M$};function Sg(e){return e===null||typeof e!="object"?!0:Object.isFrozen(e)}var R$={};function gc(e){const t=R$[e];return t||ts(0,e),t}var Ud;function KI(){return Ud}function F$(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function vj(e,t){t&&(gc("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Qb(e){Jb(e),e.drafts_.forEach(L$),e.drafts_=null}function Jb(e){e===Ud&&(Ud=e.parent_)}function xj(e){return Ud=F$(Ud,e)}function L$(e){const t=e[yi];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function yj(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[yi].modified_&&(Qb(t),ts(4)),pc(e)&&(e=cp(t,e),t.parent_||up(t,e)),t.patches_&&gc("Patches").generateReplacementPatches_(r[yi].base_,e,t.patches_,t.inversePatches_)):e=cp(t,r,[]),Qb(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==WI?e:void 0}function cp(e,t,r){if(Sg(t))return t;const n=e.immer_.shouldUseStrictIteration(),a=t[yi];if(!a)return op(t,(i,l)=>bj(e,a,t,i,l,r),n),t;if(a.scope_!==e)return t;if(!a.modified_)return up(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const i=a.copy_;let l=i,c=!1;a.type_===3&&(l=new Set(i),i.clear(),c=!0),op(l,(f,d)=>bj(e,a,i,f,d,r,c),n),up(e,i,!1),r&&e.patches_&&gc("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function bj(e,t,r,n,a,i,l){if(a==null||typeof a!="object"&&!l)return;const c=Sg(a);if(!(c&&!l)){if(Hu(a)){const f=i&&t&&t.type_!==3&&!Xb(t.assigned_,n)?i.concat(n):void 0,d=cp(e,a,f);if(GI(r,n,d),Hu(d))e.canAutoFreeze_=!1;else return}else l&&r.add(a);if(pc(a)&&!c){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1||t&&t.base_&&t.base_[n]===a&&c)return;cp(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&(_0(r)?r.has(n):Object.prototype.propertyIsEnumerable.call(r,n))&&up(e,a)}}}function up(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&k_(t,r)}function B$(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:KI(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=T_;r&&(a=[n],i=$d);const{revoke:l,proxy:c}=Proxy.revocable(a,i);return n.draft_=c,n.revoke_=l,c}var T_={get(e,t){if(t===yi)return e;const r=Ho(e);if(!Xb(r,t))return U$(e,r,t);const n=r[t];return e.finalized_||!pc(n)?n:n===E1(e.base_,t)?(N1(e),e.copy_[t]=ew(n,e)):n},has(e,t){return t in Ho(e)},ownKeys(e){return Reflect.ownKeys(Ho(e))},set(e,t,r){const n=XI(Ho(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=E1(Ho(e),t),i=a==null?void 0:a[yi];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(P$(r,a)&&(r!==void 0||Xb(e.base_,t)))return!0;N1(e),Zb(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return E1(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,N1(e),Zb(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Ho(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){ts(11)},getPrototypeOf(e){return Bd(e.base_)},setPrototypeOf(){ts(12)}},$d={};op(T_,(e,t)=>{$d[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});$d.deleteProperty=function(e,t){return $d.set.call(this,e,t,void 0)};$d.set=function(e,t,r){return T_.set.call(this,e[0],t,r,e[0])};function E1(e,t){const r=e[yi];return(r?Ho(r):e)[t]}function U$(e,t,r){var a;const n=XI(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function XI(e,t){if(!(t in e))return;let r=Bd(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Bd(r)}}function Zb(e){e.modified_||(e.modified_=!0,e.parent_&&Zb(e.parent_))}function N1(e){e.copy_||(e.copy_=Yb(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var $$=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.useStrictIteration_=!0,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const l=this;return function(f=i,...d){return l.produce(f,m=>r.call(this,m,...d))}}typeof r!="function"&&ts(6),n!==void 0&&typeof n!="function"&&ts(7);let a;if(pc(t)){const i=xj(this),l=ew(t,void 0);let c=!0;try{a=r(l),c=!1}finally{c?Qb(i):Jb(i)}return vj(i,n),yj(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===WI&&(a=void 0),this.autoFreeze_&&k_(a,!0),n){const i=[],l=[];gc("Patches").generateReplacementPatches_(t,a,i,l),n(i,l)}return a}else ts(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(l,...c)=>this.produceWithPatches(l,f=>t(f,...c));let n,a;return[this.produce(t,r,(l,c)=>{n=l,a=c}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy),typeof(e==null?void 0:e.useStrictIteration)=="boolean"&&this.setUseStrictIteration(e.useStrictIteration)}createDraft(e){pc(e)||ts(8),Hu(e)&&(e=z$(e));const t=xj(this),r=ew(e,void 0);return r[yi].isManual_=!0,Jb(t),r}finishDraft(e,t){const r=e&&e[yi];(!r||!r.isManual_)&&ts(9);const{scope_:n}=r;return vj(n,t),yj(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}setUseStrictIteration(e){this.useStrictIteration_=e}shouldUseStrictIteration(){return this.useStrictIteration_}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=gc("Patches").applyPatches_;return Hu(e)?n(e,t):this.produce(e,a=>n(a,t))}};function ew(e,t){const r=_0(e)?gc("MapSet").proxyMap_(e,t):_g(e)?gc("MapSet").proxySet_(e,t):B$(e,t);return(t?t.scope_:KI()).drafts_.push(r),r}function z$(e){return Hu(e)||ts(10,e),YI(e)}function YI(e){if(!pc(e)||Sg(e))return e;const t=e[yi];let r,n=!0;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Yb(e,t.scope_.immer_.useStrictShallowCopy_),n=t.scope_.immer_.shouldUseStrictIteration()}else r=Yb(e,!0);return op(r,(a,i)=>{GI(r,a,YI(i))},n),t&&(t.finalized_=!1),r}var H$=new $$;H$.produce;var q$={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},QI=Qa({name:"legend",initialState:q$,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload:{reducer(e,t){e.payload.push(t.payload)},prepare:Jr()},replaceLegendPayload:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ss(e).payload.indexOf(r);a>-1&&(e.payload[a]=n)},prepare:Jr()},removeLegendPayload:{reducer(e,t){var r=ss(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)},prepare:Jr()}}}),{setLegendSize:wj,setLegendSettings:W$,addLegendPayload:JI,replaceLegendPayload:ZI,removeLegendPayload:eP}=QI.actions,V$=QI.reducer,G$=["contextPayload"];function tw(){return tw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tw.apply(null,arguments)}function _j(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_j(Object(r),!0).forEach(function(n){K$(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_j(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function K$(e,t,r){return(t=X$(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function X$(e){var t=Y$(e,"string");return typeof t=="symbol"?t:t+""}function Y$(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Q$(e,t){if(e==null)return{};var r,n,a=J$(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function J$(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Z$(e){return e.value}function ez(e){var{contextPayload:t}=e,r=Q$(e,G$),n=JD(t,e.payloadUniqBy,Z$),a=qu(qu({},r),{},{payload:n});return N.isValidElement(e.content)?N.cloneElement(e.content,a):typeof e.content=="function"?N.createElement(e.content,a):N.createElement(q7,a)}function tz(e,t,r,n,a,i){var{layout:l,align:c,verticalAlign:f}=t,d,m;return(!e||(e.left===void 0||e.left===null)&&(e.right===void 0||e.right===null))&&(c==="center"&&l==="vertical"?d={left:((n||0)-i.width)/2}:d=c==="right"?{right:r&&r.right||0}:{left:r&&r.left||0}),(!e||(e.top===void 0||e.top===null)&&(e.bottom===void 0||e.bottom===null))&&(f==="middle"?m={top:((a||0)-i.height)/2}:m=f==="bottom"?{bottom:r&&r.bottom||0}:{top:r&&r.top||0}),qu(qu({},d),m)}function rz(e){var t=Ur();return N.useEffect(()=>{t(W$(e))},[t,e]),null}function nz(e){var t=Ur();return N.useEffect(()=>(t(wj(e)),()=>{t(wj({width:0,height:0}))}),[t,e]),null}function az(e,t,r,n){return e==="vertical"&&t!=null?{height:t}:e==="horizontal"?{width:r||n}:null}var iz={align:"center",iconSize:14,inactiveColor:"#ccc",itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"};function A_(e){var t=Zn(e,iz),r=BU(),n=PB(),a=C$(),{width:i,height:l,wrapperStyle:c,portal:f}=t,[d,m]=nI([r]),p=E_(),v=N_();if(p==null||v==null)return null;var x=p-((a==null?void 0:a.left)||0)-((a==null?void 0:a.right)||0),y=az(t.layout,l,i,x),b=f?c:qu(qu({position:"absolute",width:(y==null?void 0:y.width)||i||"auto",height:(y==null?void 0:y.height)||l||"auto"},tz(c,t,a,p,v,d)),c),_=f??n;if(_==null||r==null)return null;var E=N.createElement("div",{className:"recharts-legend-wrapper",style:b,ref:m},N.createElement(rz,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),!f&&N.createElement(nz,{width:d.width,height:d.height}),N.createElement(ez,tw({},t,y,{margin:a,chartWidth:p,chartHeight:v,contextPayload:r})));return a_.createPortal(E,_)}A_.displayName="Legend";function rw(){return rw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rw.apply(null,arguments)}function Sj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function id(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Sj(Object(r),!0).forEach(function(n){sz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Sj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function sz(e,t,r){return(t=lz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lz(e){var t=oz(e,"string");return typeof t=="symbol"?t:t+""}function oz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cz(e){return Array.isArray(e)&&As(e[0])&&As(e[1])?e.join(" ~ "):e}var hu={separator:" : ",contentStyle:{margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},itemStyle:{display:"block",paddingTop:4,paddingBottom:4,color:"#000"},labelStyle:{},accessibilityLayer:!1},uz=e=>{var{separator:t=hu.separator,contentStyle:r,itemStyle:n,labelStyle:a=hu.labelStyle,payload:i,formatter:l,itemSorter:c,wrapperClassName:f,labelClassName:d,label:m,labelFormatter:p,accessibilityLayer:v=hu.accessibilityLayer}=e,x=()=>{if(i&&i.length){var I={padding:0,margin:0},O=(c?ig(i,c):i).map((j,B)=>{if(j.type==="none")return null;var U=j.formatter||l||cz,{value:Y,name:te}=j,V=Y,ge=te;if(U){var be=U(Y,te,j,B,i);if(Array.isArray(be))[V,ge]=be;else if(be!=null)V=be;else return null}var ve=id(id({},hu.itemStyle),{},{color:j.color||hu.itemStyle.color},n);return N.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(B),style:ve},As(ge)?N.createElement("span",{className:"recharts-tooltip-item-name"},ge):null,As(ge)?N.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,N.createElement("span",{className:"recharts-tooltip-item-value"},V),N.createElement("span",{className:"recharts-tooltip-item-unit"},j.unit||""))});return N.createElement("ul",{className:"recharts-tooltip-item-list",style:I},O)}return null},y=id(id({},hu.contentStyle),r),b=id({margin:0},a),_=!Jn(m),E=_?m:"",A=kr("recharts-default-tooltip",f),T=kr("recharts-tooltip-label",d);_&&p&&i!==void 0&&i!==null&&(E=p(m,i));var k=v?{role:"status","aria-live":"assertive"}:{};return N.createElement("div",rw({className:A,style:y},k),N.createElement("p",{className:T,style:b},N.isValidElement(E)?E:"".concat(E)),x())},sd="recharts-tooltip-wrapper",fz={visibility:"hidden"};function dz(e){var{coordinate:t,translateX:r,translateY:n}=e;return kr(sd,{["".concat(sd,"-right")]:gt(r)&&t&&gt(t.x)&&r>=t.x,["".concat(sd,"-left")]:gt(r)&&t&&gt(t.x)&&r<t.x,["".concat(sd,"-bottom")]:gt(n)&&t&&gt(t.y)&&n>=t.y,["".concat(sd,"-top")]:gt(n)&&t&&gt(t.y)&&n<t.y})}function Ej(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offset:a,position:i,reverseDirection:l,tooltipDimension:c,viewBox:f,viewBoxDimension:d}=e;if(i&&gt(i[n]))return i[n];var m=r[n]-c-(a>0?a:0),p=r[n]+a;if(t[n])return l[n]?m:p;var v=f[n];if(v==null)return 0;if(l[n]){var x=m,y=v;return x<y?Math.max(p,v):Math.max(m,v)}if(d==null)return 0;var b=p+c,_=v+d;return b>_?Math.max(m,v):Math.max(p,v)}function hz(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function mz(e){var{allowEscapeViewBox:t,coordinate:r,offsetTop:n,offsetLeft:a,position:i,reverseDirection:l,tooltipBox:c,useTranslate3d:f,viewBox:d}=e,m,p,v;return c.height>0&&c.width>0&&r?(p=Ej({allowEscapeViewBox:t,coordinate:r,key:"x",offset:a,position:i,reverseDirection:l,tooltipDimension:c.width,viewBox:d,viewBoxDimension:d.width}),v=Ej({allowEscapeViewBox:t,coordinate:r,key:"y",offset:n,position:i,reverseDirection:l,tooltipDimension:c.height,viewBox:d,viewBoxDimension:d.height}),m=hz({translateX:p,translateY:v,useTranslate3d:f})):m=fz,{cssProperties:m,cssClasses:dz({translateX:p,translateY:v,coordinate:r})}}function Nj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Nj(Object(r),!0).forEach(function(n){nw(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Nj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nw(e,t,r){return(t=pz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pz(e){var t=gz(e,"string");return typeof t=="symbol"?t:t+""}function gz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class vz extends N.PureComponent{constructor(){super(...arguments),nw(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),nw(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:l,hasPayload:c,isAnimationActive:f,offset:d,position:m,reverseDirection:p,useTranslate3d:v,viewBox:x,wrapperStyle:y,lastBoundingBox:b,innerRef:_,hasPortalFromProps:E}=this.props,A=typeof d=="number"?d:d.x,T=typeof d=="number"?d:d.y,{cssClasses:k,cssProperties:I}=mz({allowEscapeViewBox:r,coordinate:l,offsetLeft:A,offsetTop:T,position:m,reverseDirection:p,tooltipBox:{height:b.height,width:b.width},useTranslate3d:v,viewBox:x}),O=E?{}:dm(dm({transition:f&&t?"transform ".concat(n,"ms ").concat(a):void 0},I),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&c?"visible":"hidden",position:"absolute",top:0,left:0}),j=dm(dm({},O),{},{visibility:!this.state.dismissed&&t&&c?"visible":"hidden"},y);return N.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:k,style:j,ref:_},i)}}var tP=()=>{var e;return(e=xt(t=>t.rootProps.accessibilityLayer))!==null&&e!==void 0?e:!0};function aw(){return aw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},aw.apply(null,arguments)}function kj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?kj(Object(r),!0).forEach(function(n){xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):kj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xz(e,t,r){return(t=yz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yz(e){var t=bz(e,"string");return typeof t=="symbol"?t:t+""}function bz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Aj={curveBasisClosed:ZB,curveBasisOpen:e7,curveBasis:JB,curveBumpX:LB,curveBumpY:BB,curveLinearClosed:t7,curveLinear:ng,curveMonotoneX:r7,curveMonotoneY:n7,curveNatural:a7,curveStep:i7,curveStepAfter:l7,curveStepBefore:s7},fp=e=>rr(e.x)&&rr(e.y),jj=e=>e.base!=null&&fp(e.base)&&fp(e),ld=e=>e.x,od=e=>e.y,wz=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(g0(e));if((r==="curveMonotone"||r==="curveBump")&&t){var n=Aj["".concat(r).concat(t==="vertical"?"Y":"X")];if(n)return n}return Aj[r]||ng},Oj={connectNulls:!1,type:"linear"},_z=e=>{var{type:t=Oj.type,points:r=[],baseLine:n,layout:a,connectNulls:i=Oj.connectNulls}=e,l=wz(t,a),c=i?r.filter(fp):r;if(Array.isArray(n)){var f,d=r.map((y,b)=>Tj(Tj({},y),{},{base:n[b]}));a==="vertical"?f=am().y(od).x1(ld).x0(y=>y.base.x):f=am().x(ld).y1(od).y0(y=>y.base.y);var m=f.defined(jj).curve(l),p=i?d.filter(jj):d;return m(p)}var v;a==="vertical"&&gt(n)?v=am().y(od).x1(ld).x0(n):gt(n)?v=am().x(ld).y1(od).y0(n):v=jD().x(ld).y(od);var x=v.defined(fp).curve(l);return x(c)},j_=e=>{var{className:t,points:r,path:n,pathRef:a}=e,i=tf();if((!r||!r.length)&&!n)return null;var l={type:e.type,points:e.points,baseLine:e.baseLine,layout:e.layout||i,connectNulls:e.connectNulls},c=r&&r.length?_z(l):n;return N.createElement("path",aw({},cs(e),C7(e),{className:kr("recharts-curve",t),d:c===null?void 0:c,ref:a}))},Sz=["x","y","top","left","width","height","className"];function iw(){return iw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},iw.apply(null,arguments)}function Cj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ez(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Cj(Object(r),!0).forEach(function(n){Nz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Cj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Nz(e,t,r){return(t=kz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kz(e){var t=Tz(e,"string");return typeof t=="symbol"?t:t+""}function Tz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Az(e,t){if(e==null)return{};var r,n,a=jz(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jz(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Oz=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),Cz=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:l=0,className:c}=e,f=Az(e,Sz),d=Ez({x:t,y:r,top:n,left:a,width:i,height:l},f);return!gt(t)||!gt(r)||!gt(i)||!gt(l)||!gt(n)||!gt(a)?null:N.createElement("path",iw({},$i(d),{className:kr("recharts-cross",c),d:Oz(t,r,i,l,n,a)}))};function Dz(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Dj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ij(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Dj(Object(r),!0).forEach(function(n){Iz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Dj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Iz(e,t,r){return(t=Pz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Pz(e){var t=Mz(e,"string");return typeof t=="symbol"?t:t+""}function Mz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rz=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),rP=(e,t,r)=>e.map(n=>"".concat(Rz(n)," ").concat(t,"ms ").concat(r)).join(","),Fz=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),zd=(e,t)=>Object.keys(t).reduce((r,n)=>Ij(Ij({},r),{},{[n]:e(n,t[n])}),{});function Pj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Mn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Pj(Object(r),!0).forEach(function(n){Lz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Pj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Lz(e,t,r){return(t=Bz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Bz(e){var t=Uz(e,"string");return typeof t=="symbol"?t:t+""}function Uz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dp=(e,t,r)=>e+(t-e)*r,sw=e=>{var{from:t,to:r}=e;return t!==r},nP=(e,t,r)=>{var n=zd((a,i)=>{if(sw(i)){var[l,c]=e(i.from,i.to,i.velocity);return Mn(Mn({},i),{},{from:l,velocity:c})}return i},t);return r<1?zd((a,i)=>sw(i)&&n[a]!=null?Mn(Mn({},i),{},{velocity:dp(i.velocity,n[a].velocity,r),from:dp(i.from,n[a].from,r)}):i,t):nP(e,n,r-1)};function $z(e,t,r,n,a,i){var l,c=n.reduce((v,x)=>Mn(Mn({},v),{},{[x]:{from:e[x],velocity:0,to:t[x]}}),{}),f=()=>zd((v,x)=>x.from,c),d=()=>!Object.values(c).filter(sw).length,m=null,p=v=>{l||(l=v);var x=v-l,y=x/r.dt;c=nP(r,c,y),a(Mn(Mn(Mn({},e),t),f())),l=v,d()||(m=i.setTimeout(p))};return()=>(m=i.setTimeout(p),()=>{var v;(v=m)===null||v===void 0||v()})}function zz(e,t,r,n,a,i,l){var c=null,f=a.reduce((p,v)=>{var x=e[v],y=t[v];return x==null||y==null?p:Mn(Mn({},p),{},{[v]:[x,y]})},{}),d,m=p=>{d||(d=p);var v=(p-d)/n,x=zd((b,_)=>dp(..._,r(v)),f);if(i(Mn(Mn(Mn({},e),t),x)),v<1)c=l.setTimeout(m);else{var y=zd((b,_)=>dp(..._,r(1)),f);i(Mn(Mn(Mn({},e),t),y))}};return()=>(c=l.setTimeout(m),()=>{var p;(p=c)===null||p===void 0||p()})}const Hz=(e,t,r,n,a,i)=>{var l=Fz(e,t);return r==null?()=>(a(Mn(Mn({},e),t)),()=>{}):r.isStepper===!0?$z(e,t,r,l,a,i):zz(e,t,r,n,l,a,i)};var hp=1e-4,aP=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],iP=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),Mj=(e,t)=>r=>{var n=aP(e,t);return iP(n,r)},qz=(e,t)=>r=>{var n=aP(e,t),a=[...n.map((i,l)=>i*l).slice(1),0];return iP(a,r)},Wz=e=>{var t,r=e.split("(");if(r.length!==2||r[0]!=="cubic-bezier")return null;var n=(t=r[1])===null||t===void 0||(t=t.split(")")[0])===null||t===void 0?void 0:t.split(",");if(n==null||n.length!==4)return null;var a=n.map(i=>parseFloat(i));return[a[0],a[1],a[2],a[3]]},Vz=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(r.length===1)switch(r[0]){case"linear":return[0,0,1,1];case"ease":return[.25,.1,.25,1];case"ease-in":return[.42,0,1,1];case"ease-out":return[.42,0,.58,1];case"ease-in-out":return[0,0,.58,1];default:{var a=Wz(r[0]);if(a)return a}}return r.length===4?r:[0,0,1,1]},Gz=(e,t,r,n)=>{var a=Mj(e,r),i=Mj(t,n),l=qz(e,r),c=d=>d>1?1:d<0?0:d,f=d=>{for(var m=d>1?1:d,p=m,v=0;v<8;++v){var x=a(p)-m,y=l(p);if(Math.abs(x-m)<hp||y<hp)return i(p);p=c(p-x/y)}return i(p)};return f.isStepper=!1,f},Rj=function(){return Gz(...Vz(...arguments))},Kz=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(l,c,f)=>{var d=-(l-c)*r,m=f*n,p=f+(d-m)*a/1e3,v=f*a/1e3+l;return Math.abs(v-c)<hp&&Math.abs(p)<hp?[c,0]:[v,p]};return i.isStepper=!0,i.dt=a,i},Xz=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Rj(e);case"spring":return Kz();default:if(e.split("(")[0]==="cubic-bezier")return Rj(e)}return typeof e=="function"?e:null};function Yz(e){var t,r=()=>null,n=!1,a=null,i=l=>{if(!n){if(Array.isArray(l)){if(!l.length)return;var c=l,[f,...d]=c;if(typeof f=="number"){a=e.setTimeout(i.bind(null,d),f);return}i(f),a=e.setTimeout(i.bind(null,d));return}typeof l=="string"&&(t=l,r(t)),typeof l=="object"&&(t=l,r(t)),typeof l=="function"&&l()}};return{stop:()=>{n=!0},start:l=>{n=!1,a&&(a(),a=null),i(l)},subscribe:l=>(r=l,()=>{r=()=>null}),getTimeoutController:()=>e}}class Qz{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=l=>{l-n>=r?t(l):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{a!=null&&cancelAnimationFrame(a)}}}function Jz(){return Yz(new Qz)}var Zz=N.createContext(Jz);function eH(e,t){var r=N.useContext(Zz);return N.useMemo(()=>t??r(e),[e,t,r])}var tH=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Eg={isSsr:tH()},rH={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},Fj={t:0},k1={t:1};function Ng(e){var t=Zn(e,rH),{isActive:r,canBegin:n,duration:a,easing:i,begin:l,onAnimationEnd:c,onAnimationStart:f,children:d}=t,m=r==="auto"?!Eg.isSsr:r,p=eH(t.animationId,t.animationManager),[v,x]=N.useState(m?Fj:k1),y=N.useRef(null);return N.useEffect(()=>{m||x(k1)},[m]),N.useEffect(()=>{if(!m||!n)return ef;var b=Hz(Fj,k1,Xz(i),a,x,p.getTimeoutController()),_=()=>{y.current=b()};return p.start([f,l,_,a,c]),()=>{p.stop(),y.current&&y.current(),c()}},[m,n,a,i,l,f,c,p]),d(v.t)}function kg(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=N.useRef(Md(t)),n=N.useRef(e);return n.current!==e&&(r.current=Md(t),n.current=e),r.current}var nH=["radius"],aH=["radius"],Lj,Bj,Uj,$j,zj,Hj,qj,Wj,Vj,Gj;function Kj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xj(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kj(Object(r),!0).forEach(function(n){iH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iH(e,t,r){return(t=sH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sH(e){var t=lH(e,"string");return typeof t=="symbol"?t:t+""}function lH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mp(){return mp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},mp.apply(null,arguments)}function Yj(e,t){if(e==null)return{};var r,n,a=oH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function vs(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var Qj=(e,t,r,n,a)=>{var i=ro(r),l=ro(n),c=Math.min(Math.abs(i)/2,Math.abs(l)/2),f=l>=0?1:-1,d=i>=0?1:-1,m=l>=0&&i>=0||l<0&&i<0?1:0,p;if(c>0&&Array.isArray(a)){for(var v=[0,0,0,0],x=0,y=4;x<y;x++){var b,_=(b=a[x])!==null&&b!==void 0?b:0;v[x]=_>c?c:_}p=cn(Lj||(Lj=vs(["M",",",""])),e,t+f*v[0]),v[0]>0&&(p+=cn(Bj||(Bj=vs(["A ",",",",0,0,",",",",",""])),v[0],v[0],m,e+d*v[0],t)),p+=cn(Uj||(Uj=vs(["L ",",",""])),e+r-d*v[1],t),v[1]>0&&(p+=cn($j||($j=vs(["A ",",",",0,0,",`,
        `,",",""])),v[1],v[1],m,e+r,t+f*v[1])),p+=cn(zj||(zj=vs(["L ",",",""])),e+r,t+n-f*v[2]),v[2]>0&&(p+=cn(Hj||(Hj=vs(["A ",",",",0,0,",`,
        `,",",""])),v[2],v[2],m,e+r-d*v[2],t+n)),p+=cn(qj||(qj=vs(["L ",",",""])),e+d*v[3],t+n),v[3]>0&&(p+=cn(Wj||(Wj=vs(["A ",",",",0,0,",`,
        `,",",""])),v[3],v[3],m,e,t+n-f*v[3])),p+="Z"}else if(c>0&&a===+a&&a>0){var E=Math.min(c,a);p=cn(Vj||(Vj=vs(["M ",",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",",",`
            L `,",",`
            A `,",",",0,0,",",",","," Z"])),e,t+f*E,E,E,m,e+d*E,t,e+r-d*E,t,E,E,m,e+r,t+f*E,e+r,t+n-f*E,E,E,m,e+r-d*E,t+n,e+d*E,t+n,E,E,m,e,t+n-f*E)}else p=cn(Gj||(Gj=vs(["M ",","," h "," v "," h "," Z"])),e,t,r,n,-r);return p},Jj={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},sP=e=>{var t=Zn(e,Jj),r=N.useRef(null),[n,a]=N.useState(-1);N.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var ue=r.current.getTotalLength();ue&&a(ue)}catch{}},[]);var{x:i,y:l,width:c,height:f,radius:d,className:m}=t,{animationEasing:p,animationDuration:v,animationBegin:x,isAnimationActive:y,isUpdateAnimationActive:b}=t,_=N.useRef(c),E=N.useRef(f),A=N.useRef(i),T=N.useRef(l),k=N.useMemo(()=>({x:i,y:l,width:c,height:f,radius:d}),[i,l,c,f,d]),I=kg(k,"rectangle-");if(i!==+i||l!==+l||c!==+c||f!==+f||c===0||f===0)return null;var O=kr("recharts-rectangle",m);if(!b){var j=$i(t),{radius:B}=j,U=Yj(j,nH);return N.createElement("path",mp({},U,{x:ro(i),y:ro(l),width:ro(c),height:ro(f),radius:typeof d=="number"?d:void 0,className:O,d:Qj(i,l,c,f,d)}))}var Y=_.current,te=E.current,V=A.current,ge=T.current,be="0px ".concat(n===-1?1:n,"px"),ve="".concat(n,"px 0px"),z=rP(["strokeDasharray"],v,typeof p=="string"?p:Jj.animationEasing);return N.createElement(Ng,{animationId:I,key:I,canBegin:n>0,duration:v,easing:p,isActive:b,begin:x},ue=>{var se=Pn(Y,c,ue),Q=Pn(te,f,ue),re=Pn(V,i,ue),G=Pn(ge,l,ue);r.current&&(_.current=se,E.current=Q,A.current=re,T.current=G);var P;y?ue>0?P={transition:z,strokeDasharray:ve}:P={strokeDasharray:be}:P={strokeDasharray:ve};var W=$i(t),{radius:F}=W,M=Yj(W,aH);return N.createElement("path",mp({},M,{radius:typeof d=="number"?d:void 0,className:O,d:Qj(re,G,se,Q,d),ref:r,style:Xj(Xj({},P),t.style)}))})};function Zj(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function eO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zj(Object(r),!0).forEach(function(n){cH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zj(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cH(e,t,r){return(t=uH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uH(e){var t=fH(e,"string");return typeof t=="symbol"?t:t+""}function fH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pp=Math.PI/180,dH=e=>e*180/Math.PI,On=(e,t,r,n)=>({x:e+Math.cos(-pp*n)*r,y:t+Math.sin(-pp*n)*r}),lP=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},hH=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},mH=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,l=hH({x:r,y:n},{x:a,y:i});if(l<=0)return{radius:l,angle:0};var c=(r-a)/l,f=Math.acos(c);return n>i&&(f=2*Math.PI-f),{radius:l,angle:dH(f),angleInRadian:f}},pH=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},gH=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),l=Math.min(a,i);return e+l*360},vH=(e,t)=>{var{chartX:r,chartY:n}=e,{radius:a,angle:i}=mH({x:r,y:n},t),{innerRadius:l,outerRadius:c}=t;if(a<l||a>c||a===0)return null;var{startAngle:f,endAngle:d}=pH(t),m=i,p;if(f<=d){for(;m>d;)m-=360;for(;m<f;)m+=360;p=m>=f&&m<=d}else{for(;m>f;)m-=360;for(;m<d;)m+=360;p=m>=d&&m<=f}return p?eO(eO({},t),{},{radius:a,angle:gH(m,t)}):null};function oP(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,l=On(t,r,n,a),c=On(t,r,n,i);return{points:[l,c],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}var tO,rO,nO,aO,iO,sO,lO;function lw(){return lw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lw.apply(null,arguments)}function Yo(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var xH=(e,t)=>{var r=Yn(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},hm=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:l,cornerRadius:c,cornerIsExternal:f}=e,d=c*(l?1:-1)+n,m=Math.asin(c/d)/pp,p=f?a:a+i*m,v=On(t,r,d,p),x=On(t,r,n,p),y=f?a-i*m:a,b=On(t,r,d*Math.cos(m*pp),y);return{center:v,circleTangency:x,lineTangency:b,theta:m}},cP=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:l}=e,c=xH(i,l),f=i+c,d=On(t,r,a,i),m=On(t,r,a,f),p=cn(tO||(tO=Yo(["M ",",",`
    A `,",",`,0,
    `,",",`,
    `,",",`
  `])),d.x,d.y,a,a,+(Math.abs(c)>180),+(i>f),m.x,m.y);if(n>0){var v=On(t,r,n,i),x=On(t,r,n,f);p+=cn(rO||(rO=Yo(["L ",",",`
            A `,",",`,0,
            `,",",`,
            `,","," Z"])),x.x,x.y,n,n,+(Math.abs(c)>180),+(i<=f),v.x,v.y)}else p+=cn(nO||(nO=Yo(["L ",","," Z"])),t,r);return p},yH=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:l,cornerIsExternal:c,startAngle:f,endAngle:d}=e,m=Yn(d-f),{circleTangency:p,lineTangency:v,theta:x}=hm({cx:t,cy:r,radius:a,angle:f,sign:m,cornerRadius:i,cornerIsExternal:c}),{circleTangency:y,lineTangency:b,theta:_}=hm({cx:t,cy:r,radius:a,angle:d,sign:-m,cornerRadius:i,cornerIsExternal:c}),E=c?Math.abs(f-d):Math.abs(f-d)-x-_;if(E<0)return l?cn(aO||(aO=Yo(["M ",",",`
        a`,",",",0,0,1,",`,0
        a`,",",",0,0,1,",`,0
      `])),v.x,v.y,i,i,i*2,i,i,-i*2):cP({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:f,endAngle:d});var A=cn(iO||(iO=Yo(["M ",",",`
    A`,",",",0,0,",",",",",`
    A`,",",",0,",",",",",",",`
    A`,",",",0,0,",",",",",`
  `])),v.x,v.y,i,i,+(m<0),p.x,p.y,a,a,+(E>180),+(m<0),y.x,y.y,i,i,+(m<0),b.x,b.y);if(n>0){var{circleTangency:T,lineTangency:k,theta:I}=hm({cx:t,cy:r,radius:n,angle:f,sign:m,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),{circleTangency:O,lineTangency:j,theta:B}=hm({cx:t,cy:r,radius:n,angle:d,sign:-m,isExternal:!0,cornerRadius:i,cornerIsExternal:c}),U=c?Math.abs(f-d):Math.abs(f-d)-I-B;if(U<0&&i===0)return"".concat(A,"L").concat(t,",").concat(r,"Z");A+=cn(sO||(sO=Yo(["L",",",`
      A`,",",",0,0,",",",",",`
      A`,",",",0,",",",",",",",`
      A`,",",",0,0,",",",",","Z"])),j.x,j.y,i,i,+(m<0),O.x,O.y,n,n,+(U>180),+(m>0),T.x,T.y,i,i,+(m<0),k.x,k.y)}else A+=cn(lO||(lO=Yo(["L",",","Z"])),t,r);return A},bH={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},uP=e=>{var t=Zn(e,bH),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:l,forceCornerRadius:c,cornerIsExternal:f,startAngle:d,endAngle:m,className:p}=t;if(i<a||d===m)return null;var v=kr("recharts-sector",p),x=i-a,y=ka(l,x,0,!0),b;return y>0&&Math.abs(d-m)<360?b=yH({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(y,x/2),forceCornerRadius:c,cornerIsExternal:f,startAngle:d,endAngle:m}):b=cP({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:d,endAngle:m}),N.createElement("path",lw({},$i(t),{className:v,d:b}))};function wH(e,t,r){if(e==="horizontal")return[{x:t.x,y:r.top},{x:t.x,y:r.top+r.height}];if(e==="vertical")return[{x:r.left,y:t.y},{x:r.left+r.width,y:t.y}];if(HD(t)){if(e==="centric"){var{cx:n,cy:a,innerRadius:i,outerRadius:l,angle:c}=t,f=On(n,a,i,c),d=On(n,a,l,c);return[{x:f.x,y:f.y},{x:d.x,y:d.y}]}return oP(t)}}var T1={},A1={},j1={},oO;function _H(){return oO||(oO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=eI();function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(j1)),j1}var cO;function SH(){return cO||(cO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_H();function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(A1)),A1}var uO;function EH(){return uO||(uO=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tI(),r=SH();function n(a,i,l){l&&typeof l!="number"&&t.isIterateeCall(a,i,l)&&(i=l=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),l=l===void 0?a<i?1:-1:r.toFinite(l);const c=Math.max(Math.ceil((i-a)/(l||1)),0),f=new Array(c);for(let d=0;d<c;d++)f[d]=a,a+=l;return f}e.range=n})(T1)),T1}var O1,fO;function NH(){return fO||(fO=1,O1=EH().range),O1}var kH=NH();const fP=Cs(kH);function io(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function TH(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function O_(e){let t,r,n;e.length!==2?(t=io,r=(c,f)=>io(e(c),f),n=(c,f)=>e(c)-f):(t=e===io||e===TH?e:AH,r=e,n=e);function a(c,f,d=0,m=c.length){if(d<m){if(t(f,f)!==0)return m;do{const p=d+m>>>1;r(c[p],f)<0?d=p+1:m=p}while(d<m)}return d}function i(c,f,d=0,m=c.length){if(d<m){if(t(f,f)!==0)return m;do{const p=d+m>>>1;r(c[p],f)<=0?d=p+1:m=p}while(d<m)}return d}function l(c,f,d=0,m=c.length){const p=a(c,f,d,m-1);return p>d&&n(c[p-1],f)>-n(c[p],f)?p-1:p}return{left:a,center:l,right:i}}function AH(){return 0}function dP(e){return e===null?NaN:+e}function*jH(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const OH=O_(io),S0=OH.right;O_(dP).center;class dO extends Map{constructor(t,r=IH){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(hO(this,t))}has(t){return super.has(hO(this,t))}set(t,r){return super.set(CH(this,t),r)}delete(t){return super.delete(DH(this,t))}}function hO({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function CH({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function DH({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function IH(e){return e!==null&&typeof e=="object"?e.valueOf():e}function PH(e=io){if(e===io)return hP;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function hP(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const MH=Math.sqrt(50),RH=Math.sqrt(10),FH=Math.sqrt(2);function gp(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),l=i>=MH?10:i>=RH?5:i>=FH?2:1;let c,f,d;return a<0?(d=Math.pow(10,-a)/l,c=Math.round(e*d),f=Math.round(t*d),c/d<e&&++c,f/d>t&&--f,d=-d):(d=Math.pow(10,a)*l,c=Math.round(e/d),f=Math.round(t/d),c*d<e&&++c,f*d>t&&--f),f<c&&.5<=r&&r<2?gp(e,t,r*2):[c,f,d]}function ow(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,l]=n?gp(t,e,r):gp(e,t,r);if(!(i>=a))return[];const c=i-a+1,f=new Array(c);if(n)if(l<0)for(let d=0;d<c;++d)f[d]=(i-d)/-l;else for(let d=0;d<c;++d)f[d]=(i-d)*l;else if(l<0)for(let d=0;d<c;++d)f[d]=(a+d)/-l;else for(let d=0;d<c;++d)f[d]=(a+d)*l;return f}function cw(e,t,r){return t=+t,e=+e,r=+r,gp(e,t,r)[2]}function uw(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?cw(t,e,r):cw(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function mO(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function pO(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function mP(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?hP:PH(a);n>r;){if(n-r>600){const f=n-r+1,d=t-r+1,m=Math.log(f),p=.5*Math.exp(2*m/3),v=.5*Math.sqrt(m*p*(f-p)/f)*(d-f/2<0?-1:1),x=Math.max(r,Math.floor(t-d*p/f+v)),y=Math.min(n,Math.floor(t+(f-d)*p/f+v));mP(e,t,x,y,a)}const i=e[t];let l=r,c=n;for(cd(e,r,t),a(e[n],i)>0&&cd(e,r,n);l<c;){for(cd(e,l,c),++l,--c;a(e[l],i)<0;)++l;for(;a(e[c],i)>0;)--c}a(e[r],i)===0?cd(e,r,c):(++c,cd(e,c,n)),c<=t&&(r=c+1),t<=c&&(n=c-1)}return e}function cd(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function LH(e,t,r){if(e=Float64Array.from(jH(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return pO(e);if(t>=1)return mO(e);var n,a=(n-1)*t,i=Math.floor(a),l=mO(mP(e,i).subarray(0,i+1)),c=pO(e.subarray(i+1));return l+(c-l)*(a-i)}}function BH(e,t,r=dP){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),l=+r(e[i],i,e),c=+r(e[i+1],i+1,e);return l+(c-l)*(a-i)}}function UH(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function Wi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function xl(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const fw=Symbol("implicit");function C_(){var e=new dO,t=[],r=[],n=fw;function a(i){let l=e.get(i);if(l===void 0){if(n!==fw)return n;e.set(i,l=t.push(i)-1)}return r[l%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new dO;for(const l of i)e.has(l)||e.set(l,t.push(l)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return C_(t,r).unknown(n)},Wi.apply(a,arguments),a}function D_(){var e=C_().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,l,c=!1,f=0,d=0,m=.5;delete e.unknown;function p(){var v=t().length,x=a<n,y=x?a:n,b=x?n:a;i=(b-y)/Math.max(1,v-f+d*2),c&&(i=Math.floor(i)),y+=(b-y-i*(v-f))*m,l=i*(1-f),c&&(y=Math.round(y),l=Math.round(l));var _=UH(v).map(function(E){return y+i*E});return r(x?_.reverse():_)}return e.domain=function(v){return arguments.length?(t(v),p()):t()},e.range=function(v){return arguments.length?([n,a]=v,n=+n,a=+a,p()):[n,a]},e.rangeRound=function(v){return[n,a]=v,n=+n,a=+a,c=!0,p()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(v){return arguments.length?(c=!!v,p()):c},e.padding=function(v){return arguments.length?(f=Math.min(1,d=+v),p()):f},e.paddingInner=function(v){return arguments.length?(f=Math.min(1,v),p()):f},e.paddingOuter=function(v){return arguments.length?(d=+v,p()):d},e.align=function(v){return arguments.length?(m=Math.max(0,Math.min(1,v)),p()):m},e.copy=function(){return D_(t(),[n,a]).round(c).paddingInner(f).paddingOuter(d).align(m)},Wi.apply(p(),arguments)}function pP(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return pP(t())},e}function $H(){return pP(D_.apply(null,arguments).paddingInner(1))}function I_(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function gP(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function E0(){}var Hd=.7,vp=1/Hd,Ru="\\s*([+-]?\\d+)\\s*",qd="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ks="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",zH=/^#([0-9a-f]{3,8})$/,HH=new RegExp(`^rgb\\(${Ru},${Ru},${Ru}\\)$`),qH=new RegExp(`^rgb\\(${ks},${ks},${ks}\\)$`),WH=new RegExp(`^rgba\\(${Ru},${Ru},${Ru},${qd}\\)$`),VH=new RegExp(`^rgba\\(${ks},${ks},${ks},${qd}\\)$`),GH=new RegExp(`^hsl\\(${qd},${ks},${ks}\\)$`),KH=new RegExp(`^hsla\\(${qd},${ks},${ks},${qd}\\)$`),gO={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};I_(E0,Wd,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:vO,formatHex:vO,formatHex8:XH,formatHsl:YH,formatRgb:xO,toString:xO});function vO(){return this.rgb().formatHex()}function XH(){return this.rgb().formatHex8()}function YH(){return vP(this).formatHsl()}function xO(){return this.rgb().formatRgb()}function Wd(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=zH.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?yO(t):r===3?new Ka(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?mm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?mm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=HH.exec(e))?new Ka(t[1],t[2],t[3],1):(t=qH.exec(e))?new Ka(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=WH.exec(e))?mm(t[1],t[2],t[3],t[4]):(t=VH.exec(e))?mm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=GH.exec(e))?_O(t[1],t[2]/100,t[3]/100,1):(t=KH.exec(e))?_O(t[1],t[2]/100,t[3]/100,t[4]):gO.hasOwnProperty(e)?yO(gO[e]):e==="transparent"?new Ka(NaN,NaN,NaN,0):null}function yO(e){return new Ka(e>>16&255,e>>8&255,e&255,1)}function mm(e,t,r,n){return n<=0&&(e=t=r=NaN),new Ka(e,t,r,n)}function QH(e){return e instanceof E0||(e=Wd(e)),e?(e=e.rgb(),new Ka(e.r,e.g,e.b,e.opacity)):new Ka}function dw(e,t,r,n){return arguments.length===1?QH(e):new Ka(e,t,r,n??1)}function Ka(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}I_(Ka,dw,gP(E0,{brighter(e){return e=e==null?vp:Math.pow(vp,e),new Ka(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Hd:Math.pow(Hd,e),new Ka(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ka(ac(this.r),ac(this.g),ac(this.b),xp(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bO,formatHex:bO,formatHex8:JH,formatRgb:wO,toString:wO}));function bO(){return`#${Qo(this.r)}${Qo(this.g)}${Qo(this.b)}`}function JH(){return`#${Qo(this.r)}${Qo(this.g)}${Qo(this.b)}${Qo((isNaN(this.opacity)?1:this.opacity)*255)}`}function wO(){const e=xp(this.opacity);return`${e===1?"rgb(":"rgba("}${ac(this.r)}, ${ac(this.g)}, ${ac(this.b)}${e===1?")":`, ${e})`}`}function xp(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function ac(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Qo(e){return e=ac(e),(e<16?"0":"")+e.toString(16)}function _O(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new rs(e,t,r,n)}function vP(e){if(e instanceof rs)return new rs(e.h,e.s,e.l,e.opacity);if(e instanceof E0||(e=Wd(e)),!e)return new rs;if(e instanceof rs)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),l=NaN,c=i-a,f=(i+a)/2;return c?(t===i?l=(r-n)/c+(r<n)*6:r===i?l=(n-t)/c+2:l=(t-r)/c+4,c/=f<.5?i+a:2-i-a,l*=60):c=f>0&&f<1?0:l,new rs(l,c,f,e.opacity)}function ZH(e,t,r,n){return arguments.length===1?vP(e):new rs(e,t,r,n??1)}function rs(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}I_(rs,ZH,gP(E0,{brighter(e){return e=e==null?vp:Math.pow(vp,e),new rs(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Hd:Math.pow(Hd,e),new rs(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Ka(C1(e>=240?e-240:e+120,a,n),C1(e,a,n),C1(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new rs(SO(this.h),pm(this.s),pm(this.l),xp(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xp(this.opacity);return`${e===1?"hsl(":"hsla("}${SO(this.h)}, ${pm(this.s)*100}%, ${pm(this.l)*100}%${e===1?")":`, ${e})`}`}}));function SO(e){return e=(e||0)%360,e<0?e+360:e}function pm(e){return Math.max(0,Math.min(1,e||0))}function C1(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const P_=e=>()=>e;function eq(e,t){return function(r){return e+r*t}}function tq(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function rq(e){return(e=+e)==1?xP:function(t,r){return r-t?tq(t,r,e):P_(isNaN(t)?r:t)}}function xP(e,t){var r=t-e;return r?eq(e,r):P_(isNaN(e)?t:e)}const EO=(function e(t){var r=rq(t);function n(a,i){var l=r((a=dw(a)).r,(i=dw(i)).r),c=r(a.g,i.g),f=r(a.b,i.b),d=xP(a.opacity,i.opacity);return function(m){return a.r=l(m),a.g=c(m),a.b=f(m),a.opacity=d(m),a+""}}return n.gamma=e,n})(1);function nq(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function aq(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function iq(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),l;for(l=0;l<n;++l)a[l]=rf(e[l],t[l]);for(;l<r;++l)i[l]=t[l];return function(c){for(l=0;l<n;++l)i[l]=a[l](c);return i}}function sq(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function yp(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function lq(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=rf(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var hw=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,D1=new RegExp(hw.source,"g");function oq(e){return function(){return e}}function cq(e){return function(t){return e(t)+""}}function uq(e,t){var r=hw.lastIndex=D1.lastIndex=0,n,a,i,l=-1,c=[],f=[];for(e=e+"",t=t+"";(n=hw.exec(e))&&(a=D1.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),c[l]?c[l]+=i:c[++l]=i),(n=n[0])===(a=a[0])?c[l]?c[l]+=a:c[++l]=a:(c[++l]=null,f.push({i:l,x:yp(n,a)})),r=D1.lastIndex;return r<t.length&&(i=t.slice(r),c[l]?c[l]+=i:c[++l]=i),c.length<2?f[0]?cq(f[0].x):oq(t):(t=f.length,function(d){for(var m=0,p;m<t;++m)c[(p=f[m]).i]=p.x(d);return c.join("")})}function rf(e,t){var r=typeof t,n;return t==null||r==="boolean"?P_(t):(r==="number"?yp:r==="string"?(n=Wd(t))?(t=n,EO):uq:t instanceof Wd?EO:t instanceof Date?sq:aq(t)?nq:Array.isArray(t)?iq:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?lq:yp)(e,t)}function M_(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function fq(e,t){t===void 0&&(t=e,e=rf);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(l){var c=Math.max(0,Math.min(n-1,Math.floor(l*=n)));return i[c](l-c)}}function dq(e){return function(){return e}}function bp(e){return+e}var NO=[0,1];function Ma(e){return e}function mw(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:dq(isNaN(t)?NaN:.5)}function hq(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function mq(e,t,r){var n=e[0],a=e[1],i=t[0],l=t[1];return a<n?(n=mw(a,n),i=r(l,i)):(n=mw(n,a),i=r(i,l)),function(c){return i(n(c))}}function pq(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),l=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<n;)a[l]=mw(e[l],e[l+1]),i[l]=r(t[l],t[l+1]);return function(c){var f=S0(e,c,1,n)-1;return i[f](a[f](c))}}function N0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Tg(){var e=NO,t=NO,r=rf,n,a,i,l=Ma,c,f,d;function m(){var v=Math.min(e.length,t.length);return l!==Ma&&(l=hq(e[0],e[v-1])),c=v>2?pq:mq,f=d=null,p}function p(v){return v==null||isNaN(v=+v)?i:(f||(f=c(e.map(n),t,r)))(n(l(v)))}return p.invert=function(v){return l(a((d||(d=c(t,e.map(n),yp)))(v)))},p.domain=function(v){return arguments.length?(e=Array.from(v,bp),m()):e.slice()},p.range=function(v){return arguments.length?(t=Array.from(v),m()):t.slice()},p.rangeRound=function(v){return t=Array.from(v),r=M_,m()},p.clamp=function(v){return arguments.length?(l=v?!0:Ma,m()):l!==Ma},p.interpolate=function(v){return arguments.length?(r=v,m()):r},p.unknown=function(v){return arguments.length?(i=v,p):i},function(v,x){return n=v,a=x,m()}}function R_(){return Tg()(Ma,Ma)}function gq(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function wp(e,t){if(!isFinite(e)||e===0)return null;var r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"),n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Wu(e){return e=wp(Math.abs(e)),e?e[1]:NaN}function vq(e,t){return function(r,n){for(var a=r.length,i=[],l=0,c=e[0],f=0;a>0&&c>0&&(f+c+1>n&&(c=Math.max(1,n-f)),i.push(r.substring(a-=c,a+c)),!((f+=c+1)>n));)c=e[l=(l+1)%e.length];return i.reverse().join(t)}}function xq(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var yq=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Vd(e){if(!(t=yq.exec(e)))throw new Error("invalid format: "+e);var t;return new F_({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Vd.prototype=F_.prototype;function F_(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}F_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function bq(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var _p;function wq(e,t){var r=wp(e,t);if(!r)return _p=void 0,e.toPrecision(t);var n=r[0],a=r[1],i=a-(_p=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,l=n.length;return i===l?n:i>l?n+new Array(i-l+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+wp(e,Math.max(0,t+i-1))[0]}function kO(e,t){var r=wp(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const TO={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:gq,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>kO(e*100,t),r:kO,s:wq,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function AO(e){return e}var jO=Array.prototype.map,OO=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function _q(e){var t=e.grouping===void 0||e.thousands===void 0?AO:vq(jO.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?AO:xq(jO.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",c=e.minus===void 0?"":e.minus+"",f=e.nan===void 0?"NaN":e.nan+"";function d(p,v){p=Vd(p);var x=p.fill,y=p.align,b=p.sign,_=p.symbol,E=p.zero,A=p.width,T=p.comma,k=p.precision,I=p.trim,O=p.type;O==="n"?(T=!0,O="g"):TO[O]||(k===void 0&&(k=12),I=!0,O="g"),(E||x==="0"&&y==="=")&&(E=!0,x="0",y="=");var j=(v&&v.prefix!==void 0?v.prefix:"")+(_==="$"?r:_==="#"&&/[boxX]/.test(O)?"0"+O.toLowerCase():""),B=(_==="$"?n:/[%p]/.test(O)?l:"")+(v&&v.suffix!==void 0?v.suffix:""),U=TO[O],Y=/[defgprs%]/.test(O);k=k===void 0?6:/[gprs]/.test(O)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function te(V){var ge=j,be=B,ve,z,ue;if(O==="c")be=U(V)+be,V="";else{V=+V;var se=V<0||1/V<0;if(V=isNaN(V)?f:U(Math.abs(V),k),I&&(V=bq(V)),se&&+V==0&&b!=="+"&&(se=!1),ge=(se?b==="("?b:c:b==="-"||b==="("?"":b)+ge,be=(O==="s"&&!isNaN(V)&&_p!==void 0?OO[8+_p/3]:"")+be+(se&&b==="("?")":""),Y){for(ve=-1,z=V.length;++ve<z;)if(ue=V.charCodeAt(ve),48>ue||ue>57){be=(ue===46?a+V.slice(ve+1):V.slice(ve))+be,V=V.slice(0,ve);break}}}T&&!E&&(V=t(V,1/0));var Q=ge.length+V.length+be.length,re=Q<A?new Array(A-Q+1).join(x):"";switch(T&&E&&(V=t(re+V,re.length?A-be.length:1/0),re=""),y){case"<":V=ge+V+be+re;break;case"=":V=ge+re+V+be;break;case"^":V=re.slice(0,Q=re.length>>1)+ge+V+be+re.slice(Q);break;default:V=re+ge+V+be;break}return i(V)}return te.toString=function(){return p+""},te}function m(p,v){var x=Math.max(-8,Math.min(8,Math.floor(Wu(v)/3)))*3,y=Math.pow(10,-x),b=d((p=Vd(p),p.type="f",p),{suffix:OO[8+x/3]});return function(_){return b(y*_)}}return{format:d,formatPrefix:m}}var gm,L_,yP;Sq({thousands:",",grouping:[3],currency:["$",""]});function Sq(e){return gm=_q(e),L_=gm.format,yP=gm.formatPrefix,gm}function Eq(e){return Math.max(0,-Wu(Math.abs(e)))}function Nq(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Wu(t)/3)))*3-Wu(Math.abs(e)))}function kq(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Wu(t)-Wu(e))+1}function bP(e,t,r,n){var a=uw(e,t,r),i;switch(n=Vd(n??",f"),n.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=Nq(a,l))&&(n.precision=i),yP(n,l)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=kq(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=Eq(a))&&(n.precision=i-(n.type==="%")*2);break}}return L_(n)}function go(e){var t=e.domain;return e.ticks=function(r){var n=t();return ow(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return bP(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,l=n[a],c=n[i],f,d,m=10;for(c<l&&(d=l,l=c,c=d,d=a,a=i,i=d);m-- >0;){if(d=cw(l,c,r),d===f)return n[a]=l,n[i]=c,t(n);if(d>0)l=Math.floor(l/d)*d,c=Math.ceil(c/d)*d;else if(d<0)l=Math.ceil(l*d)/d,c=Math.floor(c*d)/d;else break;f=d}return e},e}function wP(){var e=R_();return e.copy=function(){return N0(e,wP())},Wi.apply(e,arguments),go(e)}function _P(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,bp),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return _P(e).unknown(t)},e=arguments.length?Array.from(e,bp):[0,1],go(r)}function SP(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],l;return i<a&&(l=r,r=n,n=l,l=a,a=i,i=l),e[r]=t.floor(a),e[n]=t.ceil(i),e}function CO(e){return Math.log(e)}function DO(e){return Math.exp(e)}function Tq(e){return-Math.log(-e)}function Aq(e){return-Math.exp(-e)}function jq(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Oq(e){return e===10?jq:e===Math.E?Math.exp:t=>Math.pow(e,t)}function Cq(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function IO(e){return(t,r)=>-e(-t,r)}function B_(e){const t=e(CO,DO),r=t.domain;let n=10,a,i;function l(){return a=Cq(n),i=Oq(n),r()[0]<0?(a=IO(a),i=IO(i),e(Tq,Aq)):e(CO,DO),t}return t.base=function(c){return arguments.length?(n=+c,l()):n},t.domain=function(c){return arguments.length?(r(c),l()):r()},t.ticks=c=>{const f=r();let d=f[0],m=f[f.length-1];const p=m<d;p&&([d,m]=[m,d]);let v=a(d),x=a(m),y,b;const _=c==null?10:+c;let E=[];if(!(n%1)&&x-v<_){if(v=Math.floor(v),x=Math.ceil(x),d>0){for(;v<=x;++v)for(y=1;y<n;++y)if(b=v<0?y/i(-v):y*i(v),!(b<d)){if(b>m)break;E.push(b)}}else for(;v<=x;++v)for(y=n-1;y>=1;--y)if(b=v>0?y/i(-v):y*i(v),!(b<d)){if(b>m)break;E.push(b)}E.length*2<_&&(E=ow(d,m,_))}else E=ow(v,x,Math.min(x-v,_)).map(i);return p?E.reverse():E},t.tickFormat=(c,f)=>{if(c==null&&(c=10),f==null&&(f=n===10?"s":","),typeof f!="function"&&(!(n%1)&&(f=Vd(f)).precision==null&&(f.trim=!0),f=L_(f)),c===1/0)return f;const d=Math.max(1,n*c/t.ticks().length);return m=>{let p=m/i(Math.round(a(m)));return p*n<n-.5&&(p*=n),p<=d?f(m):""}},t.nice=()=>r(SP(r(),{floor:c=>i(Math.floor(a(c))),ceil:c=>i(Math.ceil(a(c)))})),t}function EP(){const e=B_(Tg()).domain([1,10]);return e.copy=()=>N0(e,EP()).base(e.base()),Wi.apply(e,arguments),e}function PO(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function MO(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function U_(e){var t=1,r=e(PO(t),MO(t));return r.constant=function(n){return arguments.length?e(PO(t=+n),MO(t)):t},go(r)}function NP(){var e=U_(Tg());return e.copy=function(){return N0(e,NP()).constant(e.constant())},Wi.apply(e,arguments)}function RO(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Dq(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Iq(e){return e<0?-e*e:e*e}function $_(e){var t=e(Ma,Ma),r=1;function n(){return r===1?e(Ma,Ma):r===.5?e(Dq,Iq):e(RO(r),RO(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},go(t)}function z_(){var e=$_(Tg());return e.copy=function(){return N0(e,z_()).exponent(e.exponent())},Wi.apply(e,arguments),e}function Pq(){return z_.apply(null,arguments).exponent(.5)}function FO(e){return Math.sign(e)*e*e}function Mq(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function kP(){var e=R_(),t=[0,1],r=!1,n;function a(i){var l=Mq(e(i));return isNaN(l)?n:r?Math.round(l):l}return a.invert=function(i){return e.invert(FO(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,bp)).map(FO)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return kP(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},Wi.apply(a,arguments),go(a)}function TP(){var e=[],t=[],r=[],n;function a(){var l=0,c=Math.max(1,t.length);for(r=new Array(c-1);++l<c;)r[l-1]=BH(e,l/c);return i}function i(l){return l==null||isNaN(l=+l)?n:t[S0(r,l)]}return i.invertExtent=function(l){var c=t.indexOf(l);return c<0?[NaN,NaN]:[c>0?r[c-1]:e[0],c<r.length?r[c]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let c of l)c!=null&&!isNaN(c=+c)&&e.push(c);return e.sort(io),a()},i.range=function(l){return arguments.length?(t=Array.from(l),a()):t.slice()},i.unknown=function(l){return arguments.length?(n=l,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return TP().domain(e).range(t).unknown(n)},Wi.apply(i,arguments)}function AP(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function l(f){return f!=null&&f<=f?a[S0(n,f,0,r)]:i}function c(){var f=-1;for(n=new Array(r);++f<r;)n[f]=((f+1)*t-(f-r)*e)/(r+1);return l}return l.domain=function(f){return arguments.length?([e,t]=f,e=+e,t=+t,c()):[e,t]},l.range=function(f){return arguments.length?(r=(a=Array.from(f)).length-1,c()):a.slice()},l.invertExtent=function(f){var d=a.indexOf(f);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},l.unknown=function(f){return arguments.length&&(i=f),l},l.thresholds=function(){return n.slice()},l.copy=function(){return AP().domain([e,t]).range(a).unknown(i)},Wi.apply(go(l),arguments)}function jP(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[S0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return jP().domain(e).range(t).unknown(r)},Wi.apply(a,arguments)}const I1=new Date,P1=new Date;function Bn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const l=a(i),c=a.ceil(i);return i-l<c-i?l:c},a.offset=(i,l)=>(t(i=new Date(+i),l==null?1:Math.floor(l)),i),a.range=(i,l,c)=>{const f=[];if(i=a.ceil(i),c=c==null?1:Math.floor(c),!(i<l)||!(c>0))return f;let d;do f.push(d=new Date(+i)),t(i,c),e(i);while(d<i&&i<l);return f},a.filter=i=>Bn(l=>{if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},(l,c)=>{if(l>=l)if(c<0)for(;++c<=0;)for(;t(l,-1),!i(l););else for(;--c>=0;)for(;t(l,1),!i(l););}),r&&(a.count=(i,l)=>(I1.setTime(+i),P1.setTime(+l),e(I1),e(P1),Math.floor(r(I1,P1))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?l=>n(l)%i===0:l=>a.count(0,l)%i===0):a)),a}const Sp=Bn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Sp.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Bn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Sp);Sp.range;const el=1e3,Bi=el*60,tl=Bi*60,cl=tl*24,H_=cl*7,LO=cl*30,M1=cl*365,Jo=Bn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*el)},(e,t)=>(t-e)/el,e=>e.getUTCSeconds());Jo.range;const q_=Bn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*el)},(e,t)=>{e.setTime(+e+t*Bi)},(e,t)=>(t-e)/Bi,e=>e.getMinutes());q_.range;const W_=Bn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*Bi)},(e,t)=>(t-e)/Bi,e=>e.getUTCMinutes());W_.range;const V_=Bn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*el-e.getMinutes()*Bi)},(e,t)=>{e.setTime(+e+t*tl)},(e,t)=>(t-e)/tl,e=>e.getHours());V_.range;const G_=Bn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*tl)},(e,t)=>(t-e)/tl,e=>e.getUTCHours());G_.range;const k0=Bn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Bi)/cl,e=>e.getDate()-1);k0.range;const Ag=Bn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/cl,e=>e.getUTCDate()-1);Ag.range;const OP=Bn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/cl,e=>Math.floor(e/cl));OP.range;function kc(e){return Bn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Bi)/H_)}const jg=kc(0),Ep=kc(1),Rq=kc(2),Fq=kc(3),Vu=kc(4),Lq=kc(5),Bq=kc(6);jg.range;Ep.range;Rq.range;Fq.range;Vu.range;Lq.range;Bq.range;function Tc(e){return Bn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/H_)}const Og=Tc(0),Np=Tc(1),Uq=Tc(2),$q=Tc(3),Gu=Tc(4),zq=Tc(5),Hq=Tc(6);Og.range;Np.range;Uq.range;$q.range;Gu.range;zq.range;Hq.range;const K_=Bn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());K_.range;const X_=Bn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());X_.range;const ul=Bn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());ul.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Bn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});ul.range;const fl=Bn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());fl.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Bn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});fl.range;function CP(e,t,r,n,a,i){const l=[[Jo,1,el],[Jo,5,5*el],[Jo,15,15*el],[Jo,30,30*el],[i,1,Bi],[i,5,5*Bi],[i,15,15*Bi],[i,30,30*Bi],[a,1,tl],[a,3,3*tl],[a,6,6*tl],[a,12,12*tl],[n,1,cl],[n,2,2*cl],[r,1,H_],[t,1,LO],[t,3,3*LO],[e,1,M1]];function c(d,m,p){const v=m<d;v&&([d,m]=[m,d]);const x=p&&typeof p.range=="function"?p:f(d,m,p),y=x?x.range(d,+m+1):[];return v?y.reverse():y}function f(d,m,p){const v=Math.abs(m-d)/p,x=O_(([,,_])=>_).right(l,v);if(x===l.length)return e.every(uw(d/M1,m/M1,p));if(x===0)return Sp.every(Math.max(uw(d,m,p),1));const[y,b]=l[v/l[x-1][2]<l[x][2]/v?x-1:x];return y.every(b)}return[c,f]}const[qq,Wq]=CP(fl,X_,Og,OP,G_,W_),[Vq,Gq]=CP(ul,K_,jg,k0,V_,q_);function R1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function F1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ud(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function Kq(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,l=e.shortDays,c=e.months,f=e.shortMonths,d=fd(a),m=dd(a),p=fd(i),v=dd(i),x=fd(l),y=dd(l),b=fd(c),_=dd(c),E=fd(f),A=dd(f),T={a:ue,A:se,b:Q,B:re,c:null,d:qO,e:qO,f:vW,g:TW,G:jW,H:mW,I:pW,j:gW,L:DP,m:xW,M:yW,p:G,q:P,Q:GO,s:KO,S:bW,u:wW,U:_W,V:SW,w:EW,W:NW,x:null,X:null,y:kW,Y:AW,Z:OW,"%":VO},k={a:W,A:F,b:M,B:le,c:null,d:WO,e:WO,f:PW,g:qW,G:VW,H:CW,I:DW,j:IW,L:PP,m:MW,M:RW,p:pe,q:Ae,Q:GO,s:KO,S:FW,u:LW,U:BW,V:UW,w:$W,W:zW,x:null,X:null,y:HW,Y:WW,Z:GW,"%":VO},I={a:Y,A:te,b:V,B:ge,c:be,d:zO,e:zO,f:uW,g:$O,G:UO,H:HO,I:HO,j:sW,L:cW,m:iW,M:lW,p:U,q:aW,Q:dW,s:hW,S:oW,u:Zq,U:eW,V:tW,w:Jq,W:rW,x:ve,X:z,y:$O,Y:UO,Z:nW,"%":fW};T.x=O(r,T),T.X=O(n,T),T.c=O(t,T),k.x=O(r,k),k.X=O(n,k),k.c=O(t,k);function O(oe,ae){return function(ze){var q=[],Je=-1,qe=0,ot=oe.length,Ke,He,wt;for(ze instanceof Date||(ze=new Date(+ze));++Je<ot;)oe.charCodeAt(Je)===37&&(q.push(oe.slice(qe,Je)),(He=BO[Ke=oe.charAt(++Je)])!=null?Ke=oe.charAt(++Je):He=Ke==="e"?" ":"0",(wt=ae[Ke])&&(Ke=wt(ze,He)),q.push(Ke),qe=Je+1);return q.push(oe.slice(qe,Je)),q.join("")}}function j(oe,ae){return function(ze){var q=ud(1900,void 0,1),Je=B(q,oe,ze+="",0),qe,ot;if(Je!=ze.length)return null;if("Q"in q)return new Date(q.Q);if("s"in q)return new Date(q.s*1e3+("L"in q?q.L:0));if(ae&&!("Z"in q)&&(q.Z=0),"p"in q&&(q.H=q.H%12+q.p*12),q.m===void 0&&(q.m="q"in q?q.q:0),"V"in q){if(q.V<1||q.V>53)return null;"w"in q||(q.w=1),"Z"in q?(qe=F1(ud(q.y,0,1)),ot=qe.getUTCDay(),qe=ot>4||ot===0?Np.ceil(qe):Np(qe),qe=Ag.offset(qe,(q.V-1)*7),q.y=qe.getUTCFullYear(),q.m=qe.getUTCMonth(),q.d=qe.getUTCDate()+(q.w+6)%7):(qe=R1(ud(q.y,0,1)),ot=qe.getDay(),qe=ot>4||ot===0?Ep.ceil(qe):Ep(qe),qe=k0.offset(qe,(q.V-1)*7),q.y=qe.getFullYear(),q.m=qe.getMonth(),q.d=qe.getDate()+(q.w+6)%7)}else("W"in q||"U"in q)&&("w"in q||(q.w="u"in q?q.u%7:"W"in q?1:0),ot="Z"in q?F1(ud(q.y,0,1)).getUTCDay():R1(ud(q.y,0,1)).getDay(),q.m=0,q.d="W"in q?(q.w+6)%7+q.W*7-(ot+5)%7:q.w+q.U*7-(ot+6)%7);return"Z"in q?(q.H+=q.Z/100|0,q.M+=q.Z%100,F1(q)):R1(q)}}function B(oe,ae,ze,q){for(var Je=0,qe=ae.length,ot=ze.length,Ke,He;Je<qe;){if(q>=ot)return-1;if(Ke=ae.charCodeAt(Je++),Ke===37){if(Ke=ae.charAt(Je++),He=I[Ke in BO?ae.charAt(Je++):Ke],!He||(q=He(oe,ze,q))<0)return-1}else if(Ke!=ze.charCodeAt(q++))return-1}return q}function U(oe,ae,ze){var q=d.exec(ae.slice(ze));return q?(oe.p=m.get(q[0].toLowerCase()),ze+q[0].length):-1}function Y(oe,ae,ze){var q=x.exec(ae.slice(ze));return q?(oe.w=y.get(q[0].toLowerCase()),ze+q[0].length):-1}function te(oe,ae,ze){var q=p.exec(ae.slice(ze));return q?(oe.w=v.get(q[0].toLowerCase()),ze+q[0].length):-1}function V(oe,ae,ze){var q=E.exec(ae.slice(ze));return q?(oe.m=A.get(q[0].toLowerCase()),ze+q[0].length):-1}function ge(oe,ae,ze){var q=b.exec(ae.slice(ze));return q?(oe.m=_.get(q[0].toLowerCase()),ze+q[0].length):-1}function be(oe,ae,ze){return B(oe,t,ae,ze)}function ve(oe,ae,ze){return B(oe,r,ae,ze)}function z(oe,ae,ze){return B(oe,n,ae,ze)}function ue(oe){return l[oe.getDay()]}function se(oe){return i[oe.getDay()]}function Q(oe){return f[oe.getMonth()]}function re(oe){return c[oe.getMonth()]}function G(oe){return a[+(oe.getHours()>=12)]}function P(oe){return 1+~~(oe.getMonth()/3)}function W(oe){return l[oe.getUTCDay()]}function F(oe){return i[oe.getUTCDay()]}function M(oe){return f[oe.getUTCMonth()]}function le(oe){return c[oe.getUTCMonth()]}function pe(oe){return a[+(oe.getUTCHours()>=12)]}function Ae(oe){return 1+~~(oe.getUTCMonth()/3)}return{format:function(oe){var ae=O(oe+="",T);return ae.toString=function(){return oe},ae},parse:function(oe){var ae=j(oe+="",!1);return ae.toString=function(){return oe},ae},utcFormat:function(oe){var ae=O(oe+="",k);return ae.toString=function(){return oe},ae},utcParse:function(oe){var ae=j(oe+="",!0);return ae.toString=function(){return oe},ae}}}var BO={"-":"",_:" ",0:"0"},ea=/^\s*\d+/,Xq=/^%/,Yq=/[\\^$*+?|[\]().{}]/g;function fr(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function Qq(e){return e.replace(Yq,"\\$&")}function fd(e){return new RegExp("^(?:"+e.map(Qq).join("|")+")","i")}function dd(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function Jq(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function Zq(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function eW(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function tW(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function rW(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function UO(e,t,r){var n=ea.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function $O(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function nW(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function aW(e,t,r){var n=ea.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function iW(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function zO(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function sW(e,t,r){var n=ea.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function HO(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function lW(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function oW(e,t,r){var n=ea.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function cW(e,t,r){var n=ea.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function uW(e,t,r){var n=ea.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function fW(e,t,r){var n=Xq.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function dW(e,t,r){var n=ea.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function hW(e,t,r){var n=ea.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function qO(e,t){return fr(e.getDate(),t,2)}function mW(e,t){return fr(e.getHours(),t,2)}function pW(e,t){return fr(e.getHours()%12||12,t,2)}function gW(e,t){return fr(1+k0.count(ul(e),e),t,3)}function DP(e,t){return fr(e.getMilliseconds(),t,3)}function vW(e,t){return DP(e,t)+"000"}function xW(e,t){return fr(e.getMonth()+1,t,2)}function yW(e,t){return fr(e.getMinutes(),t,2)}function bW(e,t){return fr(e.getSeconds(),t,2)}function wW(e){var t=e.getDay();return t===0?7:t}function _W(e,t){return fr(jg.count(ul(e)-1,e),t,2)}function IP(e){var t=e.getDay();return t>=4||t===0?Vu(e):Vu.ceil(e)}function SW(e,t){return e=IP(e),fr(Vu.count(ul(e),e)+(ul(e).getDay()===4),t,2)}function EW(e){return e.getDay()}function NW(e,t){return fr(Ep.count(ul(e)-1,e),t,2)}function kW(e,t){return fr(e.getFullYear()%100,t,2)}function TW(e,t){return e=IP(e),fr(e.getFullYear()%100,t,2)}function AW(e,t){return fr(e.getFullYear()%1e4,t,4)}function jW(e,t){var r=e.getDay();return e=r>=4||r===0?Vu(e):Vu.ceil(e),fr(e.getFullYear()%1e4,t,4)}function OW(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+fr(t/60|0,"0",2)+fr(t%60,"0",2)}function WO(e,t){return fr(e.getUTCDate(),t,2)}function CW(e,t){return fr(e.getUTCHours(),t,2)}function DW(e,t){return fr(e.getUTCHours()%12||12,t,2)}function IW(e,t){return fr(1+Ag.count(fl(e),e),t,3)}function PP(e,t){return fr(e.getUTCMilliseconds(),t,3)}function PW(e,t){return PP(e,t)+"000"}function MW(e,t){return fr(e.getUTCMonth()+1,t,2)}function RW(e,t){return fr(e.getUTCMinutes(),t,2)}function FW(e,t){return fr(e.getUTCSeconds(),t,2)}function LW(e){var t=e.getUTCDay();return t===0?7:t}function BW(e,t){return fr(Og.count(fl(e)-1,e),t,2)}function MP(e){var t=e.getUTCDay();return t>=4||t===0?Gu(e):Gu.ceil(e)}function UW(e,t){return e=MP(e),fr(Gu.count(fl(e),e)+(fl(e).getUTCDay()===4),t,2)}function $W(e){return e.getUTCDay()}function zW(e,t){return fr(Np.count(fl(e)-1,e),t,2)}function HW(e,t){return fr(e.getUTCFullYear()%100,t,2)}function qW(e,t){return e=MP(e),fr(e.getUTCFullYear()%100,t,2)}function WW(e,t){return fr(e.getUTCFullYear()%1e4,t,4)}function VW(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Gu(e):Gu.ceil(e),fr(e.getUTCFullYear()%1e4,t,4)}function GW(){return"+0000"}function VO(){return"%"}function GO(e){return+e}function KO(e){return Math.floor(+e/1e3)}var mu,RP,FP;KW({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function KW(e){return mu=Kq(e),RP=mu.format,mu.parse,FP=mu.utcFormat,mu.utcParse,mu}function XW(e){return new Date(e)}function YW(e){return e instanceof Date?+e:+new Date(+e)}function Y_(e,t,r,n,a,i,l,c,f,d){var m=R_(),p=m.invert,v=m.domain,x=d(".%L"),y=d(":%S"),b=d("%I:%M"),_=d("%I %p"),E=d("%a %d"),A=d("%b %d"),T=d("%B"),k=d("%Y");function I(O){return(f(O)<O?x:c(O)<O?y:l(O)<O?b:i(O)<O?_:n(O)<O?a(O)<O?E:A:r(O)<O?T:k)(O)}return m.invert=function(O){return new Date(p(O))},m.domain=function(O){return arguments.length?v(Array.from(O,YW)):v().map(XW)},m.ticks=function(O){var j=v();return e(j[0],j[j.length-1],O??10)},m.tickFormat=function(O,j){return j==null?I:d(j)},m.nice=function(O){var j=v();return(!O||typeof O.range!="function")&&(O=t(j[0],j[j.length-1],O??10)),O?v(SP(j,O)):m},m.copy=function(){return N0(m,Y_(e,t,r,n,a,i,l,c,f,d))},m}function QW(){return Wi.apply(Y_(Vq,Gq,ul,K_,jg,k0,V_,q_,Jo,RP).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function JW(){return Wi.apply(Y_(qq,Wq,fl,X_,Og,Ag,G_,W_,Jo,FP).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Cg(){var e=0,t=1,r,n,a,i,l=Ma,c=!1,f;function d(p){return p==null||isNaN(p=+p)?f:l(a===0?.5:(p=(i(p)-r)*a,c?Math.max(0,Math.min(1,p)):p))}d.domain=function(p){return arguments.length?([e,t]=p,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(p){return arguments.length?(c=!!p,d):c},d.interpolator=function(p){return arguments.length?(l=p,d):l};function m(p){return function(v){var x,y;return arguments.length?([x,y]=v,l=p(x,y),d):[l(0),l(1)]}}return d.range=m(rf),d.rangeRound=m(M_),d.unknown=function(p){return arguments.length?(f=p,d):f},function(p){return i=p,r=p(e),n=p(t),a=r===n?0:1/(n-r),d}}function vo(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function LP(){var e=go(Cg()(Ma));return e.copy=function(){return vo(e,LP())},xl.apply(e,arguments)}function BP(){var e=B_(Cg()).domain([1,10]);return e.copy=function(){return vo(e,BP()).base(e.base())},xl.apply(e,arguments)}function UP(){var e=U_(Cg());return e.copy=function(){return vo(e,UP()).constant(e.constant())},xl.apply(e,arguments)}function Q_(){var e=$_(Cg());return e.copy=function(){return vo(e,Q_()).exponent(e.exponent())},xl.apply(e,arguments)}function ZW(){return Q_.apply(null,arguments).exponent(.5)}function $P(){var e=[],t=Ma;function r(n){if(n!=null&&!isNaN(n=+n))return t((S0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(io),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>LH(e,i/n))},r.copy=function(){return $P(t).domain(e)},xl.apply(r,arguments)}function Dg(){var e=0,t=.5,r=1,n=1,a,i,l,c,f,d=Ma,m,p=!1,v;function x(b){return isNaN(b=+b)?v:(b=.5+((b=+m(b))-i)*(n*b<n*i?c:f),d(p?Math.max(0,Math.min(1,b)):b))}x.domain=function(b){return arguments.length?([e,t,r]=b,a=m(e=+e),i=m(t=+t),l=m(r=+r),c=a===i?0:.5/(i-a),f=i===l?0:.5/(l-i),n=i<a?-1:1,x):[e,t,r]},x.clamp=function(b){return arguments.length?(p=!!b,x):p},x.interpolator=function(b){return arguments.length?(d=b,x):d};function y(b){return function(_){var E,A,T;return arguments.length?([E,A,T]=_,d=fq(b,[E,A,T]),x):[d(0),d(.5),d(1)]}}return x.range=y(rf),x.rangeRound=y(M_),x.unknown=function(b){return arguments.length?(v=b,x):v},function(b){return m=b,a=b(e),i=b(t),l=b(r),c=a===i?0:.5/(i-a),f=i===l?0:.5/(l-i),n=i<a?-1:1,x}}function zP(){var e=go(Dg()(Ma));return e.copy=function(){return vo(e,zP())},xl.apply(e,arguments)}function HP(){var e=B_(Dg()).domain([.1,1,10]);return e.copy=function(){return vo(e,HP()).base(e.base())},xl.apply(e,arguments)}function qP(){var e=U_(Dg());return e.copy=function(){return vo(e,qP()).constant(e.constant())},xl.apply(e,arguments)}function J_(){var e=$_(Dg());return e.copy=function(){return vo(e,J_()).exponent(e.exponent())},xl.apply(e,arguments)}function eV(){return J_.apply(null,arguments).exponent(.5)}const vd=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:D_,scaleDiverging:zP,scaleDivergingLog:HP,scaleDivergingPow:J_,scaleDivergingSqrt:eV,scaleDivergingSymlog:qP,scaleIdentity:_P,scaleImplicit:fw,scaleLinear:wP,scaleLog:EP,scaleOrdinal:C_,scalePoint:$H,scalePow:z_,scaleQuantile:TP,scaleQuantize:AP,scaleRadial:kP,scaleSequential:LP,scaleSequentialLog:BP,scaleSequentialPow:Q_,scaleSequentialQuantile:$P,scaleSequentialSqrt:ZW,scaleSequentialSymlog:UP,scaleSqrt:Pq,scaleSymlog:NP,scaleThreshold:jP,scaleTime:QW,scaleUtc:JW,tickFormat:bP},Symbol.toStringTag,{value:"Module"}));var yl=e=>e.chartData,Ig=Te([yl],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),WP=(e,t,r,n)=>n?Ig(e):yl(e),tV=(e,t,r)=>r?Ig(e):yl(e);function dl(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(rr(t)&&rr(r))return!0}return!1}function XO(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function VP(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(rr(r))a=r;else if(typeof r=="function")return;if(rr(n))i=n;else if(typeof n=="function")return;var l=[a,i];if(dl(l))return l}}function rV(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(dl(n))return XO(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,l,c;if(a==="auto")t!=null&&(l=Math.min(...t));else if(gt(a))l=a;else if(typeof a=="function")try{t!=null&&(l=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&ij.test(a)){var f=ij.exec(a);if(f==null||f[1]==null||t==null)l=void 0;else{var d=+f[1];l=t[0]-d}}else l=t==null?void 0:t[0];if(i==="auto")t!=null&&(c=Math.max(...t));else if(gt(i))c=i;else if(typeof i=="function")try{t!=null&&(c=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&sj.test(i)){var m=sj.exec(i);if(m==null||m[1]==null||t==null)c=void 0;else{var p=+m[1];c=t[1]+p}}else c=t==null?void 0:t[1];var v=[l,c];if(dl(v))return t==null?v:XO(v,t,r)}}}var nf=1e9,nV={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},e2,Zr=!0,Hi="[DecimalError] ",ic=Hi+"Invalid argument: ",Z_=Hi+"Exponent out of range: ",af=Math.floor,qo=Math.pow,aV=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fi,Gn=1e7,Wr=7,GP=9007199254740991,kp=af(GP/Wr),ft={};ft.absoluteValue=ft.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ft.comparedTo=ft.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};ft.decimalPlaces=ft.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Wr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};ft.dividedBy=ft.div=function(e){return nl(this,new this.constructor(e))};ft.dividedToIntegerBy=ft.idiv=function(e){var t=this,r=t.constructor;return Rr(nl(t,new r(e),0,1),r.precision)};ft.equals=ft.eq=function(e){return!this.cmp(e)};ft.exponent=function(){return Cn(this)};ft.greaterThan=ft.gt=function(e){return this.cmp(e)>0};ft.greaterThanOrEqualTo=ft.gte=function(e){return this.cmp(e)>=0};ft.isInteger=ft.isint=function(){return this.e>this.d.length-2};ft.isNegative=ft.isneg=function(){return this.s<0};ft.isPositive=ft.ispos=function(){return this.s>0};ft.isZero=function(){return this.s===0};ft.lessThan=ft.lt=function(e){return this.cmp(e)<0};ft.lessThanOrEqualTo=ft.lte=function(e){return this.cmp(e)<1};ft.logarithm=ft.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(fi))throw Error(Hi+"NaN");if(r.s<1)throw Error(Hi+(r.s?"NaN":"-Infinity"));return r.eq(fi)?new n(0):(Zr=!1,t=nl(Gd(r,i),Gd(e,i),i),Zr=!0,Rr(t,a))};ft.minus=ft.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?YP(t,e):KP(t,(e.s=-e.s,e))};ft.modulo=ft.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(Hi+"NaN");return r.s?(Zr=!1,t=nl(r,e,0,1).times(e),Zr=!0,r.minus(t)):Rr(new n(r),a)};ft.naturalExponential=ft.exp=function(){return XP(this)};ft.naturalLogarithm=ft.ln=function(){return Gd(this)};ft.negated=ft.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ft.plus=ft.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?KP(t,e):YP(t,(e.s=-e.s,e))};ft.precision=ft.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ic+e);if(t=Cn(a)+1,n=a.d.length-1,r=n*Wr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};ft.squareRoot=ft.sqrt=function(){var e,t,r,n,a,i,l,c=this,f=c.constructor;if(c.s<1){if(!c.s)return new f(0);throw Error(Hi+"NaN")}for(e=Cn(c),Zr=!1,a=Math.sqrt(+c),a==0||a==1/0?(t=Es(c.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=af((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new f(t)):n=new f(a.toString()),r=f.precision,a=l=r+3;;)if(i=n,n=i.plus(nl(c,i,l+2)).times(.5),Es(i.d).slice(0,l)===(t=Es(n.d)).slice(0,l)){if(t=t.slice(l-3,l+1),a==l&&t=="4999"){if(Rr(i,r+1,0),i.times(i).eq(c)){n=i;break}}else if(t!="9999")break;l+=4}return Zr=!0,Rr(n,r)};ft.times=ft.mul=function(e){var t,r,n,a,i,l,c,f,d,m=this,p=m.constructor,v=m.d,x=(e=new p(e)).d;if(!m.s||!e.s)return new p(0);for(e.s*=m.s,r=m.e+e.e,f=v.length,d=x.length,f<d&&(i=v,v=x,x=i,l=f,f=d,d=l),i=[],l=f+d,n=l;n--;)i.push(0);for(n=d;--n>=0;){for(t=0,a=f+n;a>n;)c=i[a]+x[n]*v[a-n-1]+t,i[a--]=c%Gn|0,t=c/Gn|0;i[a]=(i[a]+t)%Gn|0}for(;!i[--l];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Zr?Rr(e,p.precision):e};ft.toDecimalPlaces=ft.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(Os(e,0,nf),t===void 0?t=n.rounding:Os(t,0,8),Rr(r,e+Cn(r)+1,t))};ft.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=vc(n,!0):(Os(e,0,nf),t===void 0?t=a.rounding:Os(t,0,8),n=Rr(new a(n),e+1,t),r=vc(n,!0,e+1)),r};ft.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?vc(a):(Os(e,0,nf),t===void 0?t=i.rounding:Os(t,0,8),n=Rr(new i(a),e+Cn(a)+1,t),r=vc(n.abs(),!1,e+Cn(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};ft.toInteger=ft.toint=function(){var e=this,t=e.constructor;return Rr(new t(e),Cn(e)+1,t.rounding)};ft.toNumber=function(){return+this};ft.toPower=ft.pow=function(e){var t,r,n,a,i,l,c=this,f=c.constructor,d=12,m=+(e=new f(e));if(!e.s)return new f(fi);if(c=new f(c),!c.s){if(e.s<1)throw Error(Hi+"Infinity");return c}if(c.eq(fi))return c;if(n=f.precision,e.eq(fi))return Rr(c,n);if(t=e.e,r=e.d.length-1,l=t>=r,i=c.s,l){if((r=m<0?-m:m)<=GP){for(a=new f(fi),t=Math.ceil(n/Wr+4),Zr=!1;r%2&&(a=a.times(c),QO(a.d,t)),r=af(r/2),r!==0;)c=c.times(c),QO(c.d,t);return Zr=!0,e.s<0?new f(fi).div(a):Rr(a,n)}}else if(i<0)throw Error(Hi+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,c.s=1,Zr=!1,a=e.times(Gd(c,n+d)),Zr=!0,a=XP(a),a.s=i,a};ft.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=Cn(a),n=vc(a,r<=i.toExpNeg||r>=i.toExpPos)):(Os(e,1,nf),t===void 0?t=i.rounding:Os(t,0,8),a=Rr(new i(a),e,t),r=Cn(a),n=vc(a,e<=r||r<=i.toExpNeg,e)),n};ft.toSignificantDigits=ft.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(Os(e,1,nf),t===void 0?t=n.rounding:Os(t,0,8)),Rr(new n(r),e,t)};ft.toString=ft.valueOf=ft.val=ft.toJSON=ft[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Cn(e),r=e.constructor;return vc(e,t<=r.toExpNeg||t>=r.toExpPos)};function KP(e,t){var r,n,a,i,l,c,f,d,m=e.constructor,p=m.precision;if(!e.s||!t.s)return t.s||(t=new m(e)),Zr?Rr(t,p):t;if(f=e.d,d=t.d,l=e.e,a=t.e,f=f.slice(),i=l-a,i){for(i<0?(n=f,i=-i,c=d.length):(n=d,a=l,c=f.length),l=Math.ceil(p/Wr),c=l>c?l+1:c+1,i>c&&(i=c,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(c=f.length,i=d.length,c-i<0&&(i=c,n=d,d=f,f=n),r=0;i;)r=(f[--i]=f[i]+d[i]+r)/Gn|0,f[i]%=Gn;for(r&&(f.unshift(r),++a),c=f.length;f[--c]==0;)f.pop();return t.d=f,t.e=a,Zr?Rr(t,p):t}function Os(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ic+e)}function Es(e){var t,r,n,a=e.length-1,i="",l=e[0];if(a>0){for(i+=l,t=1;t<a;t++)n=e[t]+"",r=Wr-n.length,r&&(i+=Ql(r)),i+=n;l=e[t],n=l+"",r=Wr-n.length,r&&(i+=Ql(r))}else if(l===0)return"0";for(;l%10===0;)l/=10;return i+l}var nl=(function(){function e(n,a){var i,l=0,c=n.length;for(n=n.slice();c--;)i=n[c]*a+l,n[c]=i%Gn|0,l=i/Gn|0;return l&&n.unshift(l),n}function t(n,a,i,l){var c,f;if(i!=l)f=i>l?1:-1;else for(c=f=0;c<i;c++)if(n[c]!=a[c]){f=n[c]>a[c]?1:-1;break}return f}function r(n,a,i){for(var l=0;i--;)n[i]-=l,l=n[i]<a[i]?1:0,n[i]=l*Gn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,l){var c,f,d,m,p,v,x,y,b,_,E,A,T,k,I,O,j,B,U=n.constructor,Y=n.s==a.s?1:-1,te=n.d,V=a.d;if(!n.s)return new U(n);if(!a.s)throw Error(Hi+"Division by zero");for(f=n.e-a.e,j=V.length,I=te.length,x=new U(Y),y=x.d=[],d=0;V[d]==(te[d]||0);)++d;if(V[d]>(te[d]||0)&&--f,i==null?A=i=U.precision:l?A=i+(Cn(n)-Cn(a))+1:A=i,A<0)return new U(0);if(A=A/Wr+2|0,d=0,j==1)for(m=0,V=V[0],A++;(d<I||m)&&A--;d++)T=m*Gn+(te[d]||0),y[d]=T/V|0,m=T%V|0;else{for(m=Gn/(V[0]+1)|0,m>1&&(V=e(V,m),te=e(te,m),j=V.length,I=te.length),k=j,b=te.slice(0,j),_=b.length;_<j;)b[_++]=0;B=V.slice(),B.unshift(0),O=V[0],V[1]>=Gn/2&&++O;do m=0,c=t(V,b,j,_),c<0?(E=b[0],j!=_&&(E=E*Gn+(b[1]||0)),m=E/O|0,m>1?(m>=Gn&&(m=Gn-1),p=e(V,m),v=p.length,_=b.length,c=t(p,b,v,_),c==1&&(m--,r(p,j<v?B:V,v))):(m==0&&(c=m=1),p=V.slice()),v=p.length,v<_&&p.unshift(0),r(b,p,_),c==-1&&(_=b.length,c=t(V,b,j,_),c<1&&(m++,r(b,j<_?B:V,_))),_=b.length):c===0&&(m++,b=[0]),y[d++]=m,c&&b[0]?b[_++]=te[k]||0:(b=[te[k]],_=1);while((k++<I||b[0]!==void 0)&&A--)}return y[0]||y.shift(),x.e=f,Rr(x,l?i+Cn(x)+1:i)}})();function XP(e,t){var r,n,a,i,l,c,f=0,d=0,m=e.constructor,p=m.precision;if(Cn(e)>16)throw Error(Z_+Cn(e));if(!e.s)return new m(fi);for(Zr=!1,c=p,l=new m(.03125);e.abs().gte(.1);)e=e.times(l),d+=5;for(n=Math.log(qo(2,d))/Math.LN10*2+5|0,c+=n,r=a=i=new m(fi),m.precision=c;;){if(a=Rr(a.times(e),c),r=r.times(++f),l=i.plus(nl(a,r,c)),Es(l.d).slice(0,c)===Es(i.d).slice(0,c)){for(;d--;)i=Rr(i.times(i),c);return m.precision=p,t==null?(Zr=!0,Rr(i,p)):i}i=l}}function Cn(e){for(var t=e.e*Wr,r=e.d[0];r>=10;r/=10)t++;return t}function L1(e,t,r){if(t>e.LN10.sd())throw Zr=!0,r&&(e.precision=r),Error(Hi+"LN10 precision limit exceeded");return Rr(new e(e.LN10),t)}function Ql(e){for(var t="";e--;)t+="0";return t}function Gd(e,t){var r,n,a,i,l,c,f,d,m,p=1,v=10,x=e,y=x.d,b=x.constructor,_=b.precision;if(x.s<1)throw Error(Hi+(x.s?"NaN":"-Infinity"));if(x.eq(fi))return new b(0);if(t==null?(Zr=!1,d=_):d=t,x.eq(10))return t==null&&(Zr=!0),L1(b,d);if(d+=v,b.precision=d,r=Es(y),n=r.charAt(0),i=Cn(x),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)x=x.times(e),r=Es(x.d),n=r.charAt(0),p++;i=Cn(x),n>1?(x=new b("0."+r),i++):x=new b(n+"."+r.slice(1))}else return f=L1(b,d+2,_).times(i+""),x=Gd(new b(n+"."+r.slice(1)),d-v).plus(f),b.precision=_,t==null?(Zr=!0,Rr(x,_)):x;for(c=l=x=nl(x.minus(fi),x.plus(fi),d),m=Rr(x.times(x),d),a=3;;){if(l=Rr(l.times(m),d),f=c.plus(nl(l,new b(a),d)),Es(f.d).slice(0,d)===Es(c.d).slice(0,d))return c=c.times(2),i!==0&&(c=c.plus(L1(b,d+2,_).times(i+""))),c=nl(c,new b(p),d),b.precision=_,t==null?(Zr=!0,Rr(c,_)):c;c=f,a+=2}}function YO(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=af(r/Wr),e.d=[],n=(r+1)%Wr,r<0&&(n+=Wr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Wr;n<a;)e.d.push(+t.slice(n,n+=Wr));t=t.slice(n),n=Wr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Zr&&(e.e>kp||e.e<-kp))throw Error(Z_+r)}else e.s=0,e.e=0,e.d=[0];return e}function Rr(e,t,r){var n,a,i,l,c,f,d,m,p=e.d;for(l=1,i=p[0];i>=10;i/=10)l++;if(n=t-l,n<0)n+=Wr,a=t,d=p[m=0];else{if(m=Math.ceil((n+1)/Wr),i=p.length,m>=i)return e;for(d=i=p[m],l=1;i>=10;i/=10)l++;n%=Wr,a=n-Wr+l}if(r!==void 0&&(i=qo(10,l-a-1),c=d/i%10|0,f=t<0||p[m+1]!==void 0||d%i,f=r<4?(c||f)&&(r==0||r==(e.s<0?3:2)):c>5||c==5&&(r==4||f||r==6&&(n>0?a>0?d/qo(10,l-a):0:p[m-1])%10&1||r==(e.s<0?8:7))),t<1||!p[0])return f?(i=Cn(e),p.length=1,t=t-i-1,p[0]=qo(10,(Wr-t%Wr)%Wr),e.e=af(-t/Wr)||0):(p.length=1,p[0]=e.e=e.s=0),e;if(n==0?(p.length=m,i=1,m--):(p.length=m+1,i=qo(10,Wr-n),p[m]=a>0?(d/qo(10,l-a)%qo(10,a)|0)*i:0),f)for(;;)if(m==0){(p[0]+=i)==Gn&&(p[0]=1,++e.e);break}else{if(p[m]+=i,p[m]!=Gn)break;p[m--]=0,i=1}for(n=p.length;p[--n]===0;)p.pop();if(Zr&&(e.e>kp||e.e<-kp))throw Error(Z_+Cn(e));return e}function YP(e,t){var r,n,a,i,l,c,f,d,m,p,v=e.constructor,x=v.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new v(e),Zr?Rr(t,x):t;if(f=e.d,p=t.d,n=t.e,d=e.e,f=f.slice(),l=d-n,l){for(m=l<0,m?(r=f,l=-l,c=p.length):(r=p,n=d,c=f.length),a=Math.max(Math.ceil(x/Wr),c)+2,l>a&&(l=a,r.length=1),r.reverse(),a=l;a--;)r.push(0);r.reverse()}else{for(a=f.length,c=p.length,m=a<c,m&&(c=a),a=0;a<c;a++)if(f[a]!=p[a]){m=f[a]<p[a];break}l=0}for(m&&(r=f,f=p,p=r,t.s=-t.s),c=f.length,a=p.length-c;a>0;--a)f[c++]=0;for(a=p.length;a>l;){if(f[--a]<p[a]){for(i=a;i&&f[--i]===0;)f[i]=Gn-1;--f[i],f[a]+=Gn}f[a]-=p[a]}for(;f[--c]===0;)f.pop();for(;f[0]===0;f.shift())--n;return f[0]?(t.d=f,t.e=n,Zr?Rr(t,x):t):new v(0)}function vc(e,t,r){var n,a=Cn(e),i=Es(e.d),l=i.length;return t?(r&&(n=r-l)>0?i=i.charAt(0)+"."+i.slice(1)+Ql(n):l>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+Ql(-a-1)+i,r&&(n=r-l)>0&&(i+=Ql(n))):a>=l?(i+=Ql(a+1-l),r&&(n=r-a-1)>0&&(i=i+"."+Ql(n))):((n=a+1)<l&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-l)>0&&(a+1===l&&(i+="."),i+=Ql(n))),e.s<0?"-"+i:i}function QO(e,t){if(e.length>t)return e.length=t,!0}function QP(e){var t,r,n;function a(i){var l=this;if(!(l instanceof a))return new a(i);if(l.constructor=a,i instanceof a){l.s=i.s,l.e=i.e,l.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(ic+i);if(i>0)l.s=1;else if(i<0)i=-i,l.s=-1;else{l.s=0,l.e=0,l.d=[0];return}if(i===~~i&&i<1e7){l.e=0,l.d=[i];return}return YO(l,i.toString())}else if(typeof i!="string")throw Error(ic+i);if(i.charCodeAt(0)===45?(i=i.slice(1),l.s=-1):l.s=1,aV.test(i))YO(l,i);else throw Error(ic+i)}if(a.prototype=ft,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=QP,a.config=a.set=iV,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function iV(e){if(!e||typeof e!="object")throw Error(Hi+"Object expected");var t,r,n,a=["precision",1,nf,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(af(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(ic+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(ic+r+": "+n);return this}var e2=QP(nV);fi=new e2(1);const Er=e2;function JP(e){var t;return e===0?t=1:t=Math.floor(new Er(e).abs().log(10).toNumber())+1,t}function ZP(e,t,r){for(var n=new Er(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}var eM=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},tM=(e,t,r)=>{if(e.lte(0))return new Er(0);var n=JP(e.toNumber()),a=new Er(10).pow(n),i=e.div(a),l=n!==1?.05:.1,c=new Er(Math.ceil(i.div(l).toNumber())).add(r).mul(l),f=c.mul(a);return t?new Er(f.toNumber()):new Er(Math.ceil(f.toNumber()))},sV=(e,t,r)=>{var n=new Er(1),a=new Er(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new Er(10).pow(JP(e)-1),a=new Er(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new Er(Math.floor(e)))}else e===0?a=new Er(Math.floor((t-1)/2)):r||(a=new Er(Math.floor(e)));for(var l=Math.floor((t-1)/2),c=[],f=0;f<t;f++)c.push(a.add(new Er(f-l).mul(n)).toNumber());return c},rM=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new Er(0),tickMin:new Er(0),tickMax:new Er(0)};var l=tM(new Er(r).sub(t).div(n-1),a,i),c;t<=0&&r>=0?c=new Er(0):(c=new Er(t).add(r).div(2),c=c.sub(new Er(c).mod(l)));var f=Math.ceil(c.sub(t).div(l).toNumber()),d=Math.ceil(new Er(r).sub(c).div(l).toNumber()),m=f+d+1;return m>n?rM(t,r,n,a,i+1):(m<n&&(d=r>0?d+(n-m):d,f=r>0?f:f+(n-m)),{step:l,tickMin:c.sub(new Er(f).mul(l)),tickMax:c.add(new Er(d).mul(l))})},lV=function(t){var[r,n]=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,l=Math.max(a,2),[c,f]=eM([r,n]);if(c===-1/0||f===1/0){var d=f===1/0?[c,...Array(a-1).fill(1/0)]:[...Array(a-1).fill(-1/0),f];return r>n?d.reverse():d}if(c===f)return sV(c,a,i);var{step:m,tickMin:p,tickMax:v}=rM(c,f,l,i,0),x=ZP(p,v.add(new Er(.1).mul(m)),m);return r>n?x.reverse():x},oV=function(t,r){var[n,a]=t,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[l,c]=eM([n,a]);if(l===-1/0||c===1/0)return[n,a];if(l===c)return[l];var f=Math.max(r,2),d=tM(new Er(c).sub(l).div(f-1),i,0),m=[...ZP(new Er(l),new Er(c),d),c];return i===!1&&(m=m.map(p=>Math.round(p))),n>a?m.reverse():m},nM=e=>e.rootProps.maxBarSize,cV=e=>e.rootProps.barGap,aM=e=>e.rootProps.barCategoryGap,uV=e=>e.rootProps.barSize,T0=e=>e.rootProps.stackOffset,iM=e=>e.rootProps.reverseStackOrder,t2=e=>e.options.chartName,r2=e=>e.rootProps.syncId,sM=e=>e.rootProps.syncMethod,n2=e=>e.options.eventEmitter,pa={grid:-100,barBackground:-50,area:100,cursorRectangle:200,bar:300,line:400,axis:500,scatter:600,activeBar:1e3,cursorLine:1100,activeDot:1200,label:2e3},Bo={allowDecimals:!1,allowDataOverflow:!1,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"auto"},xs={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!0,includeHidden:!1,radiusAxisId:0,reversed:!1,scale:"auto",tick:!0,tickCount:5,type:"auto"},Pg=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t};function Mg(e,t,r){if(r!=="auto")return r;if(e!=null)return po(e,t)?"category":"number"}function JO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Tp(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?JO(Object(r),!0).forEach(function(n){fV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):JO(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function fV(e,t,r){return(t=dV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function dV(e){var t=hV(e,"string");return typeof t=="symbol"?t:t+""}function hV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZO={allowDataOverflow:Bo.allowDataOverflow,allowDecimals:Bo.allowDecimals,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Bo.angleAxisId,includeHidden:!1,name:void 0,reversed:Bo.reversed,scale:Bo.scale,tick:Bo.tick,tickCount:void 0,ticks:void 0,type:Bo.type,unit:void 0},eC={allowDataOverflow:xs.allowDataOverflow,allowDecimals:xs.allowDecimals,allowDuplicatedCategory:xs.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:xs.radiusAxisId,includeHidden:xs.includeHidden,name:void 0,reversed:xs.reversed,scale:xs.scale,tick:xs.tick,tickCount:xs.tickCount,ticks:void 0,type:xs.type,unit:void 0},mV=(e,t)=>{if(t!=null)return e.polarAxis.angleAxis[t]},a2=Te([mV,qI],(e,t)=>{var r;if(e!=null)return e;var n=(r=Mg(t,"angleAxis",ZO.type))!==null&&r!==void 0?r:"category";return Tp(Tp({},ZO),{},{type:n})}),pV=(e,t)=>e.polarAxis.radiusAxis[t],i2=Te([pV,qI],(e,t)=>{var r;if(e!=null)return e;var n=(r=Mg(t,"radiusAxis",eC.type))!==null&&r!==void 0?r:"category";return Tp(Tp({},eC),{},{type:n})}),Rg=e=>e.polarOptions,s2=Te([gl,vl,Ln],lP),lM=Te([Rg,s2],(e,t)=>{if(e!=null)return ka(e.innerRadius,t,0)}),oM=Te([Rg,s2],(e,t)=>{if(e!=null)return ka(e.outerRadius,t,t*.8)}),gV=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},cM=Te([Rg],gV);Te([a2,cM],Pg);var uM=Te([s2,lM,oM],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Te([i2,uM],Pg);var fM=Te([hr,Rg,lM,oM,gl,vl],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:l,cy:c,startAngle:f,endAngle:d}=t;return{cx:ka(l,a,a/2),cy:ka(c,i,i/2),innerRadius:r,outerRadius:n,startAngle:f,endAngle:d,clockWise:!1}}}),nn=(e,t)=>t,A0=(e,t,r)=>r;function l2(e){return e==null?void 0:e.id}function dM(e,t,r){var{chartData:n=[]}=t,{allowDuplicatedCategory:a,dataKey:i}=r,l=new Map;return e.forEach(c=>{var f,d=(f=c.data)!==null&&f!==void 0?f:n;if(!(d==null||d.length===0)){var m=l2(c);d.forEach((p,v)=>{var x=i==null||a?v:String(Gr(p,i,null)),y=Gr(p,c.dataKey,0),b;l.has(x)?b=l.get(x):b={},Object.assign(b,{[m]:y}),l.set(x,b)})}}),Array.from(l.values())}function Fg(e){return"stackId"in e&&e.stackId!=null&&e.dataKey!=null}var Lg=(e,t)=>e===t?!0:e==null||t==null?!1:e[0]===t[0]&&e[1]===t[1];function Bg(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===0&&t.length===0?!0:e===t}function vV(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}return!1}var ta=e=>{var t=hr(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},sf=e=>e.tooltip.settings.axisId;function xV(e){if(e in vd)return vd[e]();var t="scale".concat(g0(e));if(t in vd)return vd[t]()}function tC(e){var t=e.ticks,r=e.bandwidth,n=e.range(),a=[Math.min(...n),Math.max(...n)];return{domain:()=>e.domain(),range:(function(i){function l(){return i.apply(this,arguments)}return l.toString=function(){return i.toString()},l})(()=>a),rangeMin:()=>a[0],rangeMax:()=>a[1],isInRange(i){var l=a[0],c=a[1];return l<=c?i>=l&&i<=c:i>=c&&i<=l},bandwidth:r?()=>r.call(e):void 0,ticks:t?i=>t.call(e,i):void 0,map:(i,l)=>{var c=e(i);if(c!=null){if(e.bandwidth&&l!==null&&l!==void 0&&l.position){var f=e.bandwidth();switch(l.position){case"middle":c+=f/2;break;case"end":c+=f;break}}return c}}}}function rC(e,t,r){if(typeof e=="function")return tC(e.copy().domain(t).range(r));if(e!=null){var n=xV(e);if(n!=null)return n.domain(t).range(r),tC(n)}}var hM=(e,t)=>{if(t!=null)switch(e){case"linear":{if(!dl(t)){for(var r,n,a=0;a<t.length;a++){var i=t[a];rr(i)&&((r===void 0||i<r)&&(r=i),(n===void 0||i>n)&&(n=i))}return r!==void 0&&n!==void 0?[r,n]:void 0}return t}default:return t}};function nC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ap(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nC(Object(r),!0).forEach(function(n){yV(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yV(e,t,r){return(t=bV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bV(e){var t=wV(e,"string");return typeof t=="symbol"?t:t+""}function wV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pw=[0,"auto"],Wn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},mM=(e,t)=>e.cartesianAxis.xAxis[t],bl=(e,t)=>{var r=mM(e,t);return r??Wn},Vn={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:pw,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:b0},pM=(e,t)=>e.cartesianAxis.yAxis[t],wl=(e,t)=>{var r=pM(e,t);return r??Vn},_V={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},o2=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??_V},mn=(e,t,r)=>{switch(t){case"xAxis":return bl(e,r);case"yAxis":return wl(e,r);case"zAxis":return o2(e,r);case"angleAxis":return a2(e,r);case"radiusAxis":return i2(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},SV=(e,t,r)=>{switch(t){case"xAxis":return bl(e,r);case"yAxis":return wl(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},lf=(e,t,r)=>{switch(t){case"xAxis":return bl(e,r);case"yAxis":return wl(e,r);case"angleAxis":return a2(e,r);case"radiusAxis":return i2(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},gM=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function c2(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var u2=e=>e.graphicalItems.cartesianItems,EV=Te([nn,A0],c2),f2=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),j0=Te([u2,mn,EV],f2,{memoizeOptions:{resultEqualityCheck:Bg}}),vM=Te([j0],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Fg)),xM=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),NV=Te([j0],xM),d2=e=>e.map(t=>t.data).filter(Boolean).flat(1),kV=Te([j0],d2,{memoizeOptions:{resultEqualityCheck:Bg}}),h2=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},m2=Te([kV,WP],h2),p2=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Gr(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:Gr(a,n)}))):e.map(n=>({value:n})),Ug=Te([m2,mn,j0],p2);function yM(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Um(e){if(As(e)||e instanceof Date){var t=Number(e);if(rr(t))return t}}function aC(e){if(Array.isArray(e)){var t=[Um(e[0]),Um(e[1])];return dl(t)?t:void 0}var r=Um(e);if(r!=null)return[r,r]}function hl(e){return e.map(Um).filter(Ga)}function TV(e,t,r){return!r||typeof t!="number"||Ts(t)?[]:r.length?hl(r.flatMap(n=>{var a=Gr(e,n.dataKey),i,l;if(Array.isArray(a)?[i,l]=a:i=l=a,!(!rr(i)||!rr(l)))return[t-i,t+l]})):[]}var Un=e=>{var t=ta(e),r=sf(e);return lf(e,t,r)},O0=Te([Un],e=>e==null?void 0:e.dataKey),AV=Te([vM,WP,Un],dM),bM=(e,t,r,n)=>{var a={},i=t.reduce((l,c)=>{if(c.stackId==null)return l;var f=l[c.stackId];return f==null&&(f=[]),f.push(c),l[c.stackId]=f,l},a);return Object.fromEntries(Object.entries(i).map(l=>{var[c,f]=l,d=n?[...f].reverse():f,m=d.map(l2);return[c,{stackedData:K9(e,m,r),graphicalItems:d}]}))},gw=Te([AV,vM,T0,iM],bM),wM=(e,t,r,n)=>{var{dataStartIndex:a,dataEndIndex:i}=t;if(n==null&&r!=="zAxis"){var l=Z9(e,a,i);if(!(l!=null&&l[0]===0&&l[1]===0))return l}},jV=Te([mn],e=>e.allowDataOverflow),g2=e=>{var t;if(e==null||!("domain"in e))return pw;if(e.domain!=null)return e.domain;if("ticks"in e&&e.ticks!=null){if(e.type==="number"){var r=hl(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:pw},v2=Te([mn],g2),x2=Te([v2,jV],VP),OV=Te([gw,yl,nn,x2],wM,{memoizeOptions:{resultEqualityCheck:Lg}}),$g=e=>e.errorBars,CV=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>yM(r,n)),jp=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),l=Math.min(...i),c=Math.max(...i);return[l,c]}},y2=(e,t,r,n,a)=>{var i,l;if(r.length>0&&e.forEach(c=>{r.forEach(f=>{var d,m,p=(d=n[f.id])===null||d===void 0?void 0:d.filter(E=>yM(a,E)),v=Gr(c,(m=t.dataKey)!==null&&m!==void 0?m:f.dataKey),x=TV(c,v,p);if(x.length>=2){var y=Math.min(...x),b=Math.max(...x);(i==null||y<i)&&(i=y),(l==null||b>l)&&(l=b)}var _=aC(v);_!=null&&(i=i==null?_[0]:Math.min(i,_[0]),l=l==null?_[1]:Math.max(l,_[1]))})}),(t==null?void 0:t.dataKey)!=null&&e.forEach(c=>{var f=aC(Gr(c,t.dataKey));f!=null&&(i=i==null?f[0]:Math.min(i,f[0]),l=l==null?f[1]:Math.max(l,f[1]))}),rr(i)&&rr(l))return[i,l]},DV=Te([m2,mn,NV,$g,nn],y2,{memoizeOptions:{resultEqualityCheck:Lg}});function IV(e){var{value:t}=e;if(As(t)||t instanceof Date)return t}var PV=(e,t,r)=>{var n=e.map(IV).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&$D(n))?fP(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},_M=e=>e.referenceElements.dots,of=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),MV=Te([_M,nn,A0],of),SM=e=>e.referenceElements.areas,RV=Te([SM,nn,A0],of),EM=e=>e.referenceElements.lines,FV=Te([EM,nn,A0],of),NM=(e,t)=>{if(e!=null){var r=hl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},LV=Te(MV,nn,NM),kM=(e,t)=>{if(e!=null){var r=hl(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},BV=Te([RV,nn],kM);function UV(e){var t;if(e.x!=null)return hl([e.x]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.x);return r==null||r.length===0?[]:hl(r)}function $V(e){var t;if(e.y!=null)return hl([e.y]);var r=(t=e.segment)===null||t===void 0?void 0:t.map(n=>n.y);return r==null||r.length===0?[]:hl(r)}var TM=(e,t)=>{if(e!=null){var r=e.flatMap(n=>t==="xAxis"?UV(n):$V(n));if(r.length!==0)return[Math.min(...r),Math.max(...r)]}},zV=Te([FV,nn],TM),HV=Te(LV,zV,BV,(e,t,r)=>jp(e,r,t)),b2=(e,t,r,n,a,i,l,c)=>{if(r!=null)return r;var f=l==="vertical"&&c==="xAxis"||l==="horizontal"&&c==="yAxis",d=f?jp(n,i,a):jp(i,a);return rV(t,d,e.allowDataOverflow)},qV=Te([mn,v2,x2,OV,DV,HV,hr,nn],b2,{memoizeOptions:{resultEqualityCheck:Lg}}),WV=[0,1],w2=(e,t,r,n,a,i,l)=>{if(!((e==null||r==null||r.length===0)&&l===void 0)){var{dataKey:c,type:f}=e,d=po(t,i);if(d&&c==null){var m;return fP(0,(m=r==null?void 0:r.length)!==null&&m!==void 0?m:0)}return f==="category"?PV(n,e,d):a==="expand"?WV:l}},_2=Te([mn,hr,m2,Ug,T0,nn,qV],w2);function VV(e){return e in vd}var AM=(e,t,r)=>{if(e!=null){var{scale:n,type:a}=e;if(n==="auto")return a==="category"&&r&&(r.indexOf("LineChart")>=0||r.indexOf("AreaChart")>=0||r.indexOf("ComposedChart")>=0&&!t)?"point":a==="category"?"band":"linear";if(typeof n=="string"){var i="scale".concat(g0(n));return VV(i)?i:"point"}}},xo=Te([mn,gM,t2],AM);function S2(e,t,r,n){if(!(r==null||n==null))return typeof e.scale=="function"?rC(e.scale,r,n):rC(t,r,n)}var E2=(e,t,r)=>{var n=g2(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&dl(e))return lV(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&dl(e))return oV(e,t.tickCount,t.allowDecimals)}},N2=Te([_2,lf,xo],E2),k2=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&dl(t)&&Array.isArray(r)&&r.length>0){var a,i,l=t[0],c=(a=r[0])!==null&&a!==void 0?a:0,f=t[1],d=(i=r[r.length-1])!==null&&i!==void 0?i:0;return[Math.min(l,c),Math.max(f,d)]}return t},GV=Te([mn,_2,N2,nn],k2),KV=Te(Ug,mn,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(hl(e.map(p=>p.value))).sort((p,v)=>p-v),a=n[0],i=n[n.length-1];if(a==null||i==null)return 1/0;var l=i-a;if(l===0)return 1/0;for(var c=0;c<n.length-1;c++){var f=n[c],d=n[c+1];if(!(f==null||d==null)){var m=d-f;r=Math.min(r,m)}}return r/l}}),jM=Te(KV,hr,aM,Ln,(e,t,r,n,a)=>a,(e,t,r,n,a)=>{if(!rr(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var l=ka(r,e*i),c=e*i/2;return c-l-(c-l)/i*l}return 0}),XV=(e,t,r)=>{var n=bl(e,t);return n==null||typeof n.padding!="string"?0:jM(e,"xAxis",t,r,n.padding)},YV=(e,t,r)=>{var n=wl(e,t);return n==null||typeof n.padding!="string"?0:jM(e,"yAxis",t,r,n.padding)},QV=Te(bl,XV,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),JV=Te(wl,YV,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),ZV=Te([Ln,QV,yg,xg,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),eG=Te([Ln,hr,JV,yg,xg,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:l}=a;return i?[n.height-l.bottom,l.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),C0=(e,t,r,n)=>{var a;switch(t){case"xAxis":return ZV(e,r,n);case"yAxis":return eG(e,r,n);case"zAxis":return(a=o2(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return cM(e);case"radiusAxis":return uM(e,r);default:return}},OM=Te([mn,C0],Pg),tG=Te([xo,GV],hM),zg=Te([mn,xo,tG,OM],S2);Te([j0,$g,nn],CV);function CM(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Hg=(e,t)=>t,qg=(e,t,r)=>r,rG=Te(gg,Hg,qg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(CM)),nG=Te(vg,Hg,qg,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(CM)),DM=(e,t)=>({width:e.width,height:t.height}),aG=(e,t)=>{var r=typeof t.width=="number"?t.width:b0;return{width:r,height:e.height}},IM=Te(Ln,bl,DM),iG=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},sG=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}},lG=Te(vl,Ln,rG,Hg,qg,(e,t,r,n,a)=>{var i={},l;return r.forEach(c=>{var f=DM(t,c);l==null&&(l=iG(t,n,e));var d=n==="top"&&!a||n==="bottom"&&a;i[c.id]=l-Number(d)*f.height,l+=(d?-1:1)*f.height}),i}),oG=Te(gl,Ln,nG,Hg,qg,(e,t,r,n,a)=>{var i={},l;return r.forEach(c=>{var f=aG(t,c);l==null&&(l=sG(t,n,e));var d=n==="left"&&!a||n==="right"&&a;i[c.id]=l-Number(d)*f.width,l+=(d?-1:1)*f.width}),i}),cG=(e,t)=>{var r=bl(e,t);if(r!=null)return lG(e,r.orientation,r.mirror)},uG=Te([Ln,bl,cG,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:e.left,y:0}:{x:e.left,y:a}}}),fG=(e,t)=>{var r=wl(e,t);if(r!=null)return oG(e,r.orientation,r.mirror)},dG=Te([Ln,wl,fG,(e,t)=>t],(e,t,r,n)=>{if(t!=null){var a=r==null?void 0:r[n];return a==null?{x:0,y:e.top}:{x:a,y:e.top}}}),PM=Te(Ln,wl,(e,t)=>{var r=typeof t.width=="number"?t.width:b0;return{width:r,height:e.height}}),iC=(e,t,r)=>{switch(t){case"xAxis":return IM(e,r).width;case"yAxis":return PM(e,r).height;default:return}},MM=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:l}=r,c=po(e,n),f=t.map(d=>d.value);if(l&&c&&i==="category"&&a&&$D(f))return f}},T2=Te([hr,Ug,mn,nn],MM),RM=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,l=po(e,n);if(l&&(a==="number"||i!=="auto"))return t.map(c=>c.value)}},A2=Te([hr,Ug,lf,nn],RM),sC=Te([hr,SV,xo,zg,T2,A2,C0,N2,nn],(e,t,r,n,a,i,l,c,f)=>{if(t!=null){var d=po(e,f);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:f,categoricalDomain:i,duplicateDomain:a,isCategorical:d,niceTicks:c,range:l,realScaleType:r,scale:n}}}),hG=(e,t,r,n,a,i,l,c,f)=>{if(!(t==null||n==null)){var d=po(e,f),{type:m,ticks:p,tickCount:v}=t,x=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,y=m==="category"&&n.bandwidth?n.bandwidth()/x:0;y=f==="angleAxis"&&i!=null&&i.length>=2?Yn(i[0]-i[1])*2*y:y;var b=p||a;return b?b.map((_,E)=>{var A=l?l.indexOf(_):_,T=n.map(A);return rr(T)?{index:E,coordinate:T+y,value:_,offset:y}:null}).filter(Ga):d&&c?c.map((_,E)=>{var A=n.map(_);return rr(A)?{coordinate:A+y,value:_,index:E,offset:y}:null}).filter(Ga):n.ticks?n.ticks(v).map((_,E)=>{var A=n.map(_);return rr(A)?{coordinate:A+y,value:_,index:E,offset:y}:null}).filter(Ga):n.domain().map((_,E)=>{var A=n.map(_);return rr(A)?{coordinate:A+y,value:l?l[_]:_,index:E,offset:y}:null}).filter(Ga)}},FM=Te([hr,lf,xo,zg,N2,C0,T2,A2,nn],hG),mG=(e,t,r,n,a,i,l)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var c=po(e,l),{tickCount:f}=t,d=0;return d=l==="angleAxis"&&(n==null?void 0:n.length)>=2?Yn(n[0]-n[1])*2*d:d,c&&i?i.map((m,p)=>{var v=r.map(m);return rr(v)?{coordinate:v+d,value:m,index:p,offset:d}:null}).filter(Ga):r.ticks?r.ticks(f).map((m,p)=>{var v=r.map(m);return rr(v)?{coordinate:v+d,value:m,index:p,offset:d}:null}).filter(Ga):r.domain().map((m,p)=>{var v=r.map(m);return rr(v)?{coordinate:v+d,value:a?a[m]:m,index:p,offset:d}:null}).filter(Ga)}},Ku=Te([hr,lf,zg,C0,T2,A2,nn],mG),Xu=Te(mn,zg,(e,t)=>{if(!(e==null||t==null))return Ap(Ap({},e),{},{scale:t})}),pG=Te([mn,xo,_2,OM],S2);Te((e,t,r)=>o2(e,r),pG,(e,t)=>{if(!(e==null||t==null))return Ap(Ap({},e),{},{scale:t})});var gG=Te([hr,gg,vg],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),LM=e=>e.options.defaultTooltipEventType,BM=e=>e.options.validateTooltipEventTypes;function UM(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function j2(e,t){var r=LM(e),n=BM(e);return UM(t,r,n)}function vG(e){return xt(t=>j2(t,e))}var $M=(e,t)=>{var r,n=Number(t);if(!(Ts(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},xG=e=>e.tooltip.settings,eo={active:!1,index:null,dataKey:void 0,graphicalItemId:void 0,coordinate:void 0},yG={itemInteraction:{click:eo,hover:eo},axisInteraction:{click:eo,hover:eo},keyboardInteraction:eo,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0,sourceViewBox:void 0,graphicalItemId:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},zM=Qa({name:"tooltip",initialState:yG,reducers:{addTooltipEntrySettings:{reducer(e,t){e.tooltipItemPayloads.push(t.payload)},prepare:Jr()},replaceTooltipEntrySettings:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ss(e).tooltipItemPayloads.indexOf(r);a>-1&&(e.tooltipItemPayloads[a]=n)},prepare:Jr()},removeTooltipEntrySettings:{reducer(e,t){var r=ss(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},prepare:Jr()},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.graphicalItemId=t.payload.activeGraphicalItemId,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate}}}),{addTooltipEntrySettings:bG,replaceTooltipEntrySettings:wG,removeTooltipEntrySettings:_G,setTooltipSettingsState:SG,setActiveMouseOverItemIndex:HM,mouseLeaveItem:EG,mouseLeaveChart:qM,setActiveClickItemIndex:NG,setMouseOverAxisIndex:WM,setMouseClickAxisIndex:kG,setSyncInteraction:vw,setKeyboardInteraction:xw}=zM.actions,TG=zM.reducer;function lC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function vm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?lC(Object(r),!0).forEach(function(n){AG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):lC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AG(e,t,r){return(t=jG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jG(e){var t=OG(e,"string");return typeof t=="symbol"?t:t+""}function OG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CG(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function DG(e){return e.index!=null}var VM=(e,t,r,n)=>{if(t==null)return eo;var a=CG(e,t,r);if(a==null)return eo;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(DG(a)){if(i)return vm(vm({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n,graphicalItemId:void 0};return vm(vm({},eo),{},{coordinate:a.coordinate})};function IG(e){if(typeof e=="number")return Number.isFinite(e)?e:void 0;if(e instanceof Date){var t=e.valueOf();return Number.isFinite(t)?t:void 0}var r=Number(e);return Number.isFinite(r)?r:void 0}function PG(e,t){var r=IG(e),n=t[0],a=t[1];if(r===void 0)return!1;var i=Math.min(n,a),l=Math.max(n,a);return r>=i&&r<=l}function MG(e,t,r){if(r==null||t==null)return!0;var n=Gr(e,t);return n==null||!dl(r)?!0:PG(n,r)}var O2=(e,t,r,n)=>{var a=e==null?void 0:e.index;if(a==null)return null;var i=Number(a);if(!rr(i))return a;var l=0,c=1/0;t.length>0&&(c=t.length-1);var f=Math.max(l,Math.min(i,c)),d=t[f];return d==null||MG(d,r,n)?String(f):null},GM=(e,t,r,n,a,i,l)=>{if(i!=null){var c=l[0],f=c==null?void 0:c.getPosition(i);if(f!=null)return f;var d=a==null?void 0:a[Number(i)];if(d)switch(r){case"horizontal":return{x:d.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:d.coordinate}}}},KM=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;if(r==="hover"?a=e.itemInteraction.hover.graphicalItemId:a=e.itemInteraction.click.graphicalItemId,a==null&&n!=null){var i=e.tooltipItemPayloads[0];return i!=null?[i]:[]}return e.tooltipItemPayloads.filter(l=>{var c;return((c=l.settings)===null||c===void 0?void 0:c.graphicalItemId)===a})},XM=e=>e.options.tooltipPayloadSearcher,cf=e=>e.tooltip;function oC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function cC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?oC(Object(r),!0).forEach(function(n){RG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RG(e,t,r){return(t=FG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FG(e){var t=LG(e,"string");return typeof t=="symbol"?t:t+""}function LG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BG(e,t){return e??t}var YM=(e,t,r,n,a,i,l)=>{if(!(t==null||i==null)){var{chartData:c,computedData:f,dataStartIndex:d,dataEndIndex:m}=r,p=[];return e.reduce((v,x)=>{var y,{dataDefinedOnItem:b,settings:_}=x,E=BG(b,c),A=Array.isArray(E)?II(E,d,m):E,T=(y=_==null?void 0:_.dataKey)!==null&&y!==void 0?y:n,k=_==null?void 0:_.nameKey,I;if(n&&Array.isArray(A)&&!Array.isArray(A[0])&&l==="axis"?I=b7(A,n,a):I=i(A,t,f,k),Array.isArray(I))I.forEach(j=>{var B=cC(cC({},_),{},{name:j.name,unit:j.unit,color:void 0,fill:void 0});v.push(lj({tooltipEntrySettings:B,dataKey:j.dataKey,payload:j.payload,value:Gr(j.payload,j.dataKey),name:j.name}))});else{var O;v.push(lj({tooltipEntrySettings:_,dataKey:T,payload:I,value:Gr(I,T),name:(O=Gr(I,k))!==null&&O!==void 0?O:_==null?void 0:_.name}))}return v},p)}},C2=Te([Un,gM,t2],AM),UG=Te([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),$G=Te([ta,sf],c2),uf=Te([UG,Un,$G],f2,{memoizeOptions:{resultEqualityCheck:Bg}}),zG=Te([uf],e=>e.filter(Fg)),HG=Te([uf],d2,{memoizeOptions:{resultEqualityCheck:Bg}}),ff=Te([HG,yl],h2),qG=Te([zG,yl,Un],dM),D2=Te([ff,Un,uf],p2),QM=Te([Un],g2),WG=Te([Un],e=>e.allowDataOverflow),JM=Te([QM,WG],VP),VG=Te([uf],e=>e.filter(Fg)),GG=Te([qG,VG,T0,iM],bM),KG=Te([GG,yl,ta,JM],wM),XG=Te([uf],xM),YG=Te([ff,Un,XG,$g,ta],y2,{memoizeOptions:{resultEqualityCheck:Lg}}),QG=Te([_M,ta,sf],of),JG=Te([QG,ta],NM),ZG=Te([SM,ta,sf],of),eK=Te([ZG,ta],kM),tK=Te([EM,ta,sf],of),rK=Te([tK,ta],TM),nK=Te([JG,rK,eK],jp),aK=Te([Un,QM,JM,KG,YG,nK,hr,ta],b2),D0=Te([Un,hr,ff,D2,T0,ta,aK],w2),iK=Te([D0,Un,C2],E2),sK=Te([Un,D0,iK,ta],k2),ZM=e=>{var t=ta(e),r=sf(e),n=!1;return C0(e,t,r,n)},eR=Te([Un,ZM],Pg),tR=Te([Un,C2,sK,eR],S2),lK=Te([hr,D2,Un,ta],MM),oK=Te([hr,D2,Un,ta],RM),cK=(e,t,r,n,a,i,l,c)=>{if(t){var{type:f}=t,d=po(e,c);if(n){var m=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,p=f==="category"&&n.bandwidth?n.bandwidth()/m:0;return p=c==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Yn(a[0]-a[1])*2*p:p,d&&l?l.map((v,x)=>{var y=n.map(v);return rr(y)?{coordinate:y+p,value:v,index:x,offset:p}:null}).filter(Ga):n.domain().map((v,x)=>{var y=n.map(v);return rr(y)?{coordinate:y+p,value:i?i[v]:v,index:x,offset:p}:null}).filter(Ga)}}},_l=Te([hr,Un,C2,tR,ZM,lK,oK,ta],cK),I2=Te([LM,BM,xG],(e,t,r)=>UM(r.shared,e,t)),rR=e=>e.tooltip.settings.trigger,P2=e=>e.tooltip.settings.defaultIndex,I0=Te([cf,I2,rR,P2],VM),xc=Te([I0,ff,O0,D0],O2),nR=Te([_l,xc],$M),M2=Te([I0],e=>{if(e)return e.dataKey}),uK=Te([I0],e=>{if(e)return e.graphicalItemId}),aR=Te([cf,I2,rR,P2],KM),fK=Te([gl,vl,hr,Ln,_l,P2,aR],GM),dK=Te([I0,fK],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),hK=Te([I0],e=>{var t;return(t=e==null?void 0:e.active)!==null&&t!==void 0?t:!1}),mK=Te([aR,xc,yl,O0,nR,XM,I2],YM);Te([mK],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function uC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function fC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?uC(Object(r),!0).forEach(function(n){pK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):uC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pK(e,t,r){return(t=gK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gK(e){var t=vK(e,"string");return typeof t=="symbol"?t:t+""}function vK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var xK=()=>xt(Un),yK=()=>{var e=xK(),t=xt(_l),r=xt(tR);return sp(!e||!r?void 0:fC(fC({},e),{},{scale:r}),t)};function dC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function pu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?dC(Object(r),!0).forEach(function(n){bK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):dC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bK(e,t,r){return(t=wK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wK(e){var t=_K(e,"string");return typeof t=="symbol"?t:t+""}function _K(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var SK=(e,t,r,n)=>{var a=t.find(i=>i&&i.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.chartY};if(e==="vertical")return{x:n.chartX,y:a.coordinate}}return{x:0,y:0}},EK=(e,t,r,n)=>{var a=t.find(d=>d&&d.index===r);if(a){if(e==="centric"){var i=a.coordinate,{radius:l}=n;return pu(pu(pu({},n),On(n.cx,n.cy,l,i)),{},{angle:i,radius:l})}var c=a.coordinate,{angle:f}=n;return pu(pu(pu({},n),On(n.cx,n.cy,c,f)),{},{angle:f,radius:c})}return{angle:0,clockWise:!1,cx:0,cy:0,endAngle:0,innerRadius:0,outerRadius:0,radius:0,startAngle:0,x:0,y:0}};function NK(e,t){var{chartX:r,chartY:n}=e;return r>=t.left&&r<=t.left+t.width&&n>=t.top&&n<=t.top+t.height}var iR=(e,t,r,n,a)=>{var i,l=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(l<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<l;c++){var f,d,m,p,v,x=c>0?(f=r[c-1])===null||f===void 0?void 0:f.coordinate:(d=r[l-1])===null||d===void 0?void 0:d.coordinate,y=(m=r[c])===null||m===void 0?void 0:m.coordinate,b=c>=l-1?(p=r[0])===null||p===void 0?void 0:p.coordinate:(v=r[c+1])===null||v===void 0?void 0:v.coordinate,_=void 0;if(!(x==null||y==null||b==null))if(Yn(y-x)!==Yn(b-y)){var E=[];if(Yn(b-y)===Yn(a[1]-a[0])){_=b;var A=y+a[1]-a[0];E[0]=Math.min(A,(A+x)/2),E[1]=Math.max(A,(A+x)/2)}else{_=x;var T=b+a[1]-a[0];E[0]=Math.min(y,(T+y)/2),E[1]=Math.max(y,(T+y)/2)}var k=[Math.min(y,(_+y)/2),Math.max(y,(_+y)/2)];if(e>k[0]&&e<=k[1]||e>=E[0]&&e<=E[1]){var I;return(I=r[c])===null||I===void 0?void 0:I.index}}else{var O=Math.min(x,b),j=Math.max(x,b);if(e>(O+y)/2&&e<=(j+y)/2){var B;return(B=r[c])===null||B===void 0?void 0:B.index}}}else if(t)for(var U=0;U<l;U++){var Y=t[U];if(Y!=null){var te=t[U+1],V=t[U-1];if(U===0&&te!=null&&e<=(Y.coordinate+te.coordinate)/2||U===l-1&&V!=null&&e>(Y.coordinate+V.coordinate)/2||U>0&&U<l-1&&V!=null&&te!=null&&e>(Y.coordinate+V.coordinate)/2&&e<=(Y.coordinate+te.coordinate)/2)return Y.index}}return-1},kK=()=>xt(t2),R2=(e,t)=>t,sR=(e,t,r)=>r,F2=(e,t,r,n)=>n,TK=Te(_l,e=>ig(e,t=>t.coordinate)),L2=Te([cf,R2,sR,F2],VM),B2=Te([L2,ff,O0,D0],O2),AK=(e,t,r)=>{if(t!=null){var n=cf(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},lR=Te([cf,R2,sR,F2],KM),Op=Te([gl,vl,hr,Ln,_l,F2,lR],GM),jK=Te([L2,Op],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),oR=Te([_l,B2],$M),OK=Te([lR,B2,yl,O0,oR,XM,R2],YM),CK=Te([L2,B2],(e,t)=>({isActive:e.active&&t!=null,activeIndex:t})),DK=(e,t,r,n,a,i,l)=>{if(!(!e||!r||!n||!a)&&NK(e,l)){var c=e$(e,t),f=iR(c,i,a,r,n),d=SK(t,a,f,e);return{activeIndex:String(f),activeCoordinate:d}}},IK=(e,t,r,n,a,i,l)=>{if(!(!e||!n||!a||!i||!r)){var c=vH(e,r);if(c){var f=t$(c,t),d=iR(f,l,i,n,a),m=EK(t,i,d,c);return{activeIndex:String(d),activeCoordinate:m}}}},PK=(e,t,r,n,a,i,l,c)=>{if(!(!e||!t||!n||!a||!i))return t==="horizontal"||t==="vertical"?DK(e,t,n,a,i,l,c):IK(e,t,r,n,a,i,l)},MK=Te(e=>e.zIndex.zIndexMap,(e,t)=>t,(e,t,r)=>r,(e,t,r)=>{if(t!=null){var n=e[t];if(n!=null)return r?n.panoramaElement:n.element}}),RK=Te(e=>e.zIndex.zIndexMap,e=>{var t=Object.keys(e).map(n=>parseInt(n,10)).concat(Object.values(pa)),r=Array.from(new Set(t));return r.sort((n,a)=>n-a)},{memoizeOptions:{resultEqualityCheck:vV}});function hC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function mC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?hC(Object(r),!0).forEach(function(n){FK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FK(e,t,r){return(t=LK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function LK(e){var t=BK(e,"string");return typeof t=="symbol"?t:t+""}function BK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var UK={},$K={zIndexMap:Object.values(pa).reduce((e,t)=>mC(mC({},e),{},{[t]:{element:void 0,panoramaElement:void 0,consumers:0}}),UK)},zK=new Set(Object.values(pa));function HK(e){return zK.has(e)}var cR=Qa({name:"zIndex",initialState:$K,reducers:{registerZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]?e.zIndexMap[r].consumers+=1:e.zIndexMap[r]={consumers:1,element:void 0,panoramaElement:void 0}},prepare:Jr()},unregisterZIndexPortal:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(e.zIndexMap[r].consumers-=1,e.zIndexMap[r].consumers<=0&&!HK(r)&&delete e.zIndexMap[r])},prepare:Jr()},registerZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r,element:n,isPanorama:a}=t.payload;e.zIndexMap[r]?a?e.zIndexMap[r].panoramaElement=n:e.zIndexMap[r].element=n:e.zIndexMap[r]={consumers:0,element:a?void 0:n,panoramaElement:a?n:void 0}},prepare:Jr()},unregisterZIndexPortalElement:{reducer:(e,t)=>{var{zIndex:r}=t.payload;e.zIndexMap[r]&&(t.payload.isPanorama?e.zIndexMap[r].panoramaElement=void 0:e.zIndexMap[r].element=void 0)},prepare:Jr()}}}),{registerZIndexPortal:qK,unregisterZIndexPortal:WK,registerZIndexPortalElement:VK,unregisterZIndexPortalElement:GK}=cR.actions,KK=cR.reducer;function ds(e){var{zIndex:t,children:r}=e,n=D$(),a=n&&t!==void 0&&t!==0,i=Ja(),l=Ur();N.useLayoutEffect(()=>a?(l(qK({zIndex:t})),()=>{l(WK({zIndex:t}))}):ef,[l,t,a]);var c=xt(f=>MK(f,t,i));return a?c?a_.createPortal(r,c):null:r}function yw(){return yw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yw.apply(null,arguments)}function pC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?pC(Object(r),!0).forEach(function(n){XK(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):pC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XK(e,t,r){return(t=YK(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YK(e){var t=QK(e,"string");return typeof t=="symbol"?t:t+""}function QK(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function JK(e){var{cursor:t,cursorComp:r,cursorProps:n}=e;return N.isValidElement(t)?N.cloneElement(t,n):N.createElement(r,n)}function ZK(e){var t,{coordinate:r,payload:n,index:a,offset:i,tooltipAxisBandSize:l,layout:c,cursor:f,tooltipEventType:d,chartName:m}=e,p=r,v=n,x=a;if(!f||!p||m!=="ScatterChart"&&d!=="axis")return null;var y,b,_;if(m==="ScatterChart")y=p,b=Cz,_=pa.cursorLine;else if(m==="BarChart")y=Dz(c,p,i,l),b=sP,_=pa.cursorRectangle;else if(c==="radial"&&HD(p)){var{cx:E,cy:A,radius:T,startAngle:k,endAngle:I}=oP(p);y={cx:E,cy:A,startAngle:k,endAngle:I,innerRadius:T,outerRadius:T},b=uP,_=pa.cursorLine}else y={points:wH(c,p,i)},b=j_,_=pa.cursorLine;var O=typeof f=="object"&&"className"in f?f.className:void 0,j=xm(xm(xm(xm({stroke:"#ccc",pointerEvents:"none"},i),y),Pd(f)),{},{payload:v,payloadIndex:x,className:kr("recharts-tooltip-cursor",O)});return N.createElement(ds,{zIndex:(t=e.zIndex)!==null&&t!==void 0?t:_},N.createElement(JK,{cursor:f,cursorComp:b,cursorProps:j}))}function eX(e){var t=yK(),r=zI(),n=tf(),a=kK();return t==null||r==null||n==null||a==null?null:N.createElement(ZK,yw({},e,{offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var uR=N.createContext(null),tX=()=>N.useContext(uR),B1={exports:{}},gC;function rX(){return gC||(gC=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(f,d,m){this.fn=f,this.context=d,this.once=m||!1}function i(f,d,m,p,v){if(typeof m!="function")throw new TypeError("The listener must be a function");var x=new a(m,p||f,v),y=r?r+d:d;return f._events[y]?f._events[y].fn?f._events[y]=[f._events[y],x]:f._events[y].push(x):(f._events[y]=x,f._eventsCount++),f}function l(f,d){--f._eventsCount===0?f._events=new n:delete f._events[d]}function c(){this._events=new n,this._eventsCount=0}c.prototype.eventNames=function(){var d=[],m,p;if(this._eventsCount===0)return d;for(p in m=this._events)t.call(m,p)&&d.push(r?p.slice(1):p);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(m)):d},c.prototype.listeners=function(d){var m=r?r+d:d,p=this._events[m];if(!p)return[];if(p.fn)return[p.fn];for(var v=0,x=p.length,y=new Array(x);v<x;v++)y[v]=p[v].fn;return y},c.prototype.listenerCount=function(d){var m=r?r+d:d,p=this._events[m];return p?p.fn?1:p.length:0},c.prototype.emit=function(d,m,p,v,x,y){var b=r?r+d:d;if(!this._events[b])return!1;var _=this._events[b],E=arguments.length,A,T;if(_.fn){switch(_.once&&this.removeListener(d,_.fn,void 0,!0),E){case 1:return _.fn.call(_.context),!0;case 2:return _.fn.call(_.context,m),!0;case 3:return _.fn.call(_.context,m,p),!0;case 4:return _.fn.call(_.context,m,p,v),!0;case 5:return _.fn.call(_.context,m,p,v,x),!0;case 6:return _.fn.call(_.context,m,p,v,x,y),!0}for(T=1,A=new Array(E-1);T<E;T++)A[T-1]=arguments[T];_.fn.apply(_.context,A)}else{var k=_.length,I;for(T=0;T<k;T++)switch(_[T].once&&this.removeListener(d,_[T].fn,void 0,!0),E){case 1:_[T].fn.call(_[T].context);break;case 2:_[T].fn.call(_[T].context,m);break;case 3:_[T].fn.call(_[T].context,m,p);break;case 4:_[T].fn.call(_[T].context,m,p,v);break;default:if(!A)for(I=1,A=new Array(E-1);I<E;I++)A[I-1]=arguments[I];_[T].fn.apply(_[T].context,A)}}return!0},c.prototype.on=function(d,m,p){return i(this,d,m,p,!1)},c.prototype.once=function(d,m,p){return i(this,d,m,p,!0)},c.prototype.removeListener=function(d,m,p,v){var x=r?r+d:d;if(!this._events[x])return this;if(!m)return l(this,x),this;var y=this._events[x];if(y.fn)y.fn===m&&(!v||y.once)&&(!p||y.context===p)&&l(this,x);else{for(var b=0,_=[],E=y.length;b<E;b++)(y[b].fn!==m||v&&!y[b].once||p&&y[b].context!==p)&&_.push(y[b]);_.length?this._events[x]=_.length===1?_[0]:_:l(this,x)}return this},c.prototype.removeAllListeners=function(d){var m;return d?(m=r?r+d:d,this._events[m]&&l(this,m)):(this._events=new n,this._eventsCount=0),this},c.prototype.off=c.prototype.removeListener,c.prototype.addListener=c.prototype.on,c.prefixed=r,c.EventEmitter=c,e.exports=c})(B1)),B1.exports}var nX=rX();const aX=Cs(nX);var Kd=new aX,bw="recharts.syncEvent.tooltip",vC="recharts.syncEvent.brush",fR=(e,t)=>{if(t&&Array.isArray(e)){var r=Number.parseInt(t,10);if(!Ts(r))return e[r]}},iX={chartName:"",tooltipPayloadSearcher:()=>{},eventEmitter:void 0,defaultTooltipEventType:"axis"},dR=Qa({name:"options",initialState:iX,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),sX=dR.reducer,{createEventEmitter:lX}=dR.actions;function oX(e){return e.tooltip.syncInteraction}var cX={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},hR=Qa({name:"chartData",initialState:cX,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:xC,setDataStartEndIndexes:uX,setComputedData:Xge}=hR.actions,fX=hR.reducer,dX=["x","y"];function yC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function gu(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?yC(Object(r),!0).forEach(function(n){hX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hX(e,t,r){return(t=mX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mX(e){var t=pX(e,"string");return typeof t=="symbol"?t:t+""}function pX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gX(e,t){if(e==null)return{};var r,n,a=vX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function vX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function xX(){var e=xt(r2),t=xt(n2),r=Ur(),n=xt(sM),a=xt(_l),i=tf(),l=bg(),c=xt(f=>f.rootProps.className);N.useEffect(()=>{if(e==null)return ef;var f=(d,m,p)=>{if(t!==p&&e===d){if(n==="index"){var v;if(l&&m!==null&&m!==void 0&&(v=m.payload)!==null&&v!==void 0&&v.coordinate&&m.payload.sourceViewBox){var x=m.payload.coordinate,{x:y,y:b}=x,_=gX(x,dX),{x:E,y:A,width:T,height:k}=m.payload.sourceViewBox,I=gu(gu({},_),{},{x:l.x+(T?(y-E)/T:0)*l.width,y:l.y+(k?(b-A)/k:0)*l.height});r(gu(gu({},m),{},{payload:gu(gu({},m.payload),{},{coordinate:I})}))}else r(m);return}if(a!=null){var O;if(typeof n=="function"){var j={activeTooltipIndex:m.payload.index==null?void 0:Number(m.payload.index),isTooltipActive:m.payload.active,activeIndex:m.payload.index==null?void 0:Number(m.payload.index),activeLabel:m.payload.label,activeDataKey:m.payload.dataKey,activeCoordinate:m.payload.coordinate},B=n(a,j);O=a[B]}else n==="value"&&(O=a.find(z=>String(z.value)===m.payload.label));var{coordinate:U}=m.payload;if(O==null||m.payload.active===!1||U==null||l==null){r(vw({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0,sourceViewBox:void 0,graphicalItemId:void 0}));return}var{x:Y,y:te}=U,V=Math.min(Y,l.x+l.width),ge=Math.min(te,l.y+l.height),be={x:i==="horizontal"?O.coordinate:V,y:i==="horizontal"?ge:O.coordinate},ve=vw({active:m.payload.active,coordinate:be,dataKey:m.payload.dataKey,index:String(O.index),label:m.payload.label,sourceViewBox:m.payload.sourceViewBox,graphicalItemId:m.payload.graphicalItemId});r(ve)}}};return Kd.on(bw,f),()=>{Kd.off(bw,f)}},[c,r,t,e,n,a,i,l])}function yX(){var e=xt(r2),t=xt(n2),r=Ur();N.useEffect(()=>{if(e==null)return ef;var n=(a,i,l)=>{t!==l&&e===a&&r(uX(i))};return Kd.on(vC,n),()=>{Kd.off(vC,n)}},[r,t,e])}function bX(){var e=Ur();N.useEffect(()=>{e(lX())},[e]),xX(),yX()}function wX(e,t,r,n,a,i){var l=xt(x=>AK(x,e,t)),c=xt(n2),f=xt(r2),d=xt(sM),m=xt(oX),p=m==null?void 0:m.active,v=bg();N.useEffect(()=>{if(!p&&f!=null&&c!=null){var x=vw({active:i,coordinate:r,dataKey:l,index:a,label:typeof n=="number"?String(n):n,sourceViewBox:v,graphicalItemId:void 0});Kd.emit(bw,f,x,c)}},[p,r,l,a,n,c,f,d,i,v])}function bC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function wC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?bC(Object(r),!0).forEach(function(n){_X(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):bC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _X(e,t,r){return(t=SX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SX(e){var t=EX(e,"string");return typeof t=="symbol"?t:t+""}function EX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NX(e){return e.dataKey}function kX(e,t){return N.isValidElement(e)?N.cloneElement(e,t):typeof e=="function"?N.createElement(e,t):N.createElement(uz,t)}var _C=[],TX={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,includeHidden:!1,isAnimationActive:"auto",itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function sc(e){var t,r,n=Zn(e,TX),{active:a,allowEscapeViewBox:i,animationDuration:l,animationEasing:c,content:f,filterNull:d,isAnimationActive:m,offset:p,payloadUniqBy:v,position:x,reverseDirection:y,useTranslate3d:b,wrapperStyle:_,cursor:E,shared:A,trigger:T,defaultIndex:k,portal:I,axisId:O}=n,j=Ur(),B=typeof k=="number"?String(k):k;N.useEffect(()=>{j(SG({shared:A,trigger:T,axisId:O,active:a,defaultIndex:B}))},[j,A,T,O,a,B]);var U=bg(),Y=tP(),te=vG(A),{activeIndex:V,isActive:ge}=(t=xt(pe=>CK(pe,te,T,B)))!==null&&t!==void 0?t:{},be=xt(pe=>OK(pe,te,T,B)),ve=xt(pe=>oR(pe,te,T,B)),z=xt(pe=>jK(pe,te,T,B)),ue=be,se=tX(),Q=(r=a??ge)!==null&&r!==void 0?r:!1,[re,G]=nI([ue,Q]),P=te==="axis"?ve:void 0;wX(te,T,z,P,V,Q);var W=I??se;if(W==null||U==null||te==null)return null;var F=ue??_C;Q||(F=_C),d&&F.length&&(F=JD(F.filter(pe=>pe.value!=null&&(pe.hide!==!0||n.includeHidden)),v,NX));var M=F.length>0,le=N.createElement(vz,{allowEscapeViewBox:i,animationDuration:l,animationEasing:c,isAnimationActive:m,active:Q,coordinate:z,hasPayload:M,offset:p,position:x,reverseDirection:y,useTranslate3d:b,viewBox:U,wrapperStyle:_,lastBoundingBox:re,innerRef:G,hasPortalFromProps:!!I},kX(f,wC(wC({},n),{},{payload:F,label:P,active:Q,activeIndex:V,coordinate:z,accessibilityLayer:Y})));return N.createElement(N.Fragment,null,a_.createPortal(le,W),Q&&N.createElement(eX,{cursor:E,tooltipEventType:te,coordinate:z,payload:F,index:V}))}var oi=e=>null;oi.displayName="Cell";function AX(e,t,r){return(t=jX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jX(e){var t=OX(e,"string");return typeof t=="symbol"?t:t+""}function OX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class CX{constructor(t){AX(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;n!=null&&this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function SC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function DX(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?SC(Object(r),!0).forEach(function(n){IX(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):SC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IX(e,t,r){return(t=PX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PX(e){var t=MX(e,"string");return typeof t=="symbol"?t:t+""}function MX(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var RX={cacheSize:2e3,enableCache:!0},mR=DX({},RX),EC=new CX(mR.cacheSize),FX={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},NC="recharts_measurement_span";function LX(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",l=t.letterSpacing||"",c=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(l,"|").concat(c)}var kC=(e,t)=>{try{var r=document.getElementById(NC);r||(r=document.createElement("span"),r.setAttribute("id",NC),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,FX,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},Sd=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Eg.isSsr)return{width:0,height:0};if(!mR.enableCache)return kC(t,r);var n=LX(t,r),a=EC.get(n);if(a)return a;var i=kC(t,r);return EC.set(n,i),i},pR;function BX(e,t,r){return(t=UX(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UX(e){var t=$X(e,"string");return typeof t=="symbol"?t:t+""}function $X(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var TC=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,AC=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,zX=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,HX=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,qX={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},WX=["cm","mm","pt","pc","in","Q","px"];function VX(e){return WX.includes(e)}var Du="NaN";function GX(e,t){return e*qX[t]}class da{static parse(t){var r,[,n,a]=(r=HX.exec(t))!==null&&r!==void 0?r:[];return n==null?da.NaN:new da(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Ts(t)&&(this.unit=""),r!==""&&!zX.test(r)&&(this.num=NaN,this.unit=""),VX(r)&&(this.num=GX(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new da(NaN,""):new da(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new da(NaN,""):new da(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new da(NaN,""):new da(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new da(NaN,""):new da(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ts(this.num)}}pR=da;BX(da,"NaN",new pR(NaN,""));function gR(e){if(e==null||e.includes(Du))return Du;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=TC.exec(t))!==null&&r!==void 0?r:[],l=da.parse(n??""),c=da.parse(i??""),f=a==="*"?l.multiply(c):l.divide(c);if(f.isNaN())return Du;t=t.replace(TC,f.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var d,[,m,p,v]=(d=AC.exec(t))!==null&&d!==void 0?d:[],x=da.parse(m??""),y=da.parse(v??""),b=p==="+"?x.add(y):x.subtract(y);if(b.isNaN())return Du;t=t.replace(AC,b.toString())}return t}var jC=/\(([^()]*)\)/;function KX(e){for(var t=e,r;(r=jC.exec(t))!=null;){var[,n]=r;t=t.replace(jC,gR(n))}return t}function XX(e){var t=e.replace(/\s+/g,"");return t=KX(t),t=gR(t),t}function YX(e){try{return XX(e)}catch{return Du}}function U1(e){var t=YX(e.slice(5,-1));return t===Du?"":t}var QX=["x","y","lineHeight","capHeight","fill","scaleToFit","textAnchor","verticalAnchor"],JX=["dx","dy","angle","className","breakAll"];function ww(){return ww=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ww.apply(null,arguments)}function OC(e,t){if(e==null)return{};var r,n,a=ZX(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ZX(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vR=/[ \f\n\r\t\v\u2028\u2029]+/,xR=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Jn(t)||(r?a=t.toString().split(""):a=t.toString().split(vR));var i=a.map(c=>({word:c,width:Sd(c,n).width})),l=r?0:Sd("",n).width;return{wordsWithComputedWidth:i,spaceWidth:l}}catch{return null}};function eY(e){return e==="start"||e==="middle"||e==="end"||e==="inherit"}var yR=(e,t,r,n)=>e.reduce((a,i)=>{var{word:l,width:c}=i,f=a[a.length-1];if(f&&c!=null&&(t==null||n||f.width+c+r<Number(t)))f.words.push(l),f.width+=c+r;else{var d={words:[l],width:c};a.push(d)}return a},[]),bR=e=>e.reduce((t,r)=>t.width>r.width?t:r),tY="",CC=(e,t,r,n,a,i,l,c)=>{var f=e.slice(0,t),d=xR({breakAll:r,style:n,children:f+tY});if(!d)return[!1,[]];var m=yR(d.wordsWithComputedWidth,i,l,c),p=m.length>a||bR(m).width>Number(i);return[p,m]},rY=(e,t,r,n,a)=>{var{maxLines:i,children:l,style:c,breakAll:f}=e,d=gt(i),m=String(l),p=yR(t,n,r,a);if(!d||a)return p;var v=p.length>i||bR(p).width>Number(n);if(!v)return p;for(var x=0,y=m.length-1,b=0,_;x<=y&&b<=m.length-1;){var E=Math.floor((x+y)/2),A=E-1,[T,k]=CC(m,A,f,c,i,n,r,a),[I]=CC(m,E,f,c,i,n,r,a);if(!T&&!I&&(x=E+1),T&&I&&(y=E-1),!T&&I){_=k;break}b++}return _||p},DC=e=>{var t=Jn(e)?[]:e.toString().split(vR);return[{words:t,width:void 0}]},nY=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:l}=e;if((t||r)&&!Eg.isSsr){var c,f,d=xR({breakAll:i,children:n,style:a});if(d){var{wordsWithComputedWidth:m,spaceWidth:p}=d;c=m,f=p}else return DC(n);return rY({breakAll:i,children:n,maxLines:l,style:a},c,f,t,!!r)}return DC(n)},wR="#808080",aY={angle:0,breakAll:!1,capHeight:"0.71em",fill:wR,lineHeight:"1em",scaleToFit:!1,textAnchor:"start",verticalAnchor:"end",x:0,y:0},Wg=N.forwardRef((e,t)=>{var r=Zn(e,aY),{x:n,y:a,lineHeight:i,capHeight:l,fill:c,scaleToFit:f,textAnchor:d,verticalAnchor:m}=r,p=OC(r,QX),v=N.useMemo(()=>nY({breakAll:p.breakAll,children:p.children,maxLines:p.maxLines,scaleToFit:f,style:p.style,width:p.width}),[p.breakAll,p.children,p.maxLines,f,p.style,p.width]),{dx:x,dy:y,angle:b,className:_,breakAll:E}=p,A=OC(p,JX);if(!As(n)||!As(a)||v.length===0)return null;var T=Number(n)+(gt(x)?x:0),k=Number(a)+(gt(y)?y:0);if(!rr(T)||!rr(k))return null;var I;switch(m){case"start":I=U1("calc(".concat(l,")"));break;case"middle":I=U1("calc(".concat((v.length-1)/2," * -").concat(i," + (").concat(l," / 2))"));break;default:I=U1("calc(".concat(v.length-1," * -").concat(i,")"));break}var O=[],j=v[0];if(f&&j!=null){var B=j.width,{width:U}=p;O.push("scale(".concat(gt(U)&&gt(B)?U/B:1,")"))}return b&&O.push("rotate(".concat(b,", ").concat(T,", ").concat(k,")")),O.length&&(A.transform=O.join(" ")),N.createElement("text",ww({},$i(A),{ref:t,x:T,y:k,className:kr("recharts-text",_),textAnchor:d,fill:c.includes("url")?wR:c}),v.map((Y,te)=>{var V=Y.words.join(E?"":" ");return N.createElement("tspan",{x:T,dy:te===0?I:i,key:"".concat(V,"-").concat(te)},V)}))});Wg.displayName="Text";function IC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ys(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IC(Object(r),!0).forEach(function(n){iY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iY(e,t,r){return(t=sY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function sY(e){var t=lY(e,"string");return typeof t=="symbol"?t:t+""}function lY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oY=e=>{var{viewBox:t,position:r,offset:n=0,parentViewBox:a}=e,{x:i,y:l,height:c,upperWidth:f,lowerWidth:d}=S_(t),m=i,p=i+(f-d)/2,v=(m+p)/2,x=(f+d)/2,y=m+f/2,b=c>=0?1:-1,_=b*n,E=b>0?"end":"start",A=b>0?"start":"end",T=f>=0?1:-1,k=T*n,I=T>0?"end":"start",O=T>0?"start":"end",j=a;if(r==="top"){var B={x:m+f/2,y:l-_,horizontalAnchor:"middle",verticalAnchor:E};return j&&(B.height=Math.max(l-j.y,0),B.width=f),B}if(r==="bottom"){var U={x:p+d/2,y:l+c+_,horizontalAnchor:"middle",verticalAnchor:A};return j&&(U.height=Math.max(j.y+j.height-(l+c),0),U.width=d),U}if(r==="left"){var Y={x:v-k,y:l+c/2,horizontalAnchor:I,verticalAnchor:"middle"};return j&&(Y.width=Math.max(Y.x-j.x,0),Y.height=c),Y}if(r==="right"){var te={x:v+x+k,y:l+c/2,horizontalAnchor:O,verticalAnchor:"middle"};return j&&(te.width=Math.max(j.x+j.width-te.x,0),te.height=c),te}var V=j?{width:x,height:c}:{};return r==="insideLeft"?ys({x:v+k,y:l+c/2,horizontalAnchor:O,verticalAnchor:"middle"},V):r==="insideRight"?ys({x:v+x-k,y:l+c/2,horizontalAnchor:I,verticalAnchor:"middle"},V):r==="insideTop"?ys({x:m+f/2,y:l+_,horizontalAnchor:"middle",verticalAnchor:A},V):r==="insideBottom"?ys({x:p+d/2,y:l+c-_,horizontalAnchor:"middle",verticalAnchor:E},V):r==="insideTopLeft"?ys({x:m+k,y:l+_,horizontalAnchor:O,verticalAnchor:A},V):r==="insideTopRight"?ys({x:m+f-k,y:l+_,horizontalAnchor:I,verticalAnchor:A},V):r==="insideBottomLeft"?ys({x:p+k,y:l+c-_,horizontalAnchor:O,verticalAnchor:E},V):r==="insideBottomRight"?ys({x:p+d-k,y:l+c-_,horizontalAnchor:I,verticalAnchor:E},V):r&&typeof r=="object"&&(gt(r.x)||hc(r.x))&&(gt(r.y)||hc(r.y))?ys({x:i+ka(r.x,x),y:l+ka(r.y,c),horizontalAnchor:"end",verticalAnchor:"end"},V):ys({x:y,y:l+c/2,horizontalAnchor:"middle",verticalAnchor:"middle"},V)},cY=["labelRef"],uY=["content"];function PC(e,t){if(e==null)return{};var r,n,a=fY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function fY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function MC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?MC(Object(r),!0).forEach(function(n){dY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):MC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function dY(e,t,r){return(t=hY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function hY(e){var t=mY(e,"string");return typeof t=="symbol"?t:t+""}function mY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zs(){return Zs=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zs.apply(null,arguments)}var _R=N.createContext(null),pY=e=>{var{x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:l,children:c}=e,f=N.useMemo(()=>({x:t,y:r,upperWidth:n,lowerWidth:a,width:i,height:l}),[t,r,n,a,i,l]);return N.createElement(_R.Provider,{value:f},c)},SR=()=>{var e=N.useContext(_R),t=bg();return e||(t?S_(t):void 0)},gY=N.createContext(null),vY=()=>{var e=N.useContext(gY),t=xt(fM);return e||t},xY=e=>{var{value:t,formatter:r}=e,n=Jn(e.children)?t:e.children;return typeof r=="function"?r(n):n},U2=e=>e!=null&&typeof e=="function",yY=(e,t)=>{var r=Yn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},bY=(e,t,r,n,a)=>{var{offset:i,className:l}=e,{cx:c,cy:f,innerRadius:d,outerRadius:m,startAngle:p,endAngle:v,clockWise:x}=a,y=(d+m)/2,b=yY(p,v),_=b>=0?1:-1,E,A;switch(t){case"insideStart":E=p+_*i,A=x;break;case"insideEnd":E=v-_*i,A=!x;break;case"end":E=v+_*i,A=x;break;default:throw new Error("Unsupported position ".concat(t))}A=b<=0?A:!A;var T=On(c,f,y,E),k=On(c,f,y,E+(A?1:-1)*359),I="M".concat(T.x,",").concat(T.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(A?0:1,`,
    `).concat(k.x,",").concat(k.y),O=Jn(e.id)?Md("recharts-radial-line-"):e.id;return N.createElement("text",Zs({},n,{dominantBaseline:"central",className:kr("recharts-radial-bar-label",l)}),N.createElement("defs",null,N.createElement("path",{id:O,d:I})),N.createElement("textPath",{xlinkHref:"#".concat(O)},r))},wY=(e,t,r)=>{var{cx:n,cy:a,innerRadius:i,outerRadius:l,startAngle:c,endAngle:f}=e,d=(c+f)/2;if(r==="outside"){var{x:m,y:p}=On(n,a,l+t,d);return{x:m,y:p,textAnchor:m>=n?"start":"end",verticalAnchor:"middle"}}if(r==="center")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"middle"};if(r==="centerTop")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"start"};if(r==="centerBottom")return{x:n,y:a,textAnchor:"middle",verticalAnchor:"end"};var v=(i+l)/2,{x,y}=On(n,a,v,d);return{x,y,textAnchor:"middle",verticalAnchor:"middle"}},$m=e=>e!=null&&"cx"in e&&gt(e.cx),_Y={angle:0,offset:5,zIndex:pa.label,position:"middle",textBreakAll:!1};function SY(e){if(!$m(e))return e;var{cx:t,cy:r,outerRadius:n}=e,a=n*2;return{x:t-n,y:r-n,width:a,upperWidth:a,lowerWidth:a,height:a}}function Jl(e){var t=Zn(e,_Y),{viewBox:r,parentViewBox:n,position:a,value:i,children:l,content:c,className:f="",textBreakAll:d,labelRef:m}=t,p=vY(),v=SR(),x=a==="center"?v:p??v,y,b,_;r==null?y=x:$m(r)?y=r:y=S_(r);var E=SY(y);if(!y||Jn(i)&&Jn(l)&&!N.isValidElement(c)&&typeof c!="function")return null;var A=xd(xd({},t),{},{viewBox:y});if(N.isValidElement(c)){var{labelRef:T}=A,k=PC(A,cY);return N.cloneElement(c,k)}if(typeof c=="function"){var{content:I}=A,O=PC(A,uY);if(b=N.createElement(c,O),N.isValidElement(b))return b}else b=xY(t);var j=$i(t);if($m(y)){if(a==="insideStart"||a==="insideEnd"||a==="end")return bY(t,a,b,j,y);_=wY(y,t.offset,t.position)}else{if(!E)return null;var B=oY({viewBox:E,position:a,offset:t.offset,parentViewBox:$m(n)?void 0:n});_=xd(xd({x:B.x,y:B.y,textAnchor:B.horizontalAnchor,verticalAnchor:B.verticalAnchor},B.width!==void 0?{width:B.width}:{}),B.height!==void 0?{height:B.height}:{})}return N.createElement(ds,{zIndex:t.zIndex},N.createElement(Wg,Zs({ref:m,className:kr("recharts-label",f)},j,_,{textAnchor:eY(j.textAnchor)?j.textAnchor:_.textAnchor,breakAll:d}),b))}Jl.displayName="Label";var EY=(e,t,r)=>{if(!e)return null;var n={viewBox:t,labelRef:r};return e===!0?N.createElement(Jl,Zs({key:"label-implicit"},n)):As(e)?N.createElement(Jl,Zs({key:"label-implicit",value:e},n)):N.isValidElement(e)?e.type===Jl?N.cloneElement(e,xd({key:"label-implicit"},n)):N.createElement(Jl,Zs({key:"label-implicit",content:e},n)):U2(e)?N.createElement(Jl,Zs({key:"label-implicit",content:e},n)):e&&typeof e=="object"?N.createElement(Jl,Zs({},e,{key:"label-implicit"},n)):null};function NY(e){var{label:t,labelRef:r}=e,n=SR();return EY(t,n,r)||null}var $1={},z1={},RC;function kY(){return RC||(RC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r[r.length-1]}e.last=t})(z1)),z1}var H1={},FC;function TY(){return FC||(FC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Array.isArray(r)?r:Array.from(r)}e.toArray=t})(H1)),H1}var LC;function AY(){return LC||(LC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kY(),r=TY(),n=d_();function a(i){if(n.isArrayLike(i))return t.last(r.toArray(i))}e.last=a})($1)),$1}var q1,BC;function jY(){return BC||(BC=1,q1=AY().last),q1}var OY=jY();const CY=Cs(OY);var DY=["valueAccessor"],IY=["dataKey","clockWise","id","textBreakAll","zIndex"];function Cp(){return Cp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cp.apply(null,arguments)}function UC(e,t){if(e==null)return{};var r,n,a=PY(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function PY(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var MY=e=>Array.isArray(e.value)?CY(e.value):e.value,ER=N.createContext(void 0),RY=ER.Provider,NR=N.createContext(void 0),FY=NR.Provider;function LY(){return N.useContext(ER)}function BY(){return N.useContext(NR)}function zm(e){var{valueAccessor:t=MY}=e,r=UC(e,DY),{dataKey:n,clockWise:a,id:i,textBreakAll:l,zIndex:c}=r,f=UC(r,IY),d=LY(),m=BY(),p=d||m;return!p||!p.length?null:N.createElement(ds,{zIndex:c??pa.label},N.createElement(Fa,{className:"recharts-label-list"},p.map((v,x)=>{var y,b=Jn(n)?t(v,x):Gr(v.payload,n),_=Jn(i)?{}:{id:"".concat(i,"-").concat(x)};return N.createElement(Jl,Cp({key:"label-".concat(x)},$i(v),f,_,{fill:(y=r.fill)!==null&&y!==void 0?y:v.fill,parentViewBox:v.parentViewBox,value:b,textBreakAll:l,viewBox:v.viewBox,index:x,zIndex:0}))})))}zm.displayName="LabelList";function kR(e){var{label:t}=e;return t?t===!0?N.createElement(zm,{key:"labelList-implicit"}):N.isValidElement(t)||U2(t)?N.createElement(zm,{key:"labelList-implicit",content:t}):typeof t=="object"?N.createElement(zm,Cp({key:"labelList-implicit"},t,{type:String(t.type)})):null:null}var TR=e=>e.graphicalItems.polarItems,UY=Te([nn,A0],c2),Vg=Te([TR,mn,UY],f2),$Y=Te([Vg],d2),Gg=Te([$Y,Ig],h2),zY=Te([Gg,mn,Vg],p2);Te([Gg,mn,Vg],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,l=Gr(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:l,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:Gr(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]})));var $C=()=>{},HY=Te([Gg,mn,Vg,$g,nn],y2),qY=Te([mn,v2,x2,$C,HY,$C,hr,nn],b2),AR=Te([mn,hr,Gg,zY,T0,nn,qY],w2),WY=Te([AR,lf,xo],E2),VY=Te([mn,AR,WY,nn],k2);Te([xo,VY],hM);var GY={radiusAxis:{},angleAxis:{}},jR=Qa({name:"polarAxis",initialState:GY,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),{addRadiusAxis:Yge,removeRadiusAxis:Qge,addAngleAxis:Jge,removeAngleAxis:Zge}=jR.actions,KY=jR.reducer;function OR(e){return e&&typeof e=="object"&&"className"in e&&typeof e.className=="string"?e.className:""}function zC(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function HC(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zC(Object(r),!0).forEach(function(n){XY(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zC(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XY(e,t,r){return(t=YY(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YY(e){var t=QY(e,"string");return typeof t=="symbol"?t:t+""}function QY(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var JY=(e,t)=>t,$2=Te([TR,JY],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),ZY=[],z2=(e,t,r)=>(r==null?void 0:r.length)===0?ZY:r,CR=Te([Ig,$2,z2],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>HC(HC({},t.presentationProps),i.props))),a!=null)return a}}),eQ=Te([CR,$2,z2],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,l=Gr(n,t.nameKey,t.name),c;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?c=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?c=n.fill:c=t.fill,{value:pg(l,t.dataKey),color:c,payload:n,type:t.legendType}})}),tQ=Te([CR,$2,z2,Ln],(e,t,r,n)=>{if(!(t==null||e==null))return aJ({offset:n,pieSettings:t,displayedData:e,cells:r})}),W1={exports:{}},Dr={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qC;function rQ(){if(qC)return Dr;qC=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function y(b){if(typeof b=="object"&&b!==null){var _=b.$$typeof;switch(_){case e:switch(b=b.type,b){case r:case a:case n:case f:case d:case v:return b;default:switch(b=b&&b.$$typeof,b){case l:case c:case p:case m:return b;case i:return b;default:return _}}case t:return _}}}return Dr.ContextConsumer=i,Dr.ContextProvider=l,Dr.Element=e,Dr.ForwardRef=c,Dr.Fragment=r,Dr.Lazy=p,Dr.Memo=m,Dr.Portal=t,Dr.Profiler=a,Dr.StrictMode=n,Dr.Suspense=f,Dr.SuspenseList=d,Dr.isContextConsumer=function(b){return y(b)===i},Dr.isContextProvider=function(b){return y(b)===l},Dr.isElement=function(b){return typeof b=="object"&&b!==null&&b.$$typeof===e},Dr.isForwardRef=function(b){return y(b)===c},Dr.isFragment=function(b){return y(b)===r},Dr.isLazy=function(b){return y(b)===p},Dr.isMemo=function(b){return y(b)===m},Dr.isPortal=function(b){return y(b)===t},Dr.isProfiler=function(b){return y(b)===a},Dr.isStrictMode=function(b){return y(b)===n},Dr.isSuspense=function(b){return y(b)===f},Dr.isSuspenseList=function(b){return y(b)===d},Dr.isValidElementType=function(b){return typeof b=="string"||typeof b=="function"||b===r||b===a||b===n||b===f||b===d||typeof b=="object"&&b!==null&&(b.$$typeof===p||b.$$typeof===m||b.$$typeof===l||b.$$typeof===i||b.$$typeof===c||b.$$typeof===x||b.getModuleId!==void 0)},Dr.typeOf=y,Dr}var WC;function nQ(){return WC||(WC=1,W1.exports=rQ()),W1.exports}var aQ=nQ(),VC=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",GC=null,V1=null,DR=e=>{if(e===GC&&Array.isArray(V1))return V1;var t=[];return N.Children.forEach(e,r=>{Jn(r)||(aQ.isFragment(r)?t=t.concat(DR(r.props.children)):t.push(r))}),V1=t,GC=e,t};function H2(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>VC(a)):n=[VC(t)],DR(e).forEach(a=>{var i=dc(a,"type.displayName")||dc(a,"type.name");i&&n.indexOf(i)!==-1&&r.push(a)}),r}var G1={},KC;function iQ(){return KC||(KC=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(G1)),G1}var K1,XC;function sQ(){return XC||(XC=1,K1=iQ().isPlainObject),K1}var lQ=sQ();const oQ=Cs(lQ);var YC,QC,JC,ZC,e4;function t4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function r4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t4(Object(r),!0).forEach(function(n){cQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cQ(e,t,r){return(t=uQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uQ(e){var t=fQ(e,"string");return typeof t=="symbol"?t:t+""}function fQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Dp(){return Dp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Dp.apply(null,arguments)}function hd(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var n4=(e,t,r,n,a)=>{var i=r-n,l;return l=cn(YC||(YC=hd(["M ",",",""])),e,t),l+=cn(QC||(QC=hd(["L ",",",""])),e+r,t),l+=cn(JC||(JC=hd(["L ",",",""])),e+r-i/2,t+a),l+=cn(ZC||(ZC=hd(["L ",",",""])),e+r-i/2-n,t+a),l+=cn(e4||(e4=hd(["L ",","," Z"])),e,t),l},dQ={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},hQ=e=>{var t=Zn(e,dQ),{x:r,y:n,upperWidth:a,lowerWidth:i,height:l,className:c}=t,{animationEasing:f,animationDuration:d,animationBegin:m,isUpdateAnimationActive:p}=t,v=N.useRef(null),[x,y]=N.useState(-1),b=N.useRef(a),_=N.useRef(i),E=N.useRef(l),A=N.useRef(r),T=N.useRef(n),k=kg(e,"trapezoid-");if(N.useEffect(()=>{if(v.current&&v.current.getTotalLength)try{var be=v.current.getTotalLength();be&&y(be)}catch{}},[]),r!==+r||n!==+n||a!==+a||i!==+i||l!==+l||a===0&&i===0||l===0)return null;var I=kr("recharts-trapezoid",c);if(!p)return N.createElement("g",null,N.createElement("path",Dp({},$i(t),{className:I,d:n4(r,n,a,i,l)})));var O=b.current,j=_.current,B=E.current,U=A.current,Y=T.current,te="0px ".concat(x===-1?1:x,"px"),V="".concat(x,"px 0px"),ge=rP(["strokeDasharray"],d,f);return N.createElement(Ng,{animationId:k,key:k,canBegin:x>0,duration:d,easing:f,isActive:p,begin:m},be=>{var ve=Pn(O,a,be),z=Pn(j,i,be),ue=Pn(B,l,be),se=Pn(U,r,be),Q=Pn(Y,n,be);v.current&&(b.current=ve,_.current=z,E.current=ue,A.current=se,T.current=Q);var re=be>0?{transition:ge,strokeDasharray:V}:{strokeDasharray:te};return N.createElement("path",Dp({},$i(t),{className:I,d:n4(se,Q,ve,z,ue),ref:v,style:r4(r4({},re),t.style)}))})},mQ=["option","shapeType","activeClassName"];function pQ(e,t){if(e==null)return{};var r,n,a=gQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function a4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ip(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a4(Object(r),!0).forEach(function(n){vQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function vQ(e,t,r){return(t=xQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function xQ(e){var t=yQ(e,"string");return typeof t=="symbol"?t:t+""}function yQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bQ(e,t){return Ip(Ip({},t),e)}function wQ(e,t){return e==="symbols"}function i4(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return N.createElement(sP,r);case"trapezoid":return N.createElement(hQ,r);case"sector":return N.createElement(uP,r);case"symbols":if(wQ(t))return N.createElement(f_,r);break;case"curve":return N.createElement(j_,r);default:return null}}function _Q(e){return N.isValidElement(e)?e.props:e}function IR(e){var{option:t,shapeType:r,activeClassName:n="recharts-active-shape"}=e,a=pQ(e,mQ),i;if(N.isValidElement(t))i=N.cloneElement(t,Ip(Ip({},a),_Q(t)));else if(typeof t=="function")i=t(a,a.index);else if(oQ(t)&&typeof t!="boolean"){var l=bQ(t,a);i=N.createElement(i4,{shapeType:r,elementProps:l})}else{var c=a;i=N.createElement(i4,{shapeType:r,elementProps:c})}return a.isActive?N.createElement(Fa,{className:n},i):i}var q2=(e,t,r)=>{var n=Ur();return(a,i)=>l=>{e==null||e(a,i,l),n(HM({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}},W2=e=>{var t=Ur();return(r,n)=>a=>{e==null||e(r,n,a),t(EG())}},V2=(e,t,r)=>{var n=Ur();return(a,i)=>l=>{e==null||e(a,i,l),n(NG({activeIndex:String(i),activeDataKey:t,activeCoordinate:a.tooltipPosition,activeGraphicalItemId:r}))}};function PR(e){var{tooltipEntrySettings:t}=e,r=Ur(),n=Ja(),a=N.useRef(null);return N.useLayoutEffect(()=>{n||(a.current===null?r(bG(t)):a.current!==t&&r(wG({prev:a.current,next:t})),a.current=t)},[t,r,n]),N.useLayoutEffect(()=>()=>{a.current&&(r(_G(a.current)),a.current=null)},[r]),null}function SQ(e){var{legendPayload:t}=e,r=Ur(),n=Ja(),a=N.useRef(null);return N.useLayoutEffect(()=>{n||(a.current===null?r(JI(t)):a.current!==t&&r(ZI({prev:a.current,next:t})),a.current=t)},[r,n,t]),N.useLayoutEffect(()=>()=>{a.current&&(r(eP(a.current)),a.current=null)},[r]),null}function EQ(e){var{legendPayload:t}=e,r=Ur(),n=xt(hr),a=N.useRef(null);return N.useLayoutEffect(()=>{n!=="centric"&&n!=="radial"||(a.current===null?r(JI(t)):a.current!==t&&r(ZI({prev:a.current,next:t})),a.current=t)},[r,n,t]),N.useLayoutEffect(()=>()=>{a.current&&(r(eP(a.current)),a.current=null)},[r]),null}var X1,NQ=()=>{var[e]=N.useState(()=>Md("uid-"));return e},kQ=(X1=eB.useId)!==null&&X1!==void 0?X1:NQ;function TQ(e,t){var r=kQ();return t||(e?"".concat(e,"-").concat(r):r)}var AQ=N.createContext(void 0),MR=e=>{var{id:t,type:r,children:n}=e,a=TQ("recharts-".concat(r),t);return N.createElement(AQ.Provider,{value:a},n(a))},jQ={cartesianItems:[],polarItems:[]},RR=Qa({name:"graphicalItems",initialState:jQ,reducers:{addCartesianGraphicalItem:{reducer(e,t){e.cartesianItems.push(t.payload)},prepare:Jr()},replaceCartesianGraphicalItem:{reducer(e,t){var{prev:r,next:n}=t.payload,a=ss(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},prepare:Jr()},removeCartesianGraphicalItem:{reducer(e,t){var r=ss(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},prepare:Jr()},addPolarGraphicalItem:{reducer(e,t){e.polarItems.push(t.payload)},prepare:Jr()},removePolarGraphicalItem:{reducer(e,t){var r=ss(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)},prepare:Jr()}}}),{addCartesianGraphicalItem:OQ,replaceCartesianGraphicalItem:CQ,removeCartesianGraphicalItem:DQ,addPolarGraphicalItem:IQ,removePolarGraphicalItem:PQ}=RR.actions,MQ=RR.reducer,RQ=e=>{var t=Ur(),r=N.useRef(null);return N.useLayoutEffect(()=>{r.current===null?t(OQ(e)):r.current!==e&&t(CQ({prev:r.current,next:e})),r.current=e},[t,e]),N.useLayoutEffect(()=>()=>{r.current&&(t(DQ(r.current)),r.current=null)},[t]),null},FQ=N.memo(RQ);function LQ(e){var t=Ur();return N.useLayoutEffect(()=>(t(IQ(e)),()=>{t(PQ(e))}),[t,e]),null}var BQ=["key"],UQ=["onMouseEnter","onClick","onMouseLeave"],$Q=["id"],zQ=["id"];function s4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function un(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s4(Object(r),!0).forEach(function(n){HQ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HQ(e,t,r){return(t=qQ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qQ(e){var t=WQ(e,"string");return typeof t=="symbol"?t:t+""}function WQ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function lo(){return lo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lo.apply(null,arguments)}function Kg(e,t){if(e==null)return{};var r,n,a=VQ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VQ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function GQ(e){var t=N.useMemo(()=>H2(e.children,oi),[e.children]),r=xt(n=>eQ(n,e.id,t));return r==null?null:N.createElement(EQ,{legendPayload:r})}var KQ=N.memo(e=>{var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:l,name:c,hide:f,tooltipType:d,id:m}=e,p={dataDefinedOnItem:n.map(v=>v.tooltipPayload),getPosition:v=>{var x;return(x=n[Number(v)])===null||x===void 0?void 0:x.tooltipPosition},settings:{stroke:a,strokeWidth:i,fill:l,dataKey:t,nameKey:r,name:pg(c,t),hide:f,type:d,color:l,unit:"",graphicalItemId:m}};return N.createElement(PR,{tooltipEntrySettings:p})}),XQ=(e,t)=>e>t?"start":e<t?"end":"middle",YQ=(e,t,r)=>ka(typeof t=="function"?t(e):t,r,r*.8),QQ=(e,t,r)=>{var{top:n,left:a,width:i,height:l}=t,c=lP(i,l),f=a+ka(e.cx,i,i/2),d=n+ka(e.cy,l,l/2),m=ka(e.innerRadius,c,0),p=YQ(r,e.outerRadius,c),v=e.maxRadius||Math.sqrt(i*i+l*l)/2;return{cx:f,cy:d,innerRadius:m,outerRadius:p,maxRadius:v}},JQ=(e,t)=>{var r=Yn(t-e),n=Math.min(Math.abs(t-e),360);return r*n},ZQ=(e,t)=>{if(N.isValidElement(e))return N.cloneElement(e,t);if(typeof e=="function")return e(t);var r=kr("recharts-pie-label-line",typeof e!="boolean"?e.className:""),{key:n}=t,a=Kg(t,BQ);return N.createElement(j_,lo({},a,{type:"linear",className:r}))},eJ=(e,t,r)=>{if(N.isValidElement(e))return N.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),N.isValidElement(n)))return n;var a=kr("recharts-pie-label-text",OR(e));return N.createElement(Wg,lo({},t,{alignmentBaseline:"middle",className:a}),n)};function tJ(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:l}=r;if(!n||!a||!t)return null;var c=cs(r),f=Pd(a),d=Pd(i),m=typeof a=="object"&&"offsetRadius"in a&&typeof a.offsetRadius=="number"&&a.offsetRadius||20,p=t.map((v,x)=>{var y=(v.startAngle+v.endAngle)/2,b=On(v.cx,v.cy,v.outerRadius+m,y),_=un(un(un(un({},c),v),{},{stroke:"none"},f),{},{index:x,textAnchor:XQ(b.x,v.cx)},b),E=un(un(un(un({},c),v),{},{fill:"none",stroke:v.fill},d),{},{index:x,points:[On(v.cx,v.cy,v.outerRadius,y),b],key:"line"});return N.createElement(ds,{zIndex:pa.label,key:"label-".concat(v.startAngle,"-").concat(v.endAngle,"-").concat(v.midAngle,"-").concat(x)},N.createElement(Fa,null,i&&ZQ(i,E),eJ(a,_,Gr(v,l))))});return N.createElement(Fa,{className:"recharts-pie-labels"},p)}function rJ(e){var{sectors:t,props:r,showLabels:n}=e,{label:a}=r;return typeof a=="object"&&a!=null&&"position"in a?N.createElement(kR,{label:a}):N.createElement(tJ,{sectors:t,props:r,showLabels:n})}function nJ(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,shape:i,id:l}=e,c=xt(xc),f=xt(M2),d=xt(uK),{onMouseEnter:m,onClick:p,onMouseLeave:v}=a,x=Kg(a,UQ),y=q2(m,a.dataKey,l),b=W2(v),_=V2(p,a.dataKey,l);return t==null||t.length===0?null:N.createElement(N.Fragment,null,t.map((E,A)=>{if((E==null?void 0:E.startAngle)===0&&(E==null?void 0:E.endAngle)===0&&t.length!==1)return null;var T=d==null||d===l,k=String(A)===c&&(f==null||a.dataKey===f)&&T,I=c?n:null,O=r&&k?r:I,j=un(un({},E),{},{stroke:E.stroke,tabIndex:-1,[FI]:A,[LI]:l});return N.createElement(Fa,lo({key:"sector-".concat(E==null?void 0:E.startAngle,"-").concat(E==null?void 0:E.endAngle,"-").concat(E.midAngle,"-").concat(A),tabIndex:-1,className:"recharts-pie-sector"},v0(x,E,A),{onMouseEnter:y(E,A),onMouseLeave:b(E,A),onClick:_(E,A)}),N.createElement(IR,lo({option:i??O,index:A,shapeType:"sector",isActive:k},j)))}))}function aJ(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:l,startAngle:c,endAngle:f,dataKey:d,nameKey:m,tooltipType:p}=r,v=Math.abs(r.minAngle),x=JQ(c,f),y=Math.abs(x),b=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,_=n.filter(O=>Gr(O,d,0)!==0).length,E=(y>=360?_:_-1)*b,A=y-_*v-E,T=n.reduce((O,j)=>{var B=Gr(j,d,0);return O+(gt(B)?B:0)},0),k;if(T>0){var I;k=n.map((O,j)=>{var B=Gr(O,d,0),U=Gr(O,m,j),Y=QQ(r,i,O),te=(gt(B)?B:0)/T,V,ge=un(un({},O),a&&a[j]&&a[j].props);j?V=I.endAngle+Yn(x)*b*(B!==0?1:0):V=c;var be=V+Yn(x)*((B!==0?v:0)+te*A),ve=(V+be)/2,z=(Y.innerRadius+Y.outerRadius)/2,ue=[{name:U,value:B,payload:ge,dataKey:d,type:p,graphicalItemId:r.id}],se=On(Y.cx,Y.cy,z,ve);return I=un(un(un(un({},r.presentationProps),{},{percent:te,cornerRadius:typeof l=="string"?parseFloat(l):l,name:U,tooltipPayload:ue,midAngle:ve,middleRadius:z,tooltipPosition:se},ge),Y),{},{value:B,dataKey:d,startAngle:V,endAngle:be,payload:ge,paddingAngle:Yn(x)*b}),I})}return k}function iJ(e){var{showLabels:t,sectors:r,children:n}=e,a=N.useMemo(()=>!t||!r?[]:r.map(i=>({value:i.value,payload:i.payload,clockWise:!1,parentViewBox:void 0,viewBox:{cx:i.cx,cy:i.cy,innerRadius:i.innerRadius,outerRadius:i.outerRadius,startAngle:i.startAngle,endAngle:i.endAngle,clockWise:!1},fill:i.fill})),[r,t]);return N.createElement(FY,{value:t?a:void 0},n)}function sJ(e){var{props:t,previousSectorsRef:r,id:n}=e,{sectors:a,isAnimationActive:i,animationBegin:l,animationDuration:c,animationEasing:f,activeShape:d,inactiveShape:m,onAnimationStart:p,onAnimationEnd:v}=t,x=kg(t,"recharts-pie-"),y=r.current,[b,_]=N.useState(!1),E=N.useCallback(()=>{typeof v=="function"&&v(),_(!1)},[v]),A=N.useCallback(()=>{typeof p=="function"&&p(),_(!0)},[p]);return N.createElement(iJ,{showLabels:!b,sectors:a},N.createElement(Ng,{animationId:x,begin:l,duration:c,isActive:i,easing:f,onAnimationStart:A,onAnimationEnd:E,key:x},T=>{var k,I=[],O=a&&a[0],j=(k=O==null?void 0:O.startAngle)!==null&&k!==void 0?k:0;return a==null||a.forEach((B,U)=>{var Y=y&&y[U],te=U>0?dc(B,"paddingAngle",0):0;if(Y){var V=Pn(Y.endAngle-Y.startAngle,B.endAngle-B.startAngle,T),ge=un(un({},B),{},{startAngle:j+te,endAngle:j+V+te});I.push(ge),j=ge.endAngle}else{var{endAngle:be,startAngle:ve}=B,z=Pn(0,be-ve,T),ue=un(un({},B),{},{startAngle:j+te,endAngle:j+z+te});I.push(ue),j=ue.endAngle}}),r.current=I,N.createElement(Fa,null,N.createElement(nJ,{sectors:I,activeShape:d,inactiveShape:m,allOtherPieProps:t,shape:t.shape,id:n}))}),N.createElement(rJ,{showLabels:!b,sectors:a,props:t}),t.children)}var lJ={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:"auto",label:!1,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff",zIndex:pa.area};function oJ(e){var{id:t}=e,r=Kg(e,$Q),{hide:n,className:a,rootTabIndex:i}=e,l=N.useMemo(()=>H2(e.children,oi),[e.children]),c=xt(m=>tQ(m,t,l)),f=N.useRef(null),d=kr("recharts-pie",a);return n||c==null?(f.current=null,N.createElement(Fa,{tabIndex:i,className:d})):N.createElement(ds,{zIndex:e.zIndex},N.createElement(KQ,{dataKey:e.dataKey,nameKey:e.nameKey,sectors:c,stroke:e.stroke,strokeWidth:e.strokeWidth,fill:e.fill,name:e.name,hide:e.hide,tooltipType:e.tooltipType,id:t}),N.createElement(Fa,{tabIndex:i,className:d},N.createElement(sJ,{props:un(un({},r),{},{sectors:c}),previousSectorsRef:f,id:t})))}function Pp(e){var t=Zn(e,lJ),{id:r}=t,n=Kg(t,zQ),a=cs(n);return N.createElement(MR,{id:r,type:"pie"},i=>N.createElement(N.Fragment,null,N.createElement(LQ,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a,maxRadius:t.maxRadius}),N.createElement(GQ,lo({},n,{id:i})),N.createElement(oJ,lo({},n,{id:i}))))}Pp.displayName="Pie";function l4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function o4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?l4(Object(r),!0).forEach(function(n){cJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):l4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cJ(e,t,r){return(t=uJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function uJ(e){var t=fJ(e,"string");return typeof t=="symbol"?t:t+""}function fJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var FR=0,dJ={xAxis:{},yAxis:{},zAxis:{}},LR=Qa({name:"cartesianAxis",initialState:dJ,reducers:{addXAxis:{reducer(e,t){e.xAxis[t.payload.id]=t.payload},prepare:Jr()},replaceXAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.xAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.xAxis[r.id],e.xAxis[n.id]=n)},prepare:Jr()},removeXAxis:{reducer(e,t){delete e.xAxis[t.payload.id]},prepare:Jr()},addYAxis:{reducer(e,t){e.yAxis[t.payload.id]=t.payload},prepare:Jr()},replaceYAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.yAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.yAxis[r.id],e.yAxis[n.id]=n)},prepare:Jr()},removeYAxis:{reducer(e,t){delete e.yAxis[t.payload.id]},prepare:Jr()},addZAxis:{reducer(e,t){e.zAxis[t.payload.id]=t.payload},prepare:Jr()},replaceZAxis:{reducer(e,t){var{prev:r,next:n}=t.payload;e.zAxis[r.id]!==void 0&&(r.id!==n.id&&delete e.zAxis[r.id],e.zAxis[n.id]=n)},prepare:Jr()},removeZAxis:{reducer(e,t){delete e.zAxis[t.payload.id]},prepare:Jr()},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload,a=e.yAxis[r];if(a){var i,l=a.widthHistory||[];if(l.length===3&&l[0]===l[2]&&n===l[1]&&n!==a.width&&Math.abs(n-((i=l[0])!==null&&i!==void 0?i:0))<=1)return;var c=[...l,n].slice(-3);e.yAxis[r]=o4(o4({},a),{},{width:n,widthHistory:c})}}}}),{addXAxis:hJ,replaceXAxis:mJ,removeXAxis:pJ,addYAxis:gJ,replaceYAxis:vJ,removeYAxis:xJ,addZAxis:eve,replaceZAxis:tve,removeZAxis:rve,updateYAxisWidth:yJ}=LR.actions,bJ=LR.reducer,wJ=Te([Ln],e=>({top:e.top,bottom:e.bottom,left:e.left,right:e.right})),_J=Te([wJ,gl,vl],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),BR=()=>xt(_J),c4=(e,t,r)=>{var n=r??e;if(!Jn(n))return ka(n,t,0)},SJ=(e,t,r)=>{var n={},a=e.filter(Fg),i=e.filter(d=>d.stackId==null),l=a.reduce((d,m)=>{var p=d[m.stackId];return p==null&&(p=[]),p.push(m),d[m.stackId]=p,d},n),c=Object.entries(l).map(d=>{var m,[p,v]=d,x=v.map(b=>b.dataKey),y=c4(t,r,(m=v[0])===null||m===void 0?void 0:m.barSize);return{stackId:p,dataKeys:x,barSize:y}}),f=i.map(d=>{var m=[d.dataKey].filter(v=>v!=null),p=c4(t,r,d.barSize);return{stackId:void 0,dataKeys:m,barSize:p}});return[...c,...f]};function u4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ym(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?u4(Object(r),!0).forEach(function(n){EJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function EJ(e,t,r){return(t=NJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function NJ(e){var t=kJ(e,"string");return typeof t=="symbol"?t:t+""}function kJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function TJ(e,t,r,n,a){var i,l=n.length;if(!(l<1)){var c=ka(e,r,0,!0),f,d=[];if(rr((i=n[0])===null||i===void 0?void 0:i.barSize)){var m=!1,p=r/l,v=n.reduce((A,T)=>A+(T.barSize||0),0);v+=(l-1)*c,v>=r&&(v-=(l-1)*c,c=0),v>=r&&p>0&&(m=!0,p*=.9,v=l*p);var x=(r-v)/2>>0,y={offset:x-c,size:0};f=n.reduce((A,T)=>{var k,I={stackId:T.stackId,dataKeys:T.dataKeys,position:{offset:y.offset+y.size+c,size:m?p:(k=T.barSize)!==null&&k!==void 0?k:0}},O=[...A,I];return y=I.position,O},d)}else{var b=ka(t,r,0,!0);r-2*b-(l-1)*c<=0&&(c=0);var _=(r-2*b-(l-1)*c)/l;_>1&&(_>>=0);var E=rr(a)?Math.min(_,a):_;f=n.reduce((A,T,k)=>[...A,{stackId:T.stackId,dataKeys:T.dataKeys,position:{offset:b+(_+c)*k+(_-E)/2,size:E}}],d)}return f}}var AJ=(e,t,r,n,a,i,l)=>{var c=Jn(l)?t:l,f=TJ(r,n,a!==i?a:i,e,c);return a!==i&&f!=null&&(f=f.map(d=>ym(ym({},d),{},{position:ym(ym({},d.position),{},{offset:d.position.offset-a/2})}))),f},jJ=(e,t)=>{var r=l2(t);if(!(!e||r==null||t==null)){var{stackId:n}=t;if(n!=null){var a=e[n];if(a){var{stackedData:i}=a;if(i)return i.find(l=>l.key===r)}}}},OJ=(e,t)=>{if(!(e==null||t==null)){var r=e.find(n=>n.stackId===t.stackId&&t.dataKey!=null&&n.dataKeys.includes(t.dataKey));if(r!=null)return r.position}};function CJ(e,t){return e&&typeof e=="object"&&"zIndex"in e&&typeof e.zIndex=="number"&&rr(e.zIndex)?e.zIndex:t}var UR=e=>{var{chartData:t}=e,r=Ur(),n=Ja();return N.useEffect(()=>n?()=>{}:(r(xC(t)),()=>{r(xC(void 0))}),[t,r,n]),null},f4={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},$R=Qa({name:"brush",initialState:f4,reducers:{setBrushSettings(e,t){return t.payload==null?f4:t.payload}}}),{setBrushSettings:nve}=$R.actions,DJ=$R.reducer;function IJ(e){return(e%180+180)%180}var PJ=function(t){var{width:r,height:n}=t,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=IJ(a),l=i*Math.PI/180,c=Math.atan(n/r),f=l>c&&l<Math.PI-c?n/Math.sin(l):r/Math.cos(l);return Math.abs(f)},MJ={dots:[],areas:[],lines:[]},zR=Qa({name:"referenceElements",initialState:MJ,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=ss(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=ss(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=ss(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),{addDot:ave,removeDot:ive,addArea:sve,removeArea:lve,addLine:ove,removeLine:cve}=zR.actions,RJ=zR.reducer,FJ=N.createContext(void 0),LJ=e=>{var{children:t}=e,[r]=N.useState("".concat(Md("recharts"),"-clip")),n=BR();if(n==null)return null;var{x:a,y:i,width:l,height:c}=n;return N.createElement(FJ.Provider,{value:r},N.createElement("defs",null,N.createElement("clipPath",{id:r},N.createElement("rect",{x:a,y:i,height:c,width:l}))),t)};function HR(e,t){if(t<1)return[];if(t===1)return e;for(var r=[],n=0;n<e.length;n+=t){var a=e[n];a!==void 0&&r.push(a)}return r}function BJ(e,t,r){var n={width:e.width+t.width,height:e.height+t.height};return PJ(n,r)}function UJ(e,t,r){var n=r==="width",{x:a,y:i,width:l,height:c}=e;return t===1?{start:n?a:i,end:n?a+l:i+c}:{start:n?a+l:i+c,end:n?a:i}}function Xd(e,t,r,n,a){if(e*t<e*n||e*t>e*a)return!1;var i=r();return e*(t-e*i/2-n)>=0&&e*(t+e*i/2-a)<=0}function $J(e,t){return HR(e,t+1)}function zJ(e,t,r,n,a){for(var i=(n||[]).slice(),{start:l,end:c}=t,f=0,d=1,m=l,p=function(){var y=n==null?void 0:n[f];if(y===void 0)return{v:HR(n,d)};var b=f,_,E=()=>(_===void 0&&(_=r(y,b)),_),A=y.coordinate,T=f===0||Xd(e,A,E,m,c);T||(f=0,m=l,d+=1),T&&(m=A+e*(E()/2+a),f+=d)},v;d<=i.length;)if(v=p(),v)return v.v;return[]}function HJ(e,t,r,n,a){var i=(n||[]).slice(),l=i.length;if(l===0)return[];for(var{start:c,end:f}=t,d=1;d<=l;d++){for(var m=(l-1)%d,p=c,v=!0,x=function(){var k=n[b];if(k==null)return 0;var I=b,O,j=()=>(O===void 0&&(O=r(k,I)),O),B=k.coordinate,U=b===m||Xd(e,B,j,p,f);if(!U)return v=!1,1;U&&(p=B+e*(j()/2+a))},y,b=m;b<l&&(y=x(),!(y!==0&&y===1));b+=d);if(v){for(var _=[],E=m;E<l;E+=d){var A=n[E];A!=null&&_.push(A)}return _}}return[]}function d4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ba(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d4(Object(r),!0).forEach(function(n){qJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qJ(e,t,r){return(t=WJ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WJ(e){var t=VJ(e,"string");return typeof t=="symbol"?t:t+""}function VJ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GJ(e,t,r,n,a){for(var i=(n||[]).slice(),l=i.length,{start:c}=t,{end:f}=t,d=function(v){var x=i[v];if(x==null)return 1;var y=x,b,_=()=>(b===void 0&&(b=r(x,v)),b);if(v===l-1){var E=e*(y.coordinate+e*_()/2-f);i[v]=y=ba(ba({},y),{},{tickCoord:E>0?y.coordinate-E*e:y.coordinate})}else i[v]=y=ba(ba({},y),{},{tickCoord:y.coordinate});if(y.tickCoord!=null){var A=Xd(e,y.tickCoord,_,c,f);A&&(f=y.tickCoord-e*(_()/2+a),i[v]=ba(ba({},y),{},{isShow:!0}))}},m=l-1;m>=0;m--)d(m);return i}function KJ(e,t,r,n,a,i){var l=(n||[]).slice(),c=l.length,{start:f,end:d}=t;if(i){var m=n[c-1];if(m!=null){var p=r(m,c-1),v=e*(m.coordinate+e*p/2-d);if(l[c-1]=m=ba(ba({},m),{},{tickCoord:v>0?m.coordinate-v*e:m.coordinate}),m.tickCoord!=null){var x=Xd(e,m.tickCoord,()=>p,f,d);x&&(d=m.tickCoord-e*(p/2+a),l[c-1]=ba(ba({},m),{},{isShow:!0}))}}}for(var y=i?c-1:c,b=function(A){var T=l[A];if(T==null)return 1;var k=T,I,O=()=>(I===void 0&&(I=r(T,A)),I);if(A===0){var j=e*(k.coordinate-e*O()/2-f);l[A]=k=ba(ba({},k),{},{tickCoord:j<0?k.coordinate-j*e:k.coordinate})}else l[A]=k=ba(ba({},k),{},{tickCoord:k.coordinate});if(k.tickCoord!=null){var B=Xd(e,k.tickCoord,O,f,d);B&&(f=k.tickCoord+e*(O()/2+a),l[A]=ba(ba({},k),{},{isShow:!0}))}},_=0;_<y;_++)b(_);return l}function G2(e,t,r){var{tick:n,ticks:a,viewBox:i,minTickGap:l,orientation:c,interval:f,tickFormatter:d,unit:m,angle:p}=e;if(!a||!a.length||!n)return[];if(gt(f)||Eg.isSsr){var v;return(v=$J(a,gt(f)?f:0))!==null&&v!==void 0?v:[]}var x=[],y=c==="top"||c==="bottom"?"width":"height",b=m&&y==="width"?Sd(m,{fontSize:t,letterSpacing:r}):{width:0,height:0},_=(I,O)=>{var j=typeof d=="function"?d(I.value,O):I.value;return y==="width"?BJ(Sd(j,{fontSize:t,letterSpacing:r}),b,p):Sd(j,{fontSize:t,letterSpacing:r})[y]},E=a[0],A=a[1],T=a.length>=2&&E!=null&&A!=null?Yn(A.coordinate-E.coordinate):1,k=UJ(i,T,y);return f==="equidistantPreserveStart"?zJ(T,k,_,a,l):f==="equidistantPreserveEnd"?HJ(T,k,_,a,l):(f==="preserveStart"||f==="preserveStartEnd"?x=KJ(T,k,_,a,l,f==="preserveStartEnd"):x=GJ(T,k,_,a,l),x.filter(I=>I.isShow))}var XJ=e=>{var{ticks:t,label:r,labelGapWithTick:n=5,tickSize:a=0,tickMargin:i=0}=e,l=0;if(t){Array.from(t).forEach(m=>{if(m){var p=m.getBoundingClientRect();p.width>l&&(l=p.width)}});var c=r?r.getBoundingClientRect().width:0,f=a+i,d=l+f+c+(r?n:0);return Math.round(d)}return 0},YJ=["axisLine","width","height","className","hide","ticks","axisType"];function QJ(e,t){if(e==null)return{};var r,n,a=JJ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JJ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function yc(){return yc=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},yc.apply(null,arguments)}function h4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ln(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h4(Object(r),!0).forEach(function(n){ZJ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZJ(e,t,r){return(t=eZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eZ(e){var t=tZ(e,"string");return typeof t=="symbol"?t:t+""}function tZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var al={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd",zIndex:pa.axis};function rZ(e){var{x:t,y:r,width:n,height:a,orientation:i,mirror:l,axisLine:c,otherSvgProps:f}=e;if(!c)return null;var d=ln(ln(ln({},f),cs(c)),{},{fill:"none"});if(i==="top"||i==="bottom"){var m=+(i==="top"&&!l||i==="bottom"&&l);d=ln(ln({},d),{},{x1:t,y1:r+m*a,x2:t+n,y2:r+m*a})}else{var p=+(i==="left"&&!l||i==="right"&&l);d=ln(ln({},d),{},{x1:t+p*n,y1:r,x2:t+p*n,y2:r+a})}return N.createElement("line",yc({},d,{className:kr("recharts-cartesian-axis-line",dc(c,"className"))}))}function nZ(e,t,r,n,a,i,l,c,f){var d,m,p,v,x,y,b=c?-1:1,_=e.tickSize||l,E=gt(e.tickCoord)?e.tickCoord:e.coordinate;switch(i){case"top":d=m=e.coordinate,v=r+ +!c*a,p=v-b*_,y=p-b*f,x=E;break;case"left":p=v=e.coordinate,m=t+ +!c*n,d=m-b*_,x=d-b*f,y=E;break;case"right":p=v=e.coordinate,m=t+ +c*n,d=m+b*_,x=d+b*f,y=E;break;default:d=m=e.coordinate,v=r+ +c*a,p=v+b*_,y=p+b*f,x=E;break}return{line:{x1:d,y1:p,x2:m,y2:v},tick:{x,y}}}function aZ(e,t){switch(e){case"left":return t?"start":"end";case"right":return t?"end":"start";default:return"middle"}}function iZ(e,t){switch(e){case"left":case"right":return"middle";case"top":return t?"start":"end";default:return t?"end":"start"}}function sZ(e){var{option:t,tickProps:r,value:n}=e,a,i=kr(r.className,"recharts-cartesian-axis-tick-value");if(N.isValidElement(t))a=N.cloneElement(t,ln(ln({},r),{},{className:i}));else if(typeof t=="function")a=t(ln(ln({},r),{},{className:i}));else{var l="recharts-cartesian-axis-tick-value";typeof t!="boolean"&&(l=kr(l,OR(t))),a=N.createElement(Wg,yc({},r,{className:l}),n)}return a}var lZ=N.forwardRef((e,t)=>{var{ticks:r=[],tick:n,tickLine:a,stroke:i,tickFormatter:l,unit:c,padding:f,tickTextProps:d,orientation:m,mirror:p,x:v,y:x,width:y,height:b,tickSize:_,tickMargin:E,fontSize:A,letterSpacing:T,getTicksConfig:k,events:I,axisType:O}=e,j=G2(ln(ln({},k),{},{ticks:r}),A,T),B=aZ(m,p),U=iZ(m,p),Y=cs(k),te=Pd(n),V={};typeof a=="object"&&(V=a);var ge=ln(ln({},Y),{},{fill:"none"},V),be=j.map(ue=>ln({entry:ue},nZ(ue,v,x,y,b,m,_,p,E))),ve=be.map(ue=>{var{entry:se,line:Q}=ue;return N.createElement(Fa,{className:"recharts-cartesian-axis-tick",key:"tick-".concat(se.value,"-").concat(se.coordinate,"-").concat(se.tickCoord)},a&&N.createElement("line",yc({},ge,Q,{className:kr("recharts-cartesian-axis-tick-line",dc(a,"className"))})))}),z=be.map((ue,se)=>{var Q,re,{entry:G,tick:P}=ue,W=ln(ln(ln(ln({verticalAnchor:U},Y),{},{textAnchor:B,stroke:"none",fill:i},P),{},{index:se,payload:G,visibleTicksCount:j.length,tickFormatter:l,padding:f},d),{},{angle:(Q=(re=d==null?void 0:d.angle)!==null&&re!==void 0?re:Y.angle)!==null&&Q!==void 0?Q:0}),F=ln(ln({},W),te);return N.createElement(Fa,yc({className:"recharts-cartesian-axis-tick-label",key:"tick-label-".concat(G.value,"-").concat(G.coordinate,"-").concat(G.tickCoord)},v0(I,G,se)),n&&N.createElement(sZ,{option:n,tickProps:F,value:"".concat(typeof l=="function"?l(G.value,se):G.value).concat(c||"")}))});return N.createElement("g",{className:"recharts-cartesian-axis-ticks recharts-".concat(O,"-ticks")},z.length>0&&N.createElement(ds,{zIndex:pa.label},N.createElement("g",{className:"recharts-cartesian-axis-tick-labels recharts-".concat(O,"-tick-labels"),ref:t},z)),ve.length>0&&N.createElement("g",{className:"recharts-cartesian-axis-tick-lines recharts-".concat(O,"-tick-lines")},ve))}),oZ=N.forwardRef((e,t)=>{var{axisLine:r,width:n,height:a,className:i,hide:l,ticks:c,axisType:f}=e,d=QJ(e,YJ),[m,p]=N.useState(""),[v,x]=N.useState(""),y=N.useRef(null);N.useImperativeHandle(t,()=>({getCalculatedWidth:()=>{var _;return XJ({ticks:y.current,label:(_=e.labelRef)===null||_===void 0?void 0:_.current,labelGapWithTick:5,tickSize:e.tickSize,tickMargin:e.tickMargin})}}));var b=N.useCallback(_=>{if(_){var E=_.getElementsByClassName("recharts-cartesian-axis-tick-value");y.current=E;var A=E[0];if(A){var T=window.getComputedStyle(A),k=T.fontSize,I=T.letterSpacing;(k!==m||I!==v)&&(p(k),x(I))}}},[m,v]);return l||n!=null&&n<=0||a!=null&&a<=0?null:N.createElement(ds,{zIndex:e.zIndex},N.createElement(Fa,{className:kr("recharts-cartesian-axis",i)},N.createElement(rZ,{x:e.x,y:e.y,width:n,height:a,orientation:e.orientation,mirror:e.mirror,axisLine:r,otherSvgProps:cs(e)}),N.createElement(lZ,{ref:b,axisType:f,events:d,fontSize:m,getTicksConfig:e,height:e.height,letterSpacing:v,mirror:e.mirror,orientation:e.orientation,padding:e.padding,stroke:e.stroke,tick:e.tick,tickFormatter:e.tickFormatter,tickLine:e.tickLine,tickMargin:e.tickMargin,tickSize:e.tickSize,tickTextProps:e.tickTextProps,ticks:c,unit:e.unit,width:e.width,x:e.x,y:e.y}),N.createElement(pY,{x:e.x,y:e.y,width:e.width,height:e.height,lowerWidth:e.width,upperWidth:e.width},N.createElement(NY,{label:e.label,labelRef:e.labelRef}),e.children)))}),K2=N.forwardRef((e,t)=>{var r=Zn(e,al);return N.createElement(oZ,yc({},r,{ref:t}))});K2.displayName="CartesianAxis";var cZ=["x1","y1","x2","y2","key"],uZ=["offset"],fZ=["xAxisId","yAxisId"],dZ=["xAxisId","yAxisId"];function m4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Sa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?m4(Object(r),!0).forEach(function(n){hZ(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):m4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hZ(e,t,r){return(t=mZ(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mZ(e){var t=pZ(e,"string");return typeof t=="symbol"?t:t+""}function pZ(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zo(){return Zo=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zo.apply(null,arguments)}function Mp(e,t){if(e==null)return{};var r,n,a=gZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function gZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var vZ=e=>{var{fill:t}=e;if(!t||t==="none")return null;var{fillOpacity:r,x:n,y:a,width:i,height:l,ry:c}=e;return N.createElement("rect",{x:n,y:a,ry:c,width:i,height:l,stroke:"none",fill:t,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function qR(e){var{option:t,lineItemProps:r}=e,n;if(N.isValidElement(t))n=N.cloneElement(t,r);else if(typeof t=="function")n=t(r);else{var a,{x1:i,y1:l,x2:c,y2:f,key:d}=r,m=Mp(r,cZ),p=(a=cs(m))!==null&&a!==void 0?a:{},{offset:v}=p,x=Mp(p,uZ);n=N.createElement("line",Zo({},x,{x1:i,y1:l,x2:c,y2:f,fill:"none",key:d}))}return n}function xZ(e){var{x:t,width:r,horizontal:n=!0,horizontalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:l}=e,c=Mp(e,fZ),f=a.map((d,m)=>{var p=Sa(Sa({},c),{},{x1:t,y1:d,x2:t+r,y2:d,key:"line-".concat(m),index:m});return N.createElement(qR,{key:"line-".concat(m),option:n,lineItemProps:p})});return N.createElement("g",{className:"recharts-cartesian-grid-horizontal"},f)}function yZ(e){var{y:t,height:r,vertical:n=!0,verticalPoints:a}=e;if(!n||!a||!a.length)return null;var{xAxisId:i,yAxisId:l}=e,c=Mp(e,dZ),f=a.map((d,m)=>{var p=Sa(Sa({},c),{},{x1:d,y1:t,x2:d,y2:t+r,key:"line-".concat(m),index:m});return N.createElement(qR,{option:n,lineItemProps:p,key:"line-".concat(m)})});return N.createElement("g",{className:"recharts-cartesian-grid-vertical"},f)}function bZ(e){var{horizontalFill:t,fillOpacity:r,x:n,y:a,width:i,height:l,horizontalPoints:c,horizontal:f=!0}=e;if(!f||!t||!t.length||c==null)return null;var d=c.map(p=>Math.round(p+a-a)).sort((p,v)=>p-v);a!==d[0]&&d.unshift(0);var m=d.map((p,v)=>{var x=d[v+1],y=x==null,b=y?a+l-p:x-p;if(b<=0)return null;var _=v%t.length;return N.createElement("rect",{key:"react-".concat(v),y:p,x:n,height:b,width:i,stroke:"none",fill:t[_],fillOpacity:r,className:"recharts-cartesian-grid-bg"})});return N.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},m)}function wZ(e){var{vertical:t=!0,verticalFill:r,fillOpacity:n,x:a,y:i,width:l,height:c,verticalPoints:f}=e;if(!t||!r||!r.length)return null;var d=f.map(p=>Math.round(p+a-a)).sort((p,v)=>p-v);a!==d[0]&&d.unshift(0);var m=d.map((p,v)=>{var x=d[v+1],y=x==null,b=y?a+l-p:x-p;if(b<=0)return null;var _=v%r.length;return N.createElement("rect",{key:"react-".concat(v),x:p,y:i,width:b,height:c,stroke:"none",fill:r[_],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return N.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},m)}var _Z=(e,t)=>{var{xAxis:r,width:n,height:a,offset:i}=e;return PI(G2(Sa(Sa(Sa({},al),r),{},{ticks:MI(r),viewBox:{x:0,y:0,width:n,height:a}})),i.left,i.left+i.width,t)},SZ=(e,t)=>{var{yAxis:r,width:n,height:a,offset:i}=e;return PI(G2(Sa(Sa(Sa({},al),r),{},{ticks:MI(r),viewBox:{x:0,y:0,width:n,height:a}})),i.top,i.top+i.height,t)},EZ={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0,syncWithTicks:!1,zIndex:pa.grid};function P0(e){var t=E_(),r=N_(),n=zI(),a=Sa(Sa({},Zn(e,EZ)),{},{x:gt(e.x)?e.x:n.left,y:gt(e.y)?e.y:n.top,width:gt(e.width)?e.width:n.width,height:gt(e.height)?e.height:n.height}),{xAxisId:i,yAxisId:l,x:c,y:f,width:d,height:m,syncWithTicks:p,horizontalValues:v,verticalValues:x}=a,y=Ja(),b=xt(U=>sC(U,"xAxis",i,y)),_=xt(U=>sC(U,"yAxis",l,y));if(!js(d)||!js(m)||!gt(c)||!gt(f))return null;var E=a.verticalCoordinatesGenerator||_Z,A=a.horizontalCoordinatesGenerator||SZ,{horizontalPoints:T,verticalPoints:k}=a;if((!T||!T.length)&&typeof A=="function"){var I=v&&v.length,O=A({yAxis:_?Sa(Sa({},_),{},{ticks:I?v:_.ticks}):void 0,width:t??d,height:r??m,offset:n},I?!0:p);lp(Array.isArray(O),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof O,"]")),Array.isArray(O)&&(T=O)}if((!k||!k.length)&&typeof E=="function"){var j=x&&x.length,B=E({xAxis:b?Sa(Sa({},b),{},{ticks:j?x:b.ticks}):void 0,width:t??d,height:r??m,offset:n},j?!0:p);lp(Array.isArray(B),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof B,"]")),Array.isArray(B)&&(k=B)}return N.createElement(ds,{zIndex:a.zIndex},N.createElement("g",{className:"recharts-cartesian-grid"},N.createElement(vZ,{fill:a.fill,fillOpacity:a.fillOpacity,x:a.x,y:a.y,width:a.width,height:a.height,ry:a.ry}),N.createElement(bZ,Zo({},a,{horizontalPoints:T})),N.createElement(wZ,Zo({},a,{verticalPoints:k})),N.createElement(xZ,Zo({},a,{offset:n,horizontalPoints:T,xAxis:b,yAxis:_})),N.createElement(yZ,Zo({},a,{offset:n,verticalPoints:k,xAxis:b,yAxis:_}))))}P0.displayName="CartesianGrid";var NZ={},WR=Qa({name:"errorBars",initialState:NZ,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},replaceErrorBar:(e,t)=>{var{itemId:r,prev:n,next:a}=t.payload;e[r]&&(e[r]=e[r].map(i=>i.dataKey===n.dataKey&&i.direction===n.direction?a:i))},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),{addErrorBar:uve,replaceErrorBar:fve,removeErrorBar:dve}=WR.actions,kZ=WR.reducer,TZ=["children"];function AZ(e,t){if(e==null)return{};var r,n,a=jZ(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function jZ(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var OZ={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},CZ=N.createContext(OZ);function DZ(e){var{children:t}=e,r=AZ(e,TZ);return N.createElement(CZ.Provider,{value:r},t)}function VR(e,t){var r,n,a=xt(d=>bl(d,e)),i=xt(d=>wl(d,t)),l=(r=a==null?void 0:a.allowDataOverflow)!==null&&r!==void 0?r:Wn.allowDataOverflow,c=(n=i==null?void 0:i.allowDataOverflow)!==null&&n!==void 0?n:Vn.allowDataOverflow,f=l||c;return{needClip:f,needClipX:l,needClipY:c}}function IZ(e){var{xAxisId:t,yAxisId:r,clipPathId:n}=e,a=BR(),{needClipX:i,needClipY:l,needClip:c}=VR(t,r);if(!c||!a)return null;var{x:f,y:d,width:m,height:p}=a;return N.createElement("clipPath",{id:"clipPath-".concat(n)},N.createElement("rect",{x:i?f:f-m/2,y:l?d:d-p/2,width:i?m:m*2,height:l?p:p*2}))}var Y1={exports:{}},Q1={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p4;function PZ(){if(p4)return Q1;p4=1;var e=Zu();function t(f,d){return f===d&&(f!==0||1/f===1/d)||f!==f&&d!==d}var r=typeof Object.is=="function"?Object.is:t,n=e.useSyncExternalStore,a=e.useRef,i=e.useEffect,l=e.useMemo,c=e.useDebugValue;return Q1.useSyncExternalStoreWithSelector=function(f,d,m,p,v){var x=a(null);if(x.current===null){var y={hasValue:!1,value:null};x.current=y}else y=x.current;x=l(function(){function _(I){if(!E){if(E=!0,A=I,I=p(I),v!==void 0&&y.hasValue){var O=y.value;if(v(O,I))return T=O}return T=I}if(O=T,r(A,I))return O;var j=p(I);return v!==void 0&&v(O,j)?(A=I,O):(A=I,T=j)}var E=!1,A,T,k=m===void 0?null:m;return[function(){return _(d())},k===null?void 0:function(){return _(k())}]},[d,m,p,v]);var b=n(f,x[0],x[1]);return i(function(){y.hasValue=!0,y.value=b},[b]),c(b),b},Q1}var g4;function MZ(){return g4||(g4=1,Y1.exports=PZ()),Y1.exports}MZ();function RZ(e){e()}function FZ(){let e=null,t=null;return{clear(){e=null,t=null},notify(){RZ(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var v4={notify(){},get:()=>[]};function LZ(e,t){let r,n=v4,a=0,i=!1;function l(b){m();const _=n.subscribe(b);let E=!1;return()=>{E||(E=!0,_(),p())}}function c(){n.notify()}function f(){y.onStateChange&&y.onStateChange()}function d(){return i}function m(){a++,r||(r=e.subscribe(f),n=FZ())}function p(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=v4)}function v(){i||(i=!0,m())}function x(){i&&(i=!1,p())}const y={addNestedSub:l,notifyNestedSubs:c,handleChangeWrapper:f,isSubscribed:d,trySubscribe:v,tryUnsubscribe:x,getListeners:()=>n};return y}var BZ=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",UZ=BZ(),$Z=()=>typeof navigator<"u"&&navigator.product==="ReactNative",zZ=$Z(),HZ=()=>UZ||zZ?N.useLayoutEffect:N.useEffect,qZ=HZ();function x4(e,t){return e===t?e!==0||t!==0||1/e===1/t:e!==e&&t!==t}function WZ(e,t){if(x4(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;const r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(let a=0;a<r.length;a++)if(!Object.prototype.hasOwnProperty.call(t,r[a])||!x4(e[r[a]],t[r[a]]))return!1;return!0}var J1=Symbol.for("react-redux-context"),Z1=typeof globalThis<"u"?globalThis:{};function VZ(){if(!N.createContext)return{};const e=Z1[J1]??(Z1[J1]=new Map);let t=e.get(N.createContext);return t||(t=N.createContext(null),e.set(N.createContext,t)),t}var GZ=VZ();function KZ(e){const{children:t,context:r,serverState:n,store:a}=e,i=N.useMemo(()=>{const f=LZ(a);return{store:a,subscription:f,getServerState:n?()=>n:void 0}},[a,n]),l=N.useMemo(()=>a.getState(),[a]);qZ(()=>{const{subscription:f}=i;return f.onStateChange=f.notifyNestedSubs,f.trySubscribe(),l!==a.getState()&&f.notifyNestedSubs(),()=>{f.tryUnsubscribe(),f.onStateChange=void 0}},[i,l]);const c=r||GZ;return N.createElement(c.Provider,{value:i},t)}var XZ=KZ,YZ=new Set(["axisLine","tickLine","activeBar","activeDot","activeLabel","activeShape","allowEscapeViewBox","background","cursor","dot","label","line","margin","padding","position","shape","style","tick","wrapperStyle","radius"]);function QZ(e,t){return e==null&&t==null?!0:typeof e=="number"&&typeof t=="number"?e===t||e!==e&&t!==t:e===t}function X2(e,t){var r=new Set([...Object.keys(e),...Object.keys(t)]);for(var n of r)if(YZ.has(n)){if(e[n]==null&&t[n]==null)continue;if(!WZ(e[n],t[n]))return!1}else if(!QZ(e[n],t[n]))return!1;return!0}function Ac(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.xAxisId)!==null&&r!==void 0?r:FR}function jc(e,t){var r,n;return(r=(n=e.graphicalItems.cartesianItems.find(a=>a.id===t))===null||n===void 0?void 0:n.yAxisId)!==null&&r!==void 0?r:FR}var JZ="Invariant failed";function ZZ(e,t){throw new Error(JZ)}function _w(){return _w=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_w.apply(null,arguments)}function Rp(e){return N.createElement(IR,_w({shapeType:"rectangle",activeClassName:"recharts-active-bar"},e))}var eee=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(n,a)=>{if(gt(t))return t;var i=gt(n)||Jn(n);return i?t(n,a):(i||ZZ(),r)}},tee=(e,t,r)=>r,ree=(e,t)=>t,M0=Te([u2,ree],(e,t)=>e.filter(r=>r.type==="bar").find(r=>r.id===t)),nee=Te([M0],e=>e==null?void 0:e.maxBarSize),aee=(e,t,r,n)=>n,iee=Te([hr,u2,Ac,jc,tee],(e,t,r,n,a)=>t.filter(i=>e==="horizontal"?i.xAxisId===r:i.yAxisId===n).filter(i=>i.isPanorama===a).filter(i=>i.hide===!1).filter(i=>i.type==="bar")),see=(e,t,r)=>{var n=hr(e),a=Ac(e,t),i=jc(e,t);if(!(a==null||i==null))return n==="horizontal"?gw(e,"yAxis",i,r):gw(e,"xAxis",a,r)},lee=(e,t)=>{var r=hr(e),n=Ac(e,t),a=jc(e,t);if(!(n==null||a==null))return r==="horizontal"?iC(e,"xAxis",n):iC(e,"yAxis",a)},oee=Te([iee,uV,lee],SJ),cee=(e,t,r)=>{var n,a,i=M0(e,t);if(i==null)return 0;var l=Ac(e,t),c=jc(e,t);if(l==null||c==null)return 0;var f=hr(e),d=nM(e),{maxBarSize:m}=i,p=Jn(m)?d:m,v,x;return f==="horizontal"?(v=Xu(e,"xAxis",l,r),x=Ku(e,"xAxis",l,r)):(v=Xu(e,"yAxis",c,r),x=Ku(e,"yAxis",c,r)),(n=(a=sp(v,x,!0))!==null&&a!==void 0?a:p)!==null&&n!==void 0?n:0},GR=(e,t,r)=>{var n=hr(e),a=Ac(e,t),i=jc(e,t);if(!(a==null||i==null)){var l,c;return n==="horizontal"?(l=Xu(e,"xAxis",a,r),c=Ku(e,"xAxis",a,r)):(l=Xu(e,"yAxis",i,r),c=Ku(e,"yAxis",i,r)),sp(l,c)}},uee=Te([oee,nM,cV,aM,cee,GR,nee],AJ),fee=(e,t,r)=>{var n=Ac(e,t);if(n!=null)return Xu(e,"xAxis",n,r)},dee=(e,t,r)=>{var n=jc(e,t);if(n!=null)return Xu(e,"yAxis",n,r)},hee=(e,t,r)=>{var n=Ac(e,t);if(n!=null)return Ku(e,"xAxis",n,r)},mee=(e,t,r)=>{var n=jc(e,t);if(n!=null)return Ku(e,"yAxis",n,r)},pee=Te([uee,M0],OJ),gee=Te([see,M0],jJ),vee=Te([Ln,w_,fee,dee,hee,mee,pee,hr,tV,GR,gee,M0,aee],(e,t,r,n,a,i,l,c,f,d,m,p,v)=>{var{chartData:x,dataStartIndex:y,dataEndIndex:b}=f;if(!(p==null||l==null||t==null||c!=="horizontal"&&c!=="vertical"||r==null||n==null||a==null||i==null||d==null)){var{data:_}=p,E;if(_!=null&&_.length>0?E=_:E=x==null?void 0:x.slice(y,b+1),E!=null)return Wee({layout:c,barSettings:p,pos:l,parentViewBox:t,bandSize:d,xAxis:r,yAxis:n,xAxisTicks:a,yAxisTicks:i,stackedData:m,displayedData:E,offset:e,cells:v,dataStartIndex:y})}}),xee=["index"];function Sw(){return Sw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Sw.apply(null,arguments)}function yee(e,t){if(e==null)return{};var r,n,a=bee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var KR=N.createContext(void 0),wee=e=>{var t=N.useContext(KR);if(t!=null)return t.stackId;if(e!=null)return X9(e)},_ee=(e,t)=>"recharts-bar-stack-clip-path-".concat(e,"-").concat(t),See=e=>{var t=N.useContext(KR);if(t!=null){var{stackId:r}=t;return"url(#".concat(_ee(r,e),")")}},XR=e=>{var{index:t}=e,r=yee(e,xee),n=See(t);return N.createElement(Fa,Sw({className:"recharts-bar-stack-layer",clipPath:n},r))},Eee=["onMouseEnter","onMouseLeave","onClick"],Nee=["value","background","tooltipPosition"],kee=["id"],Tee=["onMouseEnter","onClick","onMouseLeave"];function ml(){return ml=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ml.apply(null,arguments)}function y4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Pa(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y4(Object(r),!0).forEach(function(n){Aee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Aee(e,t,r){return(t=jee(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function jee(e){var t=Oee(e,"string");return typeof t=="symbol"?t:t+""}function Oee(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Fp(e,t){if(e==null)return{};var r,n,a=Cee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Cee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Dee=e=>{var{dataKey:t,name:r,fill:n,legendType:a,hide:i}=e;return[{inactive:i,dataKey:t,type:a,color:n,value:pg(r,t),payload:e}]},Iee=N.memo(e=>{var{dataKey:t,stroke:r,strokeWidth:n,fill:a,name:i,hide:l,unit:c,tooltipType:f,id:d}=e,m={dataDefinedOnItem:void 0,getPosition:ef,settings:{stroke:r,strokeWidth:n,fill:a,dataKey:t,nameKey:void 0,name:pg(i,t),hide:l,type:f,color:a,unit:c,graphicalItemId:d}};return N.createElement(PR,{tooltipEntrySettings:m})});function Pee(e){var t=xt(xc),{data:r,dataKey:n,background:a,allOtherBarProps:i}=e,{onMouseEnter:l,onMouseLeave:c,onClick:f}=i,d=Fp(i,Eee),m=q2(l,n,i.id),p=W2(c),v=V2(f,n,i.id);if(!a||r==null)return null;var x=Pd(a);return N.createElement(ds,{zIndex:CJ(a,pa.barBackground)},r.map((y,b)=>{var{value:_,background:E,tooltipPosition:A}=y,T=Fp(y,Nee);if(!E)return null;var k=m(y,b),I=p(y,b),O=v(y,b),j=Pa(Pa(Pa(Pa(Pa({option:a,isActive:String(b)===t},T),{},{fill:"#eee"},E),x),v0(d,y,b)),{},{onMouseEnter:k,onMouseLeave:I,onClick:O,dataKey:n,index:b,className:"recharts-bar-background-rectangle"});return N.createElement(Rp,ml({key:"background-bar-".concat(b)},j))}))}function Mee(e){var{showLabels:t,children:r,rects:n}=e,a=n==null?void 0:n.map(i=>{var l={x:i.x,y:i.y,width:i.width,lowerWidth:i.width,upperWidth:i.width,height:i.height};return Pa(Pa({},l),{},{value:i.value,payload:i.payload,parentViewBox:i.parentViewBox,viewBox:l,fill:i.fill})});return N.createElement(RY,{value:t?a:void 0},r)}function Ree(e){var{shape:t,activeBar:r,baseProps:n,entry:a,index:i,dataKey:l}=e,c=xt(xc),f=xt(M2),d=r&&String(i)===c&&(f==null||l===f),m=d?r:t;return d?N.createElement(ds,{zIndex:pa.activeBar},N.createElement(XR,{index:i},N.createElement(Rp,ml({},n,{name:String(n.name)},a,{isActive:d,option:m,index:i,dataKey:l})))):N.createElement(Rp,ml({},n,{name:String(n.name)},a,{isActive:d,option:m,index:i,dataKey:l}))}function Fee(e){var{shape:t,baseProps:r,entry:n,index:a,dataKey:i}=e;return N.createElement(Rp,ml({},r,{name:String(r.name)},n,{isActive:!1,option:t,index:a,dataKey:i}))}function Lee(e){var t,{data:r,props:n}=e,a=(t=cs(n))!==null&&t!==void 0?t:{},{id:i}=a,l=Fp(a,kee),{shape:c,dataKey:f,activeBar:d}=n,{onMouseEnter:m,onClick:p,onMouseLeave:v}=n,x=Fp(n,Tee),y=q2(m,f,i),b=W2(v),_=V2(p,f,i);return r?N.createElement(N.Fragment,null,r.map((E,A)=>N.createElement(XR,ml({index:A,key:"rectangle-".concat(E==null?void 0:E.x,"-").concat(E==null?void 0:E.y,"-").concat(E==null?void 0:E.value,"-").concat(A),className:"recharts-bar-rectangle"},v0(x,E,A),{onMouseEnter:y(E,A),onMouseLeave:b(E,A),onClick:_(E,A)}),d?N.createElement(Ree,{shape:c,activeBar:d,baseProps:l,entry:E,index:A,dataKey:f}):N.createElement(Fee,{shape:c,baseProps:l,entry:E,index:A,dataKey:f})))):null}function Bee(e){var{props:t,previousRectanglesRef:r}=e,{data:n,layout:a,isAnimationActive:i,animationBegin:l,animationDuration:c,animationEasing:f,onAnimationEnd:d,onAnimationStart:m}=t,p=r.current,v=kg(t,"recharts-bar-"),[x,y]=N.useState(!1),b=!x,_=N.useCallback(()=>{typeof d=="function"&&d(),y(!1)},[d]),E=N.useCallback(()=>{typeof m=="function"&&m(),y(!0)},[m]);return N.createElement(Mee,{showLabels:b,rects:n},N.createElement(Ng,{animationId:v,begin:l,duration:c,isActive:i,easing:f,onAnimationEnd:_,onAnimationStart:E,key:v},A=>{var T=A===1?n:n==null?void 0:n.map((k,I)=>{var O=p&&p[I];if(O)return Pa(Pa({},k),{},{x:Pn(O.x,k.x,A),y:Pn(O.y,k.y,A),width:Pn(O.width,k.width,A),height:Pn(O.height,k.height,A)});if(a==="horizontal"){var j=Pn(0,k.height,A),B=Pn(k.stackedBarStart,k.y,A);return Pa(Pa({},k),{},{y:B,height:j})}var U=Pn(0,k.width,A),Y=Pn(k.stackedBarStart,k.x,A);return Pa(Pa({},k),{},{width:U,x:Y})});return A>0&&(r.current=T??null),T==null?null:N.createElement(Fa,null,N.createElement(Lee,{props:t,data:T}))}),N.createElement(kR,{label:t.label}),t.children)}function Uee(e){var t=N.useRef(null);return N.createElement(Bee,{previousRectanglesRef:t,props:e})}var YR=0,$ee=(e,t)=>{var r=Array.isArray(e.value)?e.value[1]:e.value;return{x:e.x,y:e.y,value:r,errorVal:Gr(e,t)}};class zee extends N.PureComponent{render(){var{hide:t,data:r,dataKey:n,className:a,xAxisId:i,yAxisId:l,needClip:c,background:f,id:d}=this.props;if(t||r==null)return null;var m=kr("recharts-bar",a),p=d;return N.createElement(Fa,{className:m,id:d},c&&N.createElement("defs",null,N.createElement(IZ,{clipPathId:p,xAxisId:i,yAxisId:l})),N.createElement(Fa,{className:"recharts-bar-rectangles",clipPath:c?"url(#clipPath-".concat(p,")"):void 0},N.createElement(Pee,{data:r,dataKey:n,background:f,allOtherBarProps:this.props}),N.createElement(Uee,this.props)))}}var Hee={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",background:!1,hide:!1,isAnimationActive:"auto",label:!1,legendType:"rect",minPointSize:YR,xAxisId:0,yAxisId:0,zIndex:pa.bar};function qee(e){var{xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:l,animationBegin:c,animationDuration:f,animationEasing:d,isAnimationActive:m}=e,{needClip:p}=VR(t,r),v=tf(),x=Ja(),y=H2(e.children,oi),b=xt(A=>vee(A,e.id,x,y));if(v!=="vertical"&&v!=="horizontal")return null;var _,E=b==null?void 0:b[0];return E==null||E.height==null||E.width==null?_=0:_=v==="vertical"?E.height/2:E.width/2,N.createElement(DZ,{xAxisId:t,yAxisId:r,data:b,dataPointFormatter:$ee,errorBarOffset:_},N.createElement(zee,ml({},e,{layout:v,needClip:p,data:b,xAxisId:t,yAxisId:r,hide:n,legendType:a,minPointSize:i,activeBar:l,animationBegin:c,animationDuration:f,animationEasing:d,isAnimationActive:m})))}function Wee(e){var{layout:t,barSettings:{dataKey:r,minPointSize:n},pos:a,bandSize:i,xAxis:l,yAxis:c,xAxisTicks:f,yAxisTicks:d,stackedData:m,displayedData:p,offset:v,cells:x,parentViewBox:y,dataStartIndex:b}=e,_=t==="horizontal"?c:l,E=m?_.scale.domain():null,A=Y9({numericAxis:_}),T=_.scale.map(A);return p.map((k,I)=>{var O,j,B,U,Y,te;if(m){var V=m[I+b];if(V==null)return null;O=q9(V,E)}else O=Gr(k,r),Array.isArray(O)||(O=[A,O]);var ge=eee(n,YR)(O[1],I);if(t==="horizontal"){var be,ve=c.scale.map(O[0]),z=c.scale.map(O[1]);if(ve==null||z==null)return null;j=aj({axis:l,ticks:f,bandSize:i,offset:a.offset,entry:k,index:I}),B=(be=z??ve)!==null&&be!==void 0?be:void 0,U=a.size;var ue=ve-z;if(Y=Ts(ue)?0:ue,te={x:j,y:v.top,width:U,height:v.height},Math.abs(ge)>0&&Math.abs(Y)<Math.abs(ge)){var se=Yn(Y||ge)*(Math.abs(ge)-Math.abs(Y));B-=se,Y+=se}}else{var Q=l.scale.map(O[0]),re=l.scale.map(O[1]);if(Q==null||re==null)return null;if(j=Q,B=aj({axis:c,ticks:d,bandSize:i,offset:a.offset,entry:k,index:I}),U=re-Q,Y=a.size,te={x:v.left,y:B,width:v.width,height:Y},Math.abs(ge)>0&&Math.abs(U)<Math.abs(ge)){var G=Yn(U||ge)*(Math.abs(ge)-Math.abs(U));U+=G}}if(j==null||B==null||U==null||Y==null)return null;var P=Pa(Pa({},k),{},{stackedBarStart:T,x:j,y:B,width:U,height:Y,value:m?O:O[1],payload:k,background:te,tooltipPosition:{x:j+U/2,y:B+Y/2},parentViewBox:y},x&&x[I]&&x[I].props);return P}).filter(Boolean)}function Vee(e){var t=Zn(e,Hee),r=wee(t.stackId),n=Ja();return N.createElement(MR,{id:t.id,type:"bar"},a=>N.createElement(N.Fragment,null,N.createElement(SQ,{legendPayload:Dee(t)}),N.createElement(Iee,{dataKey:t.dataKey,stroke:t.stroke,strokeWidth:t.strokeWidth,fill:t.fill,name:t.name,hide:t.hide,unit:t.unit,tooltipType:t.tooltipType,id:a}),N.createElement(FQ,{type:"bar",id:a,data:void 0,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,dataKey:t.dataKey,stackId:r,hide:t.hide,barSize:t.barSize,minPointSize:t.minPointSize,maxBarSize:t.maxBarSize,isPanorama:n}),N.createElement(ds,{zIndex:t.zIndex},N.createElement(qee,ml({},t,{id:a})))))}var R0=N.memo(Vee,X2);R0.displayName="Bar";var Gee=["domain","range"],Kee=["domain","range"];function b4(e,t){if(e==null)return{};var r,n,a=Xee(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Xee(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function w4(e,t){return e===t?!0:Array.isArray(e)&&e.length===2&&Array.isArray(t)&&t.length===2?e[0]===t[0]&&e[1]===t[1]:!1}function QR(e,t){if(e===t)return!0;var{domain:r,range:n}=e,a=b4(e,Gee),{domain:i,range:l}=t,c=b4(t,Kee);return!w4(r,i)||!w4(n,l)?!1:X2(a,c)}var Yee=["type"],Qee=["dangerouslySetInnerHTML","ticks","scale"],Jee=["id","scale"];function Ew(){return Ew=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ew.apply(null,arguments)}function _4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function S4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_4(Object(r),!0).forEach(function(n){Zee(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Zee(e,t,r){return(t=ete(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ete(e){var t=tte(e,"string");return typeof t=="symbol"?t:t+""}function tte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Nw(e,t){if(e==null)return{};var r,n,a=rte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function rte(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function nte(e){var t=Ur(),r=N.useRef(null),n=HI(),{type:a}=e,i=Nw(e,Yee),l=Mg(n,"xAxis",a),c=N.useMemo(()=>{if(l!=null)return S4(S4({},i),{},{type:l})},[i,l]);return N.useLayoutEffect(()=>{c!=null&&(r.current===null?t(hJ(c)):r.current!==c&&t(mJ({prev:r.current,next:c})),r.current=c)},[c,t]),N.useLayoutEffect(()=>()=>{r.current&&(t(pJ(r.current)),r.current=null)},[t]),null}var ate=e=>{var{xAxisId:t,className:r}=e,n=xt(w_),a=Ja(),i="xAxis",l=xt(E=>FM(E,i,t,a)),c=xt(E=>IM(E,t)),f=xt(E=>uG(E,t)),d=xt(E=>mM(E,t));if(c==null||f==null||d==null)return null;var{dangerouslySetInnerHTML:m,ticks:p,scale:v}=e,x=Nw(e,Qee),{id:y,scale:b}=d,_=Nw(d,Jee);return N.createElement(K2,Ew({},x,_,{x:f.x,y:f.y,width:c.width,height:c.height,className:kr("recharts-".concat(i," ").concat(i),r),viewBox:n,ticks:l,axisType:i}))},ite={allowDataOverflow:Wn.allowDataOverflow,allowDecimals:Wn.allowDecimals,allowDuplicatedCategory:Wn.allowDuplicatedCategory,angle:Wn.angle,axisLine:al.axisLine,height:Wn.height,hide:!1,includeHidden:Wn.includeHidden,interval:Wn.interval,label:!1,minTickGap:Wn.minTickGap,mirror:Wn.mirror,orientation:Wn.orientation,padding:Wn.padding,reversed:Wn.reversed,scale:Wn.scale,tick:Wn.tick,tickCount:Wn.tickCount,tickLine:al.tickLine,tickSize:al.tickSize,type:Wn.type,xAxisId:0},ste=e=>{var t=Zn(e,ite);return N.createElement(N.Fragment,null,N.createElement(nte,{allowDataOverflow:t.allowDataOverflow,allowDecimals:t.allowDecimals,allowDuplicatedCategory:t.allowDuplicatedCategory,angle:t.angle,dataKey:t.dataKey,domain:t.domain,height:t.height,hide:t.hide,id:t.xAxisId,includeHidden:t.includeHidden,interval:t.interval,minTickGap:t.minTickGap,mirror:t.mirror,name:t.name,orientation:t.orientation,padding:t.padding,reversed:t.reversed,scale:t.scale,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit}),N.createElement(ate,t))},F0=N.memo(ste,QR);F0.displayName="XAxis";var lte=["type"],ote=["dangerouslySetInnerHTML","ticks","scale"],cte=["id","scale"];function kw(){return kw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kw.apply(null,arguments)}function E4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function N4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?E4(Object(r),!0).forEach(function(n){ute(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):E4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ute(e,t,r){return(t=fte(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fte(e){var t=dte(e,"string");return typeof t=="symbol"?t:t+""}function dte(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Tw(e,t){if(e==null)return{};var r,n,a=hte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function hte(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function mte(e){var t=Ur(),r=N.useRef(null),n=HI(),{type:a}=e,i=Tw(e,lte),l=Mg(n,"yAxis",a),c=N.useMemo(()=>{if(l!=null)return N4(N4({},i),{},{type:l})},[l,i]);return N.useLayoutEffect(()=>{c!=null&&(r.current===null?t(gJ(c)):r.current!==c&&t(vJ({prev:r.current,next:c})),r.current=c)},[c,t]),N.useLayoutEffect(()=>()=>{r.current&&(t(xJ(r.current)),r.current=null)},[t]),null}function pte(e){var{yAxisId:t,className:r,width:n,label:a}=e,i=N.useRef(null),l=N.useRef(null),c=xt(w_),f=Ja(),d=Ur(),m="yAxis",p=xt(O=>PM(O,t)),v=xt(O=>dG(O,t)),x=xt(O=>FM(O,m,t,f)),y=xt(O=>pM(O,t));if(N.useLayoutEffect(()=>{if(!(n!=="auto"||!p||U2(a)||N.isValidElement(a)||y==null)){var O=i.current;if(O){var j=O.getCalculatedWidth();Math.round(p.width)!==Math.round(j)&&d(yJ({id:t,width:j}))}}},[x,p,d,a,t,n,y]),p==null||v==null||y==null)return null;var{dangerouslySetInnerHTML:b,ticks:_,scale:E}=e,A=Tw(e,ote),{id:T,scale:k}=y,I=Tw(y,cte);return N.createElement(K2,kw({},A,I,{ref:i,labelRef:l,x:v.x,y:v.y,tickTextProps:n==="auto"?{width:void 0}:{width:n},width:p.width,height:p.height,className:kr("recharts-".concat(m," ").concat(m),r),viewBox:c,ticks:x,axisType:m}))}var gte={allowDataOverflow:Vn.allowDataOverflow,allowDecimals:Vn.allowDecimals,allowDuplicatedCategory:Vn.allowDuplicatedCategory,angle:Vn.angle,axisLine:al.axisLine,hide:!1,includeHidden:Vn.includeHidden,interval:Vn.interval,label:!1,minTickGap:Vn.minTickGap,mirror:Vn.mirror,orientation:Vn.orientation,padding:Vn.padding,reversed:Vn.reversed,scale:Vn.scale,tick:Vn.tick,tickCount:Vn.tickCount,tickLine:al.tickLine,tickSize:al.tickSize,type:Vn.type,width:Vn.width,yAxisId:0},vte=e=>{var t=Zn(e,gte);return N.createElement(N.Fragment,null,N.createElement(mte,{interval:t.interval,id:t.yAxisId,scale:t.scale,type:t.type,domain:t.domain,allowDataOverflow:t.allowDataOverflow,dataKey:t.dataKey,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDecimals:t.allowDecimals,tickCount:t.tickCount,padding:t.padding,includeHidden:t.includeHidden,reversed:t.reversed,ticks:t.ticks,width:t.width,orientation:t.orientation,mirror:t.mirror,hide:t.hide,unit:t.unit,name:t.name,angle:t.angle,minTickGap:t.minTickGap,tick:t.tick,tickFormatter:t.tickFormatter}),N.createElement(pte,t))},L0=N.memo(vte,QR);L0.displayName="YAxis";var xte=(e,t)=>t,Y2=Te([xte,hr,fM,ta,eR,_l,TK,Ln],PK),Q2=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},JR=zi("mouseClick"),ZR=y0();ZR.startListening({actionCreator:JR,effect:(e,t)=>{var r=e.payload,n=Y2(t.getState(),Q2(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(kG({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var Aw=zi("mouseMove"),e5=y0(),bm=null;e5.startListening({actionCreator:Aw,effect:(e,t)=>{var r=e.payload;bm!==null&&cancelAnimationFrame(bm);var n=Q2(r);bm=requestAnimationFrame(()=>{var a=t.getState(),i=j2(a,a.tooltip.settings.shared);if(i==="axis"){var l=Y2(a,n);(l==null?void 0:l.activeIndex)!=null?t.dispatch(WM({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate})):t.dispatch(qM())}bm=null})}});function yte(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":e==="children"&&typeof t=="object"&&t!==null?"<<CHILDREN>>":t}var k4={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index",baseValue:void 0,reverseStackOrder:!1},t5=Qa({name:"rootProps",initialState:k4,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:k4.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className,e.baseValue=t.payload.baseValue,e.reverseStackOrder=t.payload.reverseStackOrder}}}),bte=t5.reducer,{updateOptions:wte}=t5.actions,_te=null,Ste={updatePolarOptions:(e,t)=>t.payload},r5=Qa({name:"polarOptions",initialState:_te,reducers:Ste}),{updatePolarOptions:Ete}=r5.actions,Nte=r5.reducer,n5=zi("keyDown"),a5=zi("focus"),J2=y0();J2.startListening({actionCreator:n5,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var l=O2(a,ff(r),O0(r),D0(r)),c=l==null?-1:Number(l);if(!(!Number.isFinite(c)||c<0)){var f=_l(r);if(i==="Enter"){var d=Op(r,"axis","hover",String(a.index));t.dispatch(xw({active:!a.active,activeIndex:a.index,activeCoordinate:d}));return}var m=gG(r),p=m==="left-to-right"?1:-1,v=i==="ArrowRight"?1:-1,x=c+v*p;if(!(f==null||x>=f.length||x<0)){var y=Op(r,"axis","hover",String(x));t.dispatch(xw({active:!0,activeIndex:x.toString(),activeCoordinate:y}))}}}}}});J2.startListening({actionCreator:a5,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",l=Op(r,"axis","hover",String(i));t.dispatch(xw({active:!0,activeIndex:i,activeCoordinate:l}))}}}});var Di=zi("externalEvent"),i5=y0(),eb=new Map;i5.startListening({actionCreator:Di,effect:(e,t)=>{var{handler:r,reactEvent:n}=e.payload;if(r!=null){n.persist();var a=n.type,i=eb.get(a);i!==void 0&&cancelAnimationFrame(i);var l=requestAnimationFrame(()=>{try{var c=t.getState(),f={activeCoordinate:dK(c),activeDataKey:M2(c),activeIndex:xc(c),activeLabel:nR(c),activeTooltipIndex:xc(c),isTooltipActive:hK(c)};r(f,n)}finally{eb.delete(a)}});eb.set(a,l)}}});var kte=Te([cf],e=>e.tooltipItemPayloads),Tte=Te([kte,(e,t)=>t,(e,t,r)=>r],(e,t,r)=>{if(t!=null){var n=e.find(i=>i.settings.graphicalItemId===r);if(n!=null){var{getPosition:a}=n;if(a!=null)return a(t)}}}),s5=zi("touchMove"),l5=y0();l5.startListening({actionCreator:s5,effect:(e,t)=>{var r=e.payload;if(!(r.touches==null||r.touches.length===0)){var n=t.getState(),a=j2(n,n.tooltip.settings.shared);if(a==="axis"){var i=r.touches[0];if(i==null)return;var l=Y2(n,Q2({clientX:i.clientX,clientY:i.clientY,currentTarget:r.currentTarget}));(l==null?void 0:l.activeIndex)!=null&&t.dispatch(WM({activeIndex:l.activeIndex,activeDataKey:void 0,activeCoordinate:l.activeCoordinate}))}else if(a==="item"){var c,f=r.touches[0];if(document.elementFromPoint==null||f==null)return;var d=document.elementFromPoint(f.clientX,f.clientY);if(!d||!d.getAttribute)return;var m=d.getAttribute(FI),p=(c=d.getAttribute(LI))!==null&&c!==void 0?c:void 0,v=uf(n).find(b=>b.id===p);if(m==null||v==null||p==null)return;var{dataKey:x}=v,y=Tte(n,m,p);t.dispatch(HM({activeDataKey:x,activeIndex:m,activeCoordinate:y,activeGraphicalItemId:p}))}}}});var Ate=iI({brush:DJ,cartesianAxis:bJ,chartData:fX,errorBars:kZ,graphicalItems:MQ,layout:B9,legend:V$,options:sX,polarAxis:KY,polarOptions:Nte,referenceElements:RJ,rootProps:bte,tooltip:TG,zIndex:KK}),jte=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return u9({reducer:Ate,preloadedState:t,middleware:n=>{var a;return n({serializableCheck:!1,immutableCheck:!["commonjs","es6","production"].includes((a="es6")!==null&&a!==void 0?a:"")}).concat([ZR.middleware,e5.middleware,J2.middleware,i5.middleware,l5.middleware])},enhancers:n=>{var a=n;return typeof n=="function"&&(a=n()),a.concat(bI({type:"raf"}))},devTools:{serialize:{replacer:yte},name:"recharts-".concat(r)}})};function o5(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Ja(),i=N.useRef(null);if(a)return r;i.current==null&&(i.current=jte(t,n));var l=m_;return N.createElement(XZ,{context:l,store:i.current},r)}function Ote(e){var{layout:t,margin:r}=e,n=Ur(),a=Ja();return N.useEffect(()=>{a||(n(R9(t)),n(M9(r)))},[n,a,t,r]),null}var c5=N.memo(Ote,X2);function u5(e){var t=Ur();return N.useEffect(()=>{t(wte(e))},[t,e]),null}function T4(e){var{zIndex:t,isPanorama:r}=e,n=N.useRef(null),a=Ur();return N.useLayoutEffect(()=>(n.current&&a(VK({zIndex:t,element:n.current,isPanorama:r})),()=>{a(GK({zIndex:t,isPanorama:r}))}),[a,t,r]),N.createElement("g",{tabIndex:-1,ref:n})}function A4(e){var{children:t,isPanorama:r}=e,n=xt(RK);if(!n||n.length===0)return t;var a=n.filter(l=>l<0),i=n.filter(l=>l>0);return N.createElement(N.Fragment,null,a.map(l=>N.createElement(T4,{key:l,zIndex:l,isPanorama:r})),t,i.map(l=>N.createElement(T4,{key:l,zIndex:l,isPanorama:r})))}var Cte=["children"];function Dte(e,t){if(e==null)return{};var r,n,a=Ite(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Ite(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Lp(){return Lp=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lp.apply(null,arguments)}var Pte={width:"100%",height:"100%",display:"block"},Mte=N.forwardRef((e,t)=>{var r=E_(),n=N_(),a=tP();if(!js(r)||!js(n))return null;var{children:i,otherAttributes:l,title:c,desc:f}=e,d,m;return l!=null&&(typeof l.tabIndex=="number"?d=l.tabIndex:d=a?0:void 0,typeof l.role=="string"?m=l.role:m=a?"application":void 0),N.createElement(n_,Lp({},l,{title:c,desc:f,role:m,tabIndex:d,width:r,height:n,style:Pte,ref:t}),i)}),Rte=e=>{var{children:t}=e,r=xt(yg);if(!r)return null;var{width:n,height:a,y:i,x:l}=r;return N.createElement(n_,{width:n,height:a,x:l,y:i},t)},j4=N.forwardRef((e,t)=>{var{children:r}=e,n=Dte(e,Cte),a=Ja();return a?N.createElement(Rte,null,N.createElement(A4,{isPanorama:!0},r)):N.createElement(Mte,Lp({ref:t},n),N.createElement(A4,{isPanorama:!1},r))});function Fte(){var e=Ur(),[t,r]=N.useState(null),n=xt(r$);return N.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;rr(i)&&i!==n&&e(L9(i))}},[t,e,n]),r}function O4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lte(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?O4(Object(r),!0).forEach(function(n){Bte(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Bte(e,t,r){return(t=Ute(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ute(e){var t=$te(e,"string");return typeof t=="symbol"?t:t+""}function $te(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function so(){return so=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},so.apply(null,arguments)}var zte=()=>(bX(),null);function Bp(e){if(typeof e=="number")return e;if(typeof e=="string"){var t=parseFloat(e);if(!Number.isNaN(t))return t}return 0}var Hte=N.forwardRef((e,t)=>{var r,n,a=N.useRef(null),[i,l]=N.useState({containerWidth:Bp((r=e.style)===null||r===void 0?void 0:r.width),containerHeight:Bp((n=e.style)===null||n===void 0?void 0:n.height)}),c=N.useCallback((d,m)=>{l(p=>{var v=Math.round(d),x=Math.round(m);return p.containerWidth===v&&p.containerHeight===x?p:{containerWidth:v,containerHeight:x}})},[]),f=N.useCallback(d=>{if(typeof t=="function"&&t(d),d!=null&&typeof ResizeObserver<"u"){var{width:m,height:p}=d.getBoundingClientRect();c(m,p);var v=y=>{var b=y[0];if(b!=null){var{width:_,height:E}=b.contentRect;c(_,E)}},x=new ResizeObserver(v);x.observe(d),a.current=x}},[t,c]);return N.useEffect(()=>()=>{var d=a.current;d!=null&&d.disconnect()},[c]),N.createElement(N.Fragment,null,N.createElement(w0,{width:i.containerWidth,height:i.containerHeight}),N.createElement("div",so({ref:f},e)))}),qte=N.forwardRef((e,t)=>{var{width:r,height:n}=e,[a,i]=N.useState({containerWidth:Bp(r),containerHeight:Bp(n)}),l=N.useCallback((f,d)=>{i(m=>{var p=Math.round(f),v=Math.round(d);return m.containerWidth===p&&m.containerHeight===v?m:{containerWidth:p,containerHeight:v}})},[]),c=N.useCallback(f=>{if(typeof t=="function"&&t(f),f!=null){var{width:d,height:m}=f.getBoundingClientRect();l(d,m)}},[t,l]);return N.createElement(N.Fragment,null,N.createElement(w0,{width:a.containerWidth,height:a.containerHeight}),N.createElement("div",so({ref:c},e)))}),Wte=N.forwardRef((e,t)=>{var{width:r,height:n}=e;return N.createElement(N.Fragment,null,N.createElement(w0,{width:r,height:n}),N.createElement("div",so({ref:t},e)))}),Vte=N.forwardRef((e,t)=>{var{width:r,height:n}=e;return typeof r=="string"||typeof n=="string"?N.createElement(qte,so({},e,{ref:t})):typeof r=="number"&&typeof n=="number"?N.createElement(Wte,so({},e,{width:r,height:n,ref:t})):N.createElement(N.Fragment,null,N.createElement(w0,{width:r,height:n}),N.createElement("div",so({ref:t},e)))});function Gte(e){return e?Hte:Vte}var Kte=N.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:l,onDoubleClick:c,onMouseDown:f,onMouseEnter:d,onMouseLeave:m,onMouseMove:p,onMouseUp:v,onTouchEnd:x,onTouchMove:y,onTouchStart:b,style:_,width:E,responsive:A,dispatchTouchEvents:T=!0}=e,k=N.useRef(null),I=Ur(),[O,j]=N.useState(null),[B,U]=N.useState(null),Y=Fte(),te=__(),V=(te==null?void 0:te.width)>0?te.width:E,ge=(te==null?void 0:te.height)>0?te.height:a,be=N.useCallback(oe=>{Y(oe),typeof t=="function"&&t(oe),j(oe),U(oe),oe!=null&&(k.current=oe)},[Y,t,j,U]),ve=N.useCallback(oe=>{I(JR(oe)),I(Di({handler:i,reactEvent:oe}))},[I,i]),z=N.useCallback(oe=>{I(Aw(oe)),I(Di({handler:d,reactEvent:oe}))},[I,d]),ue=N.useCallback(oe=>{I(qM()),I(Di({handler:m,reactEvent:oe}))},[I,m]),se=N.useCallback(oe=>{I(Aw(oe)),I(Di({handler:p,reactEvent:oe}))},[I,p]),Q=N.useCallback(()=>{I(a5())},[I]),re=N.useCallback(oe=>{I(n5(oe.key))},[I]),G=N.useCallback(oe=>{I(Di({handler:l,reactEvent:oe}))},[I,l]),P=N.useCallback(oe=>{I(Di({handler:c,reactEvent:oe}))},[I,c]),W=N.useCallback(oe=>{I(Di({handler:f,reactEvent:oe}))},[I,f]),F=N.useCallback(oe=>{I(Di({handler:v,reactEvent:oe}))},[I,v]),M=N.useCallback(oe=>{I(Di({handler:b,reactEvent:oe}))},[I,b]),le=N.useCallback(oe=>{T&&I(s5(oe)),I(Di({handler:y,reactEvent:oe}))},[I,T,y]),pe=N.useCallback(oe=>{I(Di({handler:x,reactEvent:oe}))},[I,x]),Ae=Gte(A);return N.createElement(uR.Provider,{value:O},N.createElement(SD.Provider,{value:B},N.createElement(Ae,{width:V??(_==null?void 0:_.width),height:ge??(_==null?void 0:_.height),className:kr("recharts-wrapper",n),style:Lte({position:"relative",cursor:"default",width:V,height:ge},_),onClick:ve,onContextMenu:G,onDoubleClick:P,onFocus:Q,onKeyDown:re,onMouseDown:W,onMouseEnter:z,onMouseLeave:ue,onMouseMove:se,onMouseUp:F,onTouchEnd:pe,onTouchMove:le,onTouchStart:M,ref:be},N.createElement(zte,null),r)))}),Xte=["width","height","responsive","children","className","style","compact","title","desc"];function Yte(e,t){if(e==null)return{};var r,n,a=Qte(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Qte(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var f5=N.forwardRef((e,t)=>{var{width:r,height:n,responsive:a,children:i,className:l,style:c,compact:f,title:d,desc:m}=e,p=Yte(e,Xte),v=cs(p);return f?N.createElement(N.Fragment,null,N.createElement(w0,{width:r,height:n}),N.createElement(j4,{otherAttributes:v,title:d,desc:m},i)):N.createElement(Kte,{className:l,style:c,width:r,height:n,responsive:a??!1,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},N.createElement(j4,{otherAttributes:v,title:d,desc:m,ref:t},N.createElement(LJ,null,i)))});function jw(){return jw=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jw.apply(null,arguments)}var Jte={top:5,right:5,bottom:5,left:5},Zte={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,layout:"horizontal",margin:Jte,responsive:!1,reverseStackOrder:!1,stackOffset:"none",syncMethod:"index"},ere=N.forwardRef(function(t,r){var n,a=Zn(t.categoricalChartProps,Zte),{chartName:i,defaultTooltipEventType:l,validateTooltipEventTypes:c,tooltipPayloadSearcher:f,categoricalChartProps:d}=t,m={chartName:i,defaultTooltipEventType:l,validateTooltipEventTypes:c,tooltipPayloadSearcher:f,eventEmitter:void 0};return N.createElement(o5,{preloadedState:{options:m},reduxStoreName:(n=d.id)!==null&&n!==void 0?n:i},N.createElement(UR,{chartData:d.data}),N.createElement(c5,{layout:a.layout,margin:a.margin}),N.createElement(u5,{baseValue:a.baseValue,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),N.createElement(f5,jw({},a,{ref:r})))}),tre=["axis","item"],Xg=N.forwardRef((e,t)=>N.createElement(ere,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:tre,tooltipPayloadSearcher:fR,categoricalChartProps:e,ref:t}));function rre(e){var t=Ur();return N.useEffect(()=>{t(Ete(e))},[t,e]),null}var nre=["layout"];function Ow(){return Ow=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ow.apply(null,arguments)}function are(e,t){if(e==null)return{};var r,n,a=ire(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function ire(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var sre={top:5,right:5,bottom:5,left:5},d5={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:sre,reverseStackOrder:!1,syncMethod:"index",layout:"radial",responsive:!1,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},lre=N.forwardRef(function(t,r){var n,a=Zn(t.categoricalChartProps,d5),{layout:i}=a,l=are(a,nre),{chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:d,tooltipPayloadSearcher:m}=t,p={chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:d,tooltipPayloadSearcher:m,eventEmitter:void 0};return N.createElement(o5,{preloadedState:{options:p},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:c},N.createElement(UR,{chartData:a.data}),N.createElement(c5,{layout:i,margin:a.margin}),N.createElement(u5,{baseValue:void 0,accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className,reverseStackOrder:a.reverseStackOrder}),N.createElement(rre,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),N.createElement(f5,Ow({},l,{ref:r})))});function C4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function D4(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C4(Object(r),!0).forEach(function(n){ore(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C4(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ore(e,t,r){return(t=cre(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function cre(e){var t=ure(e,"string");return typeof t=="symbol"?t:t+""}function ure(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var fre=["item"],dre=D4(D4({},d5),{},{layout:"centric",startAngle:0,endAngle:360}),Cw=N.forwardRef((e,t)=>{var r=Zn(e,dre);return N.createElement(lre,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:fre,tooltipPayloadSearcher:fR,categoricalChartProps:r,ref:t})});const Sr=({label:e,options:t,value:r,onChange:n,placeholder:a,required:i,disabled:l,inputRef:c,onKeyDown:f,compact:d})=>{const[m,p]=N.useState(!1),[v,x]=N.useState(""),y=N.useRef(null);N.useEffect(()=>{if(r){const k=t.find(I=>I.id===r);k&&x(k.label||"")}else m||x("")},[r,t,m]),N.useEffect(()=>{function k(I){if(y.current&&!y.current.contains(I.target)){p(!1);const O=t.find(j=>j.id===r);x(O&&O.label||"")}}return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[r,t]);const b=N.useMemo(()=>{if(!m&&!v)return[];const k=(v||"").toLowerCase();let I=0;const O=50,j=[];for(const B of t){if(!B)continue;const U=(B.label||"").toLowerCase(),Y=(B.subLabel||"").toLowerCase();if((U.includes(k)||Y&&Y.includes(k))&&(j.push(B),I++,I>=O))break}return j},[t,v,m]),_=k=>{n(k.id),x(k.label||""),p(!1)},E=k=>{if(k.key==="Enter"&&m){const I=b.find(O=>(O.label||"").toLowerCase()===(v||"").toLowerCase());I?_(I):(b.length===1||b.length>0)&&_(b[0])}f&&f(k)},A=d?"block text-xs font-bold text-gray-600 mb-1":"block text-sm font-medium text-gray-700 mb-1",T=d?"px-2 h-9 text-sm":"px-4 py-2";return u.jsxs("div",{className:"relative",ref:y,children:[u.jsxs("label",{className:A,children:[e," ",i&&u.jsx("span",{className:"text-red-500",children:"*"})]}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{ref:c,type:"text",disabled:l,className:`w-full ${T} border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition ${l?"bg-gray-100 cursor-not-allowed":"bg-white"}`,placeholder:a,value:v,onChange:k=>{x(k.target.value),p(!0),r&&n("")},onFocus:()=>!l&&p(!0),onKeyDown:E,autoComplete:"off"}),u.jsx("div",{className:"absolute inset-y-0 right-0 flex items-center pr-3 pointer-events-none text-gray-400",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]}),m&&!l&&u.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-xl max-h-60 overflow-y-auto",children:b.length>0?u.jsxs("ul",{className:"py-1",children:[b.map(k=>u.jsxs("li",{onClick:()=>_(k),className:"px-4 py-2 hover:bg-blue-50 cursor-pointer text-gray-700 flex flex-col border-b border-gray-50 last:border-0",children:[u.jsx("span",{className:"font-medium",children:k.label||"-"}),k.subLabel&&u.jsx("span",{className:"text-xs text-gray-400",children:k.subLabel})]},k.id)),b.length===50&&u.jsx("li",{className:"px-4 py-2 text-xs text-gray-400 italic text-center bg-gray-50",children:"Results limited. Keep typing to search..."})]}):u.jsx("div",{className:"px-4 py-3 text-sm text-gray-500",children:"No results found"})})]})},hre=({items:e,locations:t})=>{const r=N.useMemo(()=>{const a=new Map;return t.forEach(i=>a.set(i.name,0)),a.set("Unassigned",0),e.forEach(i=>{const l=i.cost||0;if(i.quantitiesByLocation)Object.entries(i.quantitiesByLocation).forEach(([c,f])=>{const d=t.find(v=>v.id===c),m=d?d.name:"Unassigned",p=a.get(m)||0;a.set(m,p+Number(f)*l)});else{const c=a.get("Unassigned")||0;a.set("Unassigned",c+(i.stockQuantity||0)*l)}}),Array.from(a.entries()).map(([i,l])=>({name:i,value:l})).filter(i=>i.value>0).sort((i,l)=>l.value-i.value)},[e,t]),n=["#0ea5e9","#22c55e","#eab308","#f97316","#ef4444","#8b5cf6","#ec4899"];return u.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Stock Value by Location"}),u.jsx("div",{className:"h-80 w-full",children:u.jsx(nc,{width:"100%",height:"100%",children:u.jsxs(Xg,{data:r,margin:{top:20,right:30,left:20,bottom:5},children:[u.jsx(P0,{strokeDasharray:"3 3",vertical:!1,stroke:"#e5e7eb"}),u.jsx(F0,{dataKey:"name",axisLine:!1,tickLine:!1,tick:{fill:"#6b7280"}}),u.jsx(L0,{axisLine:!1,tickLine:!1,tick:{fill:"#6b7280"},tickFormatter:a=>`$${a.toLocaleString()}`}),u.jsx(sc,{cursor:{fill:"#f3f4f6"},formatter:a=>[`$${a.toLocaleString()}`,"Total Value"],contentStyle:{borderRadius:"0.5rem",border:"none",boxShadow:"0 4px 6px -1px rgb(0 0 0 / 0.1)"}}),u.jsx(R0,{dataKey:"value",radius:[4,4,0,0],children:r.map((a,i)=>u.jsx(oi,{fill:n[i%n.length]},`cell-${i}`))})]})})})]})};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h5=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mre=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pre=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=e=>{const t=pre(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var gre={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vre=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xre=N.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:a="",children:i,iconNode:l,...c},f)=>N.createElement("svg",{ref:f,...gre,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:h5("lucide",a),...!i&&!vre(c)&&{"aria-hidden":"true"},...c},[...l.map(([d,m])=>N.createElement(d,m)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yo=(e,t)=>{const r=N.forwardRef(({className:n,...a},i)=>N.createElement(xre,{ref:i,iconNode:t,className:h5(`lucide-${mre(I4(e))}`,`lucide-${e}`,n),...a}));return r.displayName=I4(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yre=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],bre=yo("activity",yre);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wre=[["path",{d:"M5 21v-6",key:"1hz6c0"}],["path",{d:"M12 21V3",key:"1lcnhd"}],["path",{d:"M19 21V9",key:"unv183"}]],m5=yo("chart-no-axes-column",wre);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _re=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Sre=yo("circle-alert",_re);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ere=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Nre=yo("clock",Ere);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kre=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Tre=yo("file-text",kre);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Are=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],jre=yo("plus",Are);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ore=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Cre=yo("trash",Ore);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dre=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Ire=yo("upload",Dre),Pre=({breakdowns:e})=>{const t=N.useMemo(()=>{const n=e.filter(d=>d.status==="Closed"||d.status==="Resolved"&&d.endTime),a=e.length;if(a===0)return{mttr:0,mtbf:0,oee:100};let i=0;n.forEach(d=>{if(d.durationMinutes)i+=Number(d.durationMinutes);else if(d.startTime&&d.endTime){const m=new Date(d.startTime).getTime(),p=new Date(d.endTime).getTime();i+=(p-m)/6e4}});const l=n.length>0?i/60/n.length:0;let c=0,f=0;if(e.length>0){const d=[...e].sort((b,_)=>new Date(b.startTime).getTime()-new Date(_.startTime).getTime()),m=new Date(d[0].startTime).getTime(),v=(new Date().getTime()-m)/(1e3*60),y=Math.max(0,v-i);c=y/60/a,f=v>0?y/v*100:100}return{mttr:l,mtbf:c,oee:f}},[e]),r=[{title:"MTTR",value:`${t.mttr.toFixed(1)}h`,label:"Mean Time To Repair",icon:Nre,color:"text-blue-600",bg:"bg-blue-50"},{title:"MTBF",value:`${t.mtbf.toFixed(1)}h`,label:"Mean Time Between Failures",icon:bre,color:"text-green-600",bg:"bg-green-50"},{title:"OEE (Availability)",value:`${t.oee.toFixed(1)}%`,label:"Overall Equipment Effectiveness",icon:m5,color:"text-purple-600",bg:"bg-purple-50"},{title:"Total Failures",value:e.length.toString(),label:"Recorded Breakdowns",icon:Sre,color:"text-red-600",bg:"bg-red-50"}];return u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:r.map((n,a)=>u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 flex items-start justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 mb-1",children:n.title}),u.jsx("h3",{className:"text-2xl font-bold text-gray-900",children:n.value}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:n.label})]}),u.jsx("div",{className:`p-3 rounded-md ${n.bg}`,children:u.jsx(n.icon,{className:`h-6 w-6 ${n.color}`})})]},a))})},P4=["#0088FE","#00C49F","#FFBB28","#FF8042","#8884d8"],tb={Working:"#10B981","Not Working":"#EF4444","Outside Maintenance":"#F59E0B"},M4=[{id:"maintenance-planning",label:"Maintenance Planning",icon:"",color:"bg-emerald-50 text-emerald-700 border-emerald-200 hover:bg-emerald-100",roles:["admin","maintenance_manager","maintenance_engineer"]},{id:"issue-planning",label:"Issue Planning",icon:"",color:"bg-teal-50 text-teal-700 border-teal-200 hover:bg-teal-100",roles:["admin","maintenance_manager","warehouse_manager"]},{id:"asset-management",label:"Asset Management",icon:"",color:"bg-orange-50 text-orange-700 border-orange-200 hover:bg-orange-100",roles:["admin","maintenance_manager","maintenance_engineer"]},{id:"mro-management",label:"MRO Management",icon:"",color:"bg-cyan-50 text-cyan-700 border-cyan-200 hover:bg-cyan-100",roles:["admin","warehouse_manager","maintenance_manager","maintenance_engineer","warehouse_supervisor"]},{id:"material-forecast",label:"Forecast Planning",icon:"",color:"bg-pink-50 text-pink-700 border-pink-200 hover:bg-pink-100",roles:["admin","warehouse_manager","maintenance_manager","maintenance_engineer"]},{id:"agri-work-order",label:"Work Orders",icon:"",color:"bg-green-50 text-green-700 border-green-200 hover:bg-green-100",roles:["admin","warehouse_manager","maintenance_manager","user"]},{id:"issue-form",label:"Issue Requests",icon:"",color:"bg-blue-50 text-blue-700 border-blue-200 hover:bg-blue-100",roles:["admin","user","maintenance_manager","maintenance_engineer"]},{id:"history",label:"Inventory",icon:"",color:"bg-purple-50 text-purple-700 border-purple-200 hover:bg-purple-100",roles:["admin","user","warehouse_manager","maintenance_manager","maintenance_engineer","warehouse_supervisor"]},{id:"stock-approval",label:"Approvals",icon:"",color:"bg-yellow-50 text-yellow-700 border-yellow-200 hover:bg-yellow-100",roles:["admin","warehouse_manager","warehouse_supervisor"]},{id:"ai-assistant",label:"Maintenance AI",icon:"",color:"bg-indigo-50 text-indigo-700 border-indigo-200 hover:bg-indigo-100",roles:["admin","warehouse_manager","maintenance_manager"]},{id:"master-data",label:"Master Data",icon:"",color:"bg-gray-50 text-gray-700 border-gray-200 hover:bg-gray-100",roles:["admin"]},{id:"settings",label:"Settings",icon:"",color:"bg-slate-50 text-slate-700 border-slate-200 hover:bg-slate-100",roles:["admin","warehouse_manager","maintenance_manager","warehouse_supervisor","user"]}],wm=({history:e,items:t,machines:r,locations:n,breakdowns:a,setCurrentView:i,currentUser:l})=>{const[c,f]=N.useState("Generating AI insights..."),[d,m]=N.useState(!1),[p,v]=N.useState(""),[x,y]=N.useState(""),[b,_]=N.useState("");N.useEffect(()=>{e.length>0&&(m(!0),EB(e).then(f).finally(()=>m(!1)))},[e.length]),N.useEffect(()=>{y(""),_("")},[p]),N.useEffect(()=>{_("")},[x]);const E=N.useMemo(()=>{var ve,z;const B=e.length,U={},Y={};let te=0;const V=new Date;e.forEach(ue=>{U[ue.itemName]=(U[ue.itemName]||0)+ue.quantity,Y[ue.machineName]=(Y[ue.machineName]||0)+1;const se=new Date(ue.timestamp);V.getTime()-se.getTime()<1440*60*1e3&&te++});const ge=t.filter(ue=>(ue.stockQuantity||0)>0).sort((ue,se)=>(se.stockQuantity||0)-(ue.stockQuantity||0)),be=Object.entries(Y).sort((ue,se)=>se[1]-ue[1]);return{totalIssues:B,topItem:((ve=ge[0])==null?void 0:ve.name)||"N/A",topMachine:((z=be[0])==null?void 0:z[0])||"N/A",todayCount:te,itemData:ge.slice(0,5).map(ue=>({name:ue.name,value:ue.stockQuantity||0})),machineData:be.slice(0,5).map(([ue,se])=>({name:ue,value:se}))}},[e,t]),A=N.useMemo(()=>p?r.filter(B=>{var Y;const U=(Y=n.find(te=>te.id===p))==null?void 0:Y.name;return B.locationId===p||B.locationId===U}):r,[r,p,n]),T=N.useMemo(()=>{const B=new Set(A.map(U=>U.category).filter(Boolean));return Array.from(B).sort().map(U=>({id:U,label:U}))},[A]),k=N.useMemo(()=>{const B=x?A.filter(Y=>Y.category===x):A,U=new Set(B.map(Y=>Y.brand).filter(Boolean));return Array.from(U).sort().map(Y=>({id:Y,label:Y}))},[A,x]),I=N.useMemo(()=>{let B=A;x&&(B=B.filter(ve=>ve.category===x)),b&&(B=B.filter(ve=>ve.brand===b));const U=ve=>{if(!ve)return"Unknown";const z=ve.toLowerCase();return z.includes("not working")?"Not Working":z.includes("working")?"Working":z.includes("maintenance")?"Outside Maintenance":"Unknown"};let Y=0,te=0,V=0;B.forEach(ve=>{const z=U(ve.status);z==="Working"?Y++:z==="Not Working"?te++:z==="Outside Maintenance"&&V++});const ge=B.length,be=[{name:"Working",value:Y,color:tb.Working},{name:"Not Working",value:te,color:tb["Not Working"]},{name:"Maintenance",value:V,color:tb["Outside Maintenance"]}].filter(ve=>ve.value>0);return{total:ge,working:Y,notWorking:te,maintenance:V,chartData:be}},[A,x,b]),j=N.useMemo(()=>(l==null?void 0:l.role)==="admin"?M4.filter(B=>B.roles.includes("admin")):!(l!=null&&l.allowedMenus)||l.allowedMenus.length===0?[]:M4.filter(B=>{var U;return(U=l.allowedMenus)==null?void 0:U.includes(B.id)}),[l]);return j.length===0?u.jsxs("div",{className:"flex flex-col items-center justify-center h-full min-h-[50vh] text-center space-y-4 animate-fade-in-up",children:[u.jsx("div",{className:"w-24 h-24 bg-blue-50 rounded-full flex items-center justify-center mb-4",children:u.jsx("span",{className:"text-4xl",children:""})}),u.jsxs("h2",{className:"text-3xl font-bold text-gray-800",children:["Hello, ",l.name,"!"]}),u.jsx("p",{className:"text-gray-500 max-w-md",children:"Welcome to Daltex Maintenance. Your account is active, but you currently have no access to any modules."}),u.jsx("p",{className:"text-sm text-gray-400 bg-gray-50 px-4 py-2 rounded-lg border border-gray-200",children:"Please contact your System Administrator to enable access."})]}):u.jsxs("div",{className:"space-y-8 animate-fade-in-up",children:[u.jsxs("section",{children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[u.jsx("span",{className:"mr-2",children:""})," Quick Access"]}),u.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4",children:j.map(B=>u.jsxs("button",{onClick:()=>i(B.id),className:`
                          flex flex-col items-center justify-center p-4 rounded-xl border transition-all duration-200 transform hover:-translate-y-1 hover:shadow-md
                          ${B.color}
                      `,children:[u.jsx("span",{className:"text-3xl mb-2",children:B.icon}),u.jsx("span",{className:"text-xs font-bold uppercase tracking-wide text-center",children:B.label})]},B.id))})]}),u.jsxs("section",{children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center",children:[u.jsx("span",{className:"mr-2",children:""})," Operational KPIs"]}),u.jsx(Pre,{breakdowns:a}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col justify-between hover:shadow-md transition",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500 font-medium uppercase tracking-wider",children:"Total Issues"}),u.jsx("h3",{className:"text-3xl font-bold text-gray-800 mt-2",children:E.totalIssues})]}),u.jsx("div",{className:"mt-4 text-xs text-gray-400",children:"Lifetime records"})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col justify-between hover:shadow-md transition",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500 font-medium uppercase tracking-wider",children:"Issued Today"}),u.jsx("h3",{className:"text-3xl font-bold text-blue-600 mt-2",children:E.todayCount})]}),u.jsx("div",{className:"mt-4 text-xs text-gray-400",children:"Last 24 hours"})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col justify-between hover:shadow-md transition",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500 font-medium uppercase tracking-wider",children:"Top Item"}),u.jsx("h3",{className:"text-lg font-bold text-gray-800 mt-2 truncate",title:E.topItem,children:E.topItem})]}),u.jsx("div",{className:"mt-4 text-xs text-gray-400",children:"Highest Quantity"})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 flex flex-col justify-between hover:shadow-md transition",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-500 font-medium uppercase tracking-wider",children:"Top Machine"}),u.jsx("h3",{className:"text-lg font-bold text-gray-800 mt-2 truncate",title:E.topMachine,children:E.topMachine})]}),u.jsx("div",{className:"mt-4 text-xs text-gray-400",children:"Most Frequent"})]})]})]}),u.jsx("section",{children:u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsx("div",{children:u.jsx(hre,{items:t,locations:n})}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[u.jsx("h3",{className:"text-sm font-bold text-gray-700 uppercase",children:"Machines Filter"}),u.jsxs("div",{className:"w-full md:w-auto flex flex-col md:flex-row gap-2",children:[u.jsx("div",{className:"w-full md:w-32",children:u.jsxs("select",{className:"w-full h-9 pl-2 pr-6 rounded border border-gray-300 focus:ring-1 focus:ring-blue-500 text-xs bg-white",value:p,onChange:B=>v(B.target.value),children:[u.jsx("option",{value:"",children:"Loc: All"}),n.map(B=>u.jsx("option",{value:B.id,children:B.name},B.id))]})}),u.jsx("div",{className:"w-full md:w-32",children:u.jsx(Sr,{label:"",options:T,value:x,onChange:y,placeholder:"Machine: All",compact:!0,disabled:T.length===0})}),u.jsx("div",{className:"w-full md:w-32",children:u.jsx(Sr,{label:"",options:k,value:b,onChange:_,placeholder:"Brand: All",compact:!0,disabled:k.length===0})})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col lg:flex-row",children:[u.jsxs("div",{className:"p-4 flex flex-col gap-4 justify-center lg:w-1/3 bg-gray-50 border-r border-gray-100",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm text-gray-500",children:"Total"})," ",u.jsx("span",{className:"font-bold",children:I.total})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm text-green-600",children:"Working"})," ",u.jsx("span",{className:"font-bold text-green-700",children:I.working})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm text-red-600",children:"Stopped"})," ",u.jsx("span",{className:"font-bold text-red-700",children:I.notWorking})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm text-amber-600",children:"Maint."})," ",u.jsx("span",{className:"font-bold text-amber-700",children:I.maintenance})]})]}),u.jsx("div",{className:"p-4 flex-1 h-[250px]",children:I.total>0&&I.chartData.length>0?u.jsx(nc,{width:"100%",height:"100%",children:u.jsxs(Cw,{children:[u.jsx(Pp,{data:I.chartData,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,paddingAngle:5,dataKey:"value",label:({name:B,percent:U})=>`${(U*100).toFixed(0)}%`,children:I.chartData.map((B,U)=>u.jsx(oi,{fill:B.color},`cell-${U}`))}),u.jsx(sc,{})]})}):u.jsx("div",{className:"flex items-center justify-center h-full text-gray-400 text-xs text-center p-4",children:"No Data for selected filters"})})]})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 min-h-[400px]",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Top 5 Items (Quantity)"}),u.jsx(nc,{width:"100%",height:300,children:u.jsxs(Xg,{data:E.itemData,children:[u.jsx(P0,{strokeDasharray:"3 3",vertical:!1,stroke:"#f0f0f0"}),u.jsx(F0,{dataKey:"name",tick:{fontSize:11,fill:"#6B7280"},interval:0,angle:-15,textAnchor:"end",height:60}),u.jsx(L0,{tick:{fontSize:11,fill:"#6B7280"}}),u.jsx(sc,{cursor:{fill:"#F3F4F6"},contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),u.jsx(R0,{dataKey:"value",fill:"#3B82F6",radius:[4,4,0,0],barSize:40})]})})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 min-h-[400px]",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-6",children:"Issues by Machine"}),u.jsx(nc,{width:"100%",height:300,children:u.jsxs(Cw,{children:[u.jsx(Pp,{data:E.machineData,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:5,dataKey:"value",label:({percent:B})=>`${(B*100).toFixed(0)}%`,children:E.machineData.map((B,U)=>u.jsx(oi,{fill:P4[U%P4.length]},`cell-${U}`))}),u.jsx(sc,{contentStyle:{borderRadius:"8px",border:"none",boxShadow:"0 4px 6px -1px rgba(0, 0, 0, 0.1)"}}),u.jsx(A_,{verticalAlign:"bottom",height:36,iconType:"circle"})]})})]}),u.jsxs("div",{className:"lg:col-span-2 bg-gradient-to-r from-indigo-50 to-blue-50 p-6 rounded-xl border border-indigo-100",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[u.jsx("span",{className:"text-2xl",children:""}),u.jsx("h3",{className:"text-lg font-bold text-indigo-900",children:"AI Operational Insights"})]}),d?u.jsxs("div",{className:"flex items-center space-x-3 text-indigo-500 animate-pulse",children:[u.jsx("div",{className:"w-5 h-5 border-2 border-current border-t-transparent rounded-full animate-spin"}),u.jsx("span",{children:"Analyzing warehouse patterns with Gemini..."})]}):u.jsx("div",{className:"prose prose-indigo max-w-none",children:u.jsx("div",{className:"whitespace-pre-line text-indigo-800 leading-relaxed font-medium",children:c})})]})]})]})},Mre=({batch:e})=>{if(!e||e.length===0)return null;const t=e[0],r=e.some(n=>n.machineId!==t.machineId);return u.jsxs("div",{className:"hidden print:block fixed inset-0 bg-white z-[100] p-10 h-screen w-screen overflow-auto",children:[u.jsxs("div",{className:"flex justify-between items-center border-b-2 border-black pb-4 mb-8",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold uppercase tracking-widest",children:"Material Request Slip"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Daltex Maintenance System"})]}),u.jsx("div",{className:"w-16 h-16 border border-gray-300 flex items-center justify-center text-xs text-gray-400 font-bold bg-gray-50",children:"LOGO"})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-8 mb-8 text-sm md:text-base",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Request ID:"})," ",t.id.split("-").slice(0,2).join("-")]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Date:"})," ",new Date(t.timestamp).toLocaleString()]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Location:"})," ",t.locationId]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Sector:"})," ",t.sectorName||"-"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Division:"})," ",t.divisionName||"-"]})]}),u.jsxs("div",{className:"space-y-1",children:[!r&&u.jsxs(u.Fragment,{children:[u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Machine:"})," ",t.machineName]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Asset ID:"})," ",t.machineId]})]}),r&&u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Mode:"})," Multi-Machine Request"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Maint. Plan:"})," ",t.maintenancePlan||"None"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Requester:"})," ",t.requesterEmail||"Unknown"]}),u.jsxs("p",{children:[u.jsx("span",{className:"font-bold w-24 inline-block",children:"Status:"})," ",t.status]})]})]}),u.jsxs("table",{className:"w-full text-left border-collapse border border-black mb-12 text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"bg-gray-100",children:[u.jsx("th",{className:"border border-black p-2",children:"Item Code"}),u.jsx("th",{className:"border border-black p-2",children:"Description"}),u.jsx("th",{className:"border border-black p-2 text-center",children:"Unit"}),r&&u.jsx("th",{className:"border border-black p-2",children:"Machine"}),u.jsx("th",{className:"border border-black p-2 text-right",children:"Qty"}),u.jsx("th",{className:"border border-black p-2 text-right",children:"Cost (Est)"})]})}),u.jsx("tbody",{children:e.map(n=>u.jsxs("tr",{children:[u.jsx("td",{className:"border border-black p-2 font-mono",children:n.itemId}),u.jsx("td",{className:"border border-black p-2",children:n.itemName}),u.jsx("td",{className:"border border-black p-2 text-center",children:n.unit||"pcs"}),r&&u.jsx("td",{className:"border border-black p-2",children:n.machineName}),u.jsx("td",{className:"border border-black p-2 text-right font-bold",children:n.quantity}),u.jsx("td",{className:"border border-black p-2 text-right",children:n.calculatedTotalCost?`$${n.calculatedTotalCost.toLocaleString()}`:"-"})]},n.id))}),u.jsx("tfoot",{children:u.jsxs("tr",{children:[u.jsx("td",{colSpan:r?4:3,className:"border border-black p-2 text-right font-bold",children:"Total Items:"}),u.jsx("td",{className:"border border-black p-2 text-right font-bold",children:e.reduce((n,a)=>n+a.quantity,0)}),u.jsxs("td",{className:"border border-black p-2 text-right font-bold",children:["$",e.reduce((n,a)=>n+(a.calculatedTotalCost||0),0).toLocaleString()]})]})})]}),u.jsxs("div",{className:"grid grid-cols-3 gap-8 mt-16 pt-8 break-inside-avoid",children:[u.jsx("div",{className:"border-t border-black pt-2 text-center text-sm font-semibold",children:"Requester Signature"}),u.jsx("div",{className:"border-t border-black pt-2 text-center text-sm font-semibold",children:"Supervisor Approval"}),u.jsx("div",{className:"border-t border-black pt-2 text-center text-sm font-semibold",children:"Warehouse Issuer"})]}),u.jsxs("div",{className:"text-center text-xs mt-12 text-gray-400 print:fixed print:bottom-4 print:w-full",children:["Generated by Daltex Maintenance System | ",new Date().toISOString()]})]})},Wo="2PACX-1vSMVlbr82tagYILVNamzhxIriPF3LAXrMaAHlRlp1-0F98Pfbu6orN0fTh6HDAh2vZP6WUH6LN2spNv",Rre="229812258",oo="https://script.google.com/macros/s/AKfycbxz6P8ZHgg8cN9cJBEL425BcdrjvBUqm59R_IxAwnDrb0MQ8c9iqaU1toNUN6GsAg4vQw/exec",Hm=e=>{if(!e)return"";const t=e.trim(),r=t.match(/\/d\/e\/([a-zA-Z0-9-_]+)/);if(r)return r[1];const n=t.match(/\/d\/([a-zA-Z0-9-_]+)/);return n?n[1]:t},Fre=e=>{if(!e)return null;const t=e.match(/[?&]gid=([0-9]+)/);return t?t[1]:null},Dw=async(e,t)=>{let r="";const n=e.trim(),a=t?t.trim():"0";n.startsWith("2PACX")?(r=`https://docs.google.com/spreadsheets/d/e/${n}/pub?output=csv`,a&&a!=="0"&&(r+=`&gid=${a}&single=true`)):r=`https://docs.google.com/spreadsheets/d/${n}/gviz/tq?tqx=out:csv&gid=${a}`,r+=`&_t=${Date.now()}`;try{const i=await fetch(r);if(!i.ok)throw new Error(`Failed to fetch. Status: ${i.status}. Check if sheet is "Public" or "Published to Web".`);const l=await i.text();if(l.trim().toLowerCase().startsWith("<!doctype html")||l.includes("<html"))throw new Error('Received HTML instead of CSV. The sheet is likely private. Please set access to "Anyone with the link" or "Publish to Web".');return l.split(/\r?\n/).map(f=>Lre(f))}catch(i){throw i}},Lre=e=>{const t=[];let r="",n=!1;for(let a=0;a<e.length;a++){const i=e[a];i==='"'?n&&e[a+1]==='"'?(r+='"',a++):n=!n:i===","&&!n?(t.push(r.trim()),r=""):r+=i}return t.push(r.trim()),t},Bre=async(e,t)=>{try{await fetch(e,{method:"POST",mode:"no-cors",body:JSON.stringify({action:"log_issue",...t})}),console.log("Sent to Google Sheet")}catch(r){console.error("Failed to send to Google Sheet",r)}},R4=async(e,t,r)=>{try{return await(await fetch(e,{method:"POST",body:JSON.stringify({action:"backup_tab",tabName:t,rows:r})})).json()}catch(n){throw n}},Ure=async e=>{try{const t=await fetch(e,{method:"POST",body:JSON.stringify({action:"read_full_db"})}),r=t.headers.get("content-type");if(r&&r.includes("text/html"))throw new Error("Permission Blocked by Google. Please Redeploy Script and set 'Who has access' to 'Anyone'.");const n=await t.json();if(!n||typeof n!="object")throw new Error("Invalid response received from script.");if(n.status==="success"){if(!n.data)throw new Error("Script connected but returned no data. Your script code might be outdated. Please Copy Code -> Deploy -> New Version.");return n.data}else throw new Error(n.message||"Script connected but returned an error status.")}catch(t){throw console.error("Fetch Data Error:",t),t}},$re=async(e,t,r)=>{try{const a=await(await fetch(e,{method:"POST",body:JSON.stringify({action:"upload_file",fileName:t,mimeType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",fileData:r})})).json();if(a.status==="success")return a.url;throw new Error(a.message||"Upload failed")}catch(n){return console.error("Drive Upload Error:",n),""}},zre=async e=>{try{const t=await fetch(e,{method:"POST",body:JSON.stringify({action:"locate_data"})}),r=t.headers.get("content-type");if(r&&r.indexOf("application/json")===-1){const a=await t.text();return console.error("Received non-JSON response from Script:",a.substring(0,500)),{folderUrl:"",sheetUrl:"",error:"Script returned HTML. Check Script URL and deployment."}}const n=await t.json();return n.status==="success"?n.folderUrl?{folderUrl:n.folderUrl,sheetUrl:n.sheetUrl}:{folderUrl:"",sheetUrl:"",error:"Script is outdated. Please update code in Apps Script."}:{folderUrl:"",sheetUrl:"",error:n.message||"Unknown script error"}}catch(t){throw console.error("Failed to locate data:",t),new Error(t.message)}},F4=`
// COPY ALL OF THIS CODE INTO YOUR GOOGLE APPS SCRIPT EDITOR

// Configuration
var FOLDER_NAME = "WareFlow Reports";
var DB_FILE_NAME = "WareFlow Database";
var SHEET_TAB_NAME = "Main Issue Backup";

function doPost(e) {
  var lock = LockService.getScriptLock();
  lock.tryLock(10000);

  try {
    var data = JSON.parse(e.postData.contents);

    if (data.action === "backup_tab") {
        var ss = getOrCreateSpreadsheet();
        var tabName = data.tabName;
        var rows = data.rows; 
        
        if (!tabName || !rows || !Array.isArray(rows)) {
             return ContentService.createTextOutput(JSON.stringify({status: "error", message: "Invalid data format"}));
        }

        var sheet = ss.getSheetByName(tabName);
        if (!sheet) {
            sheet = ss.insertSheet(tabName);
        } else {
            sheet.clear();
        }
        
        if (rows.length > 0) {
            var width = rows[0].length;
            var safeRows = rows.map(function(r) {
               var row = r.slice(0, width);
               while(row.length < width) row.push("");
               return row;
            });
            sheet.getRange(1, 1, safeRows.length, width).setValues(safeRows);
        }
        
        return ContentService.createTextOutput(JSON.stringify({status: "success", count: rows.length}))
            .setMimeType(ContentService.MimeType.JSON);
    }

    if (data.action === "read_full_db") {
        var ss = getOrCreateSpreadsheet();
        var result = {};
        // ADD 'forecasts' to this list
        var tabs = ['items', 'machines', 'breakdowns', 'bom', 'history', 'locations', 'sectors', 'divisions', 'plans', 'users', 'agri_orders', 'irrigation_logs', 'forecasts'];
        
        tabs.forEach(function(tabName) {
            var sheet = ss.getSheetByName(tabName);
            if (sheet) {
                var values = sheet.getDataRange().getValues();
                if (values.length > 1) {
                    var headers = values[0];
                    var sheetData = values.slice(1).map(function(row) {
                        var obj = {};
                        headers.forEach(function(h, i) {
                            obj[h] = row[i];
                        });
                        return obj;
                    });
                    result[tabName] = sheetData;
                } else {
                    result[tabName] = [];
                }
            } else {
                result[tabName] = [];
            }
        });
        
        return ContentService.createTextOutput(JSON.stringify({status: "success", data: result}))
            .setMimeType(ContentService.MimeType.JSON);
    }

    if (data.action === "locate_data") {
        var folder = getOrCreateFolder(FOLDER_NAME);
        var ss = getOrCreateSpreadsheet(folder);
        return ContentService.createTextOutput(JSON.stringify({
            status: "success",
            folderUrl: folder.getUrl(),
            sheetUrl: ss.getUrl()
        })).setMimeType(ContentService.MimeType.JSON);
    }

    if (data.action === "upload_file") {
        var folder = getOrCreateFolder(FOLDER_NAME);
        var decoded = Utilities.base64Decode(data.fileData);
        var blob = Utilities.newBlob(decoded, data.mimeType, data.fileName);
        var file = folder.createFile(blob);
        file.setSharing(DriveApp.Access.ANYONE_WITH_LINK, DriveApp.Permission.VIEW);
        return ContentService.createTextOutput(JSON.stringify({
            status: "success",
            url: file.getUrl()
        })).setMimeType(ContentService.MimeType.JSON);
    }

    var ss = getOrCreateSpreadsheet();
    var sheet = ss.getSheetByName(SHEET_TAB_NAME);
    
    if (!sheet) {
      sheet = ss.insertSheet(SHEET_TAB_NAME);
      sheet.appendRow(["ID", "Date", "Location", "Machine", "Item ID", "Item Name", "Quantity", "Status", "Notes"]);
    }
    
    sheet.appendRow([
      data.id, data.timestamp, data.locationId, data.machineName, 
      data.itemId, data.itemName, data.quantity, data.status, data.notes || ""
    ]);
    
    return ContentService.createTextOutput(JSON.stringify({status: "success"}))
      .setMimeType(ContentService.MimeType.JSON);

  } catch(e) {
    return ContentService.createTextOutput(JSON.stringify({status: "error", message: e.toString()}))
      .setMimeType(ContentService.MimeType.JSON);
  } finally {
    lock.releaseLock();
  }
}

function getOrCreateFolder(name) {
  var folders = DriveApp.getFoldersByName(name);
  return folders.hasNext() ? folders.next() : DriveApp.createFolder(name);
}

function getOrCreateSpreadsheet(parentFolder) {
  try {
    var active = SpreadsheetApp.getActiveSpreadsheet();
    if (active) return active;
  } catch(e) {}

  var files = DriveApp.getFilesByName(DB_FILE_NAME);
  if (files.hasNext()) return SpreadsheetApp.open(files.next());

  var newSS = SpreadsheetApp.create(DB_FILE_NAME);
  if (parentFolder) {
     DriveApp.getFileById(newSS.getId()).moveTo(parentFolder);
  }
  return newSS;
}
`;/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Up={};Up.version="0.18.5";var p5=1252,Hre=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Z2={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},eS=function(e){Hre.indexOf(e)!=-1&&(p5=Z2[0]=e)};function qre(){eS(1252)}var ns=function(e){eS(e)};function tS(){ns(1200),qre()}function L4(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Wre(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function g5(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var yd=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Wre(e.slice(2)):t==254&&r==255?g5(e.slice(2)):t==65279?e.slice(1):e},_m=function(t){return String.fromCharCode(t)},B4=function(t){return String.fromCharCode(t)},Yd,no="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Qd(e){for(var t="",r=0,n=0,a=0,i=0,l=0,c=0,f=0,d=0;d<e.length;)r=e.charCodeAt(d++),i=r>>2,n=e.charCodeAt(d++),l=(r&3)<<4|n>>4,a=e.charCodeAt(d++),c=(n&15)<<2|a>>6,f=a&63,isNaN(n)?c=f=64:isNaN(a)&&(f=64),t+=no.charAt(i)+no.charAt(l)+no.charAt(c)+no.charAt(f);return t}function bi(e){var t="",r=0,n=0,a=0,i=0,l=0,c=0,f=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<e.length;)i=no.indexOf(e.charAt(d++)),l=no.indexOf(e.charAt(d++)),r=i<<2|l>>4,t+=String.fromCharCode(r),c=no.indexOf(e.charAt(d++)),n=(l&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(n)),f=no.indexOf(e.charAt(d++)),a=(c&3)<<6|f,f!==64&&(t+=String.fromCharCode(a));return t}var qt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Sl=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function co(e){return qt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function U4(e){return qt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var di=function(t){return qt?Sl(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Yg(e){if(typeof ArrayBuffer>"u")return di(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function bo(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Vre(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function rS(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return rS(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Xn=qt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Sl(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Gre(e){for(var t=[],r=0,n=e.length+250,a=co(e.length+255),i=0;i<e.length;++i){var l=e.charCodeAt(i);if(l<128)a[r++]=l;else if(l<2048)a[r++]=192|l>>6&31,a[r++]=128|l&63;else if(l>=55296&&l<57344){l=(l&1023)+64;var c=e.charCodeAt(++i)&1023;a[r++]=240|l>>8&7,a[r++]=128|l>>2&63,a[r++]=128|c>>6&15|(l&3)<<4,a[r++]=128|c&63}else a[r++]=224|l>>12&15,a[r++]=128|l>>6&63,a[r++]=128|l&63;r>n&&(t.push(a.slice(0,r)),r=0,a=co(65535),n=65530)}return t.push(a.slice(0,r)),Xn(t)}var Ra=/\u0000/g,bd=/[\u0001-\u0006]/g;function Fu(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function as(e,t){var r=""+e;return r.length>=t?r:fn("0",t-r.length)+r}function nS(e,t){var r=""+e;return r.length>=t?r:fn(" ",t-r.length)+r}function $p(e,t){var r=""+e;return r.length>=t?r:r+fn(" ",t-r.length)}function Kre(e,t){var r=""+Math.round(e);return r.length>=t?r:fn("0",t-r.length)+r}function Xre(e,t){var r=""+e;return r.length>=t?r:fn("0",t-r.length)+r}var $4=Math.pow(2,32);function vu(e,t){if(e>$4||e<-$4)return Kre(e,t);var r=Math.round(e);return Xre(r,t)}function zp(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var z4=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],rb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Yre(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Dt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},H4={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Qre={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Hp(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,l=1,c=0,f=1,d=0,m=0,p=Math.floor(a);d<t&&(p=Math.floor(a),c=p*l+i,m=p*d+f,!(a-p<5e-8));)a=1/(a-p),i=l,l=c,f=d,d=m;if(m>t&&(d>t?(m=f,c=i):(m=d,c=l)),!r)return[0,n*c,m];var v=Math.floor(n*c/m);return[v,n*c-v*m,m]}function ec(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,l=[],c={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(n+=1462),c.u>.9999&&(c.u=0,++a==86400&&(c.T=a=0,++n,++c.D)),n===60)l=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)l=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var f=new Date(1900,0,1);f.setDate(f.getDate()+n-1),l=[f.getFullYear(),f.getMonth()+1,f.getDate()],i=f.getDay(),n<60&&(i=(i+6)%7),r&&(i=nne(f,l))}return c.y=l[0],c.m=l[1],c.d=l[2],c.S=a%60,a=Math.floor(a/60),c.M=a%60,a=Math.floor(a/60),c.H=a,c.q=i,c}var v5=new Date(1899,11,31,0,0,0),Jre=v5.getTime(),Zre=new Date(1900,2,1,0,0,0);function x5(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Zre&&(r+=1440*60*1e3),(r-(Jre+(e.getTimezoneOffset()-v5.getTimezoneOffset())*6e4))/(1440*60*1e3)}function aS(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function ene(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function tne(e){var t=e<0?12:11,r=aS(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function rne(e){var t=aS(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function Jd(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=tne(e):t===10?r=e.toFixed(10).substr(0,12):r=rne(e),aS(ene(r.toUpperCase()))}function bc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Jd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return qi(14,x5(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function nne(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function ane(e,t,r,n){var a="",i=0,l=0,c=r.y,f,d=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:f=c%100,d=2;break;default:f=c%1e4,d=4;break}break;case 109:switch(t.length){case 1:case 2:f=r.m,d=t.length;break;case 3:return rb[r.m-1][1];case 5:return rb[r.m-1][0];default:return rb[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:f=r.d,d=t.length;break;case 3:return z4[r.q][0];default:return z4[r.q][1]}break;case 104:switch(t.length){case 1:case 2:f=1+(r.H+11)%12,d=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:f=r.H,d=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:f=r.M,d=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?as(r.S,t.length):(n>=2?l=n===3?1e3:100:l=n===1?10:1,i=Math.round(l*(r.S+r.u)),i>=60*l&&(i=0),t==="s"?i===0?"0":""+i/l:(a=as(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":f=r.D*24+r.H;break;case"[m]":case"[mm]":f=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":f=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}d=t.length===3?1:2;break;case 101:f=c,d=1;break}var m=d>0?as(f,d):"";return m}function ao(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var y5=/%/g;function ine(e,t,r){var n=t.replace(y5,""),a=t.length-n.length;return il(e,n,r*Math.pow(10,2*a))+fn("%",a)}function sne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return il(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function b5(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+b5(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var l=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,m){return f+d+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var w5=/# (\?+)( ?)\/( ?)(\d+)/;function lne(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),l=a-i*n,c=n;return r+(i===0?"":""+i)+" "+(l===0?fn(" ",e[1].length+1+e[4].length):nS(l,e[1].length)+e[2]+"/"+e[3]+as(c,e[4].length))}function one(e,t,r){return r+(t===0?"":""+t)+fn(" ",e[1].length+2+e[4].length)}var _5=/^#*0*\.([0#]+)/,S5=/\).*[0#]/,E5=/\(###\) ###\\?-####/;function Da(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function q4(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function W4(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function cne(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function une(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function Ii(e,t,r){if(e.charCodeAt(0)===40&&!t.match(S5)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ii("n",n,r):"("+Ii("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return sne(e,t,r);if(t.indexOf("%")!==-1)return ine(e,t,r);if(t.indexOf("E")!==-1)return b5(t,r);if(t.charCodeAt(0)===36)return"$"+Ii(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,l,c,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+vu(f,t.length);if(t.match(/^[#?]+$/))return a=vu(r,0),a==="0"&&(a=""),a.length>t.length?a:Da(t.substr(0,t.length-a.length))+a;if(i=t.match(w5))return lne(i,f,d);if(t.match(/^#+0+$/))return d+vu(f,t.length-t.indexOf("0"));if(i=t.match(_5))return a=q4(r,i[1].length).replace(/^([^\.]+)$/,"$1."+Da(i[1])).replace(/\.$/,"."+Da(i[1])).replace(/\.(\d*)$/,function(y,b){return"."+b+fn("0",Da(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+q4(f,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ao(vu(f,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ii(e,t,-r):ao(""+(Math.floor(r)+cne(r,i[1].length)))+"."+as(W4(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return Ii(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fu(Ii(e,t.replace(/[\\-]/g,""),r)),l=0,Fu(Fu(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return l<a.length?a.charAt(l++):y==="0"?"0":""}));if(t.match(E5))return a=Ii(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=Hp(f,Math.pow(10,l)-1,!1),a=""+d,m=il("n",i[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=$p(c[2],l),m.length<i[4].length&&(m=Da(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=Hp(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?nS(c[1],l)+i[2]+"/"+i[3]+$p(c[2],l):fn(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=vu(r,0),t.length<=a.length?a:Da(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var p=t.indexOf(".")-l,v=t.length-a.length-p;return Da(t.substr(0,p)+a+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return l=W4(r,i[1].length),r<0?"-"+Ii(e,t,-r):ao(une(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?as(0,3-y.length):"")+y})+"."+as(l,i[1].length);switch(t){case"###,##0.00":return Ii(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var x=ao(vu(f,0));return x!=="0"?d+x:"";case"###,###.00":return Ii(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return Ii(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function fne(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return il(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function dne(e,t,r){var n=t.replace(y5,""),a=t.length-n.length;return il(e,n,r*Math.pow(10,2*a))+fn("%",a)}function N5(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+N5(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var l=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(l-r.length+i):r+="E+"+(l-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,f,d,m){return f+d+m.substr(0,(a+i)%a)+"."+m.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ws(e,t,r){if(e.charCodeAt(0)===40&&!t.match(S5)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ws("n",n,r):"("+ws("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return fne(e,t,r);if(t.indexOf("%")!==-1)return dne(e,t,r);if(t.indexOf("E")!==-1)return N5(t,r);if(t.charCodeAt(0)===36)return"$"+ws(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,l,c,f=Math.abs(r),d=r<0?"-":"";if(t.match(/^00+$/))return d+as(f,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Da(t.substr(0,t.length-a.length))+a;if(i=t.match(w5))return one(i,f,d);if(t.match(/^#+0+$/))return d+as(f,t.length-t.indexOf("0"));if(i=t.match(_5))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Da(i[1])).replace(/\.$/,"."+Da(i[1])),a=a.replace(/\.(\d*)$/,function(y,b){return"."+b+fn("0",Da(i[1]).length-b.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return d+(""+f).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return d+ao(""+f);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ws(e,t,-r):ao(""+r)+"."+fn("0",i[1].length);if(i=t.match(/^#,#*,#0/))return ws(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Fu(ws(e,t.replace(/[\\-]/g,""),r)),l=0,Fu(Fu(t.replace(/\\/g,"")).replace(/[0#]/g,function(y){return l<a.length?a.charAt(l++):y==="0"?"0":""}));if(t.match(E5))return a=ws(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var m="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(i[4].length,7),c=Hp(f,Math.pow(10,l)-1,!1),a=""+d,m=il("n",i[1],c[1]),m.charAt(m.length-1)==" "&&(m=m.substr(0,m.length-1)+"0"),a+=m+i[2]+"/"+i[3],m=$p(c[2],l),m.length<i[4].length&&(m=Da(i[4].substr(i[4].length-m.length))+m),a+=m,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return l=Math.min(Math.max(i[1].length,i[4].length),7),c=Hp(f,Math.pow(10,l)-1,!0),d+(c[0]||(c[1]?"":"0"))+" "+(c[1]?nS(c[1],l)+i[2]+"/"+i[3]+$p(c[2],l):fn(" ",2*l+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Da(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),l=a.indexOf(".");var p=t.indexOf(".")-l,v=t.length-a.length-p;return Da(t.substr(0,p)+a+t.substr(t.length-v))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ws(e,t,-r):ao(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(y){return"00,"+(y.length<3?as(0,3-y.length):"")+y})+"."+as(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var x=ao(""+f);return x!=="0"?d+x:"";default:if(t.match(/\.[0#?]*$/))return ws(e,t.slice(0,t.lastIndexOf(".")),r)+Da(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function il(e,t,r){return(r|0)===r?ws(e,t,r):Ii(e,t,r)}function hne(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var k5=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function df(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":zp(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(k5))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function mne(e,t,r,n){for(var a=[],i="",l=0,c="",f="t",d,m,p,v="H";l<e.length;)switch(c=e.charAt(l)){case"G":if(!zp(e,l))throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"G",v:"General"},l+=7;break;case'"':for(i="";(p=e.charCodeAt(++l))!==34&&l<e.length;)i+=String.fromCharCode(p);a[a.length]={t:"t",v:i},++l;break;case"\\":var x=e.charAt(++l),y=x==="("||x===")"?x:"t";a[a.length]={t:y,v:x},++l;break;case"_":a[a.length]={t:"t",v:" "},l+=2;break;case"@":a[a.length]={t:"T",v:t},++l;break;case"B":case"b":if(e.charAt(l+1)==="1"||e.charAt(l+1)==="2"){if(d==null&&(d=ec(t,r,e.charAt(l+1)==="2"),d==null))return"";a[a.length]={t:"X",v:e.substr(l,2)},f=c,l+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||d==null&&(d=ec(t,r),d==null))return"";for(i=c;++l<e.length&&e.charAt(l).toLowerCase()===c;)i+=c;c==="m"&&f.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),a[a.length]={t:c,v:i},f=c;break;case"A":case"a":case"":var b={t:c,v:c};if(d==null&&(d=ec(t,r)),e.substr(l,3).toUpperCase()==="A/P"?(d!=null&&(b.v=d.H>=12?"P":"A"),b.t="T",v="h",l+=3):e.substr(l,5).toUpperCase()==="AM/PM"?(d!=null&&(b.v=d.H>=12?"PM":"AM"),b.t="T",l+=5,v="h"):e.substr(l,5).toUpperCase()==="/"?(d!=null&&(b.v=d.H>=12?"":""),b.t="T",l+=5,v="h"):(b.t="t",++l),d==null&&b.t==="T")return"";a[a.length]=b,f=c;break;case"[":for(i=c;e.charAt(l++)!=="]"&&l<e.length;)i+=e.charAt(l);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(k5)){if(d==null&&(d=ec(t,r),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},f=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",df(e)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=c;++l<e.length&&(c=e.charAt(l))==="0";)i+=c;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=c;++l<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(l))>-1;)i+=c;a[a.length]={t:"n",v:i};break;case"?":for(i=c;e.charAt(++l)===c;)i+=c;a[a.length]={t:c,v:i},f=c;break;case"*":++l,(e.charAt(l)==" "||e.charAt(l)=="*")&&++l;break;case"(":case")":a[a.length]={t:n===1?"t":c,v:c},++l;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=c;l<e.length&&"0123456789".indexOf(e.charAt(++l))>-1;)i+=e.charAt(l);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:c,v:c},++l;break;case"$":a[a.length]={t:"t",v:"$"},++l;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);a[a.length]={t:"t",v:c},++l;break}var _=0,E=0,A;for(l=a.length-1,f="t";l>=0;--l)switch(a[l].t){case"h":case"H":a[l].t=v,f="h",_<1&&(_=1);break;case"s":(A=a[l].v.match(/\.0+$/))&&(E=Math.max(E,A[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":f=a[l].t;break;case"m":f==="s"&&(a[l].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[l].v.match(/[Hh]/)&&(_=1),_<2&&a[l].v.match(/[Mm]/)&&(_=2),_<3&&a[l].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var T="",k;for(l=0;l<a.length;++l)switch(a[l].t){case"t":case"T":case" ":case"D":break;case"X":a[l].v="",a[l].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[l].v=ane(a[l].t.charCodeAt(0),a[l].v,d,E),a[l].t="t";break;case"n":case"?":for(k=l+1;a[k]!=null&&((c=a[k].t)==="?"||c==="D"||(c===" "||c==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[l].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[l].v+=a[k].v,a[k]={v:"",t:";"},++k;T+=a[l].v,l=k-1;break;case"G":a[l].t="t",a[l].v=bc(t,r);break}var I="",O,j;if(T.length>0){T.charCodeAt(0)==40?(O=t<0&&T.charCodeAt(0)===45?-t:t,j=il("n",T,O)):(O=t<0&&n>1?-t:t,j=il("n",T,O),O<0&&a[0]&&a[0].t=="t"&&(j=j.substr(1),a[0].v="-"+a[0].v)),k=j.length-1;var B=a.length;for(l=0;l<a.length;++l)if(a[l]!=null&&a[l].t!="t"&&a[l].v.indexOf(".")>-1){B=l;break}var U=a.length;if(B===a.length&&j.indexOf("E")===-1){for(l=a.length-1;l>=0;--l)a[l]==null||"n?".indexOf(a[l].t)===-1||(k>=a[l].v.length-1?(k-=a[l].v.length,a[l].v=j.substr(k+1,a[l].v.length)):k<0?a[l].v="":(a[l].v=j.substr(0,k+1),k=-1),a[l].t="t",U=l);k>=0&&U<a.length&&(a[U].v=j.substr(0,k+1)+a[U].v)}else if(B!==a.length&&j.indexOf("E")===-1){for(k=j.indexOf(".")-1,l=B;l>=0;--l)if(!(a[l]==null||"n?".indexOf(a[l].t)===-1)){for(m=a[l].v.indexOf(".")>-1&&l===B?a[l].v.indexOf(".")-1:a[l].v.length-1,I=a[l].v.substr(m+1);m>=0;--m)k>=0&&(a[l].v.charAt(m)==="0"||a[l].v.charAt(m)==="#")&&(I=j.charAt(k--)+I);a[l].v=I,a[l].t="t",U=l}for(k>=0&&U<a.length&&(a[U].v=j.substr(0,k+1)+a[U].v),k=j.indexOf(".")+1,l=B;l<a.length;++l)if(!(a[l]==null||"n?(".indexOf(a[l].t)===-1&&l!==B)){for(m=a[l].v.indexOf(".")>-1&&l===B?a[l].v.indexOf(".")+1:0,I=a[l].v.substr(0,m);m<a[l].v.length;++m)k<j.length&&(I+=j.charAt(k++));a[l].v=I,a[l].t="t",U=l}}}for(l=0;l<a.length;++l)a[l]!=null&&"n?".indexOf(a[l].t)>-1&&(O=n>1&&t<0&&l>0&&a[l-1].v==="-"?-t:t,a[l].v=il(a[l].t,a[l].v,O),a[l].t="t");var Y="";for(l=0;l!==a.length;++l)a[l]!=null&&(Y+=a[l].v);return Y}var V4=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function G4(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function pne(e,t){var r=hne(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var l=r[0].match(V4),c=r[1].match(V4);return G4(t,l)?[n,r[0]]:G4(t,c)?[n,r[1]]:[n,r[l!=null&&c!=null?2:1]]}return[n,i]}function qi(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Dt)[e],n==null&&(n=r.table&&r.table[H4[e]]||Dt[H4[e]]),n==null&&(n=Qre[e]||"General");break}if(zp(n,0))return bc(t,r);t instanceof Date&&(t=x5(t,r.date1904));var a=pne(n,t);if(zp(a[1]))return bc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return mne(a[1],t,r,a[0])}function sl(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Dt[r]==null){t<0&&(t=r);continue}if(Dt[r]==e){t=r;break}}t<0&&(t=391)}return Dt[t]=e,t}function Qg(e){for(var t=0;t!=392;++t)e[t]!==void 0&&sl(e[t],t)}function hf(){Dt=Yre()}var gne={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},T5=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function vne(e){var t=typeof e=="number"?Dt[e]:e;return t=t.replace(T5,"(\\d+)"),new RegExp("^"+t+"$")}function xne(e,t,r){var n=-1,a=-1,i=-1,l=-1,c=-1,f=-1;(t.match(T5)||[]).forEach(function(p,v){var x=parseInt(r[v+1],10);switch(p.toLowerCase().charAt(0)){case"y":n=x;break;case"d":i=x;break;case"h":l=x;break;case"s":f=x;break;case"m":l>=0?c=x:a=x;break}}),f>=0&&c==-1&&a>=0&&(c=a,a=-1);var d=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var m=("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2);return l==-1&&c==-1&&f==-1?d:n==-1&&a==-1&&i==-1?m:d+"T"+m}var yne=(function(){var e={};e.version="1.2.0";function t(){for(var j=0,B=new Array(256),U=0;U!=256;++U)j=U,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,j=j&1?-306674912^j>>>1:j>>>1,B[U]=j;return typeof Int32Array<"u"?new Int32Array(B):B}var r=t();function n(j){var B=0,U=0,Y=0,te=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Y=0;Y!=256;++Y)te[Y]=j[Y];for(Y=0;Y!=256;++Y)for(U=j[Y],B=256+Y;B<4096;B+=256)U=te[B]=U>>>8^j[U&255];var V=[];for(Y=1;Y!=16;++Y)V[Y-1]=typeof Int32Array<"u"?te.subarray(Y*256,Y*256+256):te.slice(Y*256,Y*256+256);return V}var a=n(r),i=a[0],l=a[1],c=a[2],f=a[3],d=a[4],m=a[5],p=a[6],v=a[7],x=a[8],y=a[9],b=a[10],_=a[11],E=a[12],A=a[13],T=a[14];function k(j,B){for(var U=B^-1,Y=0,te=j.length;Y<te;)U=U>>>8^r[(U^j.charCodeAt(Y++))&255];return~U}function I(j,B){for(var U=B^-1,Y=j.length-15,te=0;te<Y;)U=T[j[te++]^U&255]^A[j[te++]^U>>8&255]^E[j[te++]^U>>16&255]^_[j[te++]^U>>>24]^b[j[te++]]^y[j[te++]]^x[j[te++]]^v[j[te++]]^p[j[te++]]^m[j[te++]]^d[j[te++]]^f[j[te++]]^c[j[te++]]^l[j[te++]]^i[j[te++]]^r[j[te++]];for(Y+=15;te<Y;)U=U>>>8^r[(U^j[te++])&255];return~U}function O(j,B){for(var U=B^-1,Y=0,te=j.length,V=0,ge=0;Y<te;)V=j.charCodeAt(Y++),V<128?U=U>>>8^r[(U^V)&255]:V<2048?(U=U>>>8^r[(U^(192|V>>6&31))&255],U=U>>>8^r[(U^(128|V&63))&255]):V>=55296&&V<57344?(V=(V&1023)+64,ge=j.charCodeAt(Y++)&1023,U=U>>>8^r[(U^(240|V>>8&7))&255],U=U>>>8^r[(U^(128|V>>2&63))&255],U=U>>>8^r[(U^(128|ge>>6&15|(V&3)<<4))&255],U=U>>>8^r[(U^(128|ge&63))&255]):(U=U>>>8^r[(U^(224|V>>12&15))&255],U=U>>>8^r[(U^(128|V>>6&63))&255],U=U>>>8^r[(U^(128|V&63))&255]);return~U}return e.table=r,e.bstr=k,e.buf=I,e.str=O,e})(),kt=(function(){var t={};t.version="1.2.1";function r(R,ee){for(var K=R.split("/"),H=ee.split("/"),Z=0,ne=0,L=Math.min(K.length,H.length);Z<L;++Z){if(ne=K[Z].length-H[Z].length)return ne;if(K[Z]!=H[Z])return K[Z]<H[Z]?-1:1}return K.length-H.length}function n(R){if(R.charAt(R.length-1)=="/")return R.slice(0,-1).indexOf("/")===-1?R:n(R.slice(0,-1));var ee=R.lastIndexOf("/");return ee===-1?R:R.slice(0,ee+1)}function a(R){if(R.charAt(R.length-1)=="/")return a(R.slice(0,-1));var ee=R.lastIndexOf("/");return ee===-1?R:R.slice(ee+1)}function i(R,ee){typeof ee=="string"&&(ee=new Date(ee));var K=ee.getHours();K=K<<6|ee.getMinutes(),K=K<<5|ee.getSeconds()>>>1,R.write_shift(2,K);var H=ee.getFullYear()-1980;H=H<<4|ee.getMonth()+1,H=H<<5|ee.getDate(),R.write_shift(2,H)}function l(R){var ee=R.read_shift(2)&65535,K=R.read_shift(2)&65535,H=new Date,Z=K&31;K>>>=5;var ne=K&15;K>>>=4,H.setMilliseconds(0),H.setFullYear(K+1980),H.setMonth(ne-1),H.setDate(Z);var L=ee&31;ee>>>=5;var he=ee&63;return ee>>>=6,H.setHours(ee),H.setMinutes(he),H.setSeconds(L<<1),H}function c(R){ha(R,0);for(var ee={},K=0;R.l<=R.length-4;){var H=R.read_shift(2),Z=R.read_shift(2),ne=R.l+Z,L={};switch(H){case 21589:K=R.read_shift(1),K&1&&(L.mtime=R.read_shift(4)),Z>5&&(K&2&&(L.atime=R.read_shift(4)),K&4&&(L.ctime=R.read_shift(4))),L.mtime&&(L.mt=new Date(L.mtime*1e3));break}R.l=ne,ee[H]=L}return ee}var f;function d(){return f||(f={})}function m(R,ee){if(R[0]==80&&R[1]==75)return $r(R,ee);if((R[0]|32)==109&&(R[1]|32)==105)return gr(R,ee);if(R.length<512)throw new Error("CFB file size "+R.length+" < 512");var K=3,H=512,Z=0,ne=0,L=0,he=0,fe=0,de=[],we=R.slice(0,512);ha(we,0);var Pe=p(we);switch(K=Pe[0],K){case 3:H=512;break;case 4:H=4096;break;case 0:if(Pe[1]==0)return $r(R,ee);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}H!==512&&(we=R.slice(0,H),ha(we,28));var Re=R.slice(0,H);v(we,K);var Ve=we.read_shift(4,"i");if(K===3&&Ve!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ve);we.l+=4,L=we.read_shift(4,"i"),we.l+=4,we.chk("00100000","Mini Stream Cutoff Size: "),he=we.read_shift(4,"i"),Z=we.read_shift(4,"i"),fe=we.read_shift(4,"i"),ne=we.read_shift(4,"i");for(var C=-1,J=0;J<109&&(C=we.read_shift(4,"i"),!(C<0));++J)de[J]=C;var xe=x(R,H);_(fe,ne,xe,H,de);var Ee=A(xe,L,de,H);Ee[L].name="!Directory",Z>0&&he!==ge&&(Ee[he].name="!MiniFAT"),Ee[de[0]].name="!FAT",Ee.fat_addrs=de,Ee.ssz=H;var Ce={},Se=[],Qe=[],Xe=[];T(L,Ee,xe,Se,Z,Ce,Qe,he),y(Qe,Xe,Se),Se.shift();var Ye={FileIndex:Qe,FullPaths:Xe};return ee&&ee.raw&&(Ye.raw={header:Re,sectors:xe}),Ye}function p(R){if(R[R.l]==80&&R[R.l+1]==75)return[0,0];R.chk(be,"Header Signature: "),R.l+=16;var ee=R.read_shift(2,"u");return[R.read_shift(2,"u"),ee]}function v(R,ee){var K=9;switch(R.l+=2,K=R.read_shift(2)){case 9:if(ee!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(ee!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}R.chk("0600","Mini Sector Shift: "),R.chk("000000000000","Reserved: ")}function x(R,ee){for(var K=Math.ceil(R.length/ee)-1,H=[],Z=1;Z<K;++Z)H[Z-1]=R.slice(Z*ee,(Z+1)*ee);return H[K-1]=R.slice(K*ee),H}function y(R,ee,K){for(var H=0,Z=0,ne=0,L=0,he=0,fe=K.length,de=[],we=[];H<fe;++H)de[H]=we[H]=H,ee[H]=K[H];for(;he<we.length;++he)H=we[he],Z=R[H].L,ne=R[H].R,L=R[H].C,de[H]===H&&(Z!==-1&&de[Z]!==Z&&(de[H]=de[Z]),ne!==-1&&de[ne]!==ne&&(de[H]=de[ne])),L!==-1&&(de[L]=H),Z!==-1&&H!=de[H]&&(de[Z]=de[H],we.lastIndexOf(Z)<he&&we.push(Z)),ne!==-1&&H!=de[H]&&(de[ne]=de[H],we.lastIndexOf(ne)<he&&we.push(ne));for(H=1;H<fe;++H)de[H]===H&&(ne!==-1&&de[ne]!==ne?de[H]=de[ne]:Z!==-1&&de[Z]!==Z&&(de[H]=de[Z]));for(H=1;H<fe;++H)if(R[H].type!==0){if(he=H,he!=de[he])do he=de[he],ee[H]=ee[he]+"/"+ee[H];while(he!==0&&de[he]!==-1&&he!=de[he]);de[H]=-1}for(ee[0]+="/",H=1;H<fe;++H)R[H].type!==2&&(ee[H]+="/")}function b(R,ee,K){for(var H=R.start,Z=R.size,ne=[],L=H;K&&Z>0&&L>=0;)ne.push(ee.slice(L*V,L*V+V)),Z-=V,L=Go(K,L*4);return ne.length===0?Ie(0):Xn(ne).slice(0,R.size)}function _(R,ee,K,H,Z){var ne=ge;if(R===ge){if(ee!==0)throw new Error("DIFAT chain shorter than expected")}else if(R!==-1){var L=K[R],he=(H>>>2)-1;if(!L)return;for(var fe=0;fe<he&&(ne=Go(L,fe*4))!==ge;++fe)Z.push(ne);_(Go(L,H-4),ee-1,K,H,Z)}}function E(R,ee,K,H,Z){var ne=[],L=[];Z||(Z=[]);var he=H-1,fe=0,de=0;for(fe=ee;fe>=0;){Z[fe]=!0,ne[ne.length]=fe,L.push(R[fe]);var we=K[Math.floor(fe*4/H)];if(de=fe*4&he,H<4+de)throw new Error("FAT boundary crossed: "+fe+" 4 "+H);if(!R[we])break;fe=Go(R[we],de)}return{nodes:ne,data:i3([L])}}function A(R,ee,K,H){var Z=R.length,ne=[],L=[],he=[],fe=[],de=H-1,we=0,Pe=0,Re=0,Ve=0;for(we=0;we<Z;++we)if(he=[],Re=we+ee,Re>=Z&&(Re-=Z),!L[Re]){fe=[];var C=[];for(Pe=Re;Pe>=0;){C[Pe]=!0,L[Pe]=!0,he[he.length]=Pe,fe.push(R[Pe]);var J=K[Math.floor(Pe*4/H)];if(Ve=Pe*4&de,H<4+Ve)throw new Error("FAT boundary crossed: "+Pe+" 4 "+H);if(!R[J]||(Pe=Go(R[J],Ve),C[Pe]))break}ne[Re]={nodes:he,data:i3([fe])}}return ne}function T(R,ee,K,H,Z,ne,L,he){for(var fe=0,de=H.length?2:0,we=ee[R].data,Pe=0,Re=0,Ve;Pe<we.length;Pe+=128){var C=we.slice(Pe,Pe+128);ha(C,64),Re=C.read_shift(2),Ve=fS(C,0,Re-de),H.push(Ve);var J={name:Ve,type:C.read_shift(1),color:C.read_shift(1),L:C.read_shift(4,"i"),R:C.read_shift(4,"i"),C:C.read_shift(4,"i"),clsid:C.read_shift(16),state:C.read_shift(4,"i"),start:0,size:0},xe=C.read_shift(2)+C.read_shift(2)+C.read_shift(2)+C.read_shift(2);xe!==0&&(J.ct=k(C,C.l-8));var Ee=C.read_shift(2)+C.read_shift(2)+C.read_shift(2)+C.read_shift(2);Ee!==0&&(J.mt=k(C,C.l-8)),J.start=C.read_shift(4,"i"),J.size=C.read_shift(4,"i"),J.size<0&&J.start<0&&(J.size=J.type=0,J.start=ge,J.name=""),J.type===5?(fe=J.start,Z>0&&fe!==ge&&(ee[fe].name="!StreamData")):J.size>=4096?(J.storage="fat",ee[J.start]===void 0&&(ee[J.start]=E(K,J.start,ee.fat_addrs,ee.ssz)),ee[J.start].name=J.name,J.content=ee[J.start].data.slice(0,J.size)):(J.storage="minifat",J.size<0?J.size=0:fe!==ge&&J.start!==ge&&ee[fe]&&(J.content=b(J,ee[fe].data,(ee[he]||{}).data))),J.content&&ha(J.content,0),ne[Ve]=J,L.push(J)}}function k(R,ee){return new Date((ui(R,ee+4)/1e7*Math.pow(2,32)+ui(R,ee)/1e7-11644473600)*1e3)}function I(R,ee){return d(),m(f.readFileSync(R),ee)}function O(R,ee){var K=ee&&ee.type;switch(K||qt&&Buffer.isBuffer(R)&&(K="buffer"),K||"base64"){case"file":return I(R,ee);case"base64":return m(di(bi(R)),ee);case"binary":return m(di(R),ee)}return m(R,ee)}function j(R,ee){var K=ee||{},H=K.root||"Root Entry";if(R.FullPaths||(R.FullPaths=[]),R.FileIndex||(R.FileIndex=[]),R.FullPaths.length!==R.FileIndex.length)throw new Error("inconsistent CFB structure");R.FullPaths.length===0&&(R.FullPaths[0]=H+"/",R.FileIndex[0]={name:H,type:5}),K.CLSID&&(R.FileIndex[0].clsid=K.CLSID),B(R)}function B(R){var ee="Sh33tJ5";if(!kt.find(R,"/"+ee)){var K=Ie(4);K[0]=55,K[1]=K[3]=50,K[2]=54,R.FileIndex.push({name:ee,type:2,content:K,size:4,L:69,R:69,C:69}),R.FullPaths.push(R.FullPaths[0]+ee),U(R)}}function U(R,ee){j(R);for(var K=!1,H=!1,Z=R.FullPaths.length-1;Z>=0;--Z){var ne=R.FileIndex[Z];switch(ne.type){case 0:H?K=!0:(R.FileIndex.pop(),R.FullPaths.pop());break;case 1:case 2:case 5:H=!0,isNaN(ne.R*ne.L*ne.C)&&(K=!0),ne.R>-1&&ne.L>-1&&ne.R==ne.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!ee)){var L=new Date(1987,1,19),he=0,fe=Object.create?Object.create(null):{},de=[];for(Z=0;Z<R.FullPaths.length;++Z)fe[R.FullPaths[Z]]=!0,R.FileIndex[Z].type!==0&&de.push([R.FullPaths[Z],R.FileIndex[Z]]);for(Z=0;Z<de.length;++Z){var we=n(de[Z][0]);H=fe[we],H||(de.push([we,{name:a(we).replace("/",""),type:1,clsid:z,ct:L,mt:L,content:null}]),fe[we]=!0)}for(de.sort(function(Ve,C){return r(Ve[0],C[0])}),R.FullPaths=[],R.FileIndex=[],Z=0;Z<de.length;++Z)R.FullPaths[Z]=de[Z][0],R.FileIndex[Z]=de[Z][1];for(Z=0;Z<de.length;++Z){var Pe=R.FileIndex[Z],Re=R.FullPaths[Z];if(Pe.name=a(Re).replace("/",""),Pe.L=Pe.R=Pe.C=-(Pe.color=1),Pe.size=Pe.content?Pe.content.length:0,Pe.start=0,Pe.clsid=Pe.clsid||z,Z===0)Pe.C=de.length>1?1:-1,Pe.size=0,Pe.type=5;else if(Re.slice(-1)=="/"){for(he=Z+1;he<de.length&&n(R.FullPaths[he])!=Re;++he);for(Pe.C=he>=de.length?-1:he,he=Z+1;he<de.length&&n(R.FullPaths[he])!=n(Re);++he);Pe.R=he>=de.length?-1:he,Pe.type=1}else n(R.FullPaths[Z+1]||"")==n(Re)&&(Pe.R=Z+1),Pe.type=2}}}function Y(R,ee){var K=ee||{};if(K.fileType=="mad")return Oa(R,K);switch(U(R),K.fileType){case"zip":return zn(R,K)}var H=(function(Ve){for(var C=0,J=0,xe=0;xe<Ve.FileIndex.length;++xe){var Ee=Ve.FileIndex[xe];if(Ee.content){var Ce=Ee.content.length;Ce>0&&(Ce<4096?C+=Ce+63>>6:J+=Ce+511>>9)}}for(var Se=Ve.FullPaths.length+3>>2,Qe=C+7>>3,Xe=C+127>>7,Ye=Qe+J+Se+Xe,pt=Ye+127>>7,Et=pt<=109?0:Math.ceil((pt-109)/127);Ye+pt+Et+127>>7>pt;)Et=++pt<=109?0:Math.ceil((pt-109)/127);var nt=[1,Et,pt,Xe,Se,J,C,0];return Ve.FileIndex[0].size=C<<6,nt[7]=(Ve.FileIndex[0].start=nt[0]+nt[1]+nt[2]+nt[3]+nt[4]+nt[5])+(nt[6]+7>>3),nt})(R),Z=Ie(H[7]<<9),ne=0,L=0;{for(ne=0;ne<8;++ne)Z.write_shift(1,ve[ne]);for(ne=0;ne<8;++ne)Z.write_shift(2,0);for(Z.write_shift(2,62),Z.write_shift(2,3),Z.write_shift(2,65534),Z.write_shift(2,9),Z.write_shift(2,6),ne=0;ne<3;++ne)Z.write_shift(2,0);for(Z.write_shift(4,0),Z.write_shift(4,H[2]),Z.write_shift(4,H[0]+H[1]+H[2]+H[3]-1),Z.write_shift(4,0),Z.write_shift(4,4096),Z.write_shift(4,H[3]?H[0]+H[1]+H[2]-1:ge),Z.write_shift(4,H[3]),Z.write_shift(-4,H[1]?H[0]-1:ge),Z.write_shift(4,H[1]),ne=0;ne<109;++ne)Z.write_shift(-4,ne<H[2]?H[1]+ne:-1)}if(H[1])for(L=0;L<H[1];++L){for(;ne<236+L*127;++ne)Z.write_shift(-4,ne<H[2]?H[1]+ne:-1);Z.write_shift(-4,L===H[1]-1?ge:L+1)}var he=function(Ve){for(L+=Ve;ne<L-1;++ne)Z.write_shift(-4,ne+1);Ve&&(++ne,Z.write_shift(-4,ge))};for(L=ne=0,L+=H[1];ne<L;++ne)Z.write_shift(-4,ue.DIFSECT);for(L+=H[2];ne<L;++ne)Z.write_shift(-4,ue.FATSECT);he(H[3]),he(H[4]);for(var fe=0,de=0,we=R.FileIndex[0];fe<R.FileIndex.length;++fe)we=R.FileIndex[fe],we.content&&(de=we.content.length,!(de<4096)&&(we.start=L,he(de+511>>9)));for(he(H[6]+7>>3);Z.l&511;)Z.write_shift(-4,ue.ENDOFCHAIN);for(L=ne=0,fe=0;fe<R.FileIndex.length;++fe)we=R.FileIndex[fe],we.content&&(de=we.content.length,!(!de||de>=4096)&&(we.start=L,he(de+63>>6)));for(;Z.l&511;)Z.write_shift(-4,ue.ENDOFCHAIN);for(ne=0;ne<H[4]<<2;++ne){var Pe=R.FullPaths[ne];if(!Pe||Pe.length===0){for(fe=0;fe<17;++fe)Z.write_shift(4,0);for(fe=0;fe<3;++fe)Z.write_shift(4,-1);for(fe=0;fe<12;++fe)Z.write_shift(4,0);continue}we=R.FileIndex[ne],ne===0&&(we.start=we.size?we.start-1:ge);var Re=ne===0&&K.root||we.name;if(de=2*(Re.length+1),Z.write_shift(64,Re,"utf16le"),Z.write_shift(2,de),Z.write_shift(1,we.type),Z.write_shift(1,we.color),Z.write_shift(-4,we.L),Z.write_shift(-4,we.R),Z.write_shift(-4,we.C),we.clsid)Z.write_shift(16,we.clsid,"hex");else for(fe=0;fe<4;++fe)Z.write_shift(4,0);Z.write_shift(4,we.state||0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(4,we.start),Z.write_shift(4,we.size),Z.write_shift(4,0)}for(ne=1;ne<R.FileIndex.length;++ne)if(we=R.FileIndex[ne],we.size>=4096)if(Z.l=we.start+1<<9,qt&&Buffer.isBuffer(we.content))we.content.copy(Z,Z.l,0,we.size),Z.l+=we.size+511&-512;else{for(fe=0;fe<we.size;++fe)Z.write_shift(1,we.content[fe]);for(;fe&511;++fe)Z.write_shift(1,0)}for(ne=1;ne<R.FileIndex.length;++ne)if(we=R.FileIndex[ne],we.size>0&&we.size<4096)if(qt&&Buffer.isBuffer(we.content))we.content.copy(Z,Z.l,0,we.size),Z.l+=we.size+63&-64;else{for(fe=0;fe<we.size;++fe)Z.write_shift(1,we.content[fe]);for(;fe&63;++fe)Z.write_shift(1,0)}if(qt)Z.l=Z.length;else for(;Z.l<Z.length;)Z.write_shift(1,0);return Z}function te(R,ee){var K=R.FullPaths.map(function(fe){return fe.toUpperCase()}),H=K.map(function(fe){var de=fe.split("/");return de[de.length-(fe.slice(-1)=="/"?2:1)]}),Z=!1;ee.charCodeAt(0)===47?(Z=!0,ee=K[0].slice(0,-1)+ee):Z=ee.indexOf("/")!==-1;var ne=ee.toUpperCase(),L=Z===!0?K.indexOf(ne):H.indexOf(ne);if(L!==-1)return R.FileIndex[L];var he=!ne.match(bd);for(ne=ne.replace(Ra,""),he&&(ne=ne.replace(bd,"!")),L=0;L<K.length;++L)if((he?K[L].replace(bd,"!"):K[L]).replace(Ra,"")==ne||(he?H[L].replace(bd,"!"):H[L]).replace(Ra,"")==ne)return R.FileIndex[L];return null}var V=64,ge=-2,be="d0cf11e0a1b11ae1",ve=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",ue={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ge,FREESECT:-1,HEADER_SIGNATURE:be,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function se(R,ee,K){d();var H=Y(R,K);f.writeFileSync(ee,H)}function Q(R){for(var ee=new Array(R.length),K=0;K<R.length;++K)ee[K]=String.fromCharCode(R[K]);return ee.join("")}function re(R,ee){var K=Y(R,ee);switch(ee&&ee.type||"buffer"){case"file":return d(),f.writeFileSync(ee.filename,K),K;case"binary":return typeof K=="string"?K:Q(K);case"base64":return Qd(typeof K=="string"?K:Q(K));case"buffer":if(qt)return Buffer.isBuffer(K)?K:Sl(K);case"array":return typeof K=="string"?di(K):K}return K}var G;function P(R){try{var ee=R.InflateRaw,K=new ee;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)G=R;else throw new Error("zlib does not expose bytesRead")}catch(H){console.error("cannot use native zlib: "+(H.message||H))}}function W(R,ee){if(!G)return ga(R,ee);var K=G.InflateRaw,H=new K,Z=H._processChunk(R.slice(R.l),H._finishFlushFlag);return R.l+=H.bytesRead,Z}function F(R){return G?G.deflateRawSync(R):St(R)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],le=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],pe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ae(R){var ee=(R<<1|R<<11)&139536|(R<<5|R<<15)&558144;return(ee>>16|ee>>8|ee)&255}for(var oe=typeof Uint8Array<"u",ae=oe?new Uint8Array(256):[],ze=0;ze<256;++ze)ae[ze]=Ae(ze);function q(R,ee){var K=ae[R&255];return ee<=8?K>>>8-ee:(K=K<<8|ae[R>>8&255],ee<=16?K>>>16-ee:(K=K<<8|ae[R>>16&255],K>>>24-ee))}function Je(R,ee){var K=ee&7,H=ee>>>3;return(R[H]|(K<=6?0:R[H+1]<<8))>>>K&3}function qe(R,ee){var K=ee&7,H=ee>>>3;return(R[H]|(K<=5?0:R[H+1]<<8))>>>K&7}function ot(R,ee){var K=ee&7,H=ee>>>3;return(R[H]|(K<=4?0:R[H+1]<<8))>>>K&15}function Ke(R,ee){var K=ee&7,H=ee>>>3;return(R[H]|(K<=3?0:R[H+1]<<8))>>>K&31}function He(R,ee){var K=ee&7,H=ee>>>3;return(R[H]|(K<=1?0:R[H+1]<<8))>>>K&127}function wt(R,ee,K){var H=ee&7,Z=ee>>>3,ne=(1<<K)-1,L=R[Z]>>>H;return K<8-H||(L|=R[Z+1]<<8-H,K<16-H)||(L|=R[Z+2]<<16-H,K<24-H)||(L|=R[Z+3]<<24-H),L&ne}function mt(R,ee,K){var H=ee&7,Z=ee>>>3;return H<=5?R[Z]|=(K&7)<<H:(R[Z]|=K<<H&255,R[Z+1]=(K&7)>>8-H),ee+3}function Ge(R,ee,K){var H=ee&7,Z=ee>>>3;return K=(K&1)<<H,R[Z]|=K,ee+1}function ut(R,ee,K){var H=ee&7,Z=ee>>>3;return K<<=H,R[Z]|=K&255,K>>>=8,R[Z+1]=K,ee+8}function ct(R,ee,K){var H=ee&7,Z=ee>>>3;return K<<=H,R[Z]|=K&255,K>>>=8,R[Z+1]=K&255,R[Z+2]=K>>>8,ee+16}function dt(R,ee){var K=R.length,H=2*K>ee?2*K:ee+5,Z=0;if(K>=ee)return R;if(qt){var ne=U4(H);if(R.copy)R.copy(ne);else for(;Z<R.length;++Z)ne[Z]=R[Z];return ne}else if(oe){var L=new Uint8Array(H);if(L.set)L.set(R);else for(;Z<K;++Z)L[Z]=R[Z];return L}return R.length=H,R}function at(R){for(var ee=new Array(R),K=0;K<R;++K)ee[K]=0;return ee}function Wt(R,ee,K){var H=1,Z=0,ne=0,L=0,he=0,fe=R.length,de=oe?new Uint16Array(32):at(32);for(ne=0;ne<32;++ne)de[ne]=0;for(ne=fe;ne<K;++ne)R[ne]=0;fe=R.length;var we=oe?new Uint16Array(fe):at(fe);for(ne=0;ne<fe;++ne)de[Z=R[ne]]++,H<Z&&(H=Z),we[ne]=0;for(de[0]=0,ne=1;ne<=H;++ne)de[ne+16]=he=he+de[ne-1]<<1;for(ne=0;ne<fe;++ne)he=R[ne],he!=0&&(we[ne]=de[he+16]++);var Pe=0;for(ne=0;ne<fe;++ne)if(Pe=R[ne],Pe!=0)for(he=q(we[ne],H)>>H-Pe,L=(1<<H+4-Pe)-1;L>=0;--L)ee[he|L<<Pe]=Pe&15|ne<<4;return H}var Oe=oe?new Uint16Array(512):at(512),st=oe?new Uint16Array(32):at(32);if(!oe){for(var Fe=0;Fe<512;++Fe)Oe[Fe]=0;for(Fe=0;Fe<32;++Fe)st[Fe]=0}(function(){for(var R=[],ee=0;ee<32;ee++)R.push(5);Wt(R,st,32);var K=[];for(ee=0;ee<=143;ee++)K.push(8);for(;ee<=255;ee++)K.push(9);for(;ee<=279;ee++)K.push(7);for(;ee<=287;ee++)K.push(8);Wt(K,Oe,288)})();var nr=(function(){for(var ee=oe?new Uint8Array(32768):[],K=0,H=0;K<pe.length-1;++K)for(;H<pe[K+1];++H)ee[H]=K;for(;H<32768;++H)ee[H]=29;var Z=oe?new Uint8Array(259):[];for(K=0,H=0;K<le.length-1;++K)for(;H<le[K+1];++H)Z[H]=K;function ne(he,fe){for(var de=0;de<he.length;){var we=Math.min(65535,he.length-de),Pe=de+we==he.length;for(fe.write_shift(1,+Pe),fe.write_shift(2,we),fe.write_shift(2,~we&65535);we-- >0;)fe[fe.l++]=he[de++]}return fe.l}function L(he,fe){for(var de=0,we=0,Pe=oe?new Uint16Array(32768):[];we<he.length;){var Re=Math.min(65535,he.length-we);if(Re<10){for(de=mt(fe,de,+(we+Re==he.length)),de&7&&(de+=8-(de&7)),fe.l=de/8|0,fe.write_shift(2,Re),fe.write_shift(2,~Re&65535);Re-- >0;)fe[fe.l++]=he[we++];de=fe.l*8;continue}de=mt(fe,de,+(we+Re==he.length)+2);for(var Ve=0;Re-- >0;){var C=he[we];Ve=(Ve<<5^C)&32767;var J=-1,xe=0;if((J=Pe[Ve])&&(J|=we&-32768,J>we&&(J-=32768),J<we))for(;he[J+xe]==he[we+xe]&&xe<250;)++xe;if(xe>2){C=Z[xe],C<=22?de=ut(fe,de,ae[C+1]>>1)-1:(ut(fe,de,3),de+=5,ut(fe,de,ae[C-23]>>5),de+=3);var Ee=C<8?0:C-4>>2;Ee>0&&(ct(fe,de,xe-le[C]),de+=Ee),C=ee[we-J],de=ut(fe,de,ae[C]>>3),de-=3;var Ce=C<4?0:C-2>>1;Ce>0&&(ct(fe,de,we-J-pe[C]),de+=Ce);for(var Se=0;Se<xe;++Se)Pe[Ve]=we&32767,Ve=(Ve<<5^he[we])&32767,++we;Re-=xe-1}else C<=143?C=C+48:de=Ge(fe,de,1),de=ut(fe,de,ae[C]),Pe[Ve]=we&32767,++we}de=ut(fe,de,0)-1}return fe.l=(de+7)/8|0,fe.l}return function(fe,de){return fe.length<8?ne(fe,de):L(fe,de)}})();function St(R){var ee=Ie(50+Math.floor(R.length*1.1)),K=nr(R,ee);return ee.slice(0,K)}var Zt=oe?new Uint16Array(32768):at(32768),mr=oe?new Uint16Array(32768):at(32768),er=oe?new Uint16Array(128):at(128),ar=1,Yr=1;function Tr(R,ee){var K=Ke(R,ee)+257;ee+=5;var H=Ke(R,ee)+1;ee+=5;var Z=ot(R,ee)+4;ee+=4;for(var ne=0,L=oe?new Uint8Array(19):at(19),he=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],fe=1,de=oe?new Uint8Array(8):at(8),we=oe?new Uint8Array(8):at(8),Pe=L.length,Re=0;Re<Z;++Re)L[M[Re]]=ne=qe(R,ee),fe<ne&&(fe=ne),de[ne]++,ee+=3;var Ve=0;for(de[0]=0,Re=1;Re<=fe;++Re)we[Re]=Ve=Ve+de[Re-1]<<1;for(Re=0;Re<Pe;++Re)(Ve=L[Re])!=0&&(he[Re]=we[Ve]++);var C=0;for(Re=0;Re<Pe;++Re)if(C=L[Re],C!=0){Ve=ae[he[Re]]>>8-C;for(var J=(1<<7-C)-1;J>=0;--J)er[Ve|J<<C]=C&7|Re<<3}var xe=[];for(fe=1;xe.length<K+H;)switch(Ve=er[He(R,ee)],ee+=Ve&7,Ve>>>=3){case 16:for(ne=3+Je(R,ee),ee+=2,Ve=xe[xe.length-1];ne-- >0;)xe.push(Ve);break;case 17:for(ne=3+qe(R,ee),ee+=3;ne-- >0;)xe.push(0);break;case 18:for(ne=11+He(R,ee),ee+=7;ne-- >0;)xe.push(0);break;default:xe.push(Ve),fe<Ve&&(fe=Ve);break}var Ee=xe.slice(0,K),Ce=xe.slice(K);for(Re=K;Re<286;++Re)Ee[Re]=0;for(Re=H;Re<30;++Re)Ce[Re]=0;return ar=Wt(Ee,Zt,286),Yr=Wt(Ce,mr,30),ee}function Ba(R,ee){if(R[0]==3&&!(R[1]&3))return[co(ee),2];for(var K=0,H=0,Z=U4(ee||1<<18),ne=0,L=Z.length>>>0,he=0,fe=0;(H&1)==0;){if(H=qe(R,K),K+=3,H>>>1)H>>1==1?(he=9,fe=5):(K=Tr(R,K),he=ar,fe=Yr);else{K&7&&(K+=8-(K&7));var de=R[K>>>3]|R[(K>>>3)+1]<<8;if(K+=32,de>0)for(!ee&&L<ne+de&&(Z=dt(Z,ne+de),L=Z.length);de-- >0;)Z[ne++]=R[K>>>3],K+=8;continue}for(;;){!ee&&L<ne+32767&&(Z=dt(Z,ne+32767),L=Z.length);var we=wt(R,K,he),Pe=H>>>1==1?Oe[we]:Zt[we];if(K+=Pe&15,Pe>>>=4,(Pe>>>8&255)===0)Z[ne++]=Pe;else{if(Pe==256)break;Pe-=257;var Re=Pe<8?0:Pe-4>>2;Re>5&&(Re=0);var Ve=ne+le[Pe];Re>0&&(Ve+=wt(R,K,Re),K+=Re),we=wt(R,K,fe),Pe=H>>>1==1?st[we]:mr[we],K+=Pe&15,Pe>>>=4;var C=Pe<4?0:Pe-2>>1,J=pe[Pe];for(C>0&&(J+=wt(R,K,C),K+=C),!ee&&L<Ve&&(Z=dt(Z,Ve+100),L=Z.length);ne<Ve;)Z[ne]=Z[ne-J],++ne}}}return ee?[Z,K+7>>>3]:[Z.slice(0,ne),K+7>>>3]}function ga(R,ee){var K=R.slice(R.l||0),H=Ba(K,ee);return R.l+=H[1],H[0]}function $n(R,ee){if(R)typeof console<"u"&&console.error(ee);else throw new Error(ee)}function $r(R,ee){var K=R;ha(K,0);var H=[],Z=[],ne={FileIndex:H,FullPaths:Z};j(ne,{root:ee.root});for(var L=K.length-4;(K[L]!=80||K[L+1]!=75||K[L+2]!=5||K[L+3]!=6)&&L>=0;)--L;K.l=L+4,K.l+=4;var he=K.read_shift(2);K.l+=6;var fe=K.read_shift(4);for(K.l=fe,L=0;L<he;++L){K.l+=20;var de=K.read_shift(4),we=K.read_shift(4),Pe=K.read_shift(2),Re=K.read_shift(2),Ve=K.read_shift(2);K.l+=8;var C=K.read_shift(4),J=c(K.slice(K.l+Pe,K.l+Pe+Re));K.l+=Pe+Re+Ve;var xe=K.l;K.l=C+4,ra(K,de,we,ne,J),K.l=xe}return ne}function ra(R,ee,K,H,Z){R.l+=2;var ne=R.read_shift(2),L=R.read_shift(2),he=l(R);if(ne&8257)throw new Error("Unsupported ZIP encryption");for(var fe=R.read_shift(4),de=R.read_shift(4),we=R.read_shift(4),Pe=R.read_shift(2),Re=R.read_shift(2),Ve="",C=0;C<Pe;++C)Ve+=String.fromCharCode(R[R.l++]);if(Re){var J=c(R.slice(R.l,R.l+Re));(J[21589]||{}).mt&&(he=J[21589].mt),((Z||{})[21589]||{}).mt&&(he=Z[21589].mt)}R.l+=Re;var xe=R.slice(R.l,R.l+de);switch(L){case 8:xe=W(R,we);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+L)}var Ee=!1;ne&8&&(fe=R.read_shift(4),fe==134695760&&(fe=R.read_shift(4),Ee=!0),de=R.read_shift(4),we=R.read_shift(4)),de!=ee&&$n(Ee,"Bad compressed size: "+ee+" != "+de),we!=K&&$n(Ee,"Bad uncompressed size: "+K+" != "+we),Ue(H,Ve,xe,{unsafe:!0,mt:he})}function zn(R,ee){var K=ee||{},H=[],Z=[],ne=Ie(1),L=K.compression?8:0,he=0,fe=0,de=0,we=0,Pe=0,Re=R.FullPaths[0],Ve=Re,C=R.FileIndex[0],J=[],xe=0;for(fe=1;fe<R.FullPaths.length;++fe)if(Ve=R.FullPaths[fe].slice(Re.length),C=R.FileIndex[fe],!(!C.size||!C.content||Ve=="Sh33tJ5")){var Ee=we,Ce=Ie(Ve.length);for(de=0;de<Ve.length;++de)Ce.write_shift(1,Ve.charCodeAt(de)&127);Ce=Ce.slice(0,Ce.l),J[Pe]=yne.buf(C.content,0);var Se=C.content;L==8&&(Se=F(Se)),ne=Ie(30),ne.write_shift(4,67324752),ne.write_shift(2,20),ne.write_shift(2,he),ne.write_shift(2,L),C.mt?i(ne,C.mt):ne.write_shift(4,0),ne.write_shift(-4,J[Pe]),ne.write_shift(4,Se.length),ne.write_shift(4,C.content.length),ne.write_shift(2,Ce.length),ne.write_shift(2,0),we+=ne.length,H.push(ne),we+=Ce.length,H.push(Ce),we+=Se.length,H.push(Se),ne=Ie(46),ne.write_shift(4,33639248),ne.write_shift(2,0),ne.write_shift(2,20),ne.write_shift(2,he),ne.write_shift(2,L),ne.write_shift(4,0),ne.write_shift(-4,J[Pe]),ne.write_shift(4,Se.length),ne.write_shift(4,C.content.length),ne.write_shift(2,Ce.length),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(4,0),ne.write_shift(4,Ee),xe+=ne.l,Z.push(ne),xe+=Ce.length,Z.push(Ce),++Pe}return ne=Ie(22),ne.write_shift(4,101010256),ne.write_shift(2,0),ne.write_shift(2,0),ne.write_shift(2,Pe),ne.write_shift(2,Pe),ne.write_shift(4,xe),ne.write_shift(4,we),ne.write_shift(2,0),Xn([Xn(H),Xn(Z),ne])}var pr={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Hn(R,ee){if(R.ctype)return R.ctype;var K=R.name||"",H=K.match(/\.([^\.]+)$/);return H&&pr[H[1]]||ee&&(H=(K=ee).match(/[\.\\]([^\.\\])+$/),H&&pr[H[1]])?pr[H[1]]:"application/octet-stream"}function lr(R){for(var ee=Qd(R),K=[],H=0;H<ee.length;H+=76)K.push(ee.slice(H,H+76));return K.join(`\r
`)+`\r
`}function wn(R){var ee=R.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(de){var we=de.charCodeAt(0).toString(16).toUpperCase();return"="+(we.length==1?"0"+we:we)});ee=ee.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ee.charAt(0)==`
`&&(ee="=0D"+ee.slice(1)),ee=ee.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],H=ee.split(`\r
`),Z=0;Z<H.length;++Z){var ne=H[Z];if(ne.length==0){K.push("");continue}for(var L=0;L<ne.length;){var he=76,fe=ne.slice(L,L+he);fe.charAt(he-1)=="="?he--:fe.charAt(he-2)=="="?he-=2:fe.charAt(he-3)=="="&&(he-=3),fe=ne.slice(L,L+he),L+=he,L<ne.length&&(fe+="="),K.push(fe)}}return K.join(`\r
`)}function zr(R){for(var ee=[],K=0;K<R.length;++K){for(var H=R[K];K<=R.length&&H.charAt(H.length-1)=="=";)H=H.slice(0,H.length-1)+R[++K];ee.push(H)}for(var Z=0;Z<ee.length;++Z)ee[Z]=ee[Z].replace(/[=][0-9A-Fa-f]{2}/g,function(ne){return String.fromCharCode(parseInt(ne.slice(1),16))});return di(ee.join(`\r
`))}function na(R,ee,K){for(var H="",Z="",ne="",L,he=0;he<10;++he){var fe=ee[he];if(!fe||fe.match(/^\s*$/))break;var de=fe.match(/^(.*?):\s*([^\s].*)$/);if(de)switch(de[1].toLowerCase()){case"content-location":H=de[2].trim();break;case"content-type":ne=de[2].trim();break;case"content-transfer-encoding":Z=de[2].trim();break}}switch(++he,Z.toLowerCase()){case"base64":L=di(bi(ee.slice(he).join("")));break;case"quoted-printable":L=zr(ee.slice(he));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Z)}var we=Ue(R,H.slice(K.length),L,{unsafe:!0});ne&&(we.ctype=ne)}function gr(R,ee){if(Q(R.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=ee&&ee.root||"",H=(qt&&Buffer.isBuffer(R)?R.toString("binary"):Q(R)).split(`\r
`),Z=0,ne="";for(Z=0;Z<H.length;++Z)if(ne=H[Z],!!/^Content-Location:/i.test(ne)&&(ne=ne.slice(ne.indexOf("file")),K||(K=ne.slice(0,ne.lastIndexOf("/")+1)),ne.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),ne.slice(0,K.length)!=K););var L=(H[1]||"").match(/boundary="(.*?)"/);if(!L)throw new Error("MAD cannot find boundary");var he="--"+(L[1]||""),fe=[],de=[],we={FileIndex:fe,FullPaths:de};j(we);var Pe,Re=0;for(Z=0;Z<H.length;++Z){var Ve=H[Z];Ve!==he&&Ve!==he+"--"||(Re++&&na(we,H.slice(Pe,Z),K),Pe=Z)}return we}function Oa(R,ee){var K=ee||{},H=K.boundary||"SheetJS";H="------="+H;for(var Z=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+H.slice(2)+'"',"","",""],ne=R.FullPaths[0],L=ne,he=R.FileIndex[0],fe=1;fe<R.FullPaths.length;++fe)if(L=R.FullPaths[fe].slice(ne.length),he=R.FileIndex[fe],!(!he.size||!he.content||L=="Sh33tJ5")){L=L.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(xe){return"_x"+xe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(xe){return"_u"+xe.charCodeAt(0).toString(16)+"_"});for(var de=he.content,we=qt&&Buffer.isBuffer(de)?de.toString("binary"):Q(de),Pe=0,Re=Math.min(1024,we.length),Ve=0,C=0;C<=Re;++C)(Ve=we.charCodeAt(C))>=32&&Ve<128&&++Pe;var J=Pe>=Re*4/5;Z.push(H),Z.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+L),Z.push("Content-Transfer-Encoding: "+(J?"quoted-printable":"base64")),Z.push("Content-Type: "+Hn(he,L)),Z.push(""),Z.push(J?wn(we):lr(we))}return Z.push(H+`--\r
`),Z.join(`\r
`)}function pn(R){var ee={};return j(ee,R),ee}function Ue(R,ee,K,H){var Z=H&&H.unsafe;Z||j(R);var ne=!Z&&kt.find(R,ee);if(!ne){var L=R.FullPaths[0];ee.slice(0,L.length)==L?L=ee:(L.slice(-1)!="/"&&(L+="/"),L=(L+ee).replace("//","/")),ne={name:a(ee),type:2},R.FileIndex.push(ne),R.FullPaths.push(L),Z||kt.utils.cfb_gc(R)}return ne.content=K,ne.size=K?K.length:0,H&&(H.CLSID&&(ne.clsid=H.CLSID),H.mt&&(ne.mt=H.mt),H.ct&&(ne.ct=H.ct)),ne}function Le(R,ee){j(R);var K=kt.find(R,ee);if(K){for(var H=0;H<R.FileIndex.length;++H)if(R.FileIndex[H]==K)return R.FileIndex.splice(H,1),R.FullPaths.splice(H,1),!0}return!1}function it(R,ee,K){j(R);var H=kt.find(R,ee);if(H){for(var Z=0;Z<R.FileIndex.length;++Z)if(R.FileIndex[Z]==H)return R.FileIndex[Z].name=a(K),R.FullPaths[Z]=K,!0}return!1}function Tt(R){U(R,!0)}return t.find=te,t.read=O,t.parse=m,t.write=re,t.writeFile=se,t.utils={cfb_new:pn,cfb_add:Ue,cfb_del:Le,cfb_mov:it,cfb_gc:Tt,ReadShift:Ed,CheckField:X5,prep_blob:ha,bconcat:Xn,use_zlib:P,_deflateRaw:St,_inflateRaw:ga,consts:ue},t})();function bne(e){return typeof e=="string"?Yg(e):Array.isArray(e)?Vre(e):e}function B0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Yg(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Ns(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([bne(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var l=document.createElement("a");if(l.download!=null)return l.download=e,l.href=i,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=bo(t)),c.write(t),c.close(),t}catch(f){if(!f.message||!f.message.match(/onstruct/))throw f}throw new Error("cannot save file "+e)}function wne(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function hn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function K4(e,t){for(var r=[],n=hn(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Jg(e){for(var t=[],r=hn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Zg(e){for(var t=[],r=hn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function _ne(e){for(var t=[],r=hn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var qp=new Date(1899,11,30,0,0,0);function Fn(e,t){var r=e.getTime(),n=qp.getTime()+(e.getTimezoneOffset()-qp.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var A5=new Date,Sne=qp.getTime()+(A5.getTimezoneOffset()-qp.getTimezoneOffset())*6e4,X4=A5.getTimezoneOffset();function ev(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Sne),t.getTimezoneOffset()!==X4&&t.setTime(t.getTime()+(t.getTimezoneOffset()-X4)*6e4),t}function Ene(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var i=1;i!=a.length;++i)if(a[i]){switch(r=1,i>3&&(n=!0),a[i].slice(a[i].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[i].slice(a[i].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[i],10)}return t}var Y4=new Date("2017-02-19T19:06:09.000Z"),j5=isNaN(Y4.getFullYear())?new Date("2/19/17"):Y4,Nne=j5.getFullYear()==2017;function Kr(e,t){var r=new Date(e);if(Nne)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(j5.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function wc(e,t){if(qt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Ns(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Ns(g5(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Ns(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Ns(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Xr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Xr(e[r]));return t}function fn(e,t){for(var r="";r.length<t;)r+=e;return r}function ls(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var kne=["january","february","march","april","may","june","july","august","september","october","november","december"];function Yu(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var l=e.toLowerCase();if(l.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(l=l.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),l.length>3&&kne.indexOf(l)==-1)return r}else if(l.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Tne=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var i=r.split(n),l=[i[0]],c=1;c<i.length;++c)l.push(a),l.push(i[c]);return l}})();function O5(e){return e?e.content&&e.type?wc(e.content,!0):e.data?yd(e.data):e.asNodeBuffer&&qt?yd(e.asNodeBuffer().toString("binary")):e.asBinary?yd(e.asBinary()):e._data&&e._data.getContent?yd(wc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function C5(e){if(!e)return null;if(e.data)return L4(e.data);if(e.asNodeBuffer&&qt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?L4(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Ane(e){return e&&e.name.slice(-4)===".bin"?C5(e):O5(e)}function Fi(e,t){for(var r=e.FullPaths||hn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),i=0;i<r.length;++i){var l=r[i].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==l||a==l)return e.files?e.files[r[i]]:e.FileIndex[i]}return null}function iS(e,t){var r=Fi(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Tn(e,t,r){if(!r)return Ane(iS(e,t));if(!t)return null;try{return Tn(e,t)}catch{return null}}function hi(e,t,r){if(!r)return O5(iS(e,t));if(!t)return null;try{return hi(e,t)}catch{return null}}function jne(e,t,r){return C5(iS(e,t))}function Q4(e){for(var t=e.FullPaths||hn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function zt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return qt?n=Sl(r):n=Gre(r),kt.utils.cfb_add(e,t,n)}kt.utils.cfb_add(e,t,r)}else e.file(t,r)}function sS(){return kt.utils.cfb_new()}function D5(e,t){switch(t.type){case"base64":return kt.read(e,{type:"base64"});case"binary":return kt.read(e,{type:"binary"});case"buffer":case"array":return kt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function wd(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var bn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,One=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,J4=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Cne=/<[^>]*>/g,ja=bn.match(J4)?J4:Cne,Dne=/<\w*:/,Ine=/<(\/?)\w+:/;function Pt(e,t,r){for(var n={},a=0,i=0;a!==e.length&&!((i=e.charCodeAt(a))===32||i===10||i===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var l=e.match(One),c=0,f="",d=0,m="",p="",v=1;if(l)for(d=0;d!=l.length;++d){for(p=l[d],i=0;i!=p.length&&p.charCodeAt(i)!==61;++i);for(m=p.slice(0,i).trim();p.charCodeAt(i+1)==32;)++i;for(v=(a=p.charCodeAt(i+1))==34||a==39?1:0,f=p.slice(i+1+v,p.length-v),c=0;c!=m.length&&m.charCodeAt(c)!==58;++c);if(c===m.length)m.indexOf("_")>0&&(m=m.slice(0,m.indexOf("_"))),n[m]=f,n[m.toLowerCase()]=f;else{var x=(c===5&&m.slice(0,5)==="xmlns"?"xmlns":"")+m.slice(c+1);if(n[x]&&m.slice(c-3,c)=="ext")continue;n[x]=f,n[x.toLowerCase()]=f}}return n}function Ds(e){return e.replace(Ine,"<$1")}var I5={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},lS=Jg(I5),ir=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",i=a.indexOf("<![CDATA[");if(i==-1)return a.replace(e,function(c,f){return I5[c]||String.fromCharCode(parseInt(f,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,f){return String.fromCharCode(parseInt(f,16))});var l=a.indexOf("]]>");return r(a.slice(0,i))+a.slice(i+9,l)+r(a.slice(l+3))}})(),oS=/[&<>'"]/g,Pne=/[\u0000-\u0008\u000b-\u001f]/g;function Nr(e){var t=e+"";return t.replace(oS,function(r){return lS[r]}).replace(Pne,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Z4(e){return Nr(e).replace(/ /g,"_x0020_")}var P5=/[\u0000-\u001f]/g;function cS(e){var t=e+"";return t.replace(oS,function(r){return lS[r]}).replace(/\n/g,"<br/>").replace(P5,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function Mne(e){var t=e+"";return t.replace(oS,function(r){return lS[r]}).replace(P5,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var e3=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function Rne(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Vr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function nb(e){for(var t="",r=0,n=0,a=0,i=0,l=0,c=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){l=(n&31)<<6,l|=a&63,t+=String.fromCharCode(l);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}l=e.charCodeAt(r++),c=((n&7)<<18|(a&63)<<12|(i&63)<<6|l&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function t3(e){var t=co(2*e.length),r,n,a=1,i=0,l=0,c;for(n=0;n<e.length;n+=a)a=1,(c=e.charCodeAt(n))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(n+1)&63),a=2):c<240?(r=(c&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(c&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,l=55296+(r>>>10&1023),r=56320+(r&1023)),l!==0&&(t[i++]=l&255,t[i++]=l>>>8,l=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function r3(e){return Sl(e,"binary").toString("utf8")}var Sm="foo bar baz",Ir=qt&&(r3(Sm)==nb(Sm)&&r3||t3(Sm)==nb(Sm)&&t3)||nb,Ns=qt?function(e){return Sl(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Zd=(function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),M5=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}})(),Fne=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),Lne=/<\/?(?:vt:)?variant>/g,Bne=/<(?:vt:)([^>]*)>([\s\S]*)</;function n3(e,t){var r=Pt(e),n=e.match(Fne(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(i){var l=i.replace(Lne,"").match(Bne);l&&a.push({v:Ir(l[2]),t:l[1]})}),a}var R5=/(^\s|\s$|\n)/;function ma(e,t){return"<"+e+(t.match(R5)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function e0(e){return hn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ze(e,t,r){return"<"+e+(r!=null?e0(r):"")+(t!=null?(t.match(R5)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Iw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function Une(e,t){switch(typeof e){case"string":var r=Ze("vt:lpwstr",Nr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ze((e|0)==e?"vt:i4":"vt:r8",Nr(String(e)));case"boolean":return Ze("vt:bool",e?"true":"false")}if(e instanceof Date)return Ze("vt:filetime",Iw(e));throw new Error("Unable to serialize "+e)}function uS(e){if(qt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ir(bo(rS(e)));throw new Error("Bad input format: expected Buffer or string")}var t0=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Rn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Oc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],ci={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $ne(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function zne(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,l=n?-t:t;isFinite(l)?l==0?a=i=0:(a=Math.floor(Math.log(l)/Math.LN2),i=l*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var c=0;c<=5;++c,i/=256)e[r+c]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var a3=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},i3=qt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Sl(t)})):a3(e)}:a3,s3=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(rl(e,a)));return n.join("").replace(Ra,"")},fS=qt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Ra,""):s3(e,t,r)}:s3,l3=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},F5=qt?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):l3(e,t,r)}:l3,o3=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Tu(e,a)));return n.join("")},U0=qt?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):o3(t,r,n)}:o3,L5=function(e,t){var r=ui(e,t);return r>0?U0(e,t+4,t+4+r-1):""},B5=L5,U5=function(e,t){var r=ui(e,t);return r>0?U0(e,t+4,t+4+r-1):""},$5=U5,z5=function(e,t){var r=2*ui(e,t);return r>0?U0(e,t+4,t+4+r-1):""},H5=z5,q5=function(t,r){var n=ui(t,r);return n>0?fS(t,r+4,r+4+n):""},W5=q5,V5=function(e,t){var r=ui(e,t);return r>0?U0(e,t+4,t+4+r):""},G5=V5,K5=function(e,t){return $ne(e,t)},Wp=K5,dS=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};qt&&(B5=function(t,r){if(!Buffer.isBuffer(t))return L5(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},$5=function(t,r){if(!Buffer.isBuffer(t))return U5(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},H5=function(t,r){if(!Buffer.isBuffer(t))return z5(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},W5=function(t,r){if(!Buffer.isBuffer(t))return q5(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},G5=function(t,r){if(!Buffer.isBuffer(t))return V5(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},Wp=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):K5(t,r)},dS=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Tu=function(e,t){return e[t]},rl=function(e,t){return e[t+1]*256+e[t]},Hne=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},ui=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Go=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},qne=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Ed(e,t){var r="",n,a,i=[],l,c,f,d;switch(t){case"dbcs":if(d=this.l,qt&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(f=0;f<e;++f)r+=String.fromCharCode(rl(this,d)),d+=2;e*=2;break;case"utf8":r=U0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=fS(this,this.l,this.l+e);break;case"wstr":return Ed.call(this,e,"dbcs");case"lpstr-ansi":r=B5(this,this.l),e=4+ui(this,this.l);break;case"lpstr-cp":r=$5(this,this.l),e=4+ui(this,this.l);break;case"lpwstr":r=H5(this,this.l),e=4+2*ui(this,this.l);break;case"lpp4":e=4+ui(this,this.l),r=W5(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ui(this,this.l),r=G5(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(l=Tu(this,this.l+e++))!==0;)i.push(_m(l));r=i.join("");break;case"_wstr":for(e=0,r="";(l=rl(this,this.l+e))!==0;)i.push(_m(l)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",d=this.l,f=0;f<e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Tu(this,d),this.l=d+1,c=Ed.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(_m(rl(this,d))),d+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",d=this.l,f=0;f!=e;++f){if(this.lens&&this.lens.indexOf(d)!==-1)return l=Tu(this,d),this.l=d+1,c=Ed.call(this,e-f,l?"dbcs-cont":"sbcs-cont"),i.join("")+c;i.push(_m(Tu(this,d))),d+=1}r=i.join("");break;default:switch(e){case 1:return n=Tu(this,this.l),this.l++,n;case 2:return n=(t==="i"?Hne:rl)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Go:qne)(this,this.l),this.l+=4,n):(a=ui(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=Wp(this,this.l):a=Wp([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=F5(this,this.l,e);break}}return this.l+=e,r}var Wne=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},Vne=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},Gne=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function Kne(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)Gne(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var l=t.charCodeAt(a);this[this.l++]=l&255,this[this.l++]=l>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,Wne(this,t,this.l);break;case 8:if(n=8,r==="f"){zne(this,t,this.l);break}case 16:break;case-4:n=4,Vne(this,t,this.l);break}return this.l+=n,this}function X5(e,t){var r=F5(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ha(e,t){e.l=t,e.read_shift=Ed,e.chk=X5,e.write_shift=Kne}function Aa(e,t){e.l+=t}function Ie(e){var t=co(e);return ha(t,0),t}function El(e,t,r){if(e){var n,a,i;ha(e,e.l||0);for(var l=e.length,c=0,f=0;e.l<l;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var d=l0[c]||l0[65535];for(n=e.read_shift(1),i=n&127,a=1;a<4&&n&128;++a)i+=((n=e.read_shift(1))&127)<<7*a;f=e.l+i;var m=d.f&&d.f(e,i,r);if(e.l=f,t(m,d,c))return}}}function Xa(){var e=[],t=qt?256:2048,r=function(d){var m=Ie(d);return ha(m,0),m},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(d){return n&&d<n.length-n.l?n:(a(),n=r(Math.max(d+1,t)))},l=function(){return a(),Xn(e)},c=function(d){a(),n=d,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:c,end:l,_bufs:e}}function We(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=l0[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var l=e.next(i);a<=127?l.write_shift(1,a):(l.write_shift(1,(a&127)+128),l.write_shift(1,a>>7));for(var c=0;c!=4;++c)if(n>=128)l.write_shift(1,(n&127)+128),n>>=7;else{l.write_shift(1,n);break}n>0&&dS(r)&&e.push(r)}}function Nd(e,t,r){var n=Xr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function c3(e,t,r){var n=Xr(e);return n.s=Nd(n.s,t.s,r),n.e=Nd(n.e,t.s,r),n}function kd(e,t){if(e.cRel&&e.c<0)for(e=Xr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Xr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=It(e);return!e.cRel&&e.cRel!=null&&(r=Qne(r)),!e.rRel&&e.rRel!=null&&(r=Xne(r)),r}function ab(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+tn(e.s.c)+":"+(e.e.cRel?"":"$")+tn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+yn(e.s.r)+":"+(e.e.rRel?"":"$")+yn(e.e.r):kd(e.s,t.biff)+":"+kd(e.e,t.biff)}function hS(e){return parseInt(Yne(e),10)-1}function yn(e){return""+(e+1)}function Xne(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Yne(e){return e.replace(/\$(\d+)$/,"$1")}function mS(e){for(var t=Jne(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function tn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function Qne(e){return e.replace(/^([A-Z])/,"$$$1")}function Jne(e){return e.replace(/^\$([A-Z])/,"$1")}function Zne(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function rn(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function It(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ya(e){var t=e.indexOf(":");return t==-1?{s:rn(e),e:rn(e)}:{s:rn(e.slice(0,t)),e:rn(e.slice(t+1))}}function Ut(e,t){return typeof t>"u"||typeof t=="number"?Ut(e.s,e.e):(typeof e!="string"&&(e=It(e)),typeof t!="string"&&(t=It(t)),e==t?e:e+":"+t)}function sr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function u3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=qi(e.z,r?Fn(t):t)}catch{}try{return e.w=qi((e.XF||{}).numFmtId||(r?14:0),r?Fn(t):t)}catch{return""+t}}function pl(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Nl[e.v]||e.v:t==null?u3(e,e.v):u3(e,t))}function wo(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function Y5(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),l=0,c=0;if(i&&n.origin!=null){if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?rn(n.origin):n.origin;l=f.r,c=f.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var m=sr(i["!ref"]);d.s.c=m.s.c,d.s.r=m.s.r,d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),l==-1&&(d.e.r=l=m.e.r+1)}for(var p=0;p!=t.length;++p)if(t[p]){if(!Array.isArray(t[p]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[p].length;++v)if(!(typeof t[p][v]>"u")){var x={v:t[p][v]},y=l+p,b=c+v;if(d.s.r>y&&(d.s.r=y),d.s.c>b&&(d.s.c=b),d.e.r<y&&(d.e.r=y),d.e.c<b&&(d.e.c=b),t[p][v]&&typeof t[p][v]=="object"&&!Array.isArray(t[p][v])&&!(t[p][v]instanceof Date))x=t[p][v];else if(Array.isArray(x.v)&&(x.f=t[p][v][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(n.nullError)x.t="e",x.v=0;else if(n.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=n.dateNF||Dt[14],n.cellDates?(x.t="d",x.w=qi(x.z,Fn(x.v))):(x.t="n",x.v=Fn(x.v),x.w=qi(x.z,x.v))):x.t="s";if(a)i[y]||(i[y]=[]),i[y][b]&&i[y][b].z&&(x.z=i[y][b].z),i[y][b]=x;else{var _=It({c:b,r:y});i[_]&&i[_].z&&(x.z=i[_].z),i[_]=x}}}return d.s.c<1e7&&(i["!ref"]=Ut(d)),i}function mf(e,t){return Y5(null,e,t)}function eae(e){return e.read_shift(4,"i")}function os(e,t){return t||(t=Ie(4)),t.write_shift(4,e),t}function Ta(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Qn(e,t){var r=!1;return t==null&&(r=!0,t=Ie(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function tae(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function rae(e,t){return t||(t=Ie(4)),t.write_shift(2,0),t.write_shift(2,0),t}function pS(e,t){var r=e.l,n=e.read_shift(1),a=Ta(e),i=[],l={t:a,h:a};if((n&1)!==0){for(var c=e.read_shift(4),f=0;f!=c;++f)i.push(tae(e));l.r=i}else l.r=[{ich:0,ifnt:0}];return e.l=r+t,l}function nae(e,t){var r=!1;return t==null&&(r=!0,t=Ie(15+4*e.t.length)),t.write_shift(1,0),Qn(e.t,t),r?t.slice(0,t.l):t}var aae=pS;function iae(e,t){var r=!1;return t==null&&(r=!0,t=Ie(23+4*e.t.length)),t.write_shift(1,1),Qn(e.t,t),t.write_shift(4,1),rae({},t),r?t.slice(0,t.l):t}function Vi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Cc(e,t){return t==null&&(t=Ie(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Dc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Ic(e,t){return t==null&&(t=Ie(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var sae=Ta,Q5=Qn;function gS(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function Vp(e,t){var r=!1;return t==null&&(r=!0,t=Ie(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var lae=Ta,Pw=gS,vS=Vp;function xS(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?Wp([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Go(t,0)>>2;return r?a/100:a}function J5(e,t){t==null&&(t=Ie(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Z5(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function oae(e,t){return t||(t=Ie(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Pc=Z5,pf=oae;function Na(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function _c(e,t){return(t||Ie(8)).write_shift(8,e,"f")}function cae(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),l=e.read_shift(1),c=e.read_shift(1),f=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var d=lc[a];d&&(t.rgb=n0(d));break;case 2:t.rgb=n0([l,c,f]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function Gp(e,t){if(t||(t=Ie(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function uae(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function fae(e,t){t||(t=Ie(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function e6(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function dae(e){return e6(e,1)}function hae(e){return e6(e,2)}var yS=2,Va=3,Em=11,f3=12,Kp=19,Nm=64,mae=65,pae=71,gae=4108,vae=4126,Kn=80,t6=81,xae=[Kn,t6],Mw={1:{n:"CodePage",t:yS},2:{n:"Category",t:Kn},3:{n:"PresentationFormat",t:Kn},4:{n:"ByteCount",t:Va},5:{n:"LineCount",t:Va},6:{n:"ParagraphCount",t:Va},7:{n:"SlideCount",t:Va},8:{n:"NoteCount",t:Va},9:{n:"HiddenCount",t:Va},10:{n:"MultimediaClipCount",t:Va},11:{n:"ScaleCrop",t:Em},12:{n:"HeadingPairs",t:gae},13:{n:"TitlesOfParts",t:vae},14:{n:"Manager",t:Kn},15:{n:"Company",t:Kn},16:{n:"LinksUpToDate",t:Em},17:{n:"CharacterCount",t:Va},19:{n:"SharedDoc",t:Em},22:{n:"HyperlinksChanged",t:Em},23:{n:"AppVersion",t:Va,p:"version"},24:{n:"DigSig",t:mae},26:{n:"ContentType",t:Kn},27:{n:"ContentStatus",t:Kn},28:{n:"Language",t:Kn},29:{n:"Version",t:Kn},255:{},2147483648:{n:"Locale",t:Kp},2147483651:{n:"Behavior",t:Kp},1919054434:{}},Rw={1:{n:"CodePage",t:yS},2:{n:"Title",t:Kn},3:{n:"Subject",t:Kn},4:{n:"Author",t:Kn},5:{n:"Keywords",t:Kn},6:{n:"Comments",t:Kn},7:{n:"Template",t:Kn},8:{n:"LastAuthor",t:Kn},9:{n:"RevNumber",t:Kn},10:{n:"EditTime",t:Nm},11:{n:"LastPrinted",t:Nm},12:{n:"CreatedDate",t:Nm},13:{n:"ModifiedDate",t:Nm},14:{n:"PageCount",t:Va},15:{n:"WordCount",t:Va},16:{n:"CharCount",t:Va},17:{n:"Thumbnail",t:pae},18:{n:"Application",t:Kn},19:{n:"DocSecurity",t:Va},255:{},2147483648:{n:"Locale",t:Kp},2147483651:{n:"Behavior",t:Kp},1919054434:{}},d3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},yae=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function bae(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var wae=bae([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),lc=Xr(wae),Nl={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},r6={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Fw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},km={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function bS(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function _ae(e){var t=bS();if(!e||!e.match)return t;var r={};if((e.match(ja)||[]).forEach(function(n){var a=Pt(n);switch(a[0].replace(Dne,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Fw[a.ContentType]]!==void 0&&t[Fw[a.ContentType]].push(a.PartName);break}}),t.xmlns!==Rn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function n6(e,t){var r=_ne(Fw),n=[],a;n[n.length]=bn,n[n.length]=Ze("Types",null,{xmlns:Rn.CT,"xmlns:xsd":Rn.xsd,"xmlns:xsi":Rn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(f){return Ze("Default",null,{Extension:f[0],ContentType:f[1]})}));var i=function(f){e[f]&&e[f].length>0&&(a=e[f][0],n[n.length]=Ze("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:km[f][t.bookType]||km[f].xlsx}))},l=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:km[f][t.bookType]||km[f].xlsx})})},c=function(f){(e[f]||[]).forEach(function(d){n[n.length]=Ze("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:r[f][0]})})};return i("workbooks"),l("sheets"),l("charts"),c("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),l("metadata"),c("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Gt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function r0(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Td(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(ja)||[]).forEach(function(a){var i=Pt(a);if(i[0]==="<Relationship"){var l={};l.Type=i.Type,l.Target=i.Target,l.Id=i.Id,i.TargetMode&&(l.TargetMode=i.TargetMode);var c=i.TargetMode==="External"?i.Target:wd(i.Target,t);r[c]=l,n[i.Id]=l}}),r["!id"]=n,r}function Lu(e){var t=[bn,Ze("Relationships",null,{xmlns:Rn.RELS})];return hn(e["!id"]).forEach(function(r){t[t.length]=Ze("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function _r(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Gt.HLINK,Gt.XPATH,Gt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}var Sae="application/vnd.oasis.opendocument.spreadsheet";function Eae(e,t){for(var r=uS(e),n,a;n=t0.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Pt(n[0],!1),a.path=="/"&&a.type!==Sae)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function Nae(e){var t=[bn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function h3(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function kae(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function Tae(e){var t=[bn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(h3(e[r][0],e[r][1])),t.push(kae("",e[r][0]));return t.push(h3("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function a6(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Up.version+"</meta:generator></office:meta></office:document-meta>"}var Ui=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Aae=(function(){for(var e=new Array(Ui.length),t=0;t<Ui.length;++t){var r=Ui[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function i6(e){var t={};e=Ir(e);for(var r=0;r<Ui.length;++r){var n=Ui[r],a=e.match(Aae[r]);a!=null&&a.length>0&&(t[n[1]]=ir(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Kr(t[n[1]]))}return t}function ib(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=Nr(t),n[n.length]=r?Ze(e,t,r):ma(e,t))}function s6(e,t){var r=t||{},n=[bn,Ze("cp:coreProperties",null,{"xmlns:cp":Rn.CORE_PROPS,"xmlns:dc":Rn.dc,"xmlns:dcterms":Rn.dcterms,"xmlns:dcmitype":Rn.dcmitype,"xmlns:xsi":Rn.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&ib("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Iw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&ib("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Iw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Ui.length;++i){var l=Ui[i],c=r.Props&&r.Props[l[1]]!=null?r.Props[l[1]]:e?e[l[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&ib(l[0],c,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var oc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],l6=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function o6(e,t,r,n){var a=[];if(typeof e=="string")a=n3(e,n);else for(var i=0;i<e.length;++i)a=a.concat(e[i].map(function(m){return{v:m}}));var l=typeof t=="string"?n3(t,n).map(function(m){return m.v}):t,c=0,f=0;if(l.length>0)for(var d=0;d!==a.length;d+=2){switch(f=+a[d+1].v,a[d].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=f,r.SheetNames=l.slice(c,c+f);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=f,r.DefinedNames=l.slice(c,c+f);break;case"Charts":case"Diagramme":r.Chartsheets=f,r.ChartNames=l.slice(c,c+f);break}c+=f}}function jae(e,t,r){var n={};return t||(t={}),e=Ir(e),oc.forEach(function(a){var i=(e.match(Zd(a[0]))||[])[1];switch(a[2]){case"string":i&&(t[a[1]]=ir(i));break;case"bool":t[a[1]]=i==="true";break;case"raw":var l=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));l&&l.length>0&&(n[a[1]]=l[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&o6(n.HeadingPairs,n.TitlesOfParts,t,r),t}function c6(e){var t=[],r=Ze;return e||(e={}),e.Application="SheetJS",t[t.length]=bn,t[t.length]=Ze("Properties",null,{xmlns:Rn.EXT_PROPS,"xmlns:vt":Rn.vt}),oc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=Nr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Nr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Oae=/<[^>]+>[^<]*/g;function Cae(e,t){var r={},n="",a=e.match(Oae);if(a)for(var i=0;i!=a.length;++i){var l=a[i],c=Pt(l);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ir(c.name);break;case"</property>":n=null;break;default:if(l.indexOf("<vt:")===0){var f=l.split(">"),d=f[0].slice(4),m=f[1];switch(d){case"lpstr":case"bstr":case"lpwstr":r[n]=ir(m);break;case"bool":r[n]=Vr(m);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(m,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(m);break;case"filetime":case"date":r[n]=Kr(m);break;case"cy":case"error":r[n]=ir(m);break;default:if(d.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",l,d,f)}}else if(l.slice(0,2)!=="</"){if(t.WTF)throw new Error(l)}}}return r}function u6(e){var t=[bn,Ze("Properties",null,{xmlns:Rn.CUST_PROPS,"xmlns:vt":Rn.vt})];if(!e)return t.join("");var r=1;return hn(e).forEach(function(a){++r,t[t.length]=Ze("property",Une(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Nr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Lw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},sb;function Dae(e,t,r){sb||(sb=Jg(Lw)),t=sb[t]||t,e[t]=r}function Iae(e,t){var r=[];return hn(Lw).map(function(n){for(var a=0;a<Ui.length;++a)if(Ui[a][1]==n)return Ui[a];for(a=0;a<oc.length;++a)if(oc[a][1]==n)return oc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(ma(Lw[n[1]]||n[1],a))}}),Ze("DocumentProperties",r.join(""),{xmlns:ci.o})}function Pae(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&hn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var l=0;l<Ui.length;++l)if(i==Ui[l][1])return;for(l=0;l<oc.length;++l)if(i==oc[l][1])return;for(l=0;l<r.length;++l)if(i==r[l])return;var c=e[i],f="string";typeof c=="number"?(f="float",c=String(c)):c===!0||c===!1?(f="boolean",c=c?"1":"0"):c=String(c),a.push(Ze(Z4(i),c,{"dt:dt":f}))}}),t&&hn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var l=t[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l instanceof Date?(c="dateTime.tz",l=l.toISOString()):l=String(l),a.push(Ze(Z4(i),l,{"dt:dt":c}))}}),"<"+n+' xmlns="'+ci.o+'">'+a.join("")+"</"+n+">"}function wS(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Mae(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var l=Ie(8);return l.write_shift(4,n),l.write_shift(4,a),l}function f6(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function d6(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function h6(e,t,r){return t===31?d6(e):f6(e,t,r)}function Bw(e,t,r){return h6(e,t,r===!1?0:4)}function Rae(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return h6(e,t,0)}function Fae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Ra,""),e.l-a&2&&(e.l+=2)}return r}function Lae(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Ra,"");return r}function Bae(e){var t=e.l,r=Xp(e,t6);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Xp(e,Va);return[r,n]}function Uae(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Bae(e));return r}function m3(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var i=e.read_shift(4),l=e.read_shift(4);n[i]=e.read_shift(l,t===1200?"utf16le":"utf8").replace(Ra,"").replace(bd,"!"),t===1200&&l%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function m6(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function $ae(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Xp(e,t,r){var n=e.read_shift(2),a,i=r||{};if(e.l+=2,t!==f3&&n!==t&&xae.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===f3?n:t){case 2:return a=e.read_shift(2,"i"),i.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return f6(e,n,4).replace(Ra,"");case 31:return d6(e);case 64:return wS(e);case 65:return m6(e);case 71:return $ae(e);case 80:return Bw(e,n,!i.raw).replace(Ra,"");case 81:return Rae(e,n).replace(Ra,"");case 4108:return Uae(e);case 4126:case 4127:return n==4127?Fae(e):Lae(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function p3(e,t){var r=Ie(4),n=Ie(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Ie(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=Mae(t);break;case 31:case 80:for(n=Ie(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Xn([r,n])}function g3(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),i=[],l=0,c=0,f=-1,d={};for(l=0;l!=a;++l){var m=e.read_shift(4),p=e.read_shift(4);i[l]=[m,p+r]}i.sort(function(A,T){return A[1]-T[1]});var v={};for(l=0;l!=a;++l){if(e.l!==i[l][1]){var x=!0;if(l>0&&t)switch(t[i[l-1][0]].t){case 2:e.l+2===i[l][1]&&(e.l+=2,x=!1);break;case 80:e.l<=i[l][1]&&(e.l=i[l][1],x=!1);break;case 4108:e.l<=i[l][1]&&(e.l=i[l][1],x=!1);break}if((!t||l==0)&&e.l<=i[l][1]&&(x=!1,e.l=i[l][1]),x)throw new Error("Read Error: Expected address "+i[l][1]+" at "+e.l+" :"+l)}if(t){var y=t[i[l][0]];if(v[y.n]=Xp(e,y.t,{raw:!0}),y.p==="version"&&(v[y.n]=String(v[y.n]>>16)+"."+("0000"+String(v[y.n]&65535)).slice(-4)),y.n=="CodePage")switch(v[y.n]){case 0:v[y.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:ns(c=v[y.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[y.n])}}else if(i[l][0]===1){if(c=v.CodePage=Xp(e,yS),ns(c),f!==-1){var b=e.l;e.l=i[f][1],d=m3(e,c),e.l=b}}else if(i[l][0]===0){if(c===0){f=l,e.l=i[l+1][1];continue}d=m3(e,c)}else{var _=d[i[l][0]],E;switch(e[e.l]){case 65:e.l+=4,E=m6(e);break;case 30:e.l+=4,E=Bw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,E=Bw(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,E=e.read_shift(4,"i");break;case 19:e.l+=4,E=e.read_shift(4);break;case 5:e.l+=4,E=e.read_shift(8,"f");break;case 11:e.l+=4,E=xn(e,4);break;case 64:e.l+=4,E=Kr(wS(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[_]=E}}return e.l=r+n,v}var p6=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function zae(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function v3(e,t,r){var n=Ie(8),a=[],i=[],l=8,c=0,f=Ie(8),d=Ie(8);if(f.write_shift(4,2),f.write_shift(4,1200),d.write_shift(4,1),i.push(f),a.push(d),l+=8+f.length,!t){d=Ie(8),d.write_shift(4,0),a.unshift(d);var m=[Ie(4)];for(m[0].write_shift(4,e.length),c=0;c<e.length;++c){var p=e[c][0];for(f=Ie(8+2*(p.length+1)+(p.length%2?0:2)),f.write_shift(4,c+2),f.write_shift(4,p.length+1),f.write_shift(0,p,"dbcs");f.l!=f.length;)f.write_shift(1,0);m.push(f)}f=Xn(m),i.unshift(f),l+=8+f.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(p6.indexOf(e[c][0])>-1||l6.indexOf(e[c][0])>-1)&&e[c][1]!=null){var v=e[c][1],x=0;if(t){x=+t[e[c][0]];var y=r[x];if(y.p=="version"&&typeof v=="string"){var b=v.split(".");v=(+b[0]<<16)+(+b[1]||0)}f=p3(y.t,v)}else{var _=zae(v);_==-1&&(_=31,v=String(v)),f=p3(_,v)}i.push(f),d=Ie(8),d.write_shift(4,t?x:2+c),a.push(d),l+=8+f.length}var E=8*(i.length+1);for(c=0;c<i.length;++c)a[c].write_shift(4,E),E+=i[c].length;return n.write_shift(4,l),n.write_shift(4,i.length),Xn([n].concat(a).concat(i))}function x3(e,t,r){var n=e.content;if(!n)return{};ha(n,0);var a,i,l,c,f=0;n.chk("feff","Byte Order: "),n.read_shift(2);var d=n.read_shift(4),m=n.read_shift(16);if(m!==kt.utils.consts.HEADER_CLSID&&m!==r)throw new Error("Bad PropertySet CLSID "+m);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(i=n.read_shift(16),c=n.read_shift(4),a===1&&c!==n.l)throw new Error("Length mismatch: "+c+" !== "+n.l);a===2&&(l=n.read_shift(16),f=n.read_shift(4));var p=g3(n,t),v={SystemIdentifier:d};for(var x in p)v[x]=p[x];if(v.FMTID=i,a===1)return v;if(f-n.l==2&&(n.l+=2),n.l!==f)throw new Error("Length mismatch 2: "+n.l+" !== "+f);var y;try{y=g3(n,null)}catch{}for(x in y)v[x]=y[x];return v.FMTID=[i,l],v}function y3(e,t,r,n,a,i){var l=Ie(a?68:48),c=[l];l.write_shift(2,65534),l.write_shift(2,0),l.write_shift(4,842412599),l.write_shift(16,kt.utils.consts.HEADER_CLSID,"hex"),l.write_shift(4,a?2:1),l.write_shift(16,t,"hex"),l.write_shift(4,a?68:48);var f=v3(e,r,n);if(c.push(f),a){var d=v3(a,null,null);l.write_shift(16,i,"hex"),l.write_shift(4,68+f.length),c.push(d)}return Xn(c)}function Yl(e,t){return e.read_shift(t),null}function Hae(e,t){t||(t=Ie(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function qae(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function xn(e,t){return e.read_shift(t)===1}function Ia(e,t){return t||(t=Ie(2)),t.write_shift(2,+!!e),t}function An(e){return e.read_shift(2,"u")}function Li(e,t){return t||(t=Ie(2)),t.write_shift(2,e),t}function g6(e,t){return qae(e,t,An)}function Wae(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function v6(e,t,r){return r||(r=Ie(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function $0(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var l=n?e.read_shift(n,a):"";return l}function Vae(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,i=1+(r&1),l=0,c,f={};a&&(l=e.read_shift(2)),n&&(c=e.read_shift(4));var d=i==2?"dbcs-cont":"sbcs-cont",m=t===0?"":e.read_shift(t,d);return a&&(e.l+=4*l),n&&(e.l+=c),f.t=m,a||(f.raw="<t>"+f.t+"</t>",f.r=f.t),f}function Gae(e){var t=e.t||"",r=Ie(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Ie(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return Xn(a)}function Sc(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function z0(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Sc(e,n,r)}function Mc(e,t,r){if(r.biff>5)return z0(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function x6(e,t,r){return r||(r=Ie(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Kae(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function Xae(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Ra,"");return n&&(e.l+=24),a}function Yae(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var i=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var l=e.read_shift(i>>1,"utf16le").replace(Ra,"");return r+l}function Qae(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return Xae(e);case"0303000000000000c000000000000046":return Yae(e);default:throw new Error("Unsupported Moniker "+r)}}function Tm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Ra,""):"";return r}function b3(e,t){t||(t=Ie(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Jae(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var i,l,c,f,d="",m,p;a&16&&(i=Tm(e,r-e.l)),a&128&&(l=Tm(e,r-e.l)),(a&257)===257&&(c=Tm(e,r-e.l)),(a&257)===1&&(f=Qae(e,r-e.l)),a&8&&(d=Tm(e,r-e.l)),a&32&&(m=e.read_shift(16)),a&64&&(p=wS(e)),e.l=r;var v=l||c||f||"";v&&d&&(v+="#"+d),v||(v="#"+d),a&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var x={Target:v};return m&&(x.guid=m),p&&(x.time=p),i&&(x.Tooltip=i),x}function Zae(e){var t=Ie(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var l=[8,6815827,6619237,4849780,83];for(r=0;r<l.length;++r)t.write_shift(4,l[r]);if(i==28)n=n.slice(1),b3(n,t);else if(i&2){for(l="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));var c=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),i&8&&b3(a>-1?n.slice(a+1):"",t)}else{for(l="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<l.length;++r)t.write_shift(1,parseInt(l[r],16));for(var f=0;n.slice(f*3,f*3+3)=="../"||n.slice(f*3,f*3+3)=="..\\";)++f;for(t.write_shift(2,f),t.write_shift(4,n.length-3*f+1),r=0;r<n.length-3*f;++r)t.write_shift(1,n.charCodeAt(r+3*f)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function y6(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function b6(e,t){var r=y6(e);return r[3]=0,r}function Is(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ec(e,t,r,n){return n||(n=Ie(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function eie(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function tie(e,t,r){return t===0?"":Mc(e,t,r)}function rie(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),l=e.read_shift(n,"i");return[a,i,l]}function w6(e){var t=e.read_shift(2),r=xS(e);return[t,r]}function nie(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=$0(e,t,r),i=e.read_shift(2);if(n-=e.l,i!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+i);return e.l+=i,a}function tv(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function _6(e,t){return t||(t=Ie(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function S6(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var aie=S6;function E6(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function iie(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function sie(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function ya(e){e.l+=2,e.l+=e.read_shift(2)}var lie={0:ya,4:ya,5:ya,6:ya,7:sie,8:ya,9:ya,10:ya,11:ya,12:ya,13:iie,14:ya,15:ya,16:ya,17:ya,18:ya,19:ya,20:ya,21:E6};function oie(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(lie[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Am(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function _S(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=Ie(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function cie(e,t){return t===0||e.read_shift(2),1200}function uie(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=Mc(e,0,r);return e.read_shift(t+n-e.l),a}function fie(e,t){var r=!t||t.biff==8,n=Ie(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function die(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function hie(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,i=e.read_shift(1);switch(i){case 0:i="Worksheet";break;case 1:i="Macrosheet";break;case 2:i="Chartsheet";break;case 6:i="VBAModule";break}var l=$0(e,0,r);return l.length===0&&(l="Sheet1"),{pos:n,hs:a,dt:i,name:l}}function mie(e,t){var r=!t||t.biff>=8?2:1,n=Ie(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function pie(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),i=[],l=0;l!=a&&e.l<r;++l)i.push(Vae(e));return i.Count=n,i.Unique=a,i}function gie(e,t){var r=Ie(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Gae(e[a]);var i=Xn([r].concat(n));return i.parts=[r.length].concat(n.map(function(l){return l.length})),i}function vie(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function xie(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function yie(e){var t=eie(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function bie(e){return e.read_shift(2),e.read_shift(4)}function w3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var i={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[i,a]}function wie(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2),f=e.read_shift(2),d=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:i,CurTab:l,FirstTab:c,Selected:f,TabRatio:d}}function _ie(){var e=Ie(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Sie(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function Eie(e){var t=Ie(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Nie(){}function kie(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=$0(e,0,r),n}function Tie(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=Ie(a);return i.write_shift(2,e.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Aie(e){var t=Is(e);return t.isst=e.read_shift(4),t}function jie(e,t,r,n){var a=Ie(10);return Ec(e,t,n,a),a.write_shift(4,r),a}function Oie(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Is(e);r.biff==2&&e.l++;var i=z0(e,n-e.l,r);return a.val=i,a}function Cie(e,t,r,n,a){var i=!a||a.biff==8,l=Ie(8+ +i+(1+i)*r.length);return Ec(e,t,n,l),l.write_shift(2,r.length),i&&l.write_shift(1,1),l.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),l}function Die(e,t,r){var n=e.read_shift(2),a=Mc(e,0,r);return[n,a]}function Iie(e,t,r,n){var a=r&&r.biff==5;n||(n=Ie(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}var Pie=Mc;function _3(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,i=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2),f=e.read_shift(2);return e.l=n,{s:{r:i,c},e:{r:l,c:f}}}function Mie(e,t){var r=t.biff==8||!t.biff?4:2,n=Ie(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Rie(e){var t=e.read_shift(2),r=e.read_shift(2),n=w6(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Fie(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(w6(e));if(e.l!==r)throw new Error("MulRK read error");var l=e.read_shift(2);if(i.length!=l-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:l,rkrec:i}}function Lie(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),i=[];e.l<r;)i.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var l=e.read_shift(2);if(i.length!=l-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:l,ixfe:i}}function Bie(e,t,r,n){var a={},i=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(4),f=e.read_shift(2);return a.patternType=yae[c>>26],n.cellStyles&&(a.alc=i&7,a.fWrap=i>>3&1,a.alcV=i>>4&7,a.fJustLast=i>>7&1,a.trot=i>>8&255,a.cIndent=i>>16&15,a.fShrinkToFit=i>>20&1,a.iReadOrder=i>>22&2,a.fAtrNum=i>>26&1,a.fAtrFnt=i>>27&1,a.fAtrAlc=i>>28&1,a.fAtrBdr=i>>29&1,a.fAtrPat=i>>30&1,a.fAtrProt=i>>31&1,a.dgLeft=l&15,a.dgRight=l>>4&15,a.dgTop=l>>8&15,a.dgBottom=l>>12&15,a.icvLeft=l>>16&127,a.icvRight=l>>23&127,a.grbitDiag=l>>30&3,a.icvTop=c&127,a.icvBottom=c>>7&127,a.icvDiag=c>>14&127,a.dgDiag=c>>21&15,a.icvFore=f&127,a.icvBack=f>>7&127,a.fsxButton=f>>14&1),a}function Uie(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=Bie(e,t,n.fStyle,r),n}function S3(e,t,r,n){var a=r&&r.biff==5;n||(n=Ie(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function $ie(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function zie(e){var t=Ie(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function E3(e,t,r){var n=Is(e);(r.biff==2||t==9)&&++e.l;var a=Wae(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Hie(e,t,r,n,a,i){var l=Ie(8);return Ec(e,t,n,l),v6(r,i,l),l}function qie(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Is(e),a=Na(e);return n.val=a,n}function Wie(e,t,r,n){var a=Ie(14);return Ec(e,t,n,a),_c(r,a),a}var N3=tie;function Vie(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(2);if(r.sbcch=i,i==1025||i==14849)return[i,a];if(i<1||i>255)throw new Error("Unexpected SupBook type: "+i);for(var l=Sc(e,i),c=[];n>e.l;)c.push(z0(e));return[i,a,l,c]}function k3(e,t,r){var n=e.read_shift(2),a,i={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=nie(e,t-2,r)),i.body=a||e.read_shift(t-2),typeof a=="string"&&(i.Name=a),i}var Gie=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function T3(e,t,r){var n=e.l+t,a=e.read_shift(2),i=e.read_shift(1),l=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),f=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),f=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var d=Sc(e,l,r);a&32&&(d=Gie[d.charCodeAt(0)]);var m=n-e.l;r&&r.biff==2&&--m;var p=n==e.l||c===0||!(m>0)?[]:oue(e,m,r,c);return{chKey:i,Name:d,itab:f,rgce:p}}function N6(e,t,r){if(r.biff<8)return Kie(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(rie(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Kie(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=$0(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Xie(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),i=Sc(e,n,r),l=Sc(e,a,r);return[i,l]}function Yie(e,t,r){var n=S6(e);e.l++;var a=e.read_shift(1);return t-=8,[cue(e,t,r),a,n]}function A3(e,t,r){var n=aie(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,sue(e,t,r)]}function Qie(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function Jie(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2),l=e.read_shift(2),c=Mc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},c,l,i]}}function Zie(e,t,r){return Jie(e,t,r)}function ese(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(tv(e));return r}function tse(e){var t=Ie(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)_6(e[r],t);return t}function rse(e,t,r){if(r&&r.biff<8)return ase(e,t,r);var n=E6(e),a=oie(e,t-22,n[1]);return{cmo:n,ft:a}}var nse={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function ase(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),i=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var l=[];return l.push((nse[n]||Aa)(e,t,r)),{cmo:[a,n,i],ft:l}}function ise(e,t,r){var n=e.l,a="";try{e.l+=4;var i=(r.lastobj||{cmo:[0,0]}).cmo[1],l;[0,5,7,11,12,14].indexOf(i)==-1?e.l+=6:l=Kae(e,6,r);var c=e.read_shift(2);e.read_shift(2),An(e,2);var f=e.read_shift(2);e.l+=f;for(var d=1;d<e.lens.length-1;++d){if(e.l-n!=e.lens[d])throw new Error("TxO: bad continue record");var m=e[e.l],p=Sc(e,e.lens[d+1]-e.lens[d]-1);if(a+=p,a.length>=(m?c:2*c))break}if(a.length!==c&&a.length!==c*2)throw new Error("cchText: "+c+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function sse(e,t){var r=tv(e);e.l+=16;var n=Jae(e,t-24);return[r,n]}function lse(e){var t=Ie(24),r=rn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return Xn([t,Zae(e[1])])}function ose(e,t){e.read_shift(2);var r=tv(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Ra,""),[r,n]}function cse(e){var t=e[1].Tooltip,r=Ie(10+2*(t.length+1));r.write_shift(2,2048);var n=rn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function use(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=d3[r]||r,r=e.read_shift(2),t[1]=d3[r]||r,t}function fse(e){return e||(e=Ie(4)),e.write_shift(2,1),e.write_shift(2,1),e}function dse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(b6(e));return r}function hse(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(b6(e));return r}function mse(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function k6(e,t,r){if(!r.cellStyles)return Aa(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),l=e.read_shift(n),c=e.read_shift(n),f=e.read_shift(2);n==2&&(e.l+=2);var d={s:a,e:i,w:l,ixfe:c,flags:f};return(r.biff>=5||!r.biff)&&(d.level=f>>8&7),d}function pse(e,t){var r=Ie(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function gse(e,t){var r={};return t<32||(e.l+=16,r.header=Na(e),r.footer=Na(e),e.l+=2),r}function vse(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}function xse(e){for(var t=Ie(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var yse=Is,bse=g6,wse=z0;function _se(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function Sse(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Is(e);++e.l;var a=Mc(e,t-7,r);return n.t="str",n.val=a,n}function Ese(e){var t=Is(e);++e.l;var r=Na(e);return t.t="n",t.val=r,t}function Nse(e,t,r){var n=Ie(15);return V0(n,e,t),n.write_shift(8,r,"f"),n}function kse(e){var t=Is(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function Tse(e,t,r){var n=Ie(9);return V0(n,e,t),n.write_shift(2,r),n}function Ase(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function jse(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function Ose(e,t,r){var n=e.l+t,a=Is(e),i=e.read_shift(2),l=Sc(e,i,r);return e.l=n,a.t="str",a.val=l,a}var Cse=[2,3,48,49,131,139,140,245],Uw=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Jg({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,f){var d=[],m=co(1);switch(f.type){case"base64":m=di(bi(c));break;case"binary":m=di(c);break;case"buffer":case"array":m=c;break}ha(m,0);var p=m.read_shift(1),v=!!(p&136),x=!1,y=!1;switch(p){case 2:break;case 3:break;case 48:x=!0,v=!0;break;case 49:x=!0,v=!0;break;case 131:break;case 139:break;case 140:y=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+p.toString(16))}var b=0,_=521;p==2&&(b=m.read_shift(2)),m.l+=3,p!=2&&(b=m.read_shift(4)),b>1048576&&(b=1e6),p!=2&&(_=m.read_shift(2));var E=m.read_shift(2),A=f.codepage||1252;p!=2&&(m.l+=16,m.read_shift(1),m[m.l]!==0&&(A=e[m[m.l]]),m.l+=1,m.l+=2),y&&(m.l+=36);for(var T=[],k={},I=Math.min(m.length,p==2?521:_-10-(x?264:0)),O=y?32:11;m.l<I&&m[m.l]!=13;)switch(k={},k.name=Yd.utils.decode(A,m.slice(m.l,m.l+O)).replace(/[\u0000\r\n].*$/g,""),m.l+=O,k.type=String.fromCharCode(m.read_shift(1)),p!=2&&!y&&(k.offset=m.read_shift(4)),k.len=m.read_shift(1),p==2&&(k.offset=m.read_shift(2)),k.dec=m.read_shift(1),k.name.length&&T.push(k),p!=2&&(m.l+=y?13:14),k.type){case"B":(!x||k.len!=8)&&f.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":f.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(m[m.l]!==13&&(m.l=_-1),m.read_shift(1)!==13)throw new Error("DBF Terminator not found "+m.l+" "+m[m.l]);m.l=_;var j=0,B=0;for(d[0]=[],B=0;B!=T.length;++B)d[0][B]=T[B].name;for(;b-- >0;){if(m[m.l]===42){m.l+=E;continue}for(++m.l,d[++j]=[],B=0,B=0;B!=T.length;++B){var U=m.slice(m.l,m.l+T[B].len);m.l+=T[B].len,ha(U,0);var Y=Yd.utils.decode(A,U);switch(T[B].type){case"C":Y.trim().length&&(d[j][B]=Y.replace(/\s+$/,""));break;case"D":Y.length===8?d[j][B]=new Date(+Y.slice(0,4),+Y.slice(4,6)-1,+Y.slice(6,8)):d[j][B]=Y;break;case"F":d[j][B]=parseFloat(Y.trim());break;case"+":case"I":d[j][B]=y?U.read_shift(-4,"i")^2147483648:U.read_shift(4,"i");break;case"L":switch(Y.trim().toUpperCase()){case"Y":case"T":d[j][B]=!0;break;case"N":case"F":d[j][B]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Y+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+p.toString(16));d[j][B]="##MEMO##"+(y?parseInt(Y.trim(),10):U.read_shift(4));break;case"N":Y=Y.replace(/\u0000/g,"").trim(),Y&&Y!="."&&(d[j][B]=+Y||0);break;case"@":d[j][B]=new Date(U.read_shift(-8,"f")-621356832e5);break;case"T":d[j][B]=new Date((U.read_shift(4)-2440588)*864e5+U.read_shift(4));break;case"Y":d[j][B]=U.read_shift(4,"i")/1e4+U.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[j][B]=-U.read_shift(-8,"f");break;case"B":if(x&&T[B].len==8){d[j][B]=U.read_shift(8,"f");break}case"G":case"P":U.l+=T[B].len;break;case"0":if(T[B].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+T[B].type)}}}if(p!=2&&m.l<m.length&&m[m.l++]!=26)throw new Error("DBF EOF Marker missing "+(m.l-1)+" of "+m.length+" "+m[m.l-1].toString(16));return f&&f.sheetRows&&(d=d.slice(0,f.sheetRows)),f.DBF=T,d}function n(c,f){var d=f||{};d.dateNF||(d.dateNF="yyyymmdd");var m=mf(r(c,d),d);return m["!cols"]=d.DBF.map(function(p){return{wch:p.len,DBF:p}}),delete d.DBF,m}function a(c,f){try{return wo(n(c,f),f)}catch(d){if(f&&f.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function l(c,f){var d=f||{};if(+d.codepage>=0&&ns(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var m=Xa(),p=Jp(c,{header:1,raw:!0,cellDates:!0}),v=p[0],x=p.slice(1),y=c["!cols"]||[],b=0,_=0,E=0,A=1;for(b=0;b<v.length;++b){if(((y[b]||{}).DBF||{}).name){v[b]=y[b].DBF.name,++E;continue}if(v[b]!=null){if(++E,typeof v[b]=="number"&&(v[b]=v[b].toString(10)),typeof v[b]!="string")throw new Error("DBF Invalid column name "+v[b]+" |"+typeof v[b]+"|");if(v.indexOf(v[b])!==b){for(_=0;_<1024;++_)if(v.indexOf(v[b]+"_"+_)==-1){v[b]+="_"+_;break}}}}var T=sr(c["!ref"]),k=[],I=[],O=[];for(b=0;b<=T.e.c-T.s.c;++b){var j="",B="",U=0,Y=[];for(_=0;_<x.length;++_)x[_][b]!=null&&Y.push(x[_][b]);if(Y.length==0||v[b]==null){k[b]="?";continue}for(_=0;_<Y.length;++_){switch(typeof Y[_]){case"number":B="B";break;case"string":B="C";break;case"boolean":B="L";break;case"object":B=Y[_]instanceof Date?"D":"C";break;default:B="C"}U=Math.max(U,String(Y[_]).length),j=j&&j!=B?"C":B}U>250&&(U=250),B=((y[b]||{}).DBF||{}).type,B=="C"&&y[b].DBF.len>U&&(U=y[b].DBF.len),j=="B"&&B=="N"&&(j="N",O[b]=y[b].DBF.dec,U=y[b].DBF.len),I[b]=j=="C"||B=="N"?U:i[j]||0,A+=I[b],k[b]=j}var te=m.next(32);for(te.write_shift(4,318902576),te.write_shift(4,x.length),te.write_shift(2,296+32*E),te.write_shift(2,A),b=0;b<4;++b)te.write_shift(4,0);for(te.write_shift(4,0|(+t[p5]||3)<<8),b=0,_=0;b<v.length;++b)if(v[b]!=null){var V=m.next(32),ge=(v[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);V.write_shift(1,ge,"sbcs"),V.write_shift(1,k[b]=="?"?"C":k[b],"sbcs"),V.write_shift(4,_),V.write_shift(1,I[b]||i[k[b]]||0),V.write_shift(1,O[b]||0),V.write_shift(1,2),V.write_shift(4,0),V.write_shift(1,0),V.write_shift(4,0),V.write_shift(4,0),_+=I[b]||i[k[b]]||0}var be=m.next(264);for(be.write_shift(4,13),b=0;b<65;++b)be.write_shift(4,0);for(b=0;b<x.length;++b){var ve=m.next(A);for(ve.write_shift(1,0),_=0;_<v.length;++_)if(v[_]!=null)switch(k[_]){case"L":ve.write_shift(1,x[b][_]==null?63:x[b][_]?84:70);break;case"B":ve.write_shift(8,x[b][_]||0,"f");break;case"N":var z="0";for(typeof x[b][_]=="number"&&(z=x[b][_].toFixed(O[_]||0)),E=0;E<I[_]-z.length;++E)ve.write_shift(1,32);ve.write_shift(1,z,"sbcs");break;case"D":x[b][_]?(ve.write_shift(4,("0000"+x[b][_].getFullYear()).slice(-4),"sbcs"),ve.write_shift(2,("00"+(x[b][_].getMonth()+1)).slice(-2),"sbcs"),ve.write_shift(2,("00"+x[b][_].getDate()).slice(-2),"sbcs")):ve.write_shift(8,"00000000","sbcs");break;case"C":var ue=String(x[b][_]!=null?x[b][_]:"").slice(0,I[_]);for(ve.write_shift(1,ue,"sbcs"),E=0;E<I[_]-ue.length;++E)ve.write_shift(1,32);break}}return m.next(1).write_shift(1,26),m.end()}return{to_workbook:a,to_sheet:n,from_sheet:l}})(),T6=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+hn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,x){var y=e[x];return typeof y=="number"?B4(y):y},n=function(v,x,y){var b=x.charCodeAt(0)-32<<4|y.charCodeAt(0)-48;return b==59?v:B4(b)};e["|"]=254;function a(v,x){switch(x.type){case"base64":return i(bi(v),x);case"binary":return i(v,x);case"buffer":return i(qt&&Buffer.isBuffer(v)?v.toString("binary"):bo(v),x);case"array":return i(wc(v),x)}throw new Error("Unrecognized type "+x.type)}function i(v,x){var y=v.split(/[\n\r]+/),b=-1,_=-1,E=0,A=0,T=[],k=[],I=null,O={},j=[],B=[],U=[],Y=0,te;for(+x.codepage>=0&&ns(+x.codepage);E!==y.length;++E){Y=0;var V=y[E].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),ge=V.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),be=ge[0],ve;if(V.length>0)switch(be){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ge[1].charAt(0)=="P"&&k.push(V.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,ue=!1,se=!1,Q=!1,re=-1,G=-1;for(A=1;A<ge.length;++A)switch(ge[A].charAt(0)){case"A":break;case"X":_=parseInt(ge[A].slice(1))-1,ue=!0;break;case"Y":for(b=parseInt(ge[A].slice(1))-1,ue||(_=0),te=T.length;te<=b;++te)T[te]=[];break;case"K":ve=ge[A].slice(1),ve.charAt(0)==='"'?ve=ve.slice(1,ve.length-1):ve==="TRUE"?ve=!0:ve==="FALSE"?ve=!1:isNaN(ls(ve))?isNaN(Yu(ve).getDate())||(ve=Kr(ve)):(ve=ls(ve),I!==null&&df(I)&&(ve=ev(ve))),z=!0;break;case"E":Q=!0;var P=Bu(ge[A].slice(1),{r:b,c:_});T[b][_]=[T[b][_],P];break;case"S":se=!0,T[b][_]=[T[b][_],"S5S"];break;case"G":break;case"R":re=parseInt(ge[A].slice(1))-1;break;case"C":G=parseInt(ge[A].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+V)}if(z&&(T[b][_]&&T[b][_].length==2?T[b][_][0]=ve:T[b][_]=ve,I=null),se){if(Q)throw new Error("SYLK shared formula cannot have own formula");var W=re>-1&&T[re][G];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");T[b][_][1]=W6(W[1],{r:b-re,c:_-G})}break;case"F":var F=0;for(A=1;A<ge.length;++A)switch(ge[A].charAt(0)){case"X":_=parseInt(ge[A].slice(1))-1,++F;break;case"Y":for(b=parseInt(ge[A].slice(1))-1,te=T.length;te<=b;++te)T[te]=[];break;case"M":Y=parseInt(ge[A].slice(1))/20;break;case"F":break;case"G":break;case"P":I=k[parseInt(ge[A].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(U=ge[A].slice(1).split(" "),te=parseInt(U[0],10);te<=parseInt(U[1],10);++te)Y=parseInt(U[2],10),B[te-1]=Y===0?{hidden:!0}:{wch:Y},uo(B[te-1]);break;case"C":_=parseInt(ge[A].slice(1))-1,B[_]||(B[_]={});break;case"R":b=parseInt(ge[A].slice(1))-1,j[b]||(j[b]={}),Y>0?(j[b].hpt=Y,j[b].hpx=Ju(Y)):Y===0&&(j[b].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+V)}F<1&&(I=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+V)}}return j.length>0&&(O["!rows"]=j),B.length>0&&(O["!cols"]=B),x&&x.sheetRows&&(T=T.slice(0,x.sheetRows)),[T,O]}function l(v,x){var y=a(v,x),b=y[0],_=y[1],E=mf(b,x);return hn(_).forEach(function(A){E[A]=_[A]}),E}function c(v,x){return wo(l(v,x),x)}function f(v,x,y,b){var _="C;Y"+(y+1)+";X"+(b+1)+";K";switch(v.t){case"n":_+=v.v||0,v.f&&!v.F&&(_+=";E"+AS(v.f,{r:y,c:b}));break;case"b":_+=v.v?"TRUE":"FALSE";break;case"e":_+=v.w||v.v;break;case"d":_+='"'+(v.w||v.v)+'"';break;case"s":_+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function d(v,x){x.forEach(function(y,b){var _="F;W"+(b+1)+" "+(b+1)+" ";y.hidden?_+="0":(typeof y.width=="number"&&!y.wpx&&(y.wpx=a0(y.width)),typeof y.wpx=="number"&&!y.wch&&(y.wch=i0(y.wpx)),typeof y.wch=="number"&&(_+=Math.round(y.wch))),_.charAt(_.length-1)!=" "&&v.push(_)})}function m(v,x){x.forEach(function(y,b){var _="F;";y.hidden?_+="M0;":y.hpt?_+="M"+20*y.hpt+";":y.hpx&&(_+="M"+20*s0(y.hpx)+";"),_.length>2&&v.push(_+"R"+(b+1))})}function p(v,x){var y=["ID;PWXL;N;E"],b=[],_=sr(v["!ref"]),E,A=Array.isArray(v),T=`\r
`;y.push("P;PGeneral"),y.push("F;P0;DG0G8;M255"),v["!cols"]&&d(y,v["!cols"]),v["!rows"]&&m(y,v["!rows"]),y.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var k=_.s.r;k<=_.e.r;++k)for(var I=_.s.c;I<=_.e.c;++I){var O=It({r:k,c:I});E=A?(v[k]||[])[I]:v[O],!(!E||E.v==null&&(!E.f||E.F))&&b.push(f(E,v,k,I))}return y.join(T)+T+b.join(T)+T+"E"+T}return{to_workbook:c,to_sheet:l,from_sheet:p}})(),A6=(function(){function e(i,l){switch(l.type){case"base64":return t(bi(i),l);case"binary":return t(i,l);case"buffer":return t(qt&&Buffer.isBuffer(i)?i.toString("binary"):bo(i),l);case"array":return t(wc(i),l)}throw new Error("Unrecognized type "+l.type)}function t(i,l){for(var c=i.split(`
`),f=-1,d=-1,m=0,p=[];m!==c.length;++m){if(c[m].trim()==="BOT"){p[++f]=[],d=0;continue}if(!(f<0)){var v=c[m].trim().split(","),x=v[0],y=v[1];++m;for(var b=c[m]||"";(b.match(/["]/g)||[]).length&1&&m<c.length-1;)b+=`
`+c[++m];switch(b=b.trim(),+x){case-1:if(b==="BOT"){p[++f]=[],d=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?p[f][d]=!0:b==="FALSE"?p[f][d]=!1:isNaN(ls(y))?isNaN(Yu(y).getDate())?p[f][d]=y:p[f][d]=Kr(y):p[f][d]=ls(y),++d;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),p[f][d++]=b!==""?b:null;break}if(b==="EOD")break}}return l&&l.sheetRows&&(p=p.slice(0,l.sheetRows)),p}function r(i,l){return mf(e(i,l),l)}function n(i,l){return wo(r(i,l),l)}var a=(function(){var i=function(f,d,m,p,v){f.push(d),f.push(m+","+p),f.push('"'+v.replace(/"/g,'""')+'"')},l=function(f,d,m,p){f.push(d+","+m),f.push(d==1?'"'+p.replace(/"/g,'""')+'"':p)};return function(f){var d=[],m=sr(f["!ref"]),p,v=Array.isArray(f);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,m.e.r-m.s.r+1,""),i(d,"TUPLES",0,m.e.c-m.s.c+1,""),i(d,"DATA",0,0,"");for(var x=m.s.r;x<=m.e.r;++x){l(d,-1,0,"BOT");for(var y=m.s.c;y<=m.e.c;++y){var b=It({r:x,c:y});if(p=v?(f[x]||[])[y]:f[b],!p){l(d,1,0,"");continue}switch(p.t){case"n":var _=p.w;!_&&p.v!=null&&(_=p.v),_==null?p.f&&!p.F?l(d,1,0,"="+p.f):l(d,1,0,""):l(d,0,_,"V");break;case"b":l(d,0,p.v?1:0,p.v?"TRUE":"FALSE");break;case"s":l(d,1,0,isNaN(p.v)?p.v:'="'+p.v+'"');break;case"d":p.w||(p.w=qi(p.z||Dt[14],Fn(Kr(p.v)))),l(d,0,p.w,"V");break;default:l(d,1,0,"")}}}l(d,-1,0,"EOD");var E=`\r
`,A=d.join(E);return A}})();return{to_workbook:n,to_sheet:r,from_sheet:a}})(),j6=(function(){function e(p){return p.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(p){return p.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(p,v){for(var x=p.split(`
`),y=-1,b=-1,_=0,E=[];_!==x.length;++_){var A=x[_].trim().split(":");if(A[0]==="cell"){var T=rn(A[1]);if(E.length<=T.r)for(y=E.length;y<=T.r;++y)E[y]||(E[y]=[]);switch(y=T.r,b=T.c,A[2]){case"t":E[y][b]=e(A[3]);break;case"v":E[y][b]=+A[3];break;case"vtf":var k=A[A.length-1];case"vtc":switch(A[3]){case"nl":E[y][b]=!!+A[4];break;default:E[y][b]=+A[4];break}A[2]=="vtf"&&(E[y][b]=[E[y][b],k])}}}return v&&v.sheetRows&&(E=E.slice(0,v.sheetRows)),E}function n(p,v){return mf(r(p,v),v)}function a(p,v){return wo(n(p,v),v)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),l=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),f="--SocialCalcSpreadsheetControlSave--";function d(p){if(!p||!p["!ref"])return"";for(var v=[],x=[],y,b="",_=Ya(p["!ref"]),E=Array.isArray(p),A=_.s.r;A<=_.e.r;++A)for(var T=_.s.c;T<=_.e.c;++T)if(b=It({r:A,c:T}),y=E?(p[A]||[])[T]:p[b],!(!y||y.v==null||y.t==="z")){switch(x=["cell",b,"t"],y.t){case"s":case"str":x.push(t(y.v));break;case"n":y.f?(x[2]="vtf",x[3]="n",x[4]=y.v,x[5]=t(y.f)):(x[2]="v",x[3]=y.v);break;case"b":x[2]="vt"+(y.f?"f":"c"),x[3]="nl",x[4]=y.v?"1":"0",x[5]=t(y.f||(y.v?"TRUE":"FALSE"));break;case"d":var k=Fn(Kr(y.v));x[2]="vtc",x[3]="nd",x[4]=""+k,x[5]=y.w||qi(y.z||Dt[14],k);break;case"e":continue}v.push(x.join(":"))}return v.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function m(p){return[i,l,c,l,d(p),f].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:m}})(),Qu=(function(){function e(m,p,v,x,y){y.raw?p[v][x]=m:m===""||(m==="TRUE"?p[v][x]=!0:m==="FALSE"?p[v][x]=!1:isNaN(ls(m))?isNaN(Yu(m).getDate())?p[v][x]=m:p[v][x]=Kr(m):p[v][x]=ls(m))}function t(m,p){var v=p||{},x=[];if(!m||m.length===0)return x;for(var y=m.split(/[\r\n]/),b=y.length-1;b>=0&&y[b].length===0;)--b;for(var _=10,E=0,A=0;A<=b;++A)E=y[A].indexOf(" "),E==-1?E=y[A].length:E++,_=Math.max(_,E);for(A=0;A<=b;++A){x[A]=[];var T=0;for(e(y[A].slice(0,_).trim(),x,A,T,v),T=1;T<=(y[A].length-_)/10+1;++T)e(y[A].slice(_+(T-1)*10,_+T*10).trim(),x,A,T,v)}return v.sheetRows&&(x=x.slice(0,v.sheetRows)),x}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(m){for(var p={},v=!1,x=0,y=0;x<m.length;++x)(y=m.charCodeAt(x))==34?v=!v:!v&&y in r&&(p[y]=(p[y]||0)+1);y=[];for(x in p)Object.prototype.hasOwnProperty.call(p,x)&&y.push([p[x],x]);if(!y.length){p=n;for(x in p)Object.prototype.hasOwnProperty.call(p,x)&&y.push([p[x],x])}return y.sort(function(b,_){return b[0]-_[0]||n[b[1]]-n[_[1]]}),r[y.pop()[1]]||44}function i(m,p){var v=p||{},x="",y=v.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};m.slice(0,4)=="sep="?m.charCodeAt(5)==13&&m.charCodeAt(6)==10?(x=m.charAt(4),m=m.slice(7)):m.charCodeAt(5)==13||m.charCodeAt(5)==10?(x=m.charAt(4),m=m.slice(6)):x=a(m.slice(0,1024)):v&&v.FS?x=v.FS:x=a(m.slice(0,1024));var _=0,E=0,A=0,T=0,k=0,I=x.charCodeAt(0),O=!1,j=0,B=m.charCodeAt(0);m=m.replace(/\r\n/mg,`
`);var U=v.dateNF!=null?vne(v.dateNF):null;function Y(){var te=m.slice(T,k),V={};if(te.charAt(0)=='"'&&te.charAt(te.length-1)=='"'&&(te=te.slice(1,-1).replace(/""/g,'"')),te.length===0)V.t="z";else if(v.raw)V.t="s",V.v=te;else if(te.trim().length===0)V.t="s",V.v=te;else if(te.charCodeAt(0)==61)te.charCodeAt(1)==34&&te.charCodeAt(te.length-1)==34?(V.t="s",V.v=te.slice(2,-1).replace(/""/g,'"')):Voe(te)?(V.t="n",V.f=te.slice(1)):(V.t="s",V.v=te);else if(te=="TRUE")V.t="b",V.v=!0;else if(te=="FALSE")V.t="b",V.v=!1;else if(!isNaN(A=ls(te)))V.t="n",v.cellText!==!1&&(V.w=te),V.v=A;else if(!isNaN(Yu(te).getDate())||U&&te.match(U)){V.z=v.dateNF||Dt[14];var ge=0;U&&te.match(U)&&(te=xne(te,v.dateNF,te.match(U)||[]),ge=1),v.cellDates?(V.t="d",V.v=Kr(te,ge)):(V.t="n",V.v=Fn(Kr(te,ge))),v.cellText!==!1&&(V.w=qi(V.z,V.v instanceof Date?Fn(V.v):V.v)),v.cellNF||delete V.z}else V.t="s",V.v=te;if(V.t=="z"||(v.dense?(y[_]||(y[_]=[]),y[_][E]=V):y[It({c:E,r:_})]=V),T=k+1,B=m.charCodeAt(T),b.e.c<E&&(b.e.c=E),b.e.r<_&&(b.e.r=_),j==I)++E;else if(E=0,++_,v.sheetRows&&v.sheetRows<=_)return!0}e:for(;k<m.length;++k)switch(j=m.charCodeAt(k)){case 34:B===34&&(O=!O);break;case I:case 10:case 13:if(!O&&Y())break e;break}return k-T>0&&Y(),y["!ref"]=Ut(b),y}function l(m,p){return!(p&&p.PRN)||p.FS||m.slice(0,4)=="sep="||m.indexOf("	")>=0||m.indexOf(",")>=0||m.indexOf(";")>=0?i(m,p):mf(t(m,p),p)}function c(m,p){var v="",x=p.type=="string"?[0,0,0,0]:RS(m,p);switch(p.type){case"base64":v=bi(m);break;case"binary":v=m;break;case"buffer":p.codepage==65001?v=m.toString("utf8"):p.codepage&&typeof Yd<"u"||(v=qt&&Buffer.isBuffer(m)?m.toString("binary"):bo(m));break;case"array":v=wc(m);break;case"string":v=m;break;default:throw new Error("Unrecognized type "+p.type)}return x[0]==239&&x[1]==187&&x[2]==191?v=Ir(v.slice(3)):p.type!="string"&&p.type!="buffer"&&p.codepage==65001?v=Ir(v):p.type=="binary"&&typeof Yd<"u",v.slice(0,19)=="socialcalc:version:"?j6.to_sheet(p.type=="string"?v:Ir(v),p):l(v,p)}function f(m,p){return wo(c(m,p),p)}function d(m){for(var p=[],v=sr(m["!ref"]),x,y=Array.isArray(m),b=v.s.r;b<=v.e.r;++b){for(var _=[],E=v.s.c;E<=v.e.c;++E){var A=It({r:b,c:E});if(x=y?(m[b]||[])[E]:m[A],!x||x.v==null){_.push("          ");continue}for(var T=(x.w||(pl(x),x.w)||"").slice(0,10);T.length<10;)T+=" ";_.push(T+(E===0?" ":""))}p.push(_.join(""))}return p.join(`
`)}return{to_workbook:f,to_sheet:c,from_sheet:d}})();function Dse(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=T6.to_workbook(e,r);return r.WTF=n,a}catch(i){if(r.WTF=n,!i.message.match(/SYLK bad record ID/)&&n)throw i;return Qu.to_workbook(e,t)}}var cc=(function(){function e(P,W,F){if(P){ha(P,P.l||0);for(var M=F.Enum||re;P.l<P.length;){var le=P.read_shift(2),pe=M[le]||M[65535],Ae=P.read_shift(2),oe=P.l+Ae,ae=pe.f&&pe.f(P,Ae,F);if(P.l=oe,W(ae,pe,le))return}}}function t(P,W){switch(W.type){case"base64":return r(di(bi(P)),W);case"binary":return r(di(P),W);case"buffer":case"array":return r(P,W)}throw"Unsupported type "+W.type}function r(P,W){if(!P)return P;var F=W||{},M=F.dense?[]:{},le="Sheet1",pe="",Ae=0,oe={},ae=[],ze=[],q={s:{r:0,c:0},e:{r:0,c:0}},Je=F.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)F.Enum=re,e(P,function(He,wt,mt){switch(mt){case 0:F.vers=He,He>=4096&&(F.qpro=!0);break;case 6:q=He;break;case 204:He&&(pe=He);break;case 222:pe=He;break;case 15:case 51:F.qpro||(He[1].v=He[1].v.slice(1));case 13:case 14:case 16:mt==14&&(He[2]&112)==112&&(He[2]&15)>1&&(He[2]&15)<15&&(He[1].z=F.dateNF||Dt[14],F.cellDates&&(He[1].t="d",He[1].v=ev(He[1].v))),F.qpro&&He[3]>Ae&&(M["!ref"]=Ut(q),oe[le]=M,ae.push(le),M=F.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},Ae=He[3],le=pe||"Sheet"+(Ae+1),pe="");var Ge=F.dense?(M[He[0].r]||[])[He[0].c]:M[It(He[0])];if(Ge){Ge.t=He[1].t,Ge.v=He[1].v,He[1].z!=null&&(Ge.z=He[1].z),He[1].f!=null&&(Ge.f=He[1].f);break}F.dense?(M[He[0].r]||(M[He[0].r]=[]),M[He[0].r][He[0].c]=He[1]):M[It(He[0])]=He[1];break}},F);else if(P[2]==26||P[2]==14)F.Enum=G,P[2]==14&&(F.qpro=!0,P.l=0),e(P,function(He,wt,mt){switch(mt){case 204:le=He;break;case 22:He[1].v=He[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(He[3]>Ae&&(M["!ref"]=Ut(q),oe[le]=M,ae.push(le),M=F.dense?[]:{},q={s:{r:0,c:0},e:{r:0,c:0}},Ae=He[3],le="Sheet"+(Ae+1)),Je>0&&He[0].r>=Je)break;F.dense?(M[He[0].r]||(M[He[0].r]=[]),M[He[0].r][He[0].c]=He[1]):M[It(He[0])]=He[1],q.e.c<He[0].c&&(q.e.c=He[0].c),q.e.r<He[0].r&&(q.e.r=He[0].r);break;case 27:He[14e3]&&(ze[He[14e3][0]]=He[14e3][1]);break;case 1537:ze[He[0]]=He[1],He[0]==Ae&&(le=He[1]);break}},F);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(M["!ref"]=Ut(q),oe[pe||le]=M,ae.push(pe||le),!ze.length)return{SheetNames:ae,Sheets:oe};for(var qe={},ot=[],Ke=0;Ke<ze.length;++Ke)oe[ae[Ke]]?(ot.push(ze[Ke]||ae[Ke]),qe[ze[Ke]]=oe[ze[Ke]]||oe[ae[Ke]]):(ot.push(ze[Ke]),qe[ze[Ke]]={"!ref":"A1"});return{SheetNames:ot,Sheets:qe}}function n(P,W){var F=W||{};if(+F.codepage>=0&&ns(+F.codepage),F.type=="string")throw new Error("Cannot write WK1 to JS string");var M=Xa(),le=sr(P["!ref"]),pe=Array.isArray(P),Ae=[];et(M,0,i(1030)),et(M,6,f(le));for(var oe=Math.min(le.e.r,8191),ae=le.s.r;ae<=oe;++ae)for(var ze=yn(ae),q=le.s.c;q<=le.e.c;++q){ae===le.s.r&&(Ae[q]=tn(q));var Je=Ae[q]+ze,qe=pe?(P[ae]||[])[q]:P[Je];if(!(!qe||qe.t=="z"))if(qe.t=="n")(qe.v|0)==qe.v&&qe.v>=-32768&&qe.v<=32767?et(M,13,x(ae,q,qe.v)):et(M,14,b(ae,q,qe.v));else{var ot=pl(qe);et(M,15,p(ae,q,ot.slice(0,239)))}}return et(M,1),M.end()}function a(P,W){var F=W||{};if(+F.codepage>=0&&ns(+F.codepage),F.type=="string")throw new Error("Cannot write WK3 to JS string");var M=Xa();et(M,0,l(P));for(var le=0,pe=0;le<P.SheetNames.length;++le)(P.Sheets[P.SheetNames[le]]||{})["!ref"]&&et(M,27,Q(P.SheetNames[le],pe++));var Ae=0;for(le=0;le<P.SheetNames.length;++le){var oe=P.Sheets[P.SheetNames[le]];if(!(!oe||!oe["!ref"])){for(var ae=sr(oe["!ref"]),ze=Array.isArray(oe),q=[],Je=Math.min(ae.e.r,8191),qe=ae.s.r;qe<=Je;++qe)for(var ot=yn(qe),Ke=ae.s.c;Ke<=ae.e.c;++Ke){qe===ae.s.r&&(q[Ke]=tn(Ke));var He=q[Ke]+ot,wt=ze?(oe[qe]||[])[Ke]:oe[He];if(!(!wt||wt.t=="z"))if(wt.t=="n")et(M,23,Y(qe,Ke,Ae,wt.v));else{var mt=pl(wt);et(M,22,j(qe,Ke,Ae,mt.slice(0,239)))}}++Ae}}return et(M,1),M.end()}function i(P){var W=Ie(2);return W.write_shift(2,P),W}function l(P){var W=Ie(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var F=0,M=0,le=0,pe=0;pe<P.SheetNames.length;++pe){var Ae=P.SheetNames[pe],oe=P.Sheets[Ae];if(!(!oe||!oe["!ref"])){++le;var ae=Ya(oe["!ref"]);F<ae.e.r&&(F=ae.e.r),M<ae.e.c&&(M=ae.e.c)}}return F>8191&&(F=8191),W.write_shift(2,F),W.write_shift(1,le),W.write_shift(1,M),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function c(P,W,F){var M={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&F.qpro?(M.s.c=P.read_shift(1),P.l++,M.s.r=P.read_shift(2),M.e.c=P.read_shift(1),P.l++,M.e.r=P.read_shift(2),M):(M.s.c=P.read_shift(2),M.s.r=P.read_shift(2),W==12&&F.qpro&&(P.l+=2),M.e.c=P.read_shift(2),M.e.r=P.read_shift(2),W==12&&F.qpro&&(P.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function f(P){var W=Ie(8);return W.write_shift(2,P.s.c),W.write_shift(2,P.s.r),W.write_shift(2,P.e.c),W.write_shift(2,P.e.r),W}function d(P,W,F){var M=[{c:0,r:0},{t:"n",v:0},0,0];return F.qpro&&F.vers!=20768?(M[0].c=P.read_shift(1),M[3]=P.read_shift(1),M[0].r=P.read_shift(2),P.l+=2):(M[2]=P.read_shift(1),M[0].c=P.read_shift(2),M[0].r=P.read_shift(2)),M}function m(P,W,F){var M=P.l+W,le=d(P,W,F);if(le[1].t="s",F.vers==20768){P.l++;var pe=P.read_shift(1);return le[1].v=P.read_shift(pe,"utf8"),le}return F.qpro&&P.l++,le[1].v=P.read_shift(M-P.l,"cstr"),le}function p(P,W,F){var M=Ie(7+F.length);M.write_shift(1,255),M.write_shift(2,W),M.write_shift(2,P),M.write_shift(1,39);for(var le=0;le<M.length;++le){var pe=F.charCodeAt(le);M.write_shift(1,pe>=128?95:pe)}return M.write_shift(1,0),M}function v(P,W,F){var M=d(P,W,F);return M[1].v=P.read_shift(2,"i"),M}function x(P,W,F){var M=Ie(7);return M.write_shift(1,255),M.write_shift(2,W),M.write_shift(2,P),M.write_shift(2,F,"i"),M}function y(P,W,F){var M=d(P,W,F);return M[1].v=P.read_shift(8,"f"),M}function b(P,W,F){var M=Ie(13);return M.write_shift(1,255),M.write_shift(2,W),M.write_shift(2,P),M.write_shift(8,F,"f"),M}function _(P,W,F){var M=P.l+W,le=d(P,W,F);if(le[1].v=P.read_shift(8,"f"),F.qpro)P.l=M;else{var pe=P.read_shift(2);k(P.slice(P.l,P.l+pe),le),P.l+=pe}return le}function E(P,W,F){var M=W&32768;return W&=-32769,W=(M?P:0)+(W>=8192?W-16384:W),(M?"":"$")+(F?tn(W):yn(W))}var A={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},T=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(P,W){ha(P,0);for(var F=[],M=0,le="",pe="",Ae="",oe="";P.l<P.length;){var ae=P[P.l++];switch(ae){case 0:F.push(P.read_shift(8,"f"));break;case 1:pe=E(W[0].c,P.read_shift(2),!0),le=E(W[0].r,P.read_shift(2),!1),F.push(pe+le);break;case 2:{var ze=E(W[0].c,P.read_shift(2),!0),q=E(W[0].r,P.read_shift(2),!1);pe=E(W[0].c,P.read_shift(2),!0),le=E(W[0].r,P.read_shift(2),!1),F.push(ze+q+":"+pe+le)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:F.push("("+F.pop()+")");break;case 5:F.push(P.read_shift(2));break;case 6:{for(var Je="";ae=P[P.l++];)Je+=String.fromCharCode(ae);F.push('"'+Je.replace(/"/g,'""')+'"')}break;case 8:F.push("-"+F.pop());break;case 23:F.push("+"+F.pop());break;case 22:F.push("NOT("+F.pop()+")");break;case 20:case 21:oe=F.pop(),Ae=F.pop(),F.push(["AND","OR"][ae-20]+"("+Ae+","+oe+")");break;default:if(ae<32&&T[ae])oe=F.pop(),Ae=F.pop(),F.push(Ae+T[ae]+oe);else if(A[ae]){if(M=A[ae][1],M==69&&(M=P[P.l++]),M>F.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+F.join("|")+"|");return}var qe=F.slice(-M);F.length-=M,F.push(A[ae][0]+"("+qe.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}F.length==1?W[1].f=""+F[0]:console.error("WK1 bad formula parse |"+F.join("|")+"|")}function I(P){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=P.read_shift(2),W[3]=P[P.l++],W[0].c=P[P.l++],W}function O(P,W){var F=I(P);return F[1].t="s",F[1].v=P.read_shift(W-4,"cstr"),F}function j(P,W,F,M){var le=Ie(6+M.length);le.write_shift(2,P),le.write_shift(1,F),le.write_shift(1,W),le.write_shift(1,39);for(var pe=0;pe<M.length;++pe){var Ae=M.charCodeAt(pe);le.write_shift(1,Ae>=128?95:Ae)}return le.write_shift(1,0),le}function B(P,W){var F=I(P);F[1].v=P.read_shift(2);var M=F[1].v>>1;if(F[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return F[1].v=M,F}function U(P,W){var F=I(P),M=P.read_shift(4),le=P.read_shift(4),pe=P.read_shift(2);if(pe==65535)return M===0&&le===3221225472?(F[1].t="e",F[1].v=15):M===0&&le===3489660928?(F[1].t="e",F[1].v=42):F[1].v=0,F;var Ae=pe&32768;return pe=(pe&32767)-16446,F[1].v=(1-Ae*2)*(le*Math.pow(2,pe+32)+M*Math.pow(2,pe)),F}function Y(P,W,F,M){var le=Ie(14);if(le.write_shift(2,P),le.write_shift(1,F),le.write_shift(1,W),M==0)return le.write_shift(4,0),le.write_shift(4,0),le.write_shift(2,65535),le;var pe=0,Ae=0,oe=0,ae=0;return M<0&&(pe=1,M=-M),Ae=Math.log2(M)|0,M/=Math.pow(2,Ae-31),ae=M>>>0,(ae&2147483648)==0&&(M/=2,++Ae,ae=M>>>0),M-=ae,ae|=2147483648,ae>>>=0,M*=Math.pow(2,32),oe=M>>>0,le.write_shift(4,oe),le.write_shift(4,ae),Ae+=16383+(pe?32768:0),le.write_shift(2,Ae),le}function te(P,W){var F=U(P);return P.l+=W-14,F}function V(P,W){var F=I(P),M=P.read_shift(4);return F[1].v=M>>6,F}function ge(P,W){var F=I(P),M=P.read_shift(8,"f");return F[1].v=M,F}function be(P,W){var F=ge(P);return P.l+=W-10,F}function ve(P,W){return P[P.l+W-1]==0?P.read_shift(W,"cstr"):""}function z(P,W){var F=P[P.l++];F>W-1&&(F=W-1);for(var M="";M.length<F;)M+=String.fromCharCode(P[P.l++]);return M}function ue(P,W,F){if(!(!F.qpro||W<21)){var M=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var le=P.read_shift(W-21,"cstr");return[M,le]}}function se(P,W){for(var F={},M=P.l+W;P.l<M;){var le=P.read_shift(2);if(le==14e3){for(F[le]=[0,""],F[le][0]=P.read_shift(2);P[P.l];)F[le][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return F}function Q(P,W){var F=Ie(5+P.length);F.write_shift(2,14e3),F.write_shift(2,W);for(var M=0;M<P.length;++M){var le=P.charCodeAt(M);F[F.l++]=le>127?95:le}return F[F.l++]=0,F}var re={0:{n:"BOF",f:An},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:y},15:{n:"LABEL",f:m},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:m},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ve},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},G={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:O},23:{n:"NUMBER17",f:U},24:{n:"NUMBER18",f:B},25:{n:"FORMULA19",f:te},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:se},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:V},38:{n:"??"},39:{n:"NUMBER27",f:ge},40:{n:"FORMULA28",f:be},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ve},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ue},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}})();function Ise(e){var t={},r=e.match(ja),n=0,a=!1;if(r)for(;n!=r.length;++n){var i=Pt(r[n]);switch(i[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!i.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(i.val=="1")break;t.cp=Z2[parseInt(i.val,10)];break;case"<outline":if(!i.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=i.val;break;case"<sz":t.sz=i.val;break;case"<strike":if(!i.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!i.val)break;switch(i.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(i.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(i.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":i.rgb&&(t.color=i.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=i.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=i.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(i[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+i[0])}}return t}var Pse=(function(){var e=Zd("t"),t=Zd("rPr");function r(i){var l=i.match(e);if(!l)return{t:"s",v:""};var c={t:"s",v:ir(l[1])},f=i.match(t);return f&&(c.s=Ise(f[1])),c}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(l){return l.replace(n,"").split(a).map(r).filter(function(c){return c.v})}})(),Mse=(function(){var t=/(\r\n|\n)/g;function r(a,i,l){var c=[];a.u&&c.push("text-decoration: underline;"),a.uval&&c.push("text-underline-style:"+a.uval+";"),a.sz&&c.push("font-size:"+a.sz+"pt;"),a.outline&&c.push("text-effect: outline;"),a.shadow&&c.push("text-shadow: auto;"),i.push('<span style="'+c.join("")+'">'),a.b&&(i.push("<b>"),l.push("</b>")),a.i&&(i.push("<i>"),l.push("</i>")),a.strike&&(i.push("<s>"),l.push("</s>"));var f=a.valign||"";return f=="superscript"||f=="super"?f="sup":f=="subscript"&&(f="sub"),f!=""&&(i.push("<"+f+">"),l.push("</"+f+">")),l.push("</span>"),a}function n(a){var i=[[],a.v,[]];return a.v?(a.s&&r(a.s,i[0],i[2]),i[0].join("")+i[1].replace(t,"<br/>")+i[2].join("")):""}return function(i){return i.map(n).join("")}})(),Rse=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Fse=/<(?:\w+:)?r>/,Lse=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function SS(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ir(Ir(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ir(e),r&&(n.h=cS(n.t))):e.match(Fse)&&(n.r=Ir(e),n.t=ir(Ir((e.replace(Lse,"").match(Rse)||[]).join("").replace(ja,""))),r&&(n.h=Mse(Pse(n.r)))),n):{t:""}}var Bse=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Use=/<(?:\w+:)?(?:si|sstItem)>/g,$se=/<\/(?:\w+:)?(?:si|sstItem)>/;function zse(e,t){var r=[],n="";if(!e)return r;var a=e.match(Bse);if(a){n=a[2].replace(Use,"").split($se);for(var i=0;i!=n.length;++i){var l=SS(n[i].trim(),t);l!=null&&(r[r.length]=l)}a=Pt(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}var Hse=/^\s|\s$|[\t\n\r]/;function O6(e,t){if(!t.bookSST)return"";var r=[bn];r[r.length]=Ze("sst",null,{xmlns:Oc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(Hse)&&(i+=' xml:space="preserve"'),i+=">"+Nr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function qse(e){return[e.read_shift(4),e.read_shift(4)]}function Wse(e,t){var r=[],n=!1;return El(e,function(i,l,c){switch(c){case 159:r.Count=i[0],r.Unique=i[1];break;case 19:r.push(i);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(l.T,!n||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function Vse(e,t){return t||(t=Ie(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Gse=nae;function Kse(e){var t=Xa();We(t,159,Vse(e));for(var r=0;r<e.length;++r)We(t,19,Gse(e[r]));return We(t,160),t.end()}function C6(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ll(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Xse(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ll(e,4),t.U=ll(e,4),t.W=ll(e,4),t}function Yse(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),i=[];a-- >0;)i.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=i,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function Qse(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Yse(e));return t}function Jse(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Zse(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ll(e,4),t.U=ll(e,4),t.W=ll(e,4),t}function ele(e){var t=Zse(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function D6(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function I6(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function tle(e){var t=ll(e);switch(t.Minor){case 2:return[t.Minor,rle(e)];case 3:return[t.Minor,nle()];case 4:return[t.Minor,ale(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function rle(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=D6(e,r),a=I6(e,e.length-e.l);return{t:"Std",h:n,v:a}}function nle(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ale(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(ja,function(i){var l=Pt(i);switch(Ds(l[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){n[c]=l[c]});break;case"<dataIntegrity":n.encryptedHmacKey=l.encryptedHmacKey,n.encryptedHmacValue=l.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=l.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(l);break;default:throw l[0]}}),n}function ile(e,t){var r={},n=r.EncryptionVersionInfo=ll(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=D6(e,a),t-=a,r.EncryptionVerifier=I6(e,t),r}function sle(e){var t={},r=t.EncryptionVersionInfo=ll(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function ES(e){var t=0,r,n=C6(e),a=n.length+1,i,l,c,f,d;for(r=co(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)l=r[i],c=(t&16384)===0?0:1,f=t<<1&32767,d=c|f,t=d^l;return t^52811}var P6=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(l){return(l/2|l*128)&255},a=function(l,c){return n(l^c)},i=function(l){for(var c=t[l.length-1],f=104,d=l.length-1;d>=0;--d)for(var m=l[d],p=0;p!=7;++p)m&64&&(c^=r[f]),m*=2,--f;return c};return function(l){for(var c=C6(l),f=i(c),d=c.length,m=co(16),p=0;p!=16;++p)m[p]=0;var v,x,y;for((d&1)===1&&(v=f>>8,m[d]=a(e[0],v),--d,v=f&255,x=c[c.length-1],m[d]=a(x,v));d>0;)--d,v=f>>8,m[d]=a(c[d],v),--d,v=f&255,m[d]=a(c[d],v);for(d=15,y=15-c.length;y>0;)v=f>>8,m[d]=a(e[y],v),--d,--y,v=f&255,m[d]=a(c[d],v),--d,--y;return m}})(),lle=function(e,t,r,n,a){a||(a=t),n||(n=P6(e));var i,l;for(i=0;i!=t.length;++i)l=t[i],l^=n[r],l=(l>>5|l<<3)&255,a[i]=l,++r;return[a,r,n]},ole=function(e){var t=0,r=P6(e);return function(n){var a=lle("",n,t,r);return t=a[1],a[0]}};function cle(e,t,r,n){var a={key:An(e),verificationBytes:An(e)};return r.password&&(a.verifier=ES(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=ole(r.password)),a}function ule(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=sle(e):n.Data=ile(e,t),n}function fle(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?ule(e,t-2,n):cle(e,r.biff>=8?t:t-2,r,n),n}var M6=(function(){function e(a,i){switch(i.type){case"base64":return t(bi(a),i);case"binary":return t(a,i);case"buffer":return t(qt&&Buffer.isBuffer(a)?a.toString("binary"):bo(a),i);case"array":return t(wc(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var l=i||{},c=l.dense?[]:{},f=a.match(/\\trowd.*?\\row\b/g);if(!f.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:f.length-1}};return f.forEach(function(m,p){Array.isArray(c)&&(c[p]=[]);for(var v=/\\\w+\b/g,x=0,y,b=-1;y=v.exec(m);){switch(y[0]){case"\\cell":var _=m.slice(x,v.lastIndex-y[0].length);if(_[0]==" "&&(_=_.slice(1)),++b,_.length){var E={v:_,t:"s"};Array.isArray(c)?c[p][b]=E:c[It({r:p,c:b})]=E}break}x=v.lastIndex}b>d.e.c&&(d.e.c=b)}),c["!ref"]=Ut(d),c}function r(a,i){return wo(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],l=sr(a["!ref"]),c,f=Array.isArray(a),d=l.s.r;d<=l.e.r;++d){i.push("\\trowd\\trautofit1");for(var m=l.s.c;m<=l.e.c;++m)i.push("\\cellx"+(m+1));for(i.push("\\pard\\intbl"),m=l.s.c;m<=l.e.c;++m){var p=It({r:d,c:m});c=f?(a[d]||[])[m]:a[p],!(!c||c.v==null&&(!c.f||c.F))&&(i.push(" "+(c.w||(pl(c),c.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function dle(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function n0(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function hle(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),i=Math.min(t,r,n),l=a-i;if(l===0)return[0,0,t];var c=0,f=0,d=a+i;switch(f=l/(d>1?2-d:d),a){case t:c=((r-n)/l+6)%6;break;case r:c=(n-t)/l+2;break;case n:c=(t-r)/l+4;break}return[c/6,f,d/2]}function mle(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),i=n-a/2,l=[i,i,i],c=6*t,f;if(r!==0)switch(c|0){case 0:case 6:f=a*c,l[0]+=a,l[1]+=f;break;case 1:f=a*(2-c),l[0]+=f,l[1]+=a;break;case 2:f=a*(c-2),l[1]+=a,l[2]+=f;break;case 3:f=a*(4-c),l[1]+=f,l[2]+=a;break;case 4:f=a*(c-4),l[2]+=a,l[0]+=f;break;case 5:f=a*(6-c),l[2]+=f,l[0]+=a;break}for(var d=0;d!=3;++d)l[d]=Math.round(l[d]*255);return l}function Yp(e,t){if(t===0)return e;var r=hle(dle(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),n0(mle(r))}var R6=6,ple=15,gle=1,Ea=R6;function a0(e){return Math.floor((e+Math.round(128/Ea)/256)*Ea)}function i0(e){return Math.floor((e-5)/Ea*100+.5)/100}function Qp(e){return Math.round((e*Ea+5)/Ea*256)/256}function lb(e){return Qp(i0(a0(e)))}function NS(e){var t=Math.abs(e-lb(e)),r=Ea;if(t>.005)for(Ea=gle;Ea<ple;++Ea)Math.abs(e-lb(e))<=t&&(t=Math.abs(e-lb(e)),r=Ea);Ea=r}function uo(e){e.width?(e.wpx=a0(e.width),e.wch=i0(e.wpx),e.MDW=Ea):e.wpx?(e.wch=i0(e.wpx),e.width=Qp(e.wch),e.MDW=Ea):typeof e.wch=="number"&&(e.width=Qp(e.wch),e.wpx=a0(e.width),e.MDW=Ea),e.customWidth&&delete e.customWidth}var vle=96,F6=vle;function s0(e){return e*96/F6}function Ju(e){return e*F6/96}var xle={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function yle(e,t,r,n){t.Borders=[];var a={},i=!1;(e[0].match(ja)||[]).forEach(function(l){var c=Pt(l);switch(Ds(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},c.diagonalUp&&(a.diagonalUp=Vr(c.diagonalUp)),c.diagonalDown&&(a.diagonalDown=Vr(c.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in borders")}})}function ble(e,t,r,n){t.Fills=[];var a={},i=!1;(e[0].match(ja)||[]).forEach(function(l){var c=Pt(l);switch(Ds(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":c.patternType&&(a.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),c.indexed&&(a.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(a.bgColor.theme=parseInt(c.theme,10)),c.tint&&(a.bgColor.tint=parseFloat(c.tint)),c.rgb&&(a.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),c.theme&&(a.fgColor.theme=parseInt(c.theme,10)),c.tint&&(a.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(a.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fills")}})}function wle(e,t,r,n){t.Fonts=[];var a={},i=!1;(e[0].match(ja)||[]).forEach(function(l){var c=Pt(l);switch(Ds(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":c.val&&(a.name=Ir(c.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=c.val?Vr(c.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=c.val?Vr(c.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(c.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=c.val?Vr(c.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=c.val?Vr(c.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=c.val?Vr(c.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=c.val?Vr(c.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=c.val?Vr(c.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":c.val&&(a.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(a.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(a.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(a.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=Z2[parseInt(c.val,10)];break;case"<color":if(a.color||(a.color={}),c.auto&&(a.color.auto=Vr(c.auto)),c.rgb)a.color.rgb=c.rgb.slice(-6);else if(c.indexed){a.color.index=parseInt(c.indexed,10);var f=lc[a.color.index];a.color.index==81&&(f=lc[1]),f||(f=lc[1]),a.color.rgb=f[0].toString(16)+f[1].toString(16)+f[2].toString(16)}else c.theme&&(a.color.theme=parseInt(c.theme,10),c.tint&&(a.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=Yp(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+c[0]+" in fonts")}})}function _le(e,t,r){t.NumberFmt=[];for(var n=hn(Dt),a=0;a<n.length;++a)t.NumberFmt[n[a]]=Dt[n[a]];var i=e[0].match(ja);if(i)for(a=0;a<i.length;++a){var l=Pt(i[a]);switch(Ds(l[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=ir(Ir(l.formatCode)),f=parseInt(l.numFmtId,10);if(t.NumberFmt[f]=c,f>0){if(f>392){for(f=392;f>60&&t.NumberFmt[f]!=null;--f);t.NumberFmt[f]=c}sl(c,f)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+l[0]+" in numFmts")}}}function Sle(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ze("numFmt",null,{numFmtId:n,formatCode:Nr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ze("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var jm=["numFmtId","fillId","fontId","borderId","xfId"],Om=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function Ele(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(ja)||[]).forEach(function(i){var l=Pt(i),c=0;switch(Ds(l[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=l,delete n[0],c=0;c<jm.length;++c)n[jm[c]]&&(n[jm[c]]=parseInt(n[jm[c]],10));for(c=0;c<Om.length;++c)n[Om[c]]&&(n[Om[c]]=Vr(n[Om[c]]));if(t.NumberFmt&&n.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[c]){n.numFmtId=c;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var f={};l.vertical&&(f.vertical=l.vertical),l.horizontal&&(f.horizontal=l.horizontal),l.textRotation!=null&&(f.textRotation=l.textRotation),l.indent&&(f.indent=l.indent),l.wrapText&&(f.wrapText=Vr(l.wrapText)),n.alignment=f;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+l[0]+" in cellXfs")}})}function Nle(e){var t=[];return t[t.length]=Ze("cellXfs",null),e.forEach(function(r){t[t.length]=Ze("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ze("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var kle=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,i=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,f,d){var m={};if(!c)return m;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var p;return(p=c.match(t))&&_le(p,m,d),(p=c.match(a))&&wle(p,m,f,d),(p=c.match(n))&&ble(p,m,f,d),(p=c.match(i))&&yle(p,m,f,d),(p=c.match(r))&&Ele(p,m,d),m}})();function L6(e,t){var r=[bn,Ze("styleSheet",null,{xmlns:Oc[0],"xmlns:vt":Rn.vt})],n;return e.SSF&&(n=Sle(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Nle(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Tle(e,t){var r=e.read_shift(2),n=Ta(e);return[r,n]}function Ale(e,t,r){r||(r=Ie(6+4*t.length)),r.write_shift(2,e),Qn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function jle(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=uae(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var l=e.read_shift(1);l!=0&&(n.underline=l);var c=e.read_shift(1);c>0&&(n.family=c);var f=e.read_shift(1);switch(f>0&&(n.charset=f),e.l++,n.color=cae(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Ta(e),n}function Ole(e,t){t||(t=Ie(153)),t.write_shift(2,e.sz*20),fae(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),Gp(e.color,t);var n=0;return n=2,t.write_shift(1,n),Qn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Cle=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ob,Dle=Aa;function j3(e,t){t||(t=Ie(84)),ob||(ob=Jg(Cle));var r=ob[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(Gp({auto:1},t),Gp({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Ile(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function B6(e,t,r){r||(r=Ie(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function md(e,t){return t||(t=Ie(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Ple=Aa;function Mle(e,t){return t||(t=Ie(51)),t.write_shift(1,0),md(null,t),md(null,t),md(null,t),md(null,t),md(null,t),t.length>t.l?t.slice(0,t.l):t}function Rle(e,t){return t||(t=Ie(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),Vp(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Fle(e,t,r){var n=Ie(2052);return n.write_shift(4,e),Vp(t,n),Vp(r,n),n.length>n.l?n.slice(0,n.l):n}function Lle(e,t,r){var n={};n.NumberFmt=[];for(var a in Dt)n.NumberFmt[a]=Dt[a];n.CellXf=[],n.Fonts=[];var i=[],l=!1;return El(e,function(f,d,m){switch(m){case 44:n.NumberFmt[f[0]]=f[1],sl(f[1],f[0]);break;case 43:n.Fonts.push(f),f.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(f.color.rgb=Yp(t.themeElements.clrScheme[f.color.theme].rgb,f.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:i[i.length-1]==617&&n.CellXf.push(f);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:i.push(m),l=!0;break;case 38:i.pop(),l=!1;break;default:if(d.T>0)i.push(m);else if(d.T<0)i.pop();else if(!l||r.WTF&&i[i.length-1]!=37)throw new Error("Unexpected record 0x"+m.toString(16))}}),n}function Ble(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(We(e,615,os(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&We(e,44,Ale(a,t[a]))}),We(e,616))}}function Ule(e){var t=1;We(e,611,os(t)),We(e,43,Ole({sz:12,color:{theme:1},name:"Calibri",family:2})),We(e,612)}function $le(e){var t=2;We(e,603,os(t)),We(e,45,j3({patternType:"none"})),We(e,45,j3({patternType:"gray125"})),We(e,604)}function zle(e){var t=1;We(e,613,os(t)),We(e,46,Mle()),We(e,614)}function Hle(e){var t=1;We(e,626,os(t)),We(e,47,B6({numFmtId:0},65535)),We(e,627)}function qle(e,t){We(e,617,os(t.length)),t.forEach(function(r){We(e,47,B6(r,0))}),We(e,618)}function Wle(e){var t=1;We(e,619,os(t)),We(e,48,Rle({xfId:0,name:"Normal"})),We(e,620)}function Vle(e){var t=0;We(e,505,os(t)),We(e,506)}function Gle(e){var t=0;We(e,508,Fle(t,"TableStyleMedium9","PivotStyleMedium4")),We(e,509)}function Kle(e,t){var r=Xa();return We(r,278),Ble(r,e.SSF),Ule(r),$le(r),zle(r),Hle(r),qle(r,t.cellXfs),Wle(r),Vle(r),Gle(r),We(r,279),r.end()}var Xle=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function Yle(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(ja)||[]).forEach(function(a){var i=Pt(a);switch(i[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=i.val;break;case"<a:sysClr":n.rgb=i.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":i[0].charAt(1)==="/"?(t.themeElements.clrScheme[Xle.indexOf(i[0])]=n,n={}):n.name=i[0].slice(3,i[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+i[0]+" in clrScheme")}})}function Qle(){}function Jle(){}var Zle=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,eoe=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,toe=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function roe(e,t,r){t.themeElements={};var n;[["clrScheme",Zle,Yle],["fontScheme",eoe,Qle],["fmtScheme",toe,Jle]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var noe=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function U6(e,t){(!e||e.length===0)&&(e=kS());var r,n={};if(!(r=e.match(noe)))throw new Error("themeElements not found in theme");return roe(r[0],n,t),n.raw=e,n}function kS(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[bn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function aoe(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var i=e.slice(e.l);e.l=n;var l;try{l=D5(i,{type:"array"})}catch{return}var c=hi(l,"theme/theme/theme1.xml",!0);if(c)return U6(c,r)}}function ioe(e){return e.read_shift(4)}function soe(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=loe(e,4);break;case 2:t.xclrValue=y6(e);break;case 3:t.xclrValue=ioe(e);break;case 4:e.l+=4;break}return e.l+=8,t}function loe(e,t){return Aa(e,t)}function ooe(e,t){return Aa(e,t)}function coe(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=soe(e);break;case 6:n[1]=ooe(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function uoe(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),i=[];a-- >0;)i.push(coe(e,r-e.l));return{ixfe:n,ext:i}}function foe(e,t){t.forEach(function(r){r[0]})}function doe(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ta(e)}}function hoe(e){var t=Ie(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Qn(e.name,t),t.slice(0,t.l)}function moe(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function poe(e){var t=Ie(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function goe(e,t){var r=Ie(8+2*t.length);return r.write_shift(4,e),Qn(t,r),r.slice(0,r.l)}function voe(e){return e.l+=4,e.read_shift(4)!=0}function xoe(e,t){var r=Ie(8);return r.write_shift(4,e),r.write_shift(4,1),r}function yoe(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},i=[],l=!1,c=2;return El(e,function(f,d,m){switch(m){case 335:n.Types.push({name:f.name});break;case 51:f.forEach(function(p){c==1?n.Cell.push({type:n.Types[p[0]-1].name,index:p[1]}):c==0&&n.Value.push({type:n.Types[p[0]-1].name,index:p[1]})});break;case 337:c=f?1:0;break;case 338:c=2;break;case 35:i.push(m),l=!0;break;case 36:i.pop(),l=!1;break;default:if(!d.T){if(!l||a.WTF&&i[i.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}}),n}function boe(){var e=Xa();return We(e,332),We(e,334,os(1)),We(e,335,hoe({name:"XLDAPR",version:12e4,flags:3496657072})),We(e,336),We(e,339,goe(1,"XLDAPR")),We(e,52),We(e,35,os(514)),We(e,4096,os(0)),We(e,4097,Li(1)),We(e,36),We(e,53),We(e,340),We(e,337,xoe(1)),We(e,51,poe([[1,0]])),We(e,338),We(e,333),e.end()}function woe(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,i=2,l;return e.replace(ja,function(c){var f=Pt(c);switch(Ds(f[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:f.name});break;case"</metadataType>":break;case"<futureMetadata":for(var d=0;d<n.Types.length;++d)n.Types[d].name==f.name&&(l=n.Types[d]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":i==1?n.Cell.push({type:n.Types[f.t-1].name,index:+f.v}):i==0&&n.Value.push({type:n.Types[f.t-1].name,index:+f.v});break;case"</rc>":break;case"<cellMetadata":i=1;break;case"</cellMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"</valueMetadata>":i=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!l)break;l.offsets||(l.offsets=[]),l.offsets.push(+f.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+f[0]+" in metadata")}return c}),n}function $6(){var e=[bn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function _oe(e){var t=[];if(!e)return t;var r=1;return(e.match(ja)||[]).forEach(function(n){var a=Pt(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function Soe(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=It(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Eoe(e,t,r){var n=[];return El(e,function(i,l,c){switch(c){case 63:n.push(i);break;default:if(!l.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),n}function Noe(e,t,r,n){if(!e)return e;var a=n||{},i=!1;El(e,function(c,f,d){switch(d){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:i=!0;break;case 36:i=!1;break;default:if(!f.T){if(!i||a.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}},a)}function koe(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Iu=1024;function z6(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Ze("xml",null,{"xmlns:v":ci.v,"xmlns:o":ci.o,"xmlns:x":ci.x,"xmlns:mv":ci.mv}).replace(/\/>/,">"),Ze("o:shapelayout",Ze("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ze("v:shapetype",[Ze("v:stroke",null,{joinstyle:"miter"}),Ze("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Iu<e*1e3;)Iu+=1e3;return t.forEach(function(i){var l=rn(i[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var f=c.type=="gradient"?Ze("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=Ze("v:fill",f,c),m={on:"t",obscured:"t"};++Iu,a=a.concat(["<v:shape"+e0({id:"_x0000_s"+Iu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,Ze("v:shadow",null,m),Ze("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ma("x:Anchor",[l.c+1,0,l.r+1,0,l.c+3,20,l.r+5,20].join(",")),ma("x:AutoFill","False"),ma("x:Row",String(l.r)),ma("x:Column",String(l.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function O3(e,t,r,n){var a=Array.isArray(e),i;t.forEach(function(l){var c=rn(l.ref);if(a?(e[c.r]||(e[c.r]=[]),i=e[c.r][c.c]):i=e[l.ref],!i){i={t:"z"},a?e[c.r][c.c]=i:e[l.ref]=i;var f=sr(e["!ref"]||"BDWGO1000001:A1");f.s.r>c.r&&(f.s.r=c.r),f.e.r<c.r&&(f.e.r=c.r),f.s.c>c.c&&(f.s.c=c.c),f.e.c<c.c&&(f.e.c=c.c);var d=Ut(f);d!==e["!ref"]&&(e["!ref"]=d)}i.c||(i.c=[]);var m={a:l.author,t:l.t,r:l.r,T:r};l.h&&(m.h=l.h);for(var p=i.c.length-1;p>=0;--p){if(!r&&i.c[p].T)return;r&&!i.c[p].T&&i.c.splice(p,1)}if(r&&n){for(p=0;p<n.length;++p)if(m.a==n[p].id){m.a=n[p].name||m.a;break}}i.c.push(m)})}function Toe(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var i=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return i&&i[1]&&i[1].split(/<\/\w*:?comment>/).forEach(function(l){if(!(l===""||l.trim()==="")){var c=l.match(/<(?:\w+:)?comment[^>]*>/);if(c){var f=Pt(c[0]),d={author:f.authorId&&r[f.authorId]||"sheetjsghost",ref:f.ref,guid:f.guid},m=rn(f.ref);if(!(t.sheetRows&&t.sheetRows<=m.r)){var p=l.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!p&&!!p[1]&&SS(p[1])||{r:"",t:"",h:""};d.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),d.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(d.h=v.h),n.push(d)}}}}),n}function H6(e){var t=[bn,Ze("comments",null,{xmlns:Oc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=Nr(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(f){f.a&&(a=r.indexOf(Nr(f.a))),i.push(f.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(ma("t",Nr(i[0]||"")));else{for(var l=`Comment:
    `+i[0]+`
`,c=1;c<i.length;++c)l+=`Reply:
    `+i[c]+`
`;t.push(ma("t",Nr(l)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function Aoe(e,t){var r=[],n=!1,a={},i=0;return e.replace(ja,function(c,f){var d=Pt(c);switch(Ds(d[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:d.personId,guid:d.id,ref:d.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":i=f+c.length;break;case"</text>":a.t=e.slice(i,f).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+d[0]+" in threaded comments")}return c}),r}function joe(e,t,r){var n=[bn,Ze("ThreadedComments",null,{xmlns:Rn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(l,c){if(!l.T){delete l.ID;return}l.a&&t.indexOf(l.a)==-1&&t.push(l.a);var f={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?i=f.id:f.parentId=i,l.ID=f.id,l.a&&(f.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(l.a)).slice(-12)+"}"),n.push(Ze("threadedComment",ma("text",l.t||""),f))})}),n.push("</ThreadedComments>"),n.join("")}function Ooe(e,t){var r=[],n=!1;return e.replace(ja,function(i){var l=Pt(i);switch(Ds(l[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:l.displayname,id:l.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+l[0]+" in threaded comments")}return i}),r}function Coe(e){var t=[bn,Ze("personList",null,{xmlns:Rn.TCMNT,"xmlns:x":Oc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ze("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function Doe(e){var t={};t.iauthor=e.read_shift(4);var r=Pc(e);return t.rfx=r.s,t.ref=It(r.s),e.l+=16,t}function Ioe(e,t){return t==null&&(t=Ie(36)),t.write_shift(4,e[1].iauthor),pf(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var Poe=Ta;function Moe(e){return Qn(e.slice(0,54))}function Roe(e,t){var r=[],n=[],a={},i=!1;return El(e,function(c,f,d){switch(d){case 632:n.push(c);break;case 635:a=c;break;case 637:a.t=c.t,a.h=c.h,a.r=c.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!f.T){if(!i||t.WTF)throw new Error("Unexpected record 0x"+d.toString(16))}}}),r}function Foe(e){var t=Xa(),r=[];return We(t,628),We(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),We(t,632,Moe(a.a)))})}),We(t,631),We(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:rn(n[0]),e:rn(n[0])};We(t,635,Ioe([i,a])),a.t&&a.t.length>0&&We(t,637,iae(a)),We(t,636),delete a.iauthor})}),We(t,634),We(t,629),t.end()}var Loe="application/vnd.ms-office.vbaProject";function Boe(e){var t=kt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");kt.utils.cfb_add(t,a,e.FileIndex[n].content)}}),kt.write(t)}function Uoe(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&kt.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var q6=["xlsb","xlsm","xlam","biff8","xla"];function $oe(){return{"!type":"dialog"}}function zoe(){return{"!type":"dialog"}}function Hoe(){return{"!type":"macro"}}function qoe(){return{"!type":"macro"}}var Bu=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,l){var c=!1,f=!1;i.length==0?f=!0:i.charAt(0)=="["&&(f=!0,i=i.slice(1,-1)),l.length==0?c=!0:l.charAt(0)=="["&&(c=!0,l=l.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,m=l.length>0?parseInt(l,10)|0:0;return c?m+=t.c:--m,f?d+=t.r:--d,a+(c?"":"$")+tn(m)+(f?"":"$")+yn(d)}return function(a,i){return t=i,a.replace(e,r)}})(),TS=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,AS=(function(){return function(t,r){return t.replace(TS,function(n,a,i,l,c,f){var d=mS(l)-(i?0:r.c),m=hS(f)-(c?0:r.r),p=m==0?"":c?m+1:"["+m+"]",v=d==0?"":i?d+1:"["+d+"]";return a+"R"+p+"C"+v})}})();function W6(e,t){return e.replace(TS,function(r,n,a,i,l,c){return n+(a=="$"?a+i:tn(mS(i)+t.c))+(l=="$"?l+c:yn(hS(c)+t.r))})}function Woe(e,t,r){var n=Ya(t),a=n.s,i=rn(r),l={r:i.r-a.r,c:i.c-a.c};return W6(e,l)}function Voe(e){return e.length!=1}function C3(e){return e.replace(/_xlfn\./g,"")}function kn(e){e.l+=1}function fo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function V6(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return G6(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),l=fo(e),c=fo(e);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:i,c:c[0],cRel:c[1],rRel:c[2]}}}function G6(e){var t=fo(e),r=fo(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function Goe(e,t,r){if(r.biff<8)return G6(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=fo(e),l=fo(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:l[0],cRel:l[1],rRel:l[2]}}}function K6(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Koe(e);var n=e.read_shift(r&&r.biff==12?4:2),a=fo(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Koe(e){var t=fo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Xoe(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Yoe(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Qoe(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),l=(i&16384)>>14,c=(i&32768)>>15;if(i&=16383,c==1)for(;a>524287;)a-=1048576;if(l==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:l,rRel:c}}function Qoe(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Joe(e,t,r){var n=(e[e.l++]&96)>>5,a=V6(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function Zoe(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var l=V6(e,i,r);return[n,a,l]}function ece(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function tce(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function rce(e,t,r){var n=(e[e.l++]&96)>>5,a=Goe(e,t-1,r);return[n,a]}function nce(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function D3(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function ace(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function ice(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function sce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function lce(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function oce(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function X6(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function cce(e){return e.read_shift(2),X6(e)}function uce(e){return e.read_shift(2),X6(e)}function fce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=K6(e,0,r);return[n,a]}function dce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Yoe(e,0,r);return[n,a]}function hce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=K6(e,0,r);return[n,a,i]}function mce(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[vue[a],J6[a],n]}function pce(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:gce(e);return[a,(i[0]===0?J6:gue)[i[1]]]}function gce(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function vce(e,t,r){e.l+=r&&r.biff==2?3:4}function xce(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function yce(e){return e.l++,Nl[e.read_shift(1)]}function bce(e){return e.l++,e.read_shift(2)}function wce(e){return e.l++,e.read_shift(1)!==0}function _ce(e){return e.l++,Na(e)}function Sce(e,t,r){return e.l++,$0(e,t-1,r)}function Ece(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=xn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Nl[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Na(e);break;case 2:r[1]=Mc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Nce(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Pc:tv)(e));return a}function kce(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,l=[];i!=n&&(l[i]=[]);++i)for(var c=0;c!=a;++c)l[i][c]=Ece(e,r.biff);return l}function Tce(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function Ace(e,t,r){if(r.biff==5)return jce(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function jce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Oce(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Cce(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Dce(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Ice(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var Pce=Aa,Mce=Aa,Rce=Aa;function H0(e,t,r){return e.l+=2,[Xoe(e)]}function jS(e){return e.l+=6,[]}var Fce=H0,Lce=jS,Bce=jS,Uce=H0;function Y6(e){return e.l+=2,[An(e),e.read_shift(2)&1]}var $ce=H0,zce=Y6,Hce=jS,qce=H0,Wce=H0,Vce=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Gce(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),l=Vce[r>>2&31];return{ixti:t,coltype:r&3,rt:l,idx:n,c:a,C:i}}function Kce(e){return e.l+=2,[e.read_shift(4)]}function Xce(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function Yce(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Qce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Jce(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Zce(e){return e.l+=4,[0,0]}var I3={1:{n:"PtgExp",f:xce},2:{n:"PtgTbl",f:Rce},3:{n:"PtgAdd",f:kn},4:{n:"PtgSub",f:kn},5:{n:"PtgMul",f:kn},6:{n:"PtgDiv",f:kn},7:{n:"PtgPower",f:kn},8:{n:"PtgConcat",f:kn},9:{n:"PtgLt",f:kn},10:{n:"PtgLe",f:kn},11:{n:"PtgEq",f:kn},12:{n:"PtgGe",f:kn},13:{n:"PtgGt",f:kn},14:{n:"PtgNe",f:kn},15:{n:"PtgIsect",f:kn},16:{n:"PtgUnion",f:kn},17:{n:"PtgRange",f:kn},18:{n:"PtgUplus",f:kn},19:{n:"PtgUminus",f:kn},20:{n:"PtgPercent",f:kn},21:{n:"PtgParen",f:kn},22:{n:"PtgMissArg",f:kn},23:{n:"PtgStr",f:Sce},26:{n:"PtgSheet",f:Xce},27:{n:"PtgEndSheet",f:Yce},28:{n:"PtgErr",f:yce},29:{n:"PtgBool",f:wce},30:{n:"PtgInt",f:bce},31:{n:"PtgNum",f:_ce},32:{n:"PtgArray",f:nce},33:{n:"PtgFunc",f:mce},34:{n:"PtgFuncVar",f:pce},35:{n:"PtgName",f:Tce},36:{n:"PtgRef",f:fce},37:{n:"PtgArea",f:Joe},38:{n:"PtgMemArea",f:Oce},39:{n:"PtgMemErr",f:Pce},40:{n:"PtgMemNoMem",f:Mce},41:{n:"PtgMemFunc",f:Cce},42:{n:"PtgRefErr",f:Dce},43:{n:"PtgAreaErr",f:ece},44:{n:"PtgRefN",f:dce},45:{n:"PtgAreaN",f:rce},46:{n:"PtgMemAreaN",f:Qce},47:{n:"PtgMemNoMemN",f:Jce},57:{n:"PtgNameX",f:Ace},58:{n:"PtgRef3d",f:hce},59:{n:"PtgArea3d",f:Zoe},60:{n:"PtgRefErr3d",f:Ice},61:{n:"PtgAreaErr3d",f:tce},255:{}},eue={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},tue={1:{n:"PtgElfLel",f:Y6},2:{n:"PtgElfRw",f:qce},3:{n:"PtgElfCol",f:Fce},6:{n:"PtgElfRwV",f:Wce},7:{n:"PtgElfColV",f:Uce},10:{n:"PtgElfRadical",f:$ce},11:{n:"PtgElfRadicalS",f:Hce},13:{n:"PtgElfColS",f:Lce},15:{n:"PtgElfColSV",f:Bce},16:{n:"PtgElfRadicalLel",f:zce},25:{n:"PtgList",f:Gce},29:{n:"PtgSxName",f:Kce},255:{}},rue={0:{n:"PtgAttrNoop",f:Zce},1:{n:"PtgAttrSemi",f:oce},2:{n:"PtgAttrIf",f:sce},4:{n:"PtgAttrChoose",f:ace},8:{n:"PtgAttrGoto",f:ice},16:{n:"PtgAttrSum",f:vce},32:{n:"PtgAttrBaxcel",f:D3},33:{n:"PtgAttrBaxcel",f:D3},64:{n:"PtgAttrSpace",f:cce},65:{n:"PtgAttrSpaceSemi",f:uce},128:{n:"PtgAttrIfError",f:lce},255:{}};function q0(e,t,r,n){if(n.biff<8)return Aa(e,t);for(var a=e.l+t,i=[],l=0;l!==r.length;++l)switch(r[l][0]){case"PtgArray":r[l][1]=kce(e,0,n),i.push(r[l][1]);break;case"PtgMemArea":r[l][2]=Nce(e,r[l][1],n),i.push(r[l][2]);break;case"PtgExp":n&&n.biff==12&&(r[l][1][1]=e.read_shift(4),i.push(r[l][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[l][0]}return t=a-e.l,t!==0&&i.push(Aa(e,t)),i}function W0(e,t,r){for(var n=e.l+t,a,i,l=[];n!=e.l;)t=n-e.l,i=e[e.l],a=I3[i]||I3[eue[i]],(i===24||i===25)&&(a=(i===24?tue:rue)[e[e.l+1]]),!a||!a.f?Aa(e,t):l.push([a.n,a.f(e,t,r)]);return l}function nue(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var l=n[i];if(l)switch(l[0]){case 2:a.push('"'+l[1].replace(/"/g,'""')+'"');break;default:a.push(l[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var aue={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function iue(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function Q6(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function P3(e,t,r){var n=Q6(e,t,r);return n=="#REF"?n:iue(n,r)}function _a(e,t,r,n,a){var i=a&&a.biff||8,l={s:{c:0,r:0}},c=[],f,d,m,p=0,v=0,x,y="";if(!e[0]||!e[0][0])return"";for(var b=-1,_="",E=0,A=e[0].length;E<A;++E){var T=e[0][E];switch(T[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(f=c.pop(),d=c.pop(),b>=0){switch(e[0][b][1][0]){case 0:_=fn(" ",e[0][b][1][1]);break;case 1:_=fn("\r",e[0][b][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}d=d+_,b=-1}c.push(d+aue[T[0]]+f);break;case"PtgIsect":f=c.pop(),d=c.pop(),c.push(d+" "+f);break;case"PtgUnion":f=c.pop(),d=c.pop(),c.push(d+","+f);break;case"PtgRange":f=c.pop(),d=c.pop(),c.push(d+":"+f);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":m=Nd(T[1][1],l,a),c.push(kd(m,i));break;case"PtgRefN":m=r?Nd(T[1][1],r,a):T[1][1],c.push(kd(m,i));break;case"PtgRef3d":p=T[1][1],m=Nd(T[1][2],l,a),y=P3(n,p,a),c.push(y+"!"+kd(m,i));break;case"PtgFunc":case"PtgFuncVar":var k=T[1][0],I=T[1][1];k||(k=0),k&=127;var O=k==0?[]:c.slice(-k);c.length-=k,I==="User"&&(I=O.shift()),c.push(I+"("+O.join(",")+")");break;case"PtgBool":c.push(T[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(T[1]);break;case"PtgNum":c.push(String(T[1]));break;case"PtgStr":c.push('"'+T[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(T[1]);break;case"PtgAreaN":x=c3(T[1][1],r?{s:r}:l,a),c.push(ab(x,a));break;case"PtgArea":x=c3(T[1][1],l,a),c.push(ab(x,a));break;case"PtgArea3d":p=T[1][1],x=T[1][2],y=P3(n,p,a),c.push(y+"!"+ab(x,a));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=T[1][2];var j=(n.names||[])[v-1]||(n[0]||[])[v],B=j?j.Name:"SH33TJSNAME"+String(v);B&&B.slice(0,6)=="_xlfn."&&!a.xlfn&&(B=B.slice(6)),c.push(B);break;case"PtgNameX":var U=T[1][1];v=T[1][2];var Y;if(a.biff<=5)U<0&&(U=-U),n[U]&&(Y=n[U][v]);else{var te="";if(((n[U]||[])[0]||[])[0]==14849||(((n[U]||[])[0]||[])[0]==1025?n[U][v]&&n[U][v].itab>0&&(te=n.SheetNames[n[U][v].itab-1]+"!"):te=n.SheetNames[v-1]+"!"),n[U]&&n[U][v])te+=n[U][v].Name;else if(n[0]&&n[0][v])te+=n[0][v].Name;else{var V=(Q6(n,U,a)||"").split(";;");V[v-1]?te=V[v-1]:te+="SH33TJSERRX"}c.push(te);break}Y||(Y={Name:"SH33TJSERRY"}),c.push(Y.Name);break;case"PtgParen":var ge="(",be=")";if(b>=0){switch(_="",e[0][b][1][0]){case 2:ge=fn(" ",e[0][b][1][1])+ge;break;case 3:ge=fn("\r",e[0][b][1][1])+ge;break;case 4:be=fn(" ",e[0][b][1][1])+be;break;case 5:be=fn("\r",e[0][b][1][1])+be;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}c.push(ge+c.pop()+be);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":m={c:T[1][1],r:T[1][0]};var ve={c:r.c,r:r.r};if(n.sharedf[It(m)]){var z=n.sharedf[It(m)];c.push(_a(z,l,ve,n,a))}else{var ue=!1;for(f=0;f!=n.arrayf.length;++f)if(d=n.arrayf[f],!(m.c<d[0].s.c||m.c>d[0].e.c)&&!(m.r<d[0].s.r||m.r>d[0].e.r)){c.push(_a(d[1],l,ve,n,a)),ue=!0;break}ue||c.push(T[1])}break;case"PtgArray":c.push("{"+nue(T[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=E;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+T[1].idx+"[#"+T[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(T));default:throw new Error("Unrecognized Formula Token: "+String(T))}var se=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&b>=0&&se.indexOf(e[0][E][0])==-1){T=e[0][b];var Q=!0;switch(T[1][0]){case 4:Q=!1;case 0:_=fn(" ",T[1][1]);break;case 5:Q=!1;case 1:_=fn("\r",T[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+T[1][0])}c.push((Q?_:"")+c.pop()+(Q?"":_)),b=-1}}if(c.length>1&&a.WTF)throw new Error("bad formula stack");return c[0]}function sue(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,l=e.read_shift(a);if(l==65535)return[[],Aa(e,t-2)];var c=W0(e,l,r);return t!==l+a&&(i=q0(e,t-l-a,c,r)),e.l=n,[c,i]}function lue(e,t,r){var n=e.l+t,a=r.biff==2?1:2,i,l=e.read_shift(a);if(l==65535)return[[],Aa(e,t-2)];var c=W0(e,l,r);return t!==l+a&&(i=q0(e,t-l-a,c,r)),e.l=n,[c,i]}function oue(e,t,r,n){var a=e.l+t,i=W0(e,n,r),l;return a!==e.l&&(l=q0(e,a-e.l,i,r)),[i,l]}function cue(e,t,r){var n=e.l+t,a,i=e.read_shift(2),l=W0(e,i,r);return i==65535?[[],Aa(e,t-2)]:(t!==i+2&&(a=q0(e,n-i-2,l,r)),[l,a])}function uue(e){var t;if(rl(e,e.l+6)!==65535)return[Na(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function fue(e){if(e==null){var t=Ie(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return _c(e);return _c(0)}function cb(e,t,r){var n=e.l+t,a=Is(e);r.biff==2&&++e.l;var i=uue(e),l=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=lue(e,n-e.l,r);return{cell:a,val:i[0],formula:c,shared:l>>3&1,tt:i[1]}}function due(e,t,r,n,a){var i=Ec(t,r,a),l=fue(e.v),c=Ie(6),f=33;c.write_shift(2,f),c.write_shift(4,0);for(var d=Ie(e.bf.length),m=0;m<e.bf.length;++m)d[m]=e.bf[m];var p=Xn([i,l,c,d]);return p}function rv(e,t,r){var n=e.read_shift(4),a=W0(e,n,r),i=e.read_shift(4),l=i>0?q0(e,i,a,r):null;return[a,l]}var hue=rv,nv=rv,mue=rv,pue=rv,gue={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},J6={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},vue={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function M3(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function xue(e){var t="of:="+e.replace(TS,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ub(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function yue(e){return e.replace(/\./,"!")}var Ad={},Uu={},jd=typeof Map<"u";function OS(e,t,r){var n=0,a=e.length;if(r){if(jd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=jd?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(jd?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function av(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Ea=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=i0(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Qp(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function uc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function _o(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){sl(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function Z6(e,t,r,n,a,i){try{n.cellNF&&(e.z=Dt[t])}catch(c){if(n.WTF)throw c}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Kr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Dt[t]==null&&sl(gne[t]||"General",t),e.t==="e")e.w=e.w||Nl[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jd(e.v);else if(e.t==="d"){var l=Fn(e.v);(l|0)===l?e.w=l.toString(10):e.w=Jd(l)}else{if(e.v===void 0)return"";e.w=bc(e.v,Uu)}else e.t==="d"?e.w=qi(t,Fn(e.v),Uu):e.w=qi(t,e.v,Uu)}catch(c){if(n.WTF)throw c}if(n.cellStyles&&r!=null)try{e.s=i.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Yp(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Yp(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(n.WTF&&i.Fills)throw c}}}function bue(e,t,r){if(e&&e["!ref"]){var n=sr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function wue(e,t){var r=sr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=Ut(r))}var _ue=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Sue=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Eue=/<(?:\w:)?hyperlink [^>]*>/mg,Nue=/"(\w*:\w*)"/,kue=/<(?:\w:)?col\b[^>]*[\/]?>/g,Tue=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Aue=/<(?:\w:)?pageMargins[^>]*\/>/g,e8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,jue=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Oue=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Cue(e,t,r,n,a,i,l){if(!e)return e;n||(n={"!id":{}});var c=t.dense?[]:{},f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d="",m="",p=e.match(Sue);p?(d=e.slice(0,p.index),m=e.slice(p.index+p[0].length)):d=m=e;var v=d.match(e8);v?CS(v[0],c,a,r):(v=d.match(jue))&&Iue(v[0],v[1]||"",c,a,r);var x=(d.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(x>0){var y=d.slice(x,x+50).match(Nue);y&&wue(c,y[1])}var b=d.match(Oue);b&&b[1]&&Vue(b[1],a);var _=[];if(t.cellStyles){var E=d.match(kue);E&&$ue(_,E)}p&&Xue(p[1],c,t,f,i,l);var A=m.match(Tue);A&&(c["!autofilter"]=Hue(A[0]));var T=[],k=m.match(_ue);if(k)for(x=0;x!=k.length;++x)T[x]=sr(k[x].slice(k[x].indexOf('"')+1));var I=m.match(Eue);I&&Lue(c,I,n);var O=m.match(Aue);if(O&&(c["!margins"]=Bue(Pt(O[0]))),!c["!ref"]&&f.e.c>=f.s.c&&f.e.r>=f.s.r&&(c["!ref"]=Ut(f)),t.sheetRows>0&&c["!ref"]){var j=sr(c["!ref"]);t.sheetRows<=+j.e.r&&(j.e.r=t.sheetRows-1,j.e.r>f.e.r&&(j.e.r=f.e.r),j.e.r<j.s.r&&(j.s.r=j.e.r),j.e.c>f.e.c&&(j.e.c=f.e.c),j.e.c<j.s.c&&(j.s.c=j.e.c),c["!fullref"]=c["!ref"],c["!ref"]=Ut(j))}return _.length>0&&(c["!cols"]=_),T.length>0&&(c["!merges"]=T),c}function Due(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+Ut(e[r])+'"/>';return t+"</mergeCells>"}function CS(e,t,r,n){var a=Pt(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ir(Ir(a.codeName)))}function Iue(e,t,r,n,a){CS(e.slice(0,e.indexOf(">")),r,n,a)}function Pue(e,t,r,n,a){var i=!1,l={},c=null;if(n.bookType!=="xlsx"&&t.vbaraw){var f=t.SheetNames[r];try{t.Workbook&&(f=t.Workbook.Sheets[r].CodeName||f)}catch{}i=!0,l.codeName=Ns(Nr(f))}if(e&&e["!outline"]){var d={summaryBelow:1,summaryRight:1};e["!outline"].above&&(d.summaryBelow=0),e["!outline"].left&&(d.summaryRight=0),c=(c||"")+Ze("outlinePr",null,d)}!i&&!c||(a[a.length]=Ze("sheetPr",c,l))}var Mue=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Rue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Fue(e){var t={sheet:1};return Mue.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Rue.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=ES(e.password).toString(16).toUpperCase()),Ze("sheetProtection",null,t)}function Lue(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var i=Pt(Ir(t[a]),!0);if(!i.ref)return;var l=((r||{})["!id"]||[])[i.id];l?(i.Target=l.Target,i.location&&(i.Target+="#"+ir(i.location))):(i.Target="#"+ir(i.location),l={Target:i.Target,TargetMode:"Internal"}),i.Rel=l,i.tooltip&&(i.Tooltip=i.tooltip,delete i.tooltip);for(var c=sr(i.ref),f=c.s.r;f<=c.e.r;++f)for(var d=c.s.c;d<=c.e.c;++d){var m=It({c:d,r:f});n?(e[f]||(e[f]=[]),e[f][d]||(e[f][d]={t:"z",v:void 0}),e[f][d].l=i):(e[m]||(e[m]={t:"z",v:void 0}),e[m].l=i)}}}function Bue(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Uue(e){return uc(e),Ze("pageMargins",null,e)}function $ue(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Pt(t[n],!0);a.hidden&&(a.hidden=Vr(a.hidden));var i=parseInt(a.min,10)-1,l=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,NS(a.width)),uo(a);i<=l;)e[i++]=Xr(a)}}function zue(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Ze("col",null,av(a,n)));return r[r.length]="</cols>",r.join("")}function Hue(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function que(e,t,r,n){var a=typeof e.ref=="string"?e.ref:Ut(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,l=Ya(a);l.s.r==l.e.r&&(l.e.r=Ya(t["!ref"]).e.r,a=Ut(l));for(var c=0;c<i.length;++c){var f=i[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==n){f.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return c==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Ze("autoFilter",null,{ref:a})}var Wue=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Vue(e,t){t.Views||(t.Views=[{}]),(e.match(Wue)||[]).forEach(function(r,n){var a=Pt(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),Vr(a.rightToLeft)&&(t.Views[n].RTL=!0)})}function Gue(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ze("sheetViews",Ze("sheetView",null,a),{})}function Kue(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,l=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=Nl[e.v];break;case"d":n&&n.cellDates?a=Kr(e.v,-1).toISOString():(e=Xr(e),e.t="n",a=""+(e.v=Fn(Kr(e.v)))),typeof e.z>"u"&&(e.z=Dt[14]);break;default:a=e.v;break}var c=ma("v",Nr(a)),f={r:t},d=_o(n.cellXfs,e,n);switch(d!==0&&(f.s=d),e.t){case"n":break;case"d":f.t="d";break;case"b":f.t="b";break;case"e":f.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){c=ma("v",""+OS(n.Strings,e.v,n.revStrings)),f.t="s";break}f.t="str";break}if(e.t!=i&&(e.t=i,e.v=l),typeof e.f=="string"&&e.f){var m=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Ze("f",Nr(e.f),m)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(f.cm=1),Ze("c",c,f)}var Xue=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,i=Zd("v"),l=Zd("f");return function(f,d,m,p,v,x){for(var y=0,b="",_=[],E=[],A=0,T=0,k=0,I="",O,j,B=0,U=0,Y,te,V=0,ge=0,be=Array.isArray(x.CellXf),ve,z=[],ue=[],se=Array.isArray(d),Q=[],re={},G=!1,P=!!m.sheetStubs,W=f.split(t),F=0,M=W.length;F!=M;++F){b=W[F].trim();var le=b.length;if(le!==0){var pe=0;e:for(y=0;y<le;++y)switch(b[y]){case">":if(b[y-1]!="/"){++y;break e}if(m&&m.cellStyles){if(j=Pt(b.slice(pe,y),!0),B=j.r!=null?parseInt(j.r,10):B+1,U=-1,m.sheetRows&&m.sheetRows<B)continue;re={},G=!1,j.ht&&(G=!0,re.hpt=parseFloat(j.ht),re.hpx=Ju(re.hpt)),j.hidden=="1"&&(G=!0,re.hidden=!0),j.outlineLevel!=null&&(G=!0,re.level=+j.outlineLevel),G&&(Q[B-1]=re)}break;case"<":pe=y;break}if(pe>=y)break;if(j=Pt(b.slice(pe,y),!0),B=j.r!=null?parseInt(j.r,10):B+1,U=-1,!(m.sheetRows&&m.sheetRows<B)){p.s.r>B-1&&(p.s.r=B-1),p.e.r<B-1&&(p.e.r=B-1),m&&m.cellStyles&&(re={},G=!1,j.ht&&(G=!0,re.hpt=parseFloat(j.ht),re.hpx=Ju(re.hpt)),j.hidden=="1"&&(G=!0,re.hidden=!0),j.outlineLevel!=null&&(G=!0,re.level=+j.outlineLevel),G&&(Q[B-1]=re)),_=b.slice(y).split(e);for(var Ae=0;Ae!=_.length&&_[Ae].trim().charAt(0)=="<";++Ae);for(_=_.slice(Ae),y=0;y!=_.length;++y)if(b=_[y].trim(),b.length!==0){if(E=b.match(r),A=y,T=0,k=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,E!=null&&E.length===2){for(A=0,I=E[1],T=0;T!=I.length&&!((k=I.charCodeAt(T)-64)<1||k>26);++T)A=26*A+k;--A,U=A}else++U;for(T=0;T!=b.length&&b.charCodeAt(T)!==62;++T);if(++T,j=Pt(b.slice(0,T),!0),j.r||(j.r=It({r:B-1,c:U})),I=b.slice(T),O={t:""},(E=I.match(i))!=null&&E[1]!==""&&(O.v=ir(E[1])),m.cellFormula){if((E=I.match(l))!=null&&E[1]!==""){if(O.f=ir(Ir(E[1])).replace(/\r\n/g,`
`),m.xlfn||(O.f=C3(O.f)),E[0].indexOf('t="array"')>-1)O.F=(I.match(a)||[])[1],O.F.indexOf(":")>-1&&z.push([sr(O.F),O.F]);else if(E[0].indexOf('t="shared"')>-1){te=Pt(E[0]);var oe=ir(Ir(E[1]));m.xlfn||(oe=C3(oe)),ue[parseInt(te.si,10)]=[te,oe,j.r]}}else(E=I.match(/<f[^>]*\/>/))&&(te=Pt(E[0]),ue[te.si]&&(O.f=Woe(ue[te.si][1],ue[te.si][2],j.r)));var ae=rn(j.r);for(T=0;T<z.length;++T)ae.r>=z[T][0].s.r&&ae.r<=z[T][0].e.r&&ae.c>=z[T][0].s.c&&ae.c<=z[T][0].e.c&&(O.F=z[T][1])}if(j.t==null&&O.v===void 0)if(O.f||O.F)O.v=0,O.t="n";else if(P)O.t="z";else continue;else O.t=j.t||"n";switch(p.s.c>U&&(p.s.c=U),p.e.c<U&&(p.e.c=U),O.t){case"n":if(O.v==""||O.v==null){if(!P)continue;O.t="z"}else O.v=parseFloat(O.v);break;case"s":if(typeof O.v>"u"){if(!P)continue;O.t="z"}else Y=Ad[parseInt(O.v,10)],O.v=Y.t,O.r=Y.r,m.cellHTML&&(O.h=Y.h);break;case"str":O.t="s",O.v=O.v!=null?Ir(O.v):"",m.cellHTML&&(O.h=cS(O.v));break;case"inlineStr":E=I.match(n),O.t="s",E!=null&&(Y=SS(E[1]))?(O.v=Y.t,m.cellHTML&&(O.h=Y.h)):O.v="";break;case"b":O.v=Vr(O.v);break;case"d":m.cellDates?O.v=Kr(O.v,1):(O.v=Fn(Kr(O.v,1)),O.t="n");break;case"e":(!m||m.cellText!==!1)&&(O.w=O.v),O.v=r6[O.v];break}if(V=ge=0,ve=null,be&&j.s!==void 0&&(ve=x.CellXf[j.s],ve!=null&&(ve.numFmtId!=null&&(V=ve.numFmtId),m.cellStyles&&ve.fillId!=null&&(ge=ve.fillId))),Z6(O,V,ge,m,v,x),m.cellDates&&be&&O.t=="n"&&df(Dt[V])&&(O.t="d",O.v=ev(O.v)),j.cm&&m.xlmeta){var ze=(m.xlmeta.Cell||[])[+j.cm-1];ze&&ze.type=="XLDAPR"&&(O.D=!0)}if(se){var q=rn(j.r);d[q.r]||(d[q.r]=[]),d[q.r][q.c]=O}else d[j.r]=O}}}}Q.length>0&&(d["!rows"]=Q)}})();function Yue(e,t,r,n){var a=[],i=[],l=sr(e["!ref"]),c="",f,d="",m=[],p=0,v=0,x=e["!rows"],y=Array.isArray(e),b={r:d},_,E=-1;for(v=l.s.c;v<=l.e.c;++v)m[v]=tn(v);for(p=l.s.r;p<=l.e.r;++p){for(i=[],d=yn(p),v=l.s.c;v<=l.e.c;++v){f=m[v]+d;var A=y?(e[p]||[])[v]:e[f];A!==void 0&&(c=Kue(A,f,e,t))!=null&&i.push(c)}(i.length>0||x&&x[p])&&(b={r:d},x&&x[p]&&(_=x[p],_.hidden&&(b.hidden=1),E=-1,_.hpx?E=s0(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(b.ht=E,b.customHeight=1),_.level&&(b.outlineLevel=_.level)),a[a.length]=Ze("row",i.join(""),b))}if(x)for(;p<x.length;++p)x&&x[p]&&(b={r:p+1},_=x[p],_.hidden&&(b.hidden=1),E=-1,_.hpx?E=s0(_.hpx):_.hpt&&(E=_.hpt),E>-1&&(b.ht=E,b.customHeight=1),_.level&&(b.outlineLevel=_.level),a[a.length]=Ze("row","",b));return a.join("")}function t8(e,t,r,n){var a=[bn,Ze("worksheet",null,{xmlns:Oc[0],"xmlns:r":Rn.r})],i=r.SheetNames[e],l=0,c="",f=r.Sheets[i];f==null&&(f={});var d=f["!ref"]||"A1",m=sr(d);if(m.e.c>16383||m.e.r>1048575){if(t.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");m.e.c=Math.min(m.e.c,16383),m.e.r=Math.min(m.e.c,1048575),d=Ut(m)}n||(n={}),f["!comments"]=[];var p=[];Pue(f,r,e,t,a),a[a.length]=Ze("dimension",null,{ref:d}),a[a.length]=Gue(f,t,e,r),t.sheetFormat&&(a[a.length]=Ze("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),f["!cols"]!=null&&f["!cols"].length>0&&(a[a.length]=zue(f,f["!cols"])),a[l=a.length]="<sheetData/>",f["!links"]=[],f["!ref"]!=null&&(c=Yue(f,t),c.length>0&&(a[a.length]=c)),a.length>l+1&&(a[a.length]="</sheetData>",a[l]=a[l].replace("/>",">")),f["!protect"]&&(a[a.length]=Fue(f["!protect"])),f["!autofilter"]!=null&&(a[a.length]=que(f["!autofilter"],f,r,e)),f["!merges"]!=null&&f["!merges"].length>0&&(a[a.length]=Due(f["!merges"]));var v=-1,x,y=-1;return f["!links"].length>0&&(a[a.length]="<hyperlinks>",f["!links"].forEach(function(b){b[1].Target&&(x={ref:b[0]},b[1].Target.charAt(0)!="#"&&(y=_r(n,-1,Nr(b[1].Target).replace(/#.*$/,""),Gt.HLINK),x["r:id"]="rId"+y),(v=b[1].Target.indexOf("#"))>-1&&(x.location=Nr(b[1].Target.slice(v+1))),b[1].Tooltip&&(x.tooltip=Nr(b[1].Tooltip)),a[a.length]=Ze("hyperlink",null,x))}),a[a.length]="</hyperlinks>"),delete f["!links"],f["!margins"]!=null&&(a[a.length]=Uue(f["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=ma("ignoredErrors",Ze("ignoredError",null,{numberStoredAsText:1,sqref:d}))),p.length>0&&(y=_r(n,-1,"../drawings/drawing"+(e+1)+".xml",Gt.DRAW),a[a.length]=Ze("drawing",null,{"r:id":"rId"+y}),f["!drawing"]=p),f["!comments"].length>0&&(y=_r(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Gt.VML),a[a.length]=Ze("legacyDrawing",null,{"r:id":"rId"+y}),f["!legacy"]=y),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Que(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function Jue(e,t,r){var n=Ie(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=s0(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var l=0;a.level&&(l|=a.level),a.hidden&&(l|=16),(a.hpx||a.hpt)&&(l|=32),n.write_shift(1,l),n.write_shift(1,0);var c=0,f=n.l;n.l+=4;for(var d={r:e,c:0},m=0;m<16;++m)if(!(t.s.c>m+1<<10||t.e.c<m<<10)){for(var p=-1,v=-1,x=m<<10;x<m+1<<10;++x){d.c=x;var y=Array.isArray(r)?(r[d.r]||[])[d.c]:r[It(d)];y&&(p<0&&(p=x),v=x)}p<0||(++c,n.write_shift(4,p),n.write_shift(4,v))}var b=n.l;return n.l=f,n.write_shift(4,c),n.l=b,n.length>n.l?n.slice(0,n.l):n}function Zue(e,t,r,n){var a=Jue(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&We(e,0,a)}var efe=Pc,tfe=pf;function rfe(){}function nfe(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=sae(e),r}function afe(e,t,r){r==null&&(r=Ie(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return Gp({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),Q5(e,r),r.slice(0,r.l)}function ife(e){var t=Vi(e);return[t]}function sfe(e,t,r){return r==null&&(r=Ie(8)),Cc(t,r)}function lfe(e){var t=Dc(e);return[t]}function ofe(e,t,r){return r==null&&(r=Ie(4)),Ic(t,r)}function cfe(e){var t=Vi(e),r=e.read_shift(1);return[t,r,"b"]}function ufe(e,t,r){return r==null&&(r=Ie(9)),Cc(t,r),r.write_shift(1,e.v?1:0),r}function ffe(e){var t=Dc(e),r=e.read_shift(1);return[t,r,"b"]}function dfe(e,t,r){return r==null&&(r=Ie(5)),Ic(t,r),r.write_shift(1,e.v?1:0),r}function hfe(e){var t=Vi(e),r=e.read_shift(1);return[t,r,"e"]}function mfe(e,t,r){return r==null&&(r=Ie(9)),Cc(t,r),r.write_shift(1,e.v),r}function pfe(e){var t=Dc(e),r=e.read_shift(1);return[t,r,"e"]}function gfe(e,t,r){return r==null&&(r=Ie(8)),Ic(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function vfe(e){var t=Vi(e),r=e.read_shift(4);return[t,r,"s"]}function xfe(e,t,r){return r==null&&(r=Ie(12)),Cc(t,r),r.write_shift(4,t.v),r}function yfe(e){var t=Dc(e),r=e.read_shift(4);return[t,r,"s"]}function bfe(e,t,r){return r==null&&(r=Ie(8)),Ic(t,r),r.write_shift(4,t.v),r}function wfe(e){var t=Vi(e),r=Na(e);return[t,r,"n"]}function _fe(e,t,r){return r==null&&(r=Ie(16)),Cc(t,r),_c(e.v,r),r}function r8(e){var t=Dc(e),r=Na(e);return[t,r,"n"]}function Sfe(e,t,r){return r==null&&(r=Ie(12)),Ic(t,r),_c(e.v,r),r}function Efe(e){var t=Vi(e),r=xS(e);return[t,r,"n"]}function Nfe(e,t,r){return r==null&&(r=Ie(12)),Cc(t,r),J5(e.v,r),r}function kfe(e){var t=Dc(e),r=xS(e);return[t,r,"n"]}function Tfe(e,t,r){return r==null&&(r=Ie(8)),Ic(t,r),J5(e.v,r),r}function Afe(e){var t=Vi(e),r=pS(e);return[t,r,"is"]}function jfe(e){var t=Vi(e),r=Ta(e);return[t,r,"str"]}function Ofe(e,t,r){return r==null&&(r=Ie(12+4*e.v.length)),Cc(t,r),Qn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Cfe(e){var t=Dc(e),r=Ta(e);return[t,r,"str"]}function Dfe(e,t,r){return r==null&&(r=Ie(8+4*e.v.length)),Ic(t,r),Qn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Ife(e,t,r){var n=e.l+t,a=Vi(e);a.r=r["!row"];var i=e.read_shift(1),l=[a,i,"b"];if(r.cellFormula){e.l+=2;var c=nv(e,n-e.l,r);l[3]=_a(c,null,a,r.supbooks,r)}else e.l=n;return l}function Pfe(e,t,r){var n=e.l+t,a=Vi(e);a.r=r["!row"];var i=e.read_shift(1),l=[a,i,"e"];if(r.cellFormula){e.l+=2;var c=nv(e,n-e.l,r);l[3]=_a(c,null,a,r.supbooks,r)}else e.l=n;return l}function Mfe(e,t,r){var n=e.l+t,a=Vi(e);a.r=r["!row"];var i=Na(e),l=[a,i,"n"];if(r.cellFormula){e.l+=2;var c=nv(e,n-e.l,r);l[3]=_a(c,null,a,r.supbooks,r)}else e.l=n;return l}function Rfe(e,t,r){var n=e.l+t,a=Vi(e);a.r=r["!row"];var i=Ta(e),l=[a,i,"str"];if(r.cellFormula){e.l+=2;var c=nv(e,n-e.l,r);l[3]=_a(c,null,a,r.supbooks,r)}else e.l=n;return l}var Ffe=Pc,Lfe=pf;function Bfe(e,t){return t==null&&(t=Ie(4)),t.write_shift(4,e),t}function Ufe(e,t){var r=e.l+t,n=Pc(e),a=gS(e),i=Ta(e),l=Ta(e),c=Ta(e);e.l=r;var f={rfx:n,relId:a,loc:i,display:c};return l&&(f.Tooltip=l),f}function $fe(e,t){var r=Ie(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));pf({s:rn(e[0]),e:rn(e[0])},r),vS("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Qn(a||"",r),Qn(e[1].Tooltip||"",r),Qn("",r),r.slice(0,r.l)}function zfe(){}function Hfe(e,t,r){var n=e.l+t,a=Z5(e),i=e.read_shift(1),l=[a];if(l[2]=i,r.cellFormula){var c=hue(e,n-e.l,r);l[1]=c}else e.l=n;return l}function qfe(e,t,r){var n=e.l+t,a=Pc(e),i=[a];if(r.cellFormula){var l=pue(e,n-e.l,r);i[1]=l,e.l=n}else e.l=n;return i}function Wfe(e,t,r){r==null&&(r=Ie(18));var n=av(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var n8=["left","right","top","bottom","header","footer"];function Vfe(e){var t={};return n8.forEach(function(r){t[r]=Na(e)}),t}function Gfe(e,t){return t==null&&(t=Ie(48)),uc(e),n8.forEach(function(r){_c(e[r],t)}),t}function Kfe(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Xfe(e,t,r){r==null&&(r=Ie(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function Yfe(e){var t=Ie(24);return t.write_shift(4,4),t.write_shift(4,1),pf(e,t),t}function Qfe(e,t){return t==null&&(t=Ie(66)),t.write_shift(2,e.password?ES(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Jfe(){}function Zfe(){}function ede(e,t,r,n,a,i,l){if(!e)return e;var c=t||{};n||(n={"!id":{}});var f=c.dense?[]:{},d,m={s:{r:2e6,c:2e6},e:{r:0,c:0}},p=!1,v=!1,x,y,b,_,E,A,T,k,I,O=[];c.biff=12,c["!row"]=0;var j=0,B=!1,U=[],Y={},te=c.supbooks||a.supbooks||[[]];if(te.sharedf=Y,te.arrayf=U,te.SheetNames=a.SheetNames||a.Sheets.map(function(se){return se.name}),!c.supbooks&&(c.supbooks=te,a.Names))for(var V=0;V<a.Names.length;++V)te[0][V+1]=a.Names[V];var ge=[],be=[],ve=!1;l0[16]={n:"BrtShortReal",f:r8};var z;if(El(e,function(Q,re,G){if(!v)switch(G){case 148:d=Q;break;case 0:x=Q,c.sheetRows&&c.sheetRows<=x.r&&(v=!0),k=yn(_=x.r),c["!row"]=x.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=Ju(Q.hpt)),be[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(y={t:Q[2]},Q[2]){case"n":y.v=Q[1];break;case"s":T=Ad[Q[1]],y.v=T.t,y.r=T.r;break;case"b":y.v=!!Q[1];break;case"e":y.v=Q[1],c.cellText!==!1&&(y.w=Nl[y.v]);break;case"str":y.t="s",y.v=Q[1];break;case"is":y.t="s",y.v=Q[1].t;break}if((b=l.CellXf[Q[0].iStyleRef])&&Z6(y,b.numFmtId,null,c,i,l),E=Q[0].c==-1?E+1:Q[0].c,c.dense?(f[_]||(f[_]=[]),f[_][E]=y):f[tn(E)+k]=y,c.cellFormula){for(B=!1,j=0;j<U.length;++j){var P=U[j];x.r>=P[0].s.r&&x.r<=P[0].e.r&&E>=P[0].s.c&&E<=P[0].e.c&&(y.F=Ut(P[0]),B=!0)}!B&&Q.length>3&&(y.f=Q[3])}if(m.s.r>x.r&&(m.s.r=x.r),m.s.c>E&&(m.s.c=E),m.e.r<x.r&&(m.e.r=x.r),m.e.c<E&&(m.e.c=E),c.cellDates&&b&&y.t=="n"&&df(Dt[b.numFmtId])){var W=ec(y.v);W&&(y.t="d",y.v=new Date(W.y,W.m-1,W.d,W.H,W.M,W.S,W.u))}z&&(z.type=="XLDAPR"&&(y.D=!0),z=void 0);break;case 1:case 12:if(!c.sheetStubs||p)break;y={t:"z",v:void 0},E=Q[0].c==-1?E+1:Q[0].c,c.dense?(f[_]||(f[_]=[]),f[_][E]=y):f[tn(E)+k]=y,m.s.r>x.r&&(m.s.r=x.r),m.s.c>E&&(m.s.c=E),m.e.r<x.r&&(m.e.r=x.r),m.e.c<E&&(m.e.c=E),z&&(z.type=="XLDAPR"&&(y.D=!0),z=void 0);break;case 176:O.push(Q);break;case 49:z=((c.xlmeta||{}).Cell||[])[Q-1];break;case 494:var F=n["!id"][Q.relId];for(F?(Q.Target=F.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=F):Q.relId==""&&(Q.Target="#"+Q.loc),_=Q.rfx.s.r;_<=Q.rfx.e.r;++_)for(E=Q.rfx.s.c;E<=Q.rfx.e.c;++E)c.dense?(f[_]||(f[_]=[]),f[_][E]||(f[_][E]={t:"z",v:void 0}),f[_][E].l=Q):(A=It({c:E,r:_}),f[A]||(f[A]={t:"z",v:void 0}),f[A].l=Q);break;case 426:if(!c.cellFormula)break;U.push(Q),I=c.dense?f[_][E]:f[tn(E)+k],I.f=_a(Q[1],m,{r:x.r,c:E},te,c),I.F=Ut(Q[0]);break;case 427:if(!c.cellFormula)break;Y[It(Q[0].s)]=Q[1],I=c.dense?f[_][E]:f[tn(E)+k],I.f=_a(Q[1],m,{r:x.r,c:E},te,c);break;case 60:if(!c.cellStyles)break;for(;Q.e>=Q.s;)ge[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},ve||(ve=!0,NS(Q.w/256)),uo(ge[Q.e+1]);break;case 161:f["!autofilter"]={ref:Ut(Q)};break;case 476:f["!margins"]=Q;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),Q.name&&(a.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(f["!outline"]={above:Q.above,left:Q.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),Q.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:p=!0;break;case 36:p=!1;break;case 37:p=!0;break;case 38:p=!1;break;default:if(!re.T){if(!p||c.WTF)throw new Error("Unexpected record 0x"+G.toString(16))}}},c),delete c.supbooks,delete c["!row"],!f["!ref"]&&(m.s.r<2e6||d&&(d.e.r>0||d.e.c>0||d.s.r>0||d.s.c>0))&&(f["!ref"]=Ut(d||m)),c.sheetRows&&f["!ref"]){var ue=sr(f["!ref"]);c.sheetRows<=+ue.e.r&&(ue.e.r=c.sheetRows-1,ue.e.r>m.e.r&&(ue.e.r=m.e.r),ue.e.r<ue.s.r&&(ue.s.r=ue.e.r),ue.e.c>m.e.c&&(ue.e.c=m.e.c),ue.e.c<ue.s.c&&(ue.s.c=ue.e.c),f["!fullref"]=f["!ref"],f["!ref"]=Ut(ue))}return O.length>0&&(f["!merges"]=O),ge.length>0&&(f["!cols"]=ge),be.length>0&&(f["!rows"]=be),f}function tde(e,t,r,n,a,i,l){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Xr(t),t.z=t.z||Dt[14],t.v=Fn(Kr(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var f={r,c:n};switch(f.s=_o(a.cellXfs,t,a),t.l&&i["!links"].push([It(f),t.l]),t.c&&i["!comments"].push([It(f),t.c]),t.t){case"s":case"str":return a.bookSST?(c=OS(a.Strings,t.v,a.revStrings),f.t="s",f.v=c,l?We(e,18,bfe(t,f)):We(e,7,xfe(t,f))):(f.t="str",l?We(e,17,Dfe(t,f)):We(e,6,Ofe(t,f))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?l?We(e,13,Tfe(t,f)):We(e,2,Nfe(t,f)):l?We(e,16,Sfe(t,f)):We(e,5,_fe(t,f)),!0;case"b":return f.t="b",l?We(e,15,dfe(t,f)):We(e,4,ufe(t,f)),!0;case"e":return f.t="e",l?We(e,14,gfe(t,f)):We(e,3,mfe(t,f)),!0}return l?We(e,12,ofe(t,f)):We(e,1,sfe(t,f)),!0}function rde(e,t,r,n){var a=sr(t["!ref"]||"A1"),i,l="",c=[];We(e,145);var f=Array.isArray(t),d=a.e.r;t["!rows"]&&(d=Math.max(a.e.r,t["!rows"].length-1));for(var m=a.s.r;m<=d;++m){l=yn(m),Zue(e,t,a,m);var p=!1;if(m<=a.e.r)for(var v=a.s.c;v<=a.e.c;++v){m===a.s.r&&(c[v]=tn(v)),i=c[v]+l;var x=f?(t[m]||[])[v]:t[i];if(!x){p=!1;continue}p=tde(e,x,m,v,n,t,p)}}We(e,146)}function nde(e,t){!t||!t["!merges"]||(We(e,177,Bfe(t["!merges"].length)),t["!merges"].forEach(function(r){We(e,176,Lfe(r))}),We(e,178))}function ade(e,t){!t||!t["!cols"]||(We(e,390),t["!cols"].forEach(function(r,n){r&&We(e,60,Wfe(n,r))}),We(e,391))}function ide(e,t){!t||!t["!ref"]||(We(e,648),We(e,649,Yfe(sr(t["!ref"]))),We(e,650))}function sde(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=_r(r,-1,n[1].Target.replace(/#.*$/,""),Gt.HLINK);We(e,494,$fe(n,a))}}),delete t["!links"]}function lde(e,t,r,n){if(t["!comments"].length>0){var a=_r(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Gt.VML);We(e,551,vS("rId"+a)),t["!legacy"]=a}}function ode(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:Ut(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var l=r.Workbook.Names,c=Ya(i);c.s.r==c.e.r&&(c.e.r=Ya(t["!ref"]).e.r,i=Ut(c));for(var f=0;f<l.length;++f){var d=l[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==n){d.Ref="'"+r.SheetNames[n]+"'!"+i;break}}f==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),We(e,161,pf(sr(i))),We(e,162)}}function cde(e,t,r){We(e,133),We(e,137,Xfe(t,r)),We(e,138),We(e,134)}function ude(e,t){t["!protect"]&&We(e,535,Qfe(t["!protect"]))}function fde(e,t,r,n){var a=Xa(),i=r.SheetNames[e],l=r.Sheets[i]||{},c=i;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var f=sr(l["!ref"]||"A1");if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575)}return l["!links"]=[],l["!comments"]=[],We(a,129),(r.vbaraw||l["!outline"])&&We(a,147,afe(c,l["!outline"])),We(a,148,tfe(f)),cde(a,l,r.Workbook),ade(a,l),rde(a,l,e,t),ude(a,l),ode(a,l,r,e),nde(a,l),sde(a,l,n),l["!margins"]&&We(a,476,Gfe(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&ide(a,l),lde(a,l,e,n),We(a,130),a.end()}function dde(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(i){var l=i.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);l&&(t[+l[1]]=r?+l[2]:l[2])});var a=ir((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(i){n=i.replace(/<.*?>/g,"")}),[t,a,n]}function hde(e,t,r,n,a,i){var l=i||{"!type":"chart"};if(!e)return i;var c=0,f=0,d="A",m={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(p){var v=dde(p);m.s.r=m.s.c=0,m.e.c=c,d=tn(c),v[0].forEach(function(x,y){l[d+yn(y)]={t:"n",v:x,z:v[1]},f=y}),m.e.r<f&&(m.e.r=f),++c}),c>0&&(l["!ref"]=Ut(m)),l}function mde(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l,c=e.match(e8);return c&&CS(c[0],i,a,r),(l=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=l[1]),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}function pde(e,t){e.l+=10;var r=Ta(e);return{name:r}}function gde(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var i={"!type":"chart","!drawel":null,"!rel":""},l=!1;return El(e,function(f,d,m){switch(m){case 550:i["!rel"]=f;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),f.name&&(a.Sheets[r].CodeName=f.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:l=!0;break;case 36:l=!1;break;case 37:break;case 38:break;default:if(!(d.T>0)){if(!(d.T<0)){if(!l||t.WTF)throw new Error("Unexpected record 0x"+m.toString(16))}}}},t),n["!id"][i["!rel"]]&&(i["!drawel"]=n["!id"][i["!rel"]]),i}var DS=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],vde=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],xde=[],yde=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function R3(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var i=t[a];if(n[i[0]]==null)n[i[0]]=i[1];else switch(i[2]){case"bool":typeof n[i[0]]=="string"&&(n[i[0]]=Vr(n[i[0]]));break;case"int":typeof n[i[0]]=="string"&&(n[i[0]]=parseInt(n[i[0]],10));break}}}function F3(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Vr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function a8(e){F3(e.WBProps,DS),F3(e.CalcPr,yde),R3(e.WBView,vde),R3(e.Sheets,xde),Uu.date1904=Vr(e.WBProps.date1904)}function bde(e){return!e.Workbook||!e.Workbook.WBProps?"false":Vr(e.Workbook.WBProps.date1904)?"true":"false"}var wde="][*?/\\".split("");function i8(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return wde.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function _de(e,t,r){e.forEach(function(n,a){i8(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var l=t&&t[a]&&t[a].CodeName||n;if(l.charCodeAt(0)==95&&l.length>22)throw new Error("Bad Code Name: Worksheet"+l)}})}function Sde(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];_de(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)bue(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Ede=/<\w+:workbook/;function Nde(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",i={},l=0;if(e.replace(ja,function(f,d){var m=Pt(f);switch(Ds(m[0])){case"<?xml":break;case"<workbook":f.match(Ede)&&(a="xmlns"+f.match(/<(\w+):/)[1]),r.xmlns=m[a];break;case"</workbook>":break;case"<fileVersion":delete m[0],r.AppVersion=m;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":DS.forEach(function(p){if(m[p[0]]!=null)switch(p[2]){case"bool":r.WBProps[p[0]]=Vr(m[p[0]]);break;case"int":r.WBProps[p[0]]=parseInt(m[p[0]],10);break;default:r.WBProps[p[0]]=m[p[0]]}}),m.codeName&&(r.WBProps.CodeName=Ir(m.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete m[0],r.WBView.push(m);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(m.state){case"hidden":m.Hidden=1;break;case"veryHidden":m.Hidden=2;break;default:m.Hidden=0}delete m.state,m.name=ir(Ir(m.name)),delete m[0],r.Sheets.push(m);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":i={},i.Name=Ir(m.name),m.comment&&(i.Comment=m.comment),m.localSheetId&&(i.Sheet=+m.localSheetId),Vr(m.hidden||"0")&&(i.Hidden=!0),l=d+f.length;break;case"</definedName>":i.Ref=ir(Ir(e.slice(l,d))),r.Names.push(i);break;case"<definedName/>":break;case"<calcPr":delete m[0],r.CalcPr=m;break;case"<calcPr/>":delete m[0],r.CalcPr=m;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+m[0]+" in workbook")}return f}),Oc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return a8(r),r}function s8(e){var t=[bn];t[t.length]=Ze("workbook",null,{xmlns:Oc[0],"xmlns:r":Rn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(DS.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(n[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ze("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var l={name:Nr(e.SheetNames[i].slice(0,31))};if(l.sheetId=""+(i+1),l["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:l.state="hidden";break;case 2:l.state="veryHidden";break}t[t.length]=Ze("sheet",null,l)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var f={name:c.Name};c.Comment&&(f.comment=c.Comment),c.Sheet!=null&&(f.localSheetId=""+c.Sheet),c.Hidden&&(f.hidden="1"),c.Ref&&(t[t.length]=Ze("definedName",Nr(c.Ref),f))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function kde(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Pw(e),r.name=Ta(e),r}function Tde(e,t){return t||(t=Ie(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),vS(e.strRelID,t),Qn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Ade(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?Ta(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function jde(e,t){t||(t=Ie(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),Q5(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Ode(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Cde(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=lae(e),l=mue(e,0,r),c=gS(e);e.l=n;var f={Name:i,Ptg:l};return a<268435455&&(f.Sheet=a),c&&(f.Comment=c),f}function Dde(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var i=[],l=[[]];return l.SheetNames=[],l.XTI=[],l0[16]={n:"BrtFRTArchID$",f:Ode},El(e,function(f,d,m){switch(m){case 156:l.SheetNames.push(f.name),r.Sheets.push(f);break;case 153:r.WBProps=f;break;case 39:f.Sheet!=null&&(t.SID=f.Sheet),f.Ref=_a(f.Ptg,null,null,l,t),delete t.SID,delete f.Ptg,i.push(f);break;case 1036:break;case 357:case 358:case 355:case 667:l[0].length?l.push([m,f]):l[0]=[m,f],l[l.length-1].XTI=[];break;case 362:l.length===0&&(l[0]=[],l[0].XTI=[]),l[l.length-1].XTI=l[l.length-1].XTI.concat(f),l.XTI=l.XTI.concat(f);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(m),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(m),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!d.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+m.toString(16))}}},t),a8(r),r.Names=i,r.supbooks=l,r}function Ide(e,t){We(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};We(e,156,Tde(a))}We(e,144)}function Pde(e,t){t||(t=Ie(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Qn("SheetJS",t),Qn(Up.version,t),Qn(Up.version,t),Qn("7262",t),t.length>t.l?t.slice(0,t.l):t}function Mde(e,t){t||(t=Ie(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Rde(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(We(e,135),We(e,158,Mde(a)),We(e,136))}}function Fde(e,t){var r=Xa();return We(r,131),We(r,128,Pde()),We(r,153,jde(e.Workbook&&e.Workbook.WBProps||null)),Rde(r,e),Ide(r,e),We(r,132),r.end()}function Lde(e,t,r){return t.slice(-4)===".bin"?Dde(e,r):Nde(e,r)}function Bde(e,t,r,n,a,i,l,c){return t.slice(-4)===".bin"?ede(e,n,r,a,i,l,c):Cue(e,n,r,a,i,l,c)}function Ude(e,t,r,n,a,i,l,c){return t.slice(-4)===".bin"?gde(e,n,r,a,i):mde(e,n,r,a,i)}function $de(e,t,r,n,a,i,l,c){return t.slice(-4)===".bin"?Hoe():qoe()}function zde(e,t,r,n,a,i,l,c){return t.slice(-4)===".bin"?$oe():zoe()}function Hde(e,t,r,n){return t.slice(-4)===".bin"?Lle(e,r,n):kle(e,r,n)}function qde(e,t,r){return U6(e,r)}function Wde(e,t,r){return t.slice(-4)===".bin"?Wse(e,r):zse(e,r)}function Vde(e,t,r){return t.slice(-4)===".bin"?Roe(e,r):Toe(e,r)}function Gde(e,t,r){return t.slice(-4)===".bin"?Eoe(e):_oe(e)}function Kde(e,t,r,n){return r.slice(-4)===".bin"?Noe(e,t,r,n):void 0}function Xde(e,t,r){return t.slice(-4)===".bin"?yoe(e,t,r):woe(e,t,r)}function Yde(e,t,r){return(t.slice(-4)===".bin"?Fde:s8)(e)}function Qde(e,t,r,n,a){return(t.slice(-4)===".bin"?fde:t8)(e,r,n,a)}function Jde(e,t,r){return(t.slice(-4)===".bin"?Kle:L6)(e,r)}function Zde(e,t,r){return(t.slice(-4)===".bin"?Kse:O6)(e,r)}function e0e(e,t,r){return(t.slice(-4)===".bin"?Foe:H6)(e)}function t0e(e){return(e.slice(-4)===".bin"?boe:$6)()}var l8=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,o8=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Yi(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(l8),i,l,c,f;if(a)for(f=0;f!=a.length;++f)i=a[f].match(o8),(l=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?c="xmlns"+i[1].slice(6):c=i[1].slice(l+1),n[c]=i[2].slice(1,i[2].length-1));return n}function r0e(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(l8),a,i,l,c;if(n)for(c=0;c!=n.length;++c)a=n[c].match(o8),(i=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?l="xmlns"+a[1].slice(6):l=a[1].slice(i+1),r[l]=a[2].slice(1,a[2].length-1));return r}var Od;function n0e(e,t){var r=Od[e]||ir(e);return r==="General"?bc(t):qi(r,t)}function a0e(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=Vr(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=Kr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ir(t)]=a}function i0e(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Nl[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jd(e.v):e.w=bc(e.v):e.w=n0e(t||"General",e.v)}catch(i){if(r.WTF)throw i}try{var n=Od[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&df(n)){var a=ec(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(i){if(r.WTF)throw i}}}function s0e(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=xle[n.Pattern]||n.Pattern)}e[t.ID]=t}function l0e(e,t,r,n,a,i,l,c,f,d){var m="General",p=n.StyleID,v={};d=d||{};var x=[],y=0;for(p===void 0&&c&&(p=c.StyleID),p===void 0&&l&&(p=l.StyleID);i[p]!==void 0&&(i[p].nf&&(m=i[p].nf),i[p].Interior&&x.push(i[p].Interior),!!i[p].Parent);)p=i[p].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Vr(e);break;case"String":n.t="s",n.r=e3(ir(e)),n.v=e.indexOf("<")>-1?ir(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Kr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=ir(e):n.v<60&&(n.v=n.v-1),(!m||m=="General")&&(m="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=r6[e],d.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=e3(t||e));break}if(i0e(n,m,d),d.cellFormula!==!1)if(n.Formula){var b=ir(n.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),n.f=Bu(b,a),delete n.Formula,n.ArrayRange=="RC"?n.F=Bu("RC:RC",a):n.ArrayRange&&(n.F=Bu(n.ArrayRange,a),f.push([sr(n.F),n.F]))}else for(y=0;y<f.length;++y)a.r>=f[y][0].s.r&&a.r<=f[y][0].e.r&&a.c>=f[y][0].s.c&&a.c<=f[y][0].e.c&&(n.F=f[y][1]);d.cellStyles&&(x.forEach(function(_){!v.patternType&&_.patternType&&(v.patternType=_.patternType)}),n.s=v),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function o0e(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function fb(e,t){var r=t||{};hf();var n=yd(uS(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ir(n));var a=n.slice(0,1024).toLowerCase(),i=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var l=Xr(r);return l.type="string",Qu.to_workbook(n,l)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(wt){a.indexOf("<"+wt)>=0&&(i=!0)}),i)return G0e(n,r);Od={"General Number":"General","General Date":Dt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Dt[15],"Short Date":Dt[14],"Long Time":Dt[19],"Medium Time":Dt[18],"Short Time":Dt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Dt[2],Standard:Dt[4],Percent:Dt[10],Scientific:Dt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,f=[],d,m={},p=[],v=r.dense?[]:{},x="",y={},b={},_=Yi('<Data ss:Type="String">'),E=0,A=0,T=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},I={},O={},j="",B=0,U=[],Y={},te={},V=0,ge=[],be=[],ve={},z=[],ue,se=!1,Q=[],re=[],G={},P=0,W=0,F={Sheets:[],WBProps:{date1904:!1}},M={};t0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var le="";c=t0.exec(n);)switch(c[3]=(le=c[3]).toLowerCase()){case"data":if(le=="data"){if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break}if(f[f.length-1][1])break;c[1]==="/"?l0e(n.slice(E,c.index),j,_,f[f.length-1][0]=="comment"?ve:y,{c:A,r:T},I,z[A],b,Q,r):(j="",_=Yi(c[0]),E=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(be.length>0&&(y.c=be),(!r.sheetRows||r.sheetRows>T)&&y.v!==void 0&&(r.dense?(v[T]||(v[T]=[]),v[T][A]=y):v[tn(A)+yn(T)]=y),y.HRef&&(y.l={Target:ir(y.HRef)},y.HRefScreenTip&&(y.l.Tooltip=y.HRefScreenTip),delete y.HRef,delete y.HRefScreenTip),(y.MergeAcross||y.MergeDown)&&(P=A+(parseInt(y.MergeAcross,10)|0),W=T+(parseInt(y.MergeDown,10)|0),U.push({s:{c:A,r:T},e:{c:P,r:W}})),!r.sheetStubs)y.MergeAcross?A=P+1:++A;else if(y.MergeAcross||y.MergeDown){for(var pe=A;pe<=P;++pe)for(var Ae=T;Ae<=W;++Ae)(pe>A||Ae>T)&&(r.dense?(v[Ae]||(v[Ae]=[]),v[Ae][pe]={t:"z"}):v[tn(pe)+yn(Ae)]={t:"z"});A=P+1}else++A;else y=r0e(c[0]),y.Index&&(A=+y.Index-1),A<k.s.c&&(k.s.c=A),A>k.e.c&&(k.e.c=A),c[0].slice(-2)==="/>"&&++A,be=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(T<k.s.r&&(k.s.r=T),T>k.e.r&&(k.e.r=T),c[0].slice(-2)==="/>"&&(b=Yi(c[0]),b.Index&&(T=+b.Index-1)),A=0,++T):(b=Yi(c[0]),b.Index&&(T=+b.Index-1),G={},(b.AutoFitHeight=="0"||b.Height)&&(G.hpx=parseInt(b.Height,10),G.hpt=s0(G.hpx),re[T]=G),b.Hidden=="1"&&(G.hidden=!0,re[T]=G));break;case"worksheet":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));p.push(x),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(v["!ref"]=Ut(k),r.sheetRows&&r.sheetRows<=k.e.r&&(v["!fullref"]=v["!ref"],k.e.r=r.sheetRows-1,v["!ref"]=Ut(k))),U.length&&(v["!merges"]=U),z.length>0&&(v["!cols"]=z),re.length>0&&(v["!rows"]=re),m[x]=v}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},T=A=0,f.push([c[3],!1]),d=Yi(c[0]),x=ir(d.Name),v=r.dense?[]:{},U=[],Q=[],re=[],M={name:x,Hidden:0},F.Sheets.push(M);break;case"table":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else{if(c[0].slice(-2)=="/>")break;f.push([c[3],!1]),z=[],se=!1}break;case"style":c[1]==="/"?s0e(I,O,r):O=Yi(c[0]);break;case"numberformat":O.nf=ir(Yi(c[0]).Format||"General"),Od[O.nf]&&(O.nf=Od[O.nf]);for(var oe=0;oe!=392&&Dt[oe]!=O.nf;++oe);if(oe==392){for(oe=57;oe!=392;++oe)if(Dt[oe]==null){sl(O.nf,oe);break}}break;case"column":if(f[f.length-1][0]!=="table")break;if(ue=Yi(c[0]),ue.Hidden&&(ue.hidden=!0,delete ue.Hidden),ue.Width&&(ue.wpx=parseInt(ue.Width,10)),!se&&ue.wpx>10){se=!0,Ea=R6;for(var ae=0;ae<z.length;++ae)z[ae]&&uo(z[ae])}se&&uo(ue),z[ue.Index-1||z.length]=ue;for(var ze=0;ze<+ue.Span;++ze)z[z.length]=Xr(ue);break;case"namedrange":if(c[1]==="/")break;F.Names||(F.Names=[]);var q=Pt(c[0]),Je={Name:q.Name,Ref:Bu(q.RefersTo.slice(1),{r:0,c:0})};F.Sheets.length>0&&(Je.Sheet=F.Sheets.length-1),F.Names.push(Je);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?j+=n.slice(B,c.index):B=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;O.Interior=Yi(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?Dae(Y,le,n.slice(V,c.index)):V=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else f.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"));o0e(ve),be.push(ve)}else f.push([c[3],!1]),d=Yi(c[0]),ve={a:d.Author};break;case"autofilter":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var qe=Yi(c[0]);v["!autofilter"]={ref:Bu(qe.Range).replace(/\$/g,"")},f.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((d=f.pop())[0]!==c[3])throw new Error("Bad state: "+d.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&f.push([c[3],!0]);break;case"null":break;default:if(f.length==0&&c[3]=="document"||f.length==0&&c[3]=="uof")return z3(n,r);var ot=!0;switch(f[f.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ot=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ot=!1}break;case"excelworkbook":switch(c[3]){case"date1904":F.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ot=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:ot=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(n.slice(V,c.index)){case"SheetHidden":M.Hidden=1;break;case"SheetVeryHidden":M.Hidden=2;break}else V=c.index+c[0].length;break;case"header":v["!margins"]||uc(v["!margins"]={},"xlml"),isNaN(+Pt(c[0]).Margin)||(v["!margins"].header=+Pt(c[0]).Margin);break;case"footer":v["!margins"]||uc(v["!margins"]={},"xlml"),isNaN(+Pt(c[0]).Margin)||(v["!margins"].footer=+Pt(c[0]).Margin);break;case"pagemargins":var Ke=Pt(c[0]);v["!margins"]||uc(v["!margins"]={},"xlml"),isNaN(+Ke.Top)||(v["!margins"].top=+Ke.Top),isNaN(+Ke.Left)||(v["!margins"].left=+Ke.Left),isNaN(+Ke.Right)||(v["!margins"].right=+Ke.Right),isNaN(+Ke.Bottom)||(v["!margins"].bottom=+Ke.Bottom);break;case"displayrighttoleft":F.Views||(F.Views=[]),F.Views[0]||(F.Views[0]={}),F.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ot=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ot=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ot=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ot=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ot=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ot=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ot=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ot=!1}break;case"smarttags":break;default:ot=!1;break}if(ot||c[3].match(/!\[CDATA/))break;if(!f[f.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+f.join("|");if(f[f.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?a0e(te,le,ge,n.slice(V,c.index)):(ge=c,V=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+f.join("|")}var He={};return!r.bookSheets&&!r.bookProps&&(He.Sheets=m),He.SheetNames=p,He.Workbook=F,He.SSF=Xr(Dt),He.Props=Y,He.Custprops=te,He}function $w(e,t){switch(PS(t=t||{}),t.type||"base64"){case"base64":return fb(bi(e),t);case"binary":case"buffer":case"file":return fb(e,t);case"array":return fb(bo(e),t)}}function c0e(e,t){var r=[];return e.Props&&r.push(Iae(e.Props,t)),e.Custprops&&r.push(Pae(e.Props,e.Custprops)),r.join("")}function u0e(){return""}function f0e(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Ze("NumberFormat",null,{"ss:Format":Nr(Dt[n.numFmtId])}));var l={"ss:ID":"s"+(21+a)};r.push(Ze("Style",i.join(""),l))}),Ze("Styles",r.join(""))}function c8(e){return Ze("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+AS(e.Ref,{r:0,c:0})})}function d0e(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(c8(a)))}return Ze("Names",r.join(""))}function h0e(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],l=0;l<a.length;++l){var c=a[l];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||i.push(c8(c)))}return i.join("")}function m0e(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Ze("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Ze("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Ze("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Ze("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(ma("ProtectContents","True")),e["!protect"].objects&&a.push(ma("ProtectObjects","True")),e["!protect"].scenarios&&a.push(ma("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(ma("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(ma("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(l){e["!protect"][l[0]]&&a.push("<"+l[1]+"/>")})),a.length==0?"":Ze("WorksheetOptions",a.join(""),{xmlns:ci.x})}function p0e(e){return e.map(function(t){var r=Rne(t.t||""),n=Ze("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ze("Comment",n,{"ss:Author":t.a})}).join("")}function g0e(e,t,r,n,a,i,l){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+Nr(AS(e.f,l))),e.F&&e.F.slice(0,t.length)==t){var f=rn(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(f.r==l.r?"":"["+(f.r-l.r)+"]")+"C"+(f.c==l.c?"":"["+(f.c-l.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=Nr(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=Nr(e.l.Tooltip))),r["!merges"])for(var d=r["!merges"],m=0;m!=d.length;++m)d[m].s.c!=l.c||d[m].s.r!=l.r||(d[m].e.c>d[m].s.c&&(c["ss:MergeAcross"]=d[m].e.c-d[m].s.c),d[m].e.r>d[m].s.r&&(c["ss:MergeDown"]=d[m].e.r-d[m].s.r));var p="",v="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":p="Number",v=String(e.v);break;case"b":p="Boolean",v=e.v?"1":"0";break;case"e":p="Error",v=Nl[e.v];break;case"d":p="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Dt[14]);break;case"s":p="String",v=Mne(e.v||"");break}var x=_o(n.cellXfs,e,n);c["ss:StyleID"]="s"+(21+x),c["ss:Index"]=l.c+1;var y=e.v!=null?v:"",b=e.t=="z"?"":'<Data ss:Type="'+p+'">'+y+"</Data>";return(e.c||[]).length>0&&(b+=p0e(e.c)),Ze("Cell",b,c)}function v0e(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=Ju(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function x0e(e,t,r,n){if(!e["!ref"])return"";var a=sr(e["!ref"]),i=e["!merges"]||[],l=0,c=[];e["!cols"]&&e["!cols"].forEach(function(_,E){uo(_);var A=!!_.width,T=av(E,_),k={"ss:Index":E+1};A&&(k["ss:Width"]=a0(T.width)),_.hidden&&(k["ss:Hidden"]="1"),c.push(Ze("Column",null,k))});for(var f=Array.isArray(e),d=a.s.r;d<=a.e.r;++d){for(var m=[v0e(d,(e["!rows"]||[])[d])],p=a.s.c;p<=a.e.c;++p){var v=!1;for(l=0;l!=i.length;++l)if(!(i[l].s.c>p)&&!(i[l].s.r>d)&&!(i[l].e.c<p)&&!(i[l].e.r<d)){(i[l].s.c!=p||i[l].s.r!=d)&&(v=!0);break}if(!v){var x={r:d,c:p},y=It(x),b=f?(e[d]||[])[p]:e[y];m.push(g0e(b,y,e,t,r,n,x))}}m.push("</Row>"),m.length>2&&c.push(m.join(""))}return c.join("")}function y0e(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],l=i?h0e(i,t,e,r):"";return l.length>0&&n.push("<Names>"+l+"</Names>"),l=i?x0e(i,t,e,r):"",l.length>0&&n.push("<Table>"+l+"</Table>"),n.push(m0e(i,t,e,r)),n.join("")}function b0e(e,t){t||(t={}),e.SSF||(e.SSF=Xr(Dt)),e.SSF&&(hf(),Qg(e.SSF),t.revssf=Zg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],_o(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(c0e(e,t)),r.push(u0e()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ze("Worksheet",y0e(n,t,e),{"ss:Name":Nr(e.SheetNames[n])}));return r[2]=f0e(e,t),r[3]=d0e(e),bn+Ze("Workbook",r.join(""),{xmlns:ci.ss,"xmlns:o":ci.o,"xmlns:x":ci.x,"xmlns:ss":ci.ss,"xmlns:dt":ci.dt,"xmlns:html":ci.html})}function w0e(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=dae(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=hae(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var _0e=[60,1084,2066,2165,2175];function S0e(e,t,r,n,a){var i=n,l=[],c=r.slice(r.l,r.l+i);if(a&&a.enc&&a.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(c)}l.push(c),r.l+=i;for(var f=rl(r,r.l),d=zw[f],m=0;d!=null&&_0e.indexOf(f)>-1;)i=rl(r,r.l+2),m=r.l+4,f==2066?m+=4:(f==2165||f==2175)&&(m+=12),c=r.slice(m,r.l+4+i),l.push(c),r.l+=4+i,d=zw[f=rl(r,r.l)];var p=Xn(l);ha(p,0);var v=0;p.lens=[];for(var x=0;x<l.length;++x)p.lens.push(v),v+=l[x].length;if(p.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+p.length+" < "+n;return t.f(p,p.length,a)}function bs(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Dt[n])}catch(i){if(t.WTF)throw i}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Nl[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Jd(e.v):e.w=bc(e.v):e.w=qi(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(i){if(t.WTF)throw i}if(t.cellDates&&n&&e.t=="n"&&df(Dt[n]||String(n))){var a=ec(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function Cm(e,t,r){return{v:e,ixfe:t,t:r}}function E0e(e,t){var r={opts:{}},n={},a=t.dense?[]:{},i={},l={},c=null,f=[],d="",m={},p,v="",x,y,b,_,E={},A=[],T,k,I=[],O=[],j={Sheets:[],WBProps:{date1904:!1},Views:[{}]},B={},U=function(St){return St<8?lc[St]:St<64&&O[St-8]||lc[St]},Y=function(St,Zt,mr){var er=Zt.XF.data;if(!(!er||!er.patternType||!mr||!mr.cellStyles)){Zt.s={},Zt.s.patternType=er.patternType;var ar;(ar=n0(U(er.icvFore)))&&(Zt.s.fgColor={rgb:ar}),(ar=n0(U(er.icvBack)))&&(Zt.s.bgColor={rgb:ar})}},te=function(St,Zt,mr){if(!(G>1)&&!(mr.sheetRows&&St.r>=mr.sheetRows)){if(mr.cellStyles&&Zt.XF&&Zt.XF.data&&Y(St,Zt,mr),delete Zt.ixfe,delete Zt.XF,p=St,v=It(St),(!l||!l.s||!l.e)&&(l={s:{r:0,c:0},e:{r:0,c:0}}),St.r<l.s.r&&(l.s.r=St.r),St.c<l.s.c&&(l.s.c=St.c),St.r+1>l.e.r&&(l.e.r=St.r+1),St.c+1>l.e.c&&(l.e.c=St.c+1),mr.cellFormula&&Zt.f){for(var er=0;er<A.length;++er)if(!(A[er][0].s.c>St.c||A[er][0].s.r>St.r)&&!(A[er][0].e.c<St.c||A[er][0].e.r<St.r)){Zt.F=Ut(A[er][0]),(A[er][0].s.c!=St.c||A[er][0].s.r!=St.r)&&delete Zt.f,Zt.f&&(Zt.f=""+_a(A[er][1],l,St,Q,V));break}}mr.dense?(a[St.r]||(a[St.r]=[]),a[St.r][St.c]=Zt):a[v]=Zt}},V={enc:!1,sbcch:0,snames:[],sharedf:E,arrayf:A,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(V.password=t.password);var ge,be=[],ve=[],z=[],ue=[],se=!1,Q=[];Q.SheetNames=V.snames,Q.sharedf=V.sharedf,Q.arrayf=V.arrayf,Q.names=[],Q.XTI=[];var re=0,G=0,P=0,W=[],F=[],M;V.codepage=1200,ns(1200);for(var le=!1;e.l<e.length-1;){var pe=e.l,Ae=e.read_shift(2);if(Ae===0&&re===10)break;var oe=e.l===e.length?0:e.read_shift(2),ae=zw[Ae];if(ae&&ae.f){if(t.bookSheets&&re===133&&Ae!==133)break;if(re=Ae,ae.r===2||ae.r==12){var ze=e.read_shift(2);if(oe-=2,!V.enc&&ze!==Ae&&((ze&255)<<8|ze>>8)!==Ae)throw new Error("rt mismatch: "+ze+"!="+Ae);ae.r==12&&(e.l+=10,oe-=10)}var q={};if(Ae===10?q=ae.f(e,oe,V):q=S0e(Ae,ae,e,oe,V),G==0&&[9,521,1033,2057].indexOf(re)===-1)continue;switch(Ae){case 34:r.opts.Date1904=j.WBProps.date1904=q;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(V.enc||(e.l=0),V.enc=q,!t.password)throw new Error("File is password-protected");if(q.valid==null)throw new Error("Encryption scheme unsupported");if(!q.valid)throw new Error("Password is incorrect");break;case 92:V.lastuser=q;break;case 66:var Je=Number(q);switch(Je){case 21010:Je=1200;break;case 32768:Je=1e4;break;case 32769:Je=1252;break}ns(V.codepage=Je),le=!0;break;case 317:V.rrtabid=q;break;case 25:V.winlocked=q;break;case 439:r.opts.RefreshAll=q;break;case 12:r.opts.CalcCount=q;break;case 16:r.opts.CalcDelta=q;break;case 17:r.opts.CalcIter=q;break;case 13:r.opts.CalcMode=q;break;case 14:r.opts.CalcPrecision=q;break;case 95:r.opts.CalcSaveRecalc=q;break;case 15:V.CalcRefMode=q;break;case 2211:r.opts.FullCalc=q;break;case 129:q.fDialog&&(a["!type"]="dialog"),q.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),q.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:I.push(q);break;case 430:Q.push([q]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(q);break;case 24:case 536:M={Name:q.Name,Ref:_a(q.rgce,l,null,Q,V)},q.itab>0&&(M.Sheet=q.itab-1),Q.names.push(M),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(q),q.Name=="_xlnm._FilterDatabase"&&q.itab>0&&q.rgce&&q.rgce[0]&&q.rgce[0][0]&&q.rgce[0][0][0]=="PtgArea3d"&&(F[q.itab-1]={ref:Ut(q.rgce[0][0][1][2])});break;case 22:V.ExternCount=q;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(q),Q.XTI=Q.XTI.concat(q);break;case 2196:if(V.biff<8)break;M!=null&&(M.Comment=q[1]);break;case 18:a["!protect"]=q;break;case 19:q!==0&&V.WTF&&console.error("Password verifier: "+q);break;case 133:i[q.pos]=q,V.snames.push(q.name);break;case 10:{if(--G)break;if(l.e){if(l.e.r>0&&l.e.c>0){if(l.e.r--,l.e.c--,a["!ref"]=Ut(l),t.sheetRows&&t.sheetRows<=l.e.r){var qe=l.e.r;l.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=Ut(l),l.e.r=qe}l.e.r++,l.e.c++}be.length>0&&(a["!merges"]=be),ve.length>0&&(a["!objects"]=ve),z.length>0&&(a["!cols"]=z),ue.length>0&&(a["!rows"]=ue),j.Sheets.push(B)}d===""?m=a:n[d]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(V.biff===8&&(V.biff={9:2,521:3,1033:4}[Ae]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[q.BIFFVer]||8),V.biffguess=q.BIFFVer==0,q.BIFFVer==0&&q.dt==4096&&(V.biff=5,le=!0,ns(V.codepage=28591)),V.biff==8&&q.BIFFVer==0&&q.dt==16&&(V.biff=2),G++)break;if(a=t.dense?[]:{},V.biff<8&&!le&&(le=!0,ns(V.codepage=t.codepage||1252)),V.biff<5||q.BIFFVer==0&&q.dt==4096){d===""&&(d="Sheet1"),l={s:{r:0,c:0},e:{r:0,c:0}};var ot={pos:e.l-oe,name:d};i[ot.pos]=ot,V.snames.push(d)}else d=(i[pe]||{name:""}).name;q.dt==32&&(a["!type"]="chart"),q.dt==64&&(a["!type"]="macro"),be=[],ve=[],V.arrayf=A=[],z=[],ue=[],se=!1,B={Hidden:(i[pe]||{hs:0}).hs,name:d}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[q.r]||[])[q.c]:a[It({c:q.c,r:q.r})])&&++q.c,T={ixfe:q.ixfe,XF:I[q.ixfe]||{},v:q.val,t:"n"},P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te({c:q.c,r:q.r},T,t);break;case 5:case 517:T={ixfe:q.ixfe,XF:I[q.ixfe],v:q.val,t:q.t},P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te({c:q.c,r:q.r},T,t);break;case 638:T={ixfe:q.ixfe,XF:I[q.ixfe],v:q.rknum,t:"n"},P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te({c:q.c,r:q.r},T,t);break;case 189:for(var Ke=q.c;Ke<=q.C;++Ke){var He=q.rkrec[Ke-q.c][0];T={ixfe:He,XF:I[He],v:q.rkrec[Ke-q.c][1],t:"n"},P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te({c:Ke,r:q.r},T,t)}break;case 6:case 518:case 1030:{if(q.val=="String"){c=q;break}if(T=Cm(q.val,q.cell.ixfe,q.tt),T.XF=I[T.ixfe],t.cellFormula){var wt=q.formula;if(wt&&wt[0]&&wt[0][0]&&wt[0][0][0]=="PtgExp"){var mt=wt[0][0][1][0],Ge=wt[0][0][1][1],ut=It({r:mt,c:Ge});E[ut]?T.f=""+_a(q.formula,l,q.cell,Q,V):T.F=((t.dense?(a[mt]||[])[Ge]:a[ut])||{}).F}else T.f=""+_a(q.formula,l,q.cell,Q,V)}P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te(q.cell,T,t),c=q}break;case 7:case 519:if(c)c.val=q,T=Cm(q,c.cell.ixfe,"s"),T.XF=I[T.ixfe],t.cellFormula&&(T.f=""+_a(c.formula,l,c.cell,Q,V)),P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te(c.cell,T,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{A.push(q);var ct=It(q[0].s);if(x=t.dense?(a[q[0].s.r]||[])[q[0].s.c]:a[ct],t.cellFormula&&x){if(!c||!ct||!x)break;x.f=""+_a(q[1],l,q[0],Q,V),x.F=Ut(q[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!c)break;E[It(c.cell)]=q[0],x=t.dense?(a[c.cell.r]||[])[c.cell.c]:a[It(c.cell)],(x||{}).f=""+_a(q[0],l,p,Q,V)}}break;case 253:T=Cm(f[q.isst].t,q.ixfe,"s"),f[q.isst].h&&(T.h=f[q.isst].h),T.XF=I[T.ixfe],P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te({c:q.c,r:q.r},T,t);break;case 513:t.sheetStubs&&(T={ixfe:q.ixfe,XF:I[q.ixfe],t:"z"},P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te({c:q.c,r:q.r},T,t));break;case 190:if(t.sheetStubs)for(var dt=q.c;dt<=q.C;++dt){var at=q.ixfe[dt-q.c];T={ixfe:at,XF:I[at],t:"z"},P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te({c:dt,r:q.r},T,t)}break;case 214:case 516:case 4:T=Cm(q.val,q.ixfe,"s"),T.XF=I[T.ixfe],P>0&&(T.z=W[T.ixfe>>8&63]),bs(T,t,r.opts.Date1904),te({c:q.c,r:q.r},T,t);break;case 0:case 512:G===1&&(l=q);break;case 252:f=q;break;case 1054:if(V.biff==4){W[P++]=q[1];for(var Wt=0;Wt<P+163&&Dt[Wt]!=q[1];++Wt);Wt>=163&&sl(q[1],P+163)}else sl(q[1],q[0]);break;case 30:{W[P++]=q;for(var Oe=0;Oe<P+163&&Dt[Oe]!=q;++Oe);Oe>=163&&sl(q,P+163)}break;case 229:be=be.concat(q);break;case 93:ve[q.cmo[0]]=V.lastobj=q;break;case 438:V.lastobj.TxO=q;break;case 127:V.lastobj.ImData=q;break;case 440:for(_=q[0].s.r;_<=q[0].e.r;++_)for(b=q[0].s.c;b<=q[0].e.c;++b)x=t.dense?(a[_]||[])[b]:a[It({c:b,r:_})],x&&(x.l=q[1]);break;case 2048:for(_=q[0].s.r;_<=q[0].e.r;++_)for(b=q[0].s.c;b<=q[0].e.c;++b)x=t.dense?(a[_]||[])[b]:a[It({c:b,r:_})],x&&x.l&&(x.l.Tooltip=q[1]);break;case 28:{if(V.biff<=5&&V.biff>=2)break;x=t.dense?(a[q[0].r]||[])[q[0].c]:a[It(q[0])];var st=ve[q[2]];x||(t.dense?(a[q[0].r]||(a[q[0].r]=[]),x=a[q[0].r][q[0].c]={t:"z"}):x=a[It(q[0])]={t:"z"},l.e.r=Math.max(l.e.r,q[0].r),l.s.r=Math.min(l.s.r,q[0].r),l.e.c=Math.max(l.e.c,q[0].c),l.s.c=Math.min(l.s.c,q[0].c)),x.c||(x.c=[]),y={a:q[1],t:st.TxO.t},x.c.push(y)}break;case 2173:foe(I[q.ixfe],q.ext);break;case 125:{if(!V.cellStyles)break;for(;q.e>=q.s;)z[q.e--]={width:q.w/256,level:q.level||0,hidden:!!(q.flags&1)},se||(se=!0,NS(q.w/256)),uo(z[q.e+1])}break;case 520:{var Fe={};q.level!=null&&(ue[q.r]=Fe,Fe.level=q.level),q.hidden&&(ue[q.r]=Fe,Fe.hidden=!0),q.hpt&&(ue[q.r]=Fe,Fe.hpt=q.hpt,Fe.hpx=Ju(q.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||uc(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ae]]=q;break;case 161:a["!margins"]||uc(a["!margins"]={}),a["!margins"].header=q.header,a["!margins"].footer=q.footer;break;case 574:q.RTL&&(j.Views[0].RTL=!0);break;case 146:O=q;break;case 2198:ge=q;break;case 140:k=q;break;case 442:d?B.CodeName=q||B.name:j.WBProps.CodeName=q||"ThisWorkbook";break}}else ae||console.error("Missing Info for XLS Record 0x"+Ae.toString(16)),e.l+=oe}return r.SheetNames=hn(i).sort(function(nr,St){return Number(nr)-Number(St)}).map(function(nr){return i[nr].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&m["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=m)):r.Preamble=m,r.Sheets&&F.forEach(function(nr,St){r.Sheets[r.SheetNames[St]]["!autofilter"]=nr}),r.Strings=f,r.SSF=Xr(Dt),V.enc&&(r.Encryption=V.enc),ge&&(r.Themes=ge),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),Q.names.length>0&&(j.Names=Q.names),r.Workbook=j,r}var Cd={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function N0e(e,t,r){var n=kt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=x3(n,Mw,Cd.DSI);for(var i in a)t[i]=a[i]}catch(d){if(r.WTF)throw d}var l=kt.find(e,"/!SummaryInformation");if(l&&l.size>0)try{var c=x3(l,Rw,Cd.SI);for(var f in c)t[f]==null&&(t[f]=c[f])}catch(d){if(r.WTF)throw d}t.HeadingPairs&&t.TitlesOfParts&&(o6(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function k0e(e,t){var r=[],n=[],a=[],i=0,l,c=K4(Mw,"n"),f=K4(Rw,"n");if(e.Props)for(l=hn(e.Props),i=0;i<l.length;++i)(Object.prototype.hasOwnProperty.call(c,l[i])?r:Object.prototype.hasOwnProperty.call(f,l[i])?n:a).push([l[i],e.Props[l[i]]]);if(e.Custprops)for(l=hn(e.Custprops),i=0;i<l.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},l[i])||(Object.prototype.hasOwnProperty.call(c,l[i])?r:Object.prototype.hasOwnProperty.call(f,l[i])?n:a).push([l[i],e.Custprops[l[i]]]);var d=[];for(i=0;i<a.length;++i)p6.indexOf(a[i][0])>-1||l6.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);n.length&&kt.utils.cfb_add(t,"/SummaryInformation",y3(n,Cd.SI,f,Rw)),(r.length||d.length)&&kt.utils.cfb_add(t,"/DocumentSummaryInformation",y3(r,Cd.DSI,c,Mw,d.length?d:null,Cd.UDI))}function u8(e,t){t||(t={}),PS(t),tS(),t.codepage&&eS(t.codepage);var r,n;if(e.FullPaths){if(kt.find(e,"/encryption"))throw new Error("File is password-protected");r=kt.find(e,"!CompObj"),n=kt.find(e,"/Workbook")||kt.find(e,"/Book")}else{switch(t.type){case"base64":e=di(bi(e));break;case"binary":e=di(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ha(e,0),n={content:e}}var a,i;if(r&&w0e(r),t.bookProps&&!t.bookSheets)a={};else{var l=qt?"buffer":"array";if(n&&n.content)a=E0e(n.content,t);else if((i=kt.find(e,"PerfectOffice_MAIN"))&&i.content)a=cc.to_workbook(i.content,(t.type=l,t));else if((i=kt.find(e,"NativeContent_MAIN"))&&i.content)a=cc.to_workbook(i.content,(t.type=l,t));else throw(i=kt.find(e,"MN0"))&&i.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&kt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=Boe(e))}var c={};return e.FullPaths&&N0e(e,c,t),a.Props=a.Custprops=c,t.bookFiles&&(a.cfb=e),a}function T0e(e,t){var r=t||{},n=kt.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return kt.utils.cfb_add(n,a,f8(e,r)),r.biff==8&&(e.Props||e.Custprops)&&k0e(e,n),r.biff==8&&e.vbaraw&&Uoe(n,kt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var l0={0:{f:Que},1:{f:ife},2:{f:Efe},3:{f:hfe},4:{f:cfe},5:{f:wfe},6:{f:jfe},7:{f:vfe},8:{f:Rfe},9:{f:Mfe},10:{f:Ife},11:{f:Pfe},12:{f:lfe},13:{f:kfe},14:{f:pfe},15:{f:ffe},16:{f:r8},17:{f:Cfe},18:{f:yfe},19:{f:pS},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Cde},40:{},42:{},43:{f:jle},44:{f:Tle},45:{f:Dle},46:{f:Ple},47:{f:Ile},48:{},49:{f:eae},50:{},51:{f:moe},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:k6},62:{f:Afe},63:{f:Soe},64:{f:Jfe},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Aa,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Kfe},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:nfe},148:{f:efe,p:16},151:{f:zfe},152:{},153:{f:Ade},154:{},155:{},156:{f:kde},157:{},158:{},159:{T:1,f:qse},160:{T:-1},161:{T:1,f:Pc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Ffe},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:doe},336:{T:-1},337:{f:voe,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Pw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:N6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Hfe},427:{f:qfe},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Vfe},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:rfe},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Ufe},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Pw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Poe},633:{T:1},634:{T:-1},635:{T:1,f:Doe},636:{T:-1},637:{f:aae},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:pde},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Zfe},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},zw={6:{f:cb},10:{f:Yl},12:{f:An},13:{f:An},14:{f:xn},15:{f:xn},16:{f:Na},17:{f:xn},18:{f:xn},19:{f:An},20:{f:N3},21:{f:N3},23:{f:N6},24:{f:T3},25:{f:xn},26:{},27:{},28:{f:Zie},29:{},34:{f:xn},35:{f:k3},38:{f:Na},39:{f:Na},40:{f:Na},41:{f:Na},42:{f:xn},43:{f:xn},47:{f:fle},49:{f:kie},51:{f:An},60:{},61:{f:wie},64:{f:xn},65:{f:Nie},66:{f:An},77:{},80:{},81:{},82:{},85:{f:An},89:{},90:{},91:{},92:{f:uie},93:{f:rse},94:{},95:{f:xn},96:{},97:{},99:{f:xn},125:{f:k6},128:{f:$ie},129:{f:die},130:{f:An},131:{f:xn},132:{f:xn},133:{f:hie},134:{},140:{f:use},141:{f:An},144:{},146:{f:hse},151:{},152:{},153:{},154:{},155:{},156:{f:An},157:{},158:{},160:{f:bse},161:{f:gse},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Fie},190:{f:Lie},193:{f:Yl},197:{},198:{},199:{},200:{},201:{},202:{f:xn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:An},220:{},221:{f:xn},222:{},224:{f:Uie},225:{f:cie},226:{f:Yl},227:{},229:{f:ese},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:pie},253:{f:Aie},255:{f:vie},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:g6},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:xn},353:{f:Yl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Vie},431:{f:xn},432:{},433:{},434:{},437:{},438:{f:ise},439:{f:xn},440:{f:sse},441:{},442:{f:z0},443:{},444:{f:An},445:{},446:{},448:{f:Yl},449:{f:bie,r:2},450:{f:Yl},512:{f:_3},513:{f:yse},515:{f:qie},516:{f:Oie},517:{f:E3},519:{f:wse},520:{f:xie},523:{},545:{f:A3},549:{f:w3},566:{},574:{f:Sie},638:{f:Rie},659:{},1048:{},1054:{f:Die},1084:{},1212:{f:Yie},2048:{f:ose},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Am},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Yl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:mse,r:12},2173:{f:uoe,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:xn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Xie,r:12},2197:{},2198:{f:aoe,r:12},2199:{},2200:{},2201:{},2202:{f:Qie,r:12},2203:{f:Yl},2204:{},2205:{},2206:{},2207:{},2211:{f:yie},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:An},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:vse},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:dse},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:_3},1:{},2:{f:kse},3:{f:Ese},4:{f:Sse},5:{f:E3},7:{f:Ase},8:{},9:{f:Am},11:{},22:{f:An},30:{f:Pie},31:{},32:{},33:{f:A3},36:{},37:{f:w3},50:{f:jse},62:{},52:{},67:{},68:{f:An},69:{},86:{},126:{},127:{f:_se},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:Ose},223:{},234:{},354:{},421:{},518:{f:cb},521:{f:Am},536:{f:T3},547:{f:k3},561:{},579:{},1030:{f:cb},1033:{f:Am},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function et(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,l=e.next(4);l.write_shift(2,a),l.write_shift(2,i),i>0&&dS(r)&&e.push(r)}}function A0e(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return et(e,t,r,a);var i=t;if(!isNaN(i)){for(var l=r.parts||[],c=0,f=0,d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;var m=e.next(4);for(m.write_shift(2,i),m.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d;f<a;){for(m=e.next(4),m.write_shift(2,60),d=0;d+(l[c]||8224)<=8224;)d+=l[c]||8224,c++;m.write_shift(2,d),e.push(r.slice(f,f+d)),f+=d}}}function V0(e,t,r){return e||(e=Ie(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function j0e(e,t,r,n){var a=Ie(9);return V0(a,e,t),v6(r,n||"b",a),a}function O0e(e,t,r){var n=Ie(8+2*r.length);return V0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function C0e(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Fn(Kr(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?et(e,2,Tse(r,n,a)):et(e,3,Nse(r,n,a));return;case"b":case"e":et(e,5,j0e(r,n,t.v,t.t));return;case"s":case"str":et(e,4,O0e(r,n,(t.v||"").slice(0,255)));return}et(e,1,V0(null,r,n))}function D0e(e,t,r,n){var a=Array.isArray(t),i=sr(t["!ref"]||"A1"),l,c="",f=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),l=Ut(i)}for(var d=i.s.r;d<=i.e.r;++d){c=yn(d);for(var m=i.s.c;m<=i.e.c;++m){d===i.s.r&&(f[m]=tn(m)),l=f[m]+c;var p=a?(t[d]||[])[m]:t[l];p&&C0e(e,p,d,m)}}}function I0e(e,t){for(var r=t||{},n=Xa(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return et(n,r.biff==4?1033:r.biff==3?521:9,_S(e,16,r)),D0e(n,e.Sheets[e.SheetNames[a]],a,r),et(n,10),n.end()}function P0e(e,t,r){et(e,49,Tie({sz:12,name:"Arial"},r))}function M0e(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&et(e,1054,Iie(a,t[a],r))})}function R0e(e,t){var r=Ie(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),et(e,2151,r),r=Ie(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),_6(sr(t["!ref"]||"A1"),r),r.write_shift(4,4),et(e,2152,r)}function F0e(e,t){for(var r=0;r<16;++r)et(e,224,S3({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){et(e,224,S3(n,0,t))})}function L0e(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];et(e,440,lse(n)),n[1].Tooltip&&et(e,2048,cse(n))}delete t["!links"]}function B0e(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&et(e,125,pse(av(a,n),a))})}}function U0e(e,t,r,n,a){var i=16+_o(a.cellXfs,t,a);if(t.v==null&&!t.bf){et(e,513,Ec(r,n,i));return}if(t.bf)et(e,6,due(t,r,n,a,i));else switch(t.t){case"d":case"n":var l=t.t=="d"?Fn(Kr(t.v)):t.v;et(e,515,Wie(r,n,l,i));break;case"b":case"e":et(e,517,Hie(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var c=OS(a.Strings,t.v,a.revStrings);et(e,253,jie(r,n,c,i))}else et(e,516,Cie(r,n,(t.v||"").slice(0,255),i,a));break;default:et(e,513,Ec(r,n,i))}}function $0e(e,t,r){var n=Xa(),a=r.SheetNames[e],i=r.Sheets[a]||{},l=(r||{}).Workbook||{},c=(l.Sheets||[])[e]||{},f=Array.isArray(i),d=t.biff==8,m,p="",v=[],x=sr(i["!ref"]||"A1"),y=d?65536:16384;if(x.e.c>255||x.e.r>=y){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,y-1)}et(n,2057,_S(r,16,t)),et(n,13,Li(1)),et(n,12,Li(100)),et(n,15,Ia(!0)),et(n,17,Ia(!1)),et(n,16,_c(.001)),et(n,95,Ia(!0)),et(n,42,Ia(!1)),et(n,43,Ia(!1)),et(n,130,Li(1)),et(n,128,zie()),et(n,131,Ia(!1)),et(n,132,Ia(!1)),d&&B0e(n,i["!cols"]),et(n,512,Mie(x,t)),d&&(i["!links"]=[]);for(var b=x.s.r;b<=x.e.r;++b){p=yn(b);for(var _=x.s.c;_<=x.e.c;++_){b===x.s.r&&(v[_]=tn(_)),m=v[_]+p;var E=f?(i[b]||[])[_]:i[m];E&&(U0e(n,E,b,_,t),d&&E.l&&i["!links"].push([m,E.l]))}}var A=c.CodeName||c.name||a;return d&&et(n,574,Eie((l.Views||[])[0])),d&&(i["!merges"]||[]).length&&et(n,229,tse(i["!merges"])),d&&L0e(n,i),et(n,442,x6(A)),d&&R0e(n,i),et(n,10),n.end()}function z0e(e,t,r){var n=Xa(),a=(e||{}).Workbook||{},i=a.Sheets||[],l=a.WBProps||{},c=r.biff==8,f=r.biff==5;if(et(n,2057,_S(e,5,r)),r.bookType=="xla"&&et(n,135),et(n,225,c?Li(1200):null),et(n,193,Hae(2)),f&&et(n,191),f&&et(n,192),et(n,226),et(n,92,fie("SheetJS",r)),et(n,66,Li(c?1200:1252)),c&&et(n,353,Li(0)),c&&et(n,448),et(n,317,xse(e.SheetNames.length)),c&&e.vbaraw&&et(n,211),c&&e.vbaraw){var d=l.CodeName||"ThisWorkbook";et(n,442,x6(d))}et(n,156,Li(17)),et(n,25,Ia(!1)),et(n,18,Ia(!1)),et(n,19,Li(0)),c&&et(n,431,Ia(!1)),c&&et(n,444,Li(0)),et(n,61,_ie()),et(n,64,Ia(!1)),et(n,141,Li(0)),et(n,34,Ia(bde(e)=="true")),et(n,14,Ia(!0)),c&&et(n,439,Ia(!1)),et(n,218,Li(0)),P0e(n,e,r),M0e(n,e.SSF,r),F0e(n,r),c&&et(n,352,Ia(!1));var m=n.end(),p=Xa();c&&et(p,140,fse()),c&&r.Strings&&A0e(p,252,gie(r.Strings)),et(p,10);var v=p.end(),x=Xa(),y=0,b=0;for(b=0;b<e.SheetNames.length;++b)y+=(c?12:11)+(c?2:1)*e.SheetNames[b].length;var _=m.length+y+v.length;for(b=0;b<e.SheetNames.length;++b){var E=i[b]||{};et(x,133,mie({pos:_,hs:E.Hidden||0,dt:0,name:e.SheetNames[b]},r)),_+=t[b].length}var A=x.end();if(y!=A.length)throw new Error("BS8 "+y+" != "+A.length);var T=[];return m.length&&T.push(m),A.length&&T.push(A),v.length&&T.push(v),Xn(T)}function H0e(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Xr(Dt)),e&&e.SSF&&(hf(),Qg(e.SSF),r.revssf=Zg(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,MS(r),r.cellXfs=[],_o(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=$0e(a,r,e);return n.unshift(z0e(e,n,r)),Xn(n)}function f8(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Ya(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return H0e(e,t);case 4:case 3:case 2:return I0e(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function L3(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var i=e.match(/<\/table/i),l=a.index,c=i&&i.index||e.length,f=Tne(e.slice(l,c),/(:?<tr[^>]*>)/i,"<tr>"),d=-1,m=0,p=0,v=0,x={s:{r:1e7,c:1e7},e:{r:0,c:0}},y=[];for(l=0;l<f.length;++l){var b=f[l].trim(),_=b.slice(0,3).toLowerCase();if(_=="<tr"){if(++d,r.sheetRows&&r.sheetRows<=d){--d;break}m=0;continue}if(!(_!="<td"&&_!="<th")){var E=b.split(/<\/t[dh]>/i);for(c=0;c<E.length;++c){var A=E[c].trim();if(A.match(/<t[dh]/i)){for(var T=A,k=0;T.charAt(0)=="<"&&(k=T.indexOf(">"))>-1;)T=T.slice(k+1);for(var I=0;I<y.length;++I){var O=y[I];O.s.c==m&&O.s.r<d&&d<=O.e.r&&(m=O.e.c+1,I=-1)}var j=Pt(A.slice(0,A.indexOf(">")));v=j.colspan?+j.colspan:1,((p=+j.rowspan)>1||v>1)&&y.push({s:{r:d,c:m},e:{r:d+(p||1)-1,c:m+v-1}});var B=j.t||j["data-t"]||"";if(!T.length){m+=v;continue}if(T=M5(T),x.s.r>d&&(x.s.r=d),x.e.r<d&&(x.e.r=d),x.s.c>m&&(x.s.c=m),x.e.c<m&&(x.e.c=m),!T.length){m+=v;continue}var U={t:"s",v:T};r.raw||!T.trim().length||B=="s"||(T==="TRUE"?U={t:"b",v:!0}:T==="FALSE"?U={t:"b",v:!1}:isNaN(ls(T))?isNaN(Yu(T).getDate())||(U={t:"d",v:Kr(T)},r.cellDates||(U={t:"n",v:Fn(U.v)}),U.z=r.dateNF||Dt[14]):U={t:"n",v:ls(T)}),r.dense?(n[d]||(n[d]=[]),n[d][m]=U):n[It({r:d,c:m})]=U,m+=v}}}}return n["!ref"]=Ut(x),y.length&&(n["!merges"]=y),n}function q0e(e,t,r,n){for(var a=e["!merges"]||[],i=[],l=t.s.c;l<=t.e.c;++l){for(var c=0,f=0,d=0;d<a.length;++d)if(!(a[d].s.r>r||a[d].s.c>l)&&!(a[d].e.r<r||a[d].e.c<l)){if(a[d].s.r<r||a[d].s.c<l){c=-1;break}c=a[d].e.r-a[d].s.r+1,f=a[d].e.c-a[d].s.c+1;break}if(!(c<0)){var m=It({r,c:l}),p=n.dense?(e[r]||[])[l]:e[m],v=p&&p.v!=null&&(p.h||cS(p.w||(pl(p),p.w)||""))||"",x={};c>1&&(x.rowspan=c),f>1&&(x.colspan=f),n.editable?v='<span contenteditable="true">'+v+"</span>":p&&(x["data-t"]=p&&p.t||"z",p.v!=null&&(x["data-v"]=p.v),p.z!=null&&(x["data-z"]=p.z),p.l&&(p.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+p.l.Target+'">'+v+"</a>")),x.id=(n.id||"sjs")+"-"+m,i.push(Ze("td",v,x))}}var y="<tr>";return y+i.join("")+"</tr>"}var W0e='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',V0e="</body></html>";function G0e(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return wo(L3(r[0],t),t);var n=BS();return r.forEach(function(a,i){US(n,L3(a,t),"Sheet"+(i+1))}),n}function K0e(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function d8(e,t){var r=t||{},n=r.header!=null?r.header:W0e,a=r.footer!=null?r.footer:V0e,i=[n],l=Ya(e["!ref"]);r.dense=Array.isArray(e),i.push(K0e(e,l,r));for(var c=l.s.r;c<=l.e.r;++c)i.push(q0e(e,l,c,r));return i.push("</table>"+a),i.join("")}function h8(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var l=typeof n.origin=="string"?rn(n.origin):n.origin;a=l.r,i=l.c}var c=t.getElementsByTagName("tr"),f=Math.min(n.sheetRows||1e7,c.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var m=Ya(e["!ref"]);d.s.r=Math.min(d.s.r,m.s.r),d.s.c=Math.min(d.s.c,m.s.c),d.e.r=Math.max(d.e.r,m.e.r),d.e.c=Math.max(d.e.c,m.e.c),a==-1&&(d.e.r=a=m.e.r+1)}var p=[],v=0,x=e["!rows"]||(e["!rows"]=[]),y=0,b=0,_=0,E=0,A=0,T=0;for(e["!cols"]||(e["!cols"]=[]);y<c.length&&b<f;++y){var k=c[y];if(B3(k)){if(n.display)continue;x[b]={hidden:!0}}var I=k.children;for(_=E=0;_<I.length;++_){var O=I[_];if(!(n.display&&B3(O))){var j=O.hasAttribute("data-v")?O.getAttribute("data-v"):O.hasAttribute("v")?O.getAttribute("v"):M5(O.innerHTML),B=O.getAttribute("data-z")||O.getAttribute("z");for(v=0;v<p.length;++v){var U=p[v];U.s.c==E+i&&U.s.r<b+a&&b+a<=U.e.r&&(E=U.e.c+1-i,v=-1)}T=+O.getAttribute("colspan")||1,((A=+O.getAttribute("rowspan")||1)>1||T>1)&&p.push({s:{r:b+a,c:E+i},e:{r:b+a+(A||1)-1,c:E+i+(T||1)-1}});var Y={t:"s",v:j},te=O.getAttribute("data-t")||O.getAttribute("t")||"";j!=null&&(j.length==0?Y.t=te||"z":n.raw||j.trim().length==0||te=="s"||(j==="TRUE"?Y={t:"b",v:!0}:j==="FALSE"?Y={t:"b",v:!1}:isNaN(ls(j))?isNaN(Yu(j).getDate())||(Y={t:"d",v:Kr(j)},n.cellDates||(Y={t:"n",v:Fn(Y.v)}),Y.z=n.dateNF||Dt[14]):Y={t:"n",v:ls(j)})),Y.z===void 0&&B!=null&&(Y.z=B);var V="",ge=O.getElementsByTagName("A");if(ge&&ge.length)for(var be=0;be<ge.length&&!(ge[be].hasAttribute("href")&&(V=ge[be].getAttribute("href"),V.charAt(0)!="#"));++be);V&&V.charAt(0)!="#"&&(Y.l={Target:V}),n.dense?(e[b+a]||(e[b+a]=[]),e[b+a][E+i]=Y):e[It({c:E+i,r:b+a})]=Y,d.e.c<E+i&&(d.e.c=E+i),E+=T}}++b}return p.length&&(e["!merges"]=(e["!merges"]||[]).concat(p)),d.e.r=Math.max(d.e.r,b-1+a),e["!ref"]=Ut(d),b>=f&&(e["!fullref"]=Ut((d.e.r=c.length-y+b-1+a,d))),e}function m8(e,t){var r=t||{},n=r.dense?[]:{};return h8(n,e,t)}function X0e(e,t){return wo(m8(e,t),t)}function B3(e){var t="",r=Y0e(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function Y0e(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Q0e(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ir(t.replace(/<[^>]*>/g,""));return[r]}var U3={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function p8(e,t){var r=t||{},n=uS(e),a=[],i,l,c={name:""},f="",d=0,m,p,v={},x=[],y=r.dense?[]:{},b,_,E={value:""},A="",T=0,k=[],I=-1,O=-1,j={s:{r:1e6,c:1e7},e:{r:0,c:0}},B=0,U={},Y=[],te={},V=0,ge=0,be=[],ve=1,z=1,ue=[],se={Names:[]},Q={},re=["",""],G=[],P={},W="",F=0,M=!1,le=!1,pe=0;for(t0.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=t0.exec(n);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"":b[1]==="/"?(j.e.c>=j.s.c&&j.e.r>=j.s.r?y["!ref"]=Ut(j):y["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=j.e.r&&(y["!fullref"]=y["!ref"],j.e.r=r.sheetRows-1,y["!ref"]=Ut(j)),Y.length&&(y["!merges"]=Y),be.length&&(y["!rows"]=be),m.name=m.||m.name,typeof JSON<"u"&&JSON.stringify(m),x.push(m.name),v[m.name]=y,le=!1):b[0].charAt(b[0].length-2)!=="/"&&(m=Pt(b[0],!1),I=O=-1,j.s.r=j.s.c=1e7,j.e.r=j.e.c=0,y=r.dense?[]:{},Y=[],be=[],le=!0);break;case"table-row-group":b[1]==="/"?--B:++B;break;case"table-row":case"":if(b[1]==="/"){I+=ve,ve=1;break}if(p=Pt(b[0],!1),p.?I=p.-1:I==-1&&(I=0),ve=+p["number-rows-repeated"]||1,ve<10)for(pe=0;pe<ve;++pe)B>0&&(be[I+pe]={level:B});O=-1;break;case"covered-table-cell":b[1]!=="/"&&++O,r.sheetStubs&&(r.dense?(y[I]||(y[I]=[]),y[I][O]={t:"z"}):y[It({r:I,c:O})]={t:"z"}),A="",k=[];break;case"table-cell":case"":if(b[0].charAt(b[0].length-2)==="/")++O,E=Pt(b[0],!1),z=parseInt(E["number-columns-repeated"]||"1",10),_={t:"z",v:null},E.formula&&r.cellFormula!=!1&&(_.f=M3(ir(E.formula))),(E.||E["value-type"])=="string"&&(_.t="s",_.v=ir(E["string-value"]||""),r.dense?(y[I]||(y[I]=[]),y[I][O]=_):y[It({r:I,c:O})]=_),O+=z-1;else if(b[1]!=="/"){++O,A="",T=0,k=[],z=1;var Ae=ve?I+ve-1:I;if(O>j.e.c&&(j.e.c=O),O<j.s.c&&(j.s.c=O),I<j.s.r&&(j.s.r=I),Ae>j.e.r&&(j.e.r=Ae),E=Pt(b[0],!1),G=[],P={},_={t:E.||E["value-type"],v:null},r.cellFormula)if(E.formula&&(E.formula=ir(E.formula)),E["number-matrix-columns-spanned"]&&E["number-matrix-rows-spanned"]&&(V=parseInt(E["number-matrix-rows-spanned"],10)||0,ge=parseInt(E["number-matrix-columns-spanned"],10)||0,te={s:{r:I,c:O},e:{r:I+V-1,c:O+ge-1}},_.F=Ut(te),ue.push([te,_.F])),E.formula)_.f=M3(E.formula);else for(pe=0;pe<ue.length;++pe)I>=ue[pe][0].s.r&&I<=ue[pe][0].e.r&&O>=ue[pe][0].s.c&&O<=ue[pe][0].e.c&&(_.F=ue[pe][1]);switch((E["number-columns-spanned"]||E["number-rows-spanned"])&&(V=parseInt(E["number-rows-spanned"],10)||0,ge=parseInt(E["number-columns-spanned"],10)||0,te={s:{r:I,c:O},e:{r:I+V-1,c:O+ge-1}},Y.push(te)),E["number-columns-repeated"]&&(z=parseInt(E["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=Vr(E["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(E.value);break;case"percentage":_.t="n",_.v=parseFloat(E.value);break;case"currency":_.t="n",_.v=parseFloat(E.value);break;case"date":_.t="d",_.v=Kr(E["date-value"]),r.cellDates||(_.t="n",_.v=Fn(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=Ene(E["time-value"])/86400,r.cellDates&&(_.t="d",_.v=ev(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(E.);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",E["string-value"]!=null&&(A=ir(E["string-value"]),k=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(M=!1,_.t==="s"&&(_.v=A||"",k.length&&(_.R=k),M=T==0),Q.Target&&(_.l=Q),G.length>0&&(_.c=G,G=[]),A&&r.cellText!==!1&&(_.w=A),M&&(_.t="z",delete _.v),(!M||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=I))for(var oe=0;oe<ve;++oe){if(z=parseInt(E["number-columns-repeated"]||"1",10),r.dense)for(y[I+oe]||(y[I+oe]=[]),y[I+oe][O]=oe==0?_:Xr(_);--z>0;)y[I+oe][O+z]=Xr(_);else for(y[It({r:I+oe,c:O})]=_;--z>0;)y[It({r:I+oe,c:O+z})]=Xr(_);j.e.c<=O&&(j.e.c=O)}z=parseInt(E["number-columns-repeated"]||"1",10),O+=z-1,z=0,_={},A="",k=[]}Q={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i;P.t=A,k.length&&(P.R=k),P.a=W,G.push(P)}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);W="",F=0,A="",T=0,k=[];break;case"creator":b[1]==="/"?W=n.slice(F,b.index):F=b.index+b[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&a.push([b[3],!1]);A="",T=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(U[c.name]=f,(i=a.pop())[0]!==b[3])throw"Bad state: "+i}else b[0].charAt(b[0].length-2)!=="/"&&(f="",c=Pt(b[0],!1),a.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Pt(b[0],!1),f+=U3[b[3]][l.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":l=Pt(b[0],!1),f+=U3[b[3]][l.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":f+=n.slice(d,b.index);break}else d=b.index+b[0].length;break;case"named-range":l=Pt(b[0],!1),re=ub(l["cell-range-address"]);var ae={Name:l.name,Ref:re[0]+"!"+re[1]};le&&(ae.Sheet=x.length),se.Names.push(ae);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(b[1]==="/"&&(!E||!E["string-value"])){var ze=Q0e(n.slice(T,b.index));A=(A.length>0?A+`
`:"")+ze[0]}else Pt(b[0],!1),T=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{re=ub(Pt(b[0])["target-range-address"]),v[re[0]]["!autofilter"]={ref:re[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(Q=Pt(b[0],!1),!Q.href)break;Q.Target=ir(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(re=ub(Q.Target.slice(1)),Q.Target="#"+re[0]+"!"+re[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(b)}}var q={Sheets:v,SheetNames:x,Workbook:se};return r.bookSheets&&delete q.Sheets,q}function $3(e,t){t=t||{},Fi(e,"META-INF/manifest.xml")&&Eae(Tn(e,"META-INF/manifest.xml"),t);var r=hi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=p8(Ir(r),t);return Fi(e,"meta.xml")&&(n.Props=i6(Tn(e,"meta.xml"))),n}function z3(e,t){return p8(e,t)}var J0e=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+e0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return bn+t}})(),H3=(function(){var e=function(i){return Nr(i).replace(/  +/g,function(l){return'<text:s text:c="'+l.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,l,c){var f=[];f.push('      <table:table table:name="'+Nr(l.SheetNames[c])+`" table:style-name="ta1">
`);var d=0,m=0,p=Ya(i["!ref"]||"A1"),v=i["!merges"]||[],x=0,y=Array.isArray(i);if(i["!cols"])for(m=0;m<=p.e.c;++m)f.push("        <table:table-column"+(i["!cols"][m]?' table:style-name="co'+i["!cols"][m].ods+'"':"")+`></table:table-column>
`);var b="",_=i["!rows"]||[];for(d=0;d<p.s.r;++d)b=_[d]?' table:style-name="ro'+_[d].ods+'"':"",f.push("        <table:table-row"+b+`></table:table-row>
`);for(;d<=p.e.r;++d){for(b=_[d]?' table:style-name="ro'+_[d].ods+'"':"",f.push("        <table:table-row"+b+`>
`),m=0;m<p.s.c;++m)f.push(t);for(;m<=p.e.c;++m){var E=!1,A={},T="";for(x=0;x!=v.length;++x)if(!(v[x].s.c>m)&&!(v[x].s.r>d)&&!(v[x].e.c<m)&&!(v[x].e.r<d)){(v[x].s.c!=m||v[x].s.r!=d)&&(E=!0),A["table:number-columns-spanned"]=v[x].e.c-v[x].s.c+1,A["table:number-rows-spanned"]=v[x].e.r-v[x].s.r+1;break}if(E){f.push(r);continue}var k=It({r:d,c:m}),I=y?(i[d]||[])[m]:i[k];if(I&&I.f&&(A["table:formula"]=Nr(xue(I.f)),I.F&&I.F.slice(0,k.length)==k)){var O=Ya(I.F);A["table:number-matrix-columns-spanned"]=O.e.c-O.s.c+1,A["table:number-matrix-rows-spanned"]=O.e.r-O.s.r+1}if(!I){f.push(t);continue}switch(I.t){case"b":T=I.v?"TRUE":"FALSE",A["office:value-type"]="boolean",A["office:boolean-value"]=I.v?"true":"false";break;case"n":T=I.w||String(I.v||0),A["office:value-type"]="float",A["office:value"]=I.v||0;break;case"s":case"str":T=I.v==null?"":I.v,A["office:value-type"]="string";break;case"d":T=I.w||Kr(I.v).toISOString(),A["office:value-type"]="date",A["office:date-value"]=Kr(I.v).toISOString(),A["table:style-name"]="ce1";break;default:f.push(t);continue}var j=e(T);if(I.l&&I.l.Target){var B=I.l.Target;B=B.charAt(0)=="#"?"#"+yue(B.slice(1)):B,B.charAt(0)!="#"&&!B.match(/^\w+:/)&&(B="../"+B),j=Ze("text:a",j,{"xlink:href":B.replace(/&/g,"&amp;")})}f.push("          "+Ze("table:table-cell",Ze("text:p",j,{}),A)+`
`)}f.push(`        </table:table-row>
`)}return f.push(`      </table:table>
`),f.join("")},a=function(i,l){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var c=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var m=0;m<d["!cols"].length;++m)if(d["!cols"][m]){var p=d["!cols"][m];if(p.width==null&&p.wpx==null&&p.wch==null)continue;uo(p),p.ods=c;var v=d["!cols"][m].wpx+"px";i.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),i.push(`  </style:style>
`),++c}}});var f=0;l.SheetNames.map(function(d){return l.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var m=0;m<d["!rows"].length;++m)if(d["!rows"][m]){d["!rows"][m].ods=f;var p=d["!rows"][m].hpx+"px";i.push('  <style:style style:name="ro'+f+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+p+`"/>
`),i.push(`  </style:style>
`),++f}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(l,c){var f=[bn],d=e0({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),m=e0({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(f.push("<office:document"+d+m+`>
`),f.push(a6().replace(/office:document-meta/g,"office:meta"))):f.push("<office:document-content"+d+`>
`),a(f,l),f.push(`  <office:body>
`),f.push(`    <office:spreadsheet>
`);for(var p=0;p!=l.SheetNames.length;++p)f.push(n(l.Sheets[l.SheetNames[p]],l,p));return f.push(`    </office:spreadsheet>
`),f.push(`  </office:body>
`),c.bookType=="fods"?f.push("</office:document>"):f.push("</office:document-content>"),f.join("")}})();function g8(e,t){if(t.bookType=="fods")return H3(e,t);var r=sS(),n="",a=[],i=[];return n="mimetype",zt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",zt(r,n,H3(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",zt(r,n,J0e(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",zt(r,n,bn+a6()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",zt(r,n,Tae(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",zt(r,n,Nae(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Nc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Hw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ir(bo(e))}function Z0e(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):di(Ns(e))}function ehe(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function ho(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function q3(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function the(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function rhe(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function o0(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function wr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function dn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function ur(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=o0(e,r),i=a&7;a=Math.floor(a/8);var l=0,c;if(a==0)break;switch(i){case 0:{for(var f=r[0];e[r[0]++]>=128;);c=e.slice(f,r[0])}break;case 5:l=4,c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 1:l=8,c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 2:l=o0(e,r),c=e.slice(r[0],r[0]+l),r[0]+=l;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var d={data:c,type:i};t[a]==null?t[a]=[d]:t[a].push(d)}return t}function ca(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(wr(n*8+a.type)),a.type==2&&t.push(wr(a.data.length)),t.push(a.data))})}),ho(t)}function IS(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Pi(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=o0(e,n),i=ur(e.slice(n[0],n[0]+a));n[0]+=a;var l={id:dn(i[1][0].data),messages:[]};i[2].forEach(function(c){var f=ur(c.data),d=dn(f[3][0].data);l.messages.push({meta:f,data:e.slice(n[0],n[0]+d)}),n[0]+=d}),(t=i[3])!=null&&t[0]&&(l.merge=dn(i[3][0].data)>>>0>0),r.push(l)}return r}function xu(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:wr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:wr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(l){a.push(l.data),l.meta[3]=[{type:0,data:wr(l.data.length)}],n[2].push({data:ca(l.meta),type:2})});var i=ca(n);t.push(wr(i.length)),t.push(i),a.forEach(function(l){return t.push(l)})}),ho(t)}function nhe(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=o0(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var l=t[r[0]++]>>2;if(l<60)++l;else{var c=l-59;l=t[r[0]],c>1&&(l|=t[r[0]+1]<<8),c>2&&(l|=t[r[0]+2]<<16),c>3&&(l|=t[r[0]+3]<<24),l>>>=0,l++,r[0]+=c}a.push(t.slice(r[0],r[0]+l)),r[0]+=l;continue}else{var f=0,d=0;if(i==1?(d=(t[r[0]]>>2&7)+4,f=(t[r[0]++]&224)<<3,f|=t[r[0]++]):(d=(t[r[0]++]>>2)+1,i==2?(f=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(f=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[ho(a)],f==0)throw new Error("Invalid offset 0");if(f>a[0].length)throw new Error("Invalid offset beyond length");if(d>=f)for(a.push(a[0].slice(-f)),d-=f;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-f,-f+d))}}var m=ho(a);if(m.length!=n)throw new Error("Unexpected length: ".concat(m.length," != ").concat(n));return m}function Mi(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(nhe(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return ho(t)}function yu(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=wr(n),l=i.length;t.push(i),n<=60?(l++,t.push(new Uint8Array([n-1<<2]))):n<=256?(l+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(l+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(l+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(l+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),l+=n,a[0]=0,a[1]=l&255,a[2]=l>>8&255,a[3]=l>>16&255,r+=n}return ho(t)}function ahe(e,t,r,n){var a=Nc(e),i=a.getUint32(4,!0),l=(n>1?12:8)+q3(i&(n>1?3470:398))*4,c=-1,f=-1,d=NaN,m=new Date(2001,0,1);i&512&&(c=a.getUint32(l,!0),l+=4),l+=q3(i&(n>1?12288:4096))*4,i&16&&(f=a.getUint32(l,!0),l+=4),i&32&&(d=a.getFloat64(l,!0),l+=8),i&64&&(m.setTime(m.getTime()+a.getFloat64(l,!0)*1e3),l+=8);var p;switch(e[2]){case 0:break;case 2:p={t:"n",v:d};break;case 3:p={t:"s",v:t[f]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(c>-1)p={t:"s",v:r[c]};else if(f>-1)p={t:"s",v:t[f]};else if(!isNaN(d))p={t:"n",v:d};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return p}function ihe(e,t,r){var n=Nc(e),a=n.getUint32(8,!0),i=12,l=-1,c=-1,f=NaN,d=NaN,m=new Date(2001,0,1);a&1&&(f=the(e,i),i+=16),a&2&&(d=n.getFloat64(i,!0),i+=8),a&4&&(m.setTime(m.getTime()+n.getFloat64(i,!0)*1e3),i+=8),a&8&&(c=n.getUint32(i,!0),i+=4),a&16&&(l=n.getUint32(i,!0),i+=4);var p;switch(e[1]){case 0:break;case 2:p={t:"n",v:f};break;case 3:p={t:"s",v:t[c]};break;case 5:p={t:"d",v:m};break;case 6:p={t:"b",v:d>0};break;case 7:p={t:"n",v:d/86400};break;case 8:p={t:"e",v:0};break;case 9:if(l>-1)p={t:"s",v:r[l]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:p={t:"n",v:f};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return p}function db(e,t){var r=new Uint8Array(32),n=Nc(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,rhe(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function hb(e,t){var r=new Uint8Array(32),n=Nc(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function she(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return ahe(e,t,r,e[0]);case 5:return ihe(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function wa(e){var t=ur(e);return o0(t[1][0].data)}function W3(e,t){var r=ur(t.data),n=dn(r[1][0].data),a=r[3],i=[];return(a||[]).forEach(function(l){var c=ur(l.data),f=dn(c[1][0].data)>>>0;switch(n){case 1:i[f]=Hw(c[3][0].data);break;case 8:{var d=e[wa(c[9][0].data)][0],m=ur(d.data),p=e[wa(m[1][0].data)][0],v=dn(p.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var x=ur(p.data);i[f]=x[3].map(function(y){return Hw(y.data)}).join("")}break}}),i}function lhe(e,t){var r,n,a,i,l,c,f,d,m,p,v,x,y,b,_=ur(e),E=dn(_[1][0].data)>>>0,A=dn(_[2][0].data)>>>0,T=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&dn(_[8][0].data)>0||!1,k,I;if((i=(a=_[7])==null?void 0:a[0])!=null&&i.data&&t!=0)k=(c=(l=_[7])==null?void 0:l[0])==null?void 0:c.data,I=(d=(f=_[6])==null?void 0:f[0])==null?void 0:d.data;else if((p=(m=_[4])==null?void 0:m[0])!=null&&p.data&&t!=1)k=(x=(v=_[4])==null?void 0:v[0])==null?void 0:x.data,I=(b=(y=_[3])==null?void 0:y[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var O=T?4:1,j=Nc(k),B=[],U=0;U<k.length/2;++U){var Y=j.getUint16(U*2,!0);Y<65535&&B.push([U,Y])}if(B.length!=A)throw"Expected ".concat(A," cells, found ").concat(B.length);var te=[];for(U=0;U<B.length-1;++U)te[B[U][0]]=I.subarray(B[U][1]*O,B[U+1][1]*O);return B.length>=1&&(te[B[B.length-1][0]]=I.subarray(B[B.length-1][1]*O)),{R:E,cells:te}}function ohe(e,t){var r,n=ur(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?dn(n[7][0].data)>>>0>0?1:0:-1,i=IS(n[5],function(l){return lhe(l,a)});return{nrows:dn(n[4][0].data)>>>0,data:i.reduce(function(l,c){return l[c.R]||(l[c.R]=[]),c.cells.forEach(function(f,d){if(l[c.R][d])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(d));l[c.R][d]=f}),l},[])}}function che(e,t,r){var n,a=ur(t.data),i={s:{r:0,c:0},e:{r:0,c:0}};if(i.e.r=(dn(a[6][0].data)>>>0)-1,i.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(i.e.c=(dn(a[7][0].data)>>>0)-1,i.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=Ut(i);var l=ur(a[4][0].data),c=W3(e,e[wa(l[4][0].data)][0]),f=(n=l[17])!=null&&n[0]?W3(e,e[wa(l[17][0].data)][0]):[],d=ur(l[3][0].data),m=0;d[1].forEach(function(p){var v=ur(p.data),x=e[wa(v[2][0].data)][0],y=dn(x.meta[1][0].data);if(y!=6002)throw new Error("6001 unexpected reference to ".concat(y));var b=ohe(e,x);b.data.forEach(function(_,E){_.forEach(function(A,T){var k=It({r:m+E,c:T}),I=she(A,c,f);I&&(r[k]=I)})}),m+=b.nrows})}function uhe(e,t){var r=ur(t.data),n={"!ref":"A1"},a=e[wa(r[2][0].data)],i=dn(a[0].meta[1][0].data);if(i!=6001)throw new Error("6000 unexpected reference to ".concat(i));return che(e,a[0],n),n}function fhe(e,t){var r,n=ur(t.data),a={name:(r=n[1])!=null&&r[0]?Hw(n[1][0].data):"",sheets:[]},i=IS(n[2],wa);return i.forEach(function(l){e[l].forEach(function(c){var f=dn(c.meta[1][0].data);f==6e3&&a.sheets.push(uhe(e,c))})}),a}function dhe(e,t){var r=BS(),n=ur(t.data),a=IS(n[1],wa);if(a.forEach(function(i){e[i].forEach(function(l){var c=dn(l.meta[1][0].data);if(c==2){var f=fhe(e,l);f.sheets.forEach(function(d,m){US(r,d,m==0?f.name:f.name+"_"+m,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function mb(e){var t,r,n,a,i={},l=[];if(e.FullPaths.forEach(function(f){if(f.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(f){if(f.name.match(/\.iwa$/)){var d;try{d=Mi(f.content)}catch(p){return console.log("?? "+f.content.length+" "+(p.message||p))}var m;try{m=Pi(d)}catch(p){return console.log("## "+(p.message||p))}m.forEach(function(p){i[p.id]=p.messages,l.push(p.id)})}}),!l.length)throw new Error("File has no messages");var c=((a=(n=(r=(t=i==null?void 0:i[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&dn(i[1][0].meta[1][0].data)==1&&i[1][0];if(c||l.forEach(function(f){i[f].forEach(function(d){var m=dn(d.meta[1][0].data)>>>0;if(m==1)if(!c)c=d;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return dhe(i,c)}function hhe(e,t,r){var n,a,i,l;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var c=((l=(i=e[8])==null?void 0:i[0])==null?void 0:l.data)&&dn(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var f=0,d=Nc(e[7][0].data),m=0,p=[],v=Nc(e[4][0].data),x=0,y=[],b=0;b<t.length;++b){if(t[b]==null){d.setUint16(b*2,65535,!0),v.setUint16(b*2,65535);continue}d.setUint16(b*2,m,!0),v.setUint16(b*2,x,!0);var _,E;switch(typeof t[b]){case"string":_=db({t:"s",v:t[b]},r),E=hb({t:"s",v:t[b]},r);break;case"number":_=db({t:"n",v:t[b]},r),E=hb({t:"n",v:t[b]},r);break;case"boolean":_=db({t:"b",v:t[b]},r),E=hb({t:"b",v:t[b]},r);break;default:throw new Error("Unsupported value "+t[b])}p.push(_),m+=_.length,y.push(E),x+=E.length,++f}for(e[2][0].data=wr(f);b<e[7][0].data.length/2;++b)d.setUint16(b*2,65535,!0),v.setUint16(b*2,65535,!0);return e[6][0].data=ho(p),e[3][0].data=ho(y),f}function mhe(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ya(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Ut(n)));var i=Jp(r,{range:n,header:1}),l=["~Sh33tJ5~"];i.forEach(function(W){return W.forEach(function(F){typeof F=="string"&&l.push(F)})});var c={},f=[],d=kt.read(t.numbers,{type:"base64"});d.FileIndex.map(function(W,F){return[W,d.FullPaths[F]]}).forEach(function(W){var F=W[0],M=W[1];if(F.type==2&&F.name.match(/\.iwa/)){var le=F.content,pe=Mi(le),Ae=Pi(pe);Ae.forEach(function(oe){f.push(oe.id),c[oe.id]={deps:[],location:M,type:dn(oe.messages[0].meta[1][0].data)}})}}),f.sort(function(W,F){return W-F});var m=f.filter(function(W){return W>1}).map(function(W){return[W,wr(W)]});d.FileIndex.map(function(W,F){return[W,d.FullPaths[F]]}).forEach(function(W){var F=W[0];if(W[1],!!F.name.match(/\.iwa/)){var M=Pi(Mi(F.content));M.forEach(function(le){le.messages.forEach(function(pe){m.forEach(function(Ae){le.messages.some(function(oe){return dn(oe.meta[1][0].data)!=11006&&ehe(oe.data,Ae[1])})&&c[Ae[0]].deps.push(le.id)})})})}});for(var p=kt.find(d,c[1].location),v=Pi(Mi(p.content)),x,y=0;y<v.length;++y){var b=v[y];b.id==1&&(x=b)}var _=wa(ur(x.messages[0].data)[1][0].data);for(p=kt.find(d,c[_].location),v=Pi(Mi(p.content)),y=0;y<v.length;++y)b=v[y],b.id==_&&(x=b);for(_=wa(ur(x.messages[0].data)[2][0].data),p=kt.find(d,c[_].location),v=Pi(Mi(p.content)),y=0;y<v.length;++y)b=v[y],b.id==_&&(x=b);for(_=wa(ur(x.messages[0].data)[2][0].data),p=kt.find(d,c[_].location),v=Pi(Mi(p.content)),y=0;y<v.length;++y)b=v[y],b.id==_&&(x=b);var E=ur(x.messages[0].data);{E[6][0].data=wr(n.e.r+1),E[7][0].data=wr(n.e.c+1);var A=wa(E[46][0].data),T=kt.find(d,c[A].location),k=Pi(Mi(T.content));{for(var I=0;I<k.length&&k[I].id!=A;++I);if(k[I].id!=A)throw"Bad ColumnRowUIDMapArchive";var O=ur(k[I].messages[0].data);O[1]=[],O[2]=[],O[3]=[];for(var j=0;j<=n.e.c;++j){var B=[];B[1]=B[2]=[{type:0,data:wr(j+420690)}],O[1].push({type:2,data:ca(B)}),O[2].push({type:0,data:wr(j)}),O[3].push({type:0,data:wr(j)})}O[4]=[],O[5]=[],O[6]=[];for(var U=0;U<=n.e.r;++U)B=[],B[1]=B[2]=[{type:0,data:wr(U+726270)}],O[4].push({type:2,data:ca(B)}),O[5].push({type:0,data:wr(U)}),O[6].push({type:0,data:wr(U)});k[I].messages[0].data=ca(O)}T.content=yu(xu(k)),T.size=T.content.length,delete E[46];var Y=ur(E[4][0].data);{Y[7][0].data=wr(n.e.r+1);var te=ur(Y[1][0].data),V=wa(te[2][0].data);T=kt.find(d,c[V].location),k=Pi(Mi(T.content));{if(k[0].id!=V)throw"Bad HeaderStorageBucket";var ge=ur(k[0].messages[0].data);for(U=0;U<i.length;++U){var be=ur(ge[2][0].data);be[1][0].data=wr(U),be[4][0].data=wr(i[U].length),ge[2][U]={type:ge[2][0].type,data:ca(be)}}k[0].messages[0].data=ca(ge)}T.content=yu(xu(k)),T.size=T.content.length;var ve=wa(Y[2][0].data);T=kt.find(d,c[ve].location),k=Pi(Mi(T.content));{if(k[0].id!=ve)throw"Bad HeaderStorageBucket";for(ge=ur(k[0].messages[0].data),j=0;j<=n.e.c;++j)be=ur(ge[2][0].data),be[1][0].data=wr(j),be[4][0].data=wr(n.e.r+1),ge[2][j]={type:ge[2][0].type,data:ca(be)};k[0].messages[0].data=ca(ge)}T.content=yu(xu(k)),T.size=T.content.length;var z=wa(Y[4][0].data);(function(){for(var W=kt.find(d,c[z].location),F=Pi(Mi(W.content)),M,le=0;le<F.length;++le){var pe=F[le];pe.id==z&&(M=pe)}var Ae=ur(M.messages[0].data);{Ae[3]=[];var oe=[];l.forEach(function(q,Je){oe[1]=[{type:0,data:wr(Je)}],oe[2]=[{type:0,data:wr(1)}],oe[3]=[{type:2,data:Z0e(q)}],Ae[3].push({type:2,data:ca(oe)})})}M.messages[0].data=ca(Ae);var ae=xu(F),ze=yu(ae);W.content=ze,W.size=W.content.length})();var ue=ur(Y[3][0].data);{var se=ue[1][0];delete ue[2];var Q=ur(se.data);{var re=wa(Q[2][0].data);(function(){for(var W=kt.find(d,c[re].location),F=Pi(Mi(W.content)),M,le=0;le<F.length;++le){var pe=F[le];pe.id==re&&(M=pe)}var Ae=ur(M.messages[0].data);{delete Ae[6],delete ue[7];var oe=new Uint8Array(Ae[5][0].data);Ae[5]=[];for(var ae=0,ze=0;ze<=n.e.r;++ze){var q=ur(oe);ae+=hhe(q,i[ze],l),q[1][0].data=wr(ze),Ae[5].push({data:ca(q),type:2})}Ae[1]=[{type:0,data:wr(n.e.c+1)}],Ae[2]=[{type:0,data:wr(n.e.r+1)}],Ae[3]=[{type:0,data:wr(ae)}],Ae[4]=[{type:0,data:wr(n.e.r+1)}]}M.messages[0].data=ca(Ae);var Je=xu(F),qe=yu(Je);W.content=qe,W.size=W.content.length})()}se.data=ca(Q)}Y[3][0].data=ca(ue)}E[4][0].data=ca(Y)}x.messages[0].data=ca(E);var G=xu(v),P=yu(G);return p.content=P,p.size=p.content.length,d}function v8(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function PS(e){v8([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function MS(e){v8([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function phe(e){return Gt.WS.indexOf(e)>-1?"sheet":e==Gt.CS?"chart":e==Gt.DS?"dialog":e==Gt.MS?"macro":e&&e.length?e:"sheet"}function ghe(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,phe(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function vhe(e,t,r,n,a,i,l,c,f,d,m,p){try{i[n]=Td(hi(e,r,!0),t);var v=Tn(e,t),x;switch(c){case"sheet":x=Bde(v,t,a,f,i[n],d,m,p);break;case"chart":if(x=Ude(v,t,a,f,i[n],d,m,p),!x||!x["!drawel"])break;var y=wd(x["!drawel"].Target,t),b=r0(y),_=koe(hi(e,y,!0),Td(hi(e,b,!0),y)),E=wd(_,y),A=r0(E);x=hde(hi(e,E,!0),E,f,Td(hi(e,A,!0),E),d,x);break;case"macro":x=$de(v,t,a,f,i[n],d,m,p);break;case"dialog":x=zde(v,t,a,f,i[n],d,m,p);break;default:throw new Error("Unrecognized sheet type "+c)}l[n]=x;var T=[];i&&i[n]&&hn(i[n]).forEach(function(k){var I="";if(i[n][k].Type==Gt.CMNT){I=wd(i[n][k].Target,t);var O=Vde(Tn(e,I,!0),I,f);if(!O||!O.length)return;O3(x,O,!1)}i[n][k].Type==Gt.TCMNT&&(I=wd(i[n][k].Target,t),T=T.concat(Aoe(Tn(e,I,!0),f)))}),T&&T.length&&O3(x,T,!0,f.people||[])}catch(k){if(f.WTF)throw k}}function Ci(e){return e.charAt(0)=="/"?e.slice(1):e}function xhe(e,t){if(hf(),t=t||{},PS(t),Fi(e,"META-INF/manifest.xml")||Fi(e,"objectdata.xml"))return $3(e,t);if(Fi(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof mb<"u"){if(e.FileIndex)return mb(e);var r=kt.utils.cfb_new();return Q4(e).forEach(function(be){zt(r,be,jne(e,be))}),mb(r)}throw new Error("Unsupported NUMBERS file")}if(!Fi(e,"[Content_Types].xml"))throw Fi(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Fi(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=Q4(e),a=_ae(hi(e,"[Content_Types].xml")),i=!1,l,c;if(a.workbooks.length===0&&(c="xl/workbook.xml",Tn(e,c,!0)&&a.workbooks.push(c)),a.workbooks.length===0){if(c="xl/workbook.bin",!Tn(e,c,!0))throw new Error("Could not find workbook");a.workbooks.push(c),i=!0}a.workbooks[0].slice(-3)=="bin"&&(i=!0);var f={},d={};if(!t.bookSheets&&!t.bookProps){if(Ad=[],a.sst)try{Ad=Wde(Tn(e,Ci(a.sst)),a.sst,t)}catch(be){if(t.WTF)throw be}t.cellStyles&&a.themes.length&&(f=qde(hi(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(d=Hde(Tn(e,Ci(a.style)),a.style,f,t))}a.links.map(function(be){try{var ve=Td(hi(e,r0(Ci(be))),be);return Kde(Tn(e,Ci(be)),ve,be,t)}catch{}});var m=Lde(Tn(e,Ci(a.workbooks[0])),a.workbooks[0],t),p={},v="";a.coreprops.length&&(v=Tn(e,Ci(a.coreprops[0]),!0),v&&(p=i6(v)),a.extprops.length!==0&&(v=Tn(e,Ci(a.extprops[0]),!0),v&&jae(v,p,t)));var x={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(v=hi(e,Ci(a.custprops[0]),!0),v&&(x=Cae(v,t)));var y={};if((t.bookSheets||t.bookProps)&&(m.Sheets?l=m.Sheets.map(function(ve){return ve.name}):p.Worksheets&&p.SheetNames.length>0&&(l=p.SheetNames),t.bookProps&&(y.Props=p,y.Custprops=x),t.bookSheets&&typeof l<"u"&&(y.SheetNames=l),t.bookSheets?y.SheetNames:t.bookProps))return y;l={};var b={};t.bookDeps&&a.calcchain&&(b=Gde(Tn(e,Ci(a.calcchain)),a.calcchain));var _=0,E={},A,T;{var k=m.Sheets;p.Worksheets=k.length,p.SheetNames=[];for(var I=0;I!=k.length;++I)p.SheetNames[I]=k[I].name}var O=i?"bin":"xml",j=a.workbooks[0].lastIndexOf("/"),B=(a.workbooks[0].slice(0,j+1)+"_rels/"+a.workbooks[0].slice(j+1)+".rels").replace(/^\//,"");Fi(e,B)||(B="xl/_rels/workbook."+O+".rels");var U=Td(hi(e,B,!0),B.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=Xde(Tn(e,Ci(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Ooe(Tn(e,Ci(a.people[0])),t)),U&&(U=ghe(U,m.Sheets));var Y=Tn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=p.Worksheets;++_){var te="sheet";if(U&&U[_]?(A="xl/"+U[_][1].replace(/[\/]?xl\//,""),Fi(e,A)||(A=U[_][1]),Fi(e,A)||(A=B.replace(/_rels\/.*$/,"")+U[_][1]),te=U[_][2]):(A="xl/worksheets/sheet"+(_+1-Y)+"."+O,A=A.replace(/sheet0\./,"sheet.")),T=A.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(p.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var V=!1,ge=0;ge!=t.sheets.length;++ge)typeof t.sheets[ge]=="number"&&t.sheets[ge]==_&&(V=1),typeof t.sheets[ge]=="string"&&t.sheets[ge].toLowerCase()==p.SheetNames[_].toLowerCase()&&(V=1);if(!V)continue e}}vhe(e,A,T,p.SheetNames[_],_,E,l,te,t,m,f,d)}return y={Directory:a,Workbook:m,Props:p,Custprops:x,Deps:b,Sheets:l,SheetNames:p.SheetNames,Strings:Ad,Styles:d,Themes:f,SSF:Xr(Dt)},t&&t.bookFiles&&(e.files?(y.keys=n,y.files=e.files):(y.keys=[],y.files={},e.FullPaths.forEach(function(be,ve){be=be.replace(/^Root Entry[\/]/,""),y.keys.push(be),y.files[be]=e.FileIndex[ve]}))),t&&t.bookVBA&&(a.vba.length>0?y.vbaraw=Tn(e,Ci(a.vba[0]),!0):a.defaults&&a.defaults.bin===Loe&&(y.vbaraw=Tn(e,"xl/vbaProject.bin",!0))),y}function yhe(e,t){var r=t||{},n="Workbook",a=kt.find(e,n);try{if(n="/!DataSpaces/Version",a=kt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Xse(a.content),n="/!DataSpaces/DataSpaceMap",a=kt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Qse(a.content);if(i.length!==1||i[0].comps.length!==1||i[0].comps[0].t!==0||i[0].name!=="StrongEncryptionDataSpace"||i[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=kt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=Jse(a.content);if(l.length!=1||l[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=kt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);ele(a.content)}catch{}if(n="/EncryptionInfo",a=kt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=tle(a.content);if(n="/EncryptedPackage",a=kt.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],a.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function bhe(e,t){return t.bookType=="ods"?g8(e,t):t.bookType=="numbers"?mhe(e,t):t.bookType=="xlsb"?whe(e,t):_he(e,t)}function whe(e,t){Iu=1024,e&&!e.SSF&&(e.SSF=Xr(Dt)),e&&e.SSF&&(hf(),Qg(e.SSF),t.revssf=Zg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=q6.indexOf(t.bookType)>-1,a=bS();MS(t=t||{});var i=sS(),l="",c=0;if(t.cellXfs=[],_o(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",zt(i,l,s6(e.Props,t)),a.coreprops.push(l),_r(t.rels,2,l,Gt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}for(e.Props.Worksheets=e.Props.SheetNames.length,zt(i,l,c6(e.Props)),a.extprops.push(l),_r(t.rels,3,l,Gt.EXT_PROPS),e.Custprops!==e.Props&&hn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",zt(i,l,u6(e.Custprops)),a.custprops.push(l),_r(t.rels,4,l,Gt.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var m={"!id":{}},p=e.Sheets[e.SheetNames[c-1]],v=(p||{})["!type"]||"sheet";switch(v){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,zt(i,l,Qde(c-1,l,t,e,m)),a.sheets.push(l),_r(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Gt.WS[0])}if(p){var x=p["!comments"],y=!1,b="";x&&x.length>0&&(b="xl/comments"+c+"."+r,zt(i,b,e0e(x,b)),a.comments.push(b),_r(m,-1,"../comments"+c+"."+r,Gt.CMNT),y=!0),p["!legacy"]&&y&&zt(i,"xl/drawings/vmlDrawing"+c+".vml",z6(c,p["!comments"])),delete p["!comments"],delete p["!legacy"]}m["!id"].rId1&&zt(i,r0(l),Lu(m))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,zt(i,l,Zde(t.Strings,l,t)),a.strs.push(l),_r(t.wbrels,-1,"sharedStrings."+r,Gt.SST)),l="xl/workbook."+r,zt(i,l,Yde(e,l)),a.workbooks.push(l),_r(t.rels,1,l,Gt.WB),l="xl/theme/theme1.xml",zt(i,l,kS(e.Themes,t)),a.themes.push(l),_r(t.wbrels,-1,"theme/theme1.xml",Gt.THEME),l="xl/styles."+r,zt(i,l,Jde(e,l,t)),a.styles.push(l),_r(t.wbrels,-1,"styles."+r,Gt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",zt(i,l,e.vbaraw),a.vba.push(l),_r(t.wbrels,-1,"vbaProject.bin",Gt.VBA)),l="xl/metadata."+r,zt(i,l,t0e(l)),a.metadata.push(l),_r(t.wbrels,-1,"metadata."+r,Gt.XLMETA),zt(i,"[Content_Types].xml",n6(a,t)),zt(i,"_rels/.rels",Lu(t.rels)),zt(i,"xl/_rels/workbook."+r+".rels",Lu(t.wbrels)),delete t.revssf,delete t.ssf,i}function _he(e,t){Iu=1024,e&&!e.SSF&&(e.SSF=Xr(Dt)),e&&e.SSF&&(hf(),Qg(e.SSF),t.revssf=Zg(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,jd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=q6.indexOf(t.bookType)>-1,a=bS();MS(t=t||{});var i=sS(),l="",c=0;if(t.cellXfs=[],_o(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),l="docProps/core.xml",zt(i,l,s6(e.Props,t)),a.coreprops.push(l),_r(t.rels,2,l,Gt.CORE_PROPS),l="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var f=[],d=0;d<e.SheetNames.length;++d)(e.Workbook.Sheets[d]||{}).Hidden!=2&&f.push(e.SheetNames[d]);e.Props.SheetNames=f}e.Props.Worksheets=e.Props.SheetNames.length,zt(i,l,c6(e.Props)),a.extprops.push(l),_r(t.rels,3,l,Gt.EXT_PROPS),e.Custprops!==e.Props&&hn(e.Custprops||{}).length>0&&(l="docProps/custom.xml",zt(i,l,u6(e.Custprops)),a.custprops.push(l),_r(t.rels,4,l,Gt.CUST_PROPS));var m=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var p={"!id":{}},v=e.Sheets[e.SheetNames[c-1]],x=(v||{})["!type"]||"sheet";switch(x){case"chart":default:l="xl/worksheets/sheet"+c+"."+r,zt(i,l,t8(c-1,t,e,p)),a.sheets.push(l),_r(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Gt.WS[0])}if(v){var y=v["!comments"],b=!1,_="";if(y&&y.length>0){var E=!1;y.forEach(function(A){A[1].forEach(function(T){T.T==!0&&(E=!0)})}),E&&(_="xl/threadedComments/threadedComment"+c+"."+r,zt(i,_,joe(y,m,t)),a.threadedcomments.push(_),_r(p,-1,"../threadedComments/threadedComment"+c+"."+r,Gt.TCMNT)),_="xl/comments"+c+"."+r,zt(i,_,H6(y)),a.comments.push(_),_r(p,-1,"../comments"+c+"."+r,Gt.CMNT),b=!0}v["!legacy"]&&b&&zt(i,"xl/drawings/vmlDrawing"+c+".vml",z6(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&zt(i,r0(l),Lu(p))}return t.Strings!=null&&t.Strings.length>0&&(l="xl/sharedStrings."+r,zt(i,l,O6(t.Strings,t)),a.strs.push(l),_r(t.wbrels,-1,"sharedStrings."+r,Gt.SST)),l="xl/workbook."+r,zt(i,l,s8(e)),a.workbooks.push(l),_r(t.rels,1,l,Gt.WB),l="xl/theme/theme1.xml",zt(i,l,kS(e.Themes,t)),a.themes.push(l),_r(t.wbrels,-1,"theme/theme1.xml",Gt.THEME),l="xl/styles."+r,zt(i,l,L6(e,t)),a.styles.push(l),_r(t.wbrels,-1,"styles."+r,Gt.STY),e.vbaraw&&n&&(l="xl/vbaProject.bin",zt(i,l,e.vbaraw),a.vba.push(l),_r(t.wbrels,-1,"vbaProject.bin",Gt.VBA)),l="xl/metadata."+r,zt(i,l,$6()),a.metadata.push(l),_r(t.wbrels,-1,"metadata."+r,Gt.XLMETA),m.length>1&&(l="xl/persons/person.xml",zt(i,l,Coe(m)),a.people.push(l),_r(t.wbrels,-1,"persons/person.xml",Gt.PEOPLE)),zt(i,"[Content_Types].xml",n6(a,t)),zt(i,"_rels/.rels",Lu(t.rels)),zt(i,"xl/_rels/workbook."+r+".rels",Lu(t.wbrels)),delete t.revssf,delete t.ssf,i}function RS(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=bi(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function She(e,t){return kt.find(e,"EncryptedPackage")?yhe(e,t):u8(e,t)}function Ehe(e,t){var r,n=e,a=t||{};return a.type||(a.type=qt&&Buffer.isBuffer(e)?"buffer":"base64"),r=D5(n,a),xhe(r,a)}function x8(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return $w(e.slice(r),t);default:break e}return Qu.to_workbook(e,t)}function Nhe(e,t){var r="",n=RS(e,t);switch(t.type){case"base64":r=bi(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=wc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ir(r)),t.type="binary",x8(r,t)}function khe(e,t){var r=e;return t.type=="base64"&&(r=bi(r)),r=Yd.utils.decode(1200,r.slice(2),"str"),t.type="binary",x8(r,t)}function The(e){return e.match(/[^\x00-\x7F]/)?Ns(e):e}function pb(e,t,r,n){return n?(r.type="string",Qu.to_workbook(e,r)):Qu.to_workbook(t,r)}function is(e,t){tS();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return is(new Uint8Array(e),(r=Xr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],i=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),Uu={},r.dateNF&&(Uu.dateNF=r.dateNF),r.type||(r.type=qt&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=qt?"buffer":"binary",n=wne(e),typeof Uint8Array<"u"&&!qt&&(r.type="array")),r.type=="string"&&(i=!0,r.type="binary",r.codepage=65001,n=The(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var l=new ArrayBuffer(3),c=new Uint8Array(l);if(c.foo="bar",!c.foo)return r=Xr(r),r.type="array",is(rS(n),r)}switch((a=RS(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return She(kt.read(n,r),r);break;case 9:if(a[1]<=8)return u8(n,r);break;case 60:return $w(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Dse(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return A6.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Ehe(n,r):pb(e,n,r,i);case 239:return a[3]===60?$w(n,r):pb(e,n,r,i);case 255:if(a[1]===254)return khe(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return cc.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return cc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Uw.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return M6.to_workbook(n,r);break;case 10:case 13:case 32:return Nhe(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return Cse.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Uw.to_workbook(n,r):pb(e,n,r,i)}function y8(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return B0(t.file,kt.write(e,{type:qt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return kt.write(e,t)}function Ahe(e,t){var r=Xr(t||{}),n=bhe(e,r);return jhe(n,r)}function jhe(e,t){var r={},n=qt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?kt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Yg(a))}return t.password&&typeof encrypt_agile<"u"?y8(encrypt_agile(a,t.password),t):t.type==="file"?B0(t.file,a):t.type=="string"?Ir(a):a}function Ohe(e,t){var r=t||{},n=T0e(e,r);return y8(n,r)}function _s(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Qd(Ns(n));case"binary":return Ns(n);case"string":return e;case"file":return B0(t.file,n,"utf8");case"buffer":return qt?Sl(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):_s(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Che(e,t){switch(t.type){case"base64":return Qd(e);case"binary":return e;case"string":return e;case"file":return B0(t.file,e,"binary");case"buffer":return qt?Sl(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Dm(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Qd(r):t.type=="string"?Ir(r):r;case"file":return B0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function FS(e,t){tS(),Sde(e);var r=Xr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=FS(e,r);return r.type="array",Yg(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return _s(b0e(e,r),r);case"slk":case"sylk":return _s(T6.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return _s(d8(e.Sheets[e.SheetNames[a]],r),r);case"txt":return Che(b8(e.Sheets[e.SheetNames[a]],r),r);case"csv":return _s(LS(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return _s(A6.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return Dm(Uw.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return _s(Qu.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return _s(M6.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return _s(j6.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return _s(g8(e,r),r);case"wk1":return Dm(cc.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return Dm(cc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Dm(f8(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Ohe(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return Ahe(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Dhe(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function mi(e,t,r){var n={};return n.type="file",n.file=t,Dhe(n),FS(e,n)}function Ihe(e,t,r,n,a,i,l,c){var f=yn(r),d=c.defval,m=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),p=!0,v=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!l||e[r])for(var x=t.s.c;x<=t.e.c;++x){var y=l?e[r][x]:e[n[x]+f];if(y===void 0||y.t===void 0){if(d===void 0)continue;i[x]!=null&&(v[i[x]]=d);continue}var b=y.v;switch(y.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+y.t)}if(i[x]!=null){if(b==null)if(y.t=="e"&&b===null)v[i[x]]=null;else if(d!==void 0)v[i[x]]=d;else if(m&&b===null)v[i[x]]=null;else continue;else v[i[x]]=m&&(y.t!=="n"||y.t==="n"&&c.rawNumbers!==!1)?b:pl(y,b,c);b!=null&&(p=!1)}}return{row:v,isempty:p}}function Jp(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],l=0,c="",f={s:{r:0,c:0},e:{r:0,c:0}},d=t||{},m=d.range!=null?d.range:e["!ref"];switch(d.header===1?n=1:d.header==="A"?n=2:Array.isArray(d.header)?n=3:d.header==null&&(n=0),typeof m){case"string":f=sr(m);break;case"number":f=sr(e["!ref"]),f.s.r=m;break;default:f=m}n>0&&(a=0);var p=yn(f.s.r),v=[],x=[],y=0,b=0,_=Array.isArray(e),E=f.s.r,A=0,T={};_&&!e[E]&&(e[E]=[]);var k=d.skipHidden&&e["!cols"]||[],I=d.skipHidden&&e["!rows"]||[];for(A=f.s.c;A<=f.e.c;++A)if(!(k[A]||{}).hidden)switch(v[A]=tn(A),r=_?e[E][A]:e[v[A]+p],n){case 1:i[A]=A-f.s.c;break;case 2:i[A]=v[A];break;case 3:i[A]=d.header[A-f.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=l=pl(r,null,d),b=T[l]||0,!b)T[l]=1;else{do c=l+"_"+b++;while(T[c]);T[l]=b,T[c]=1}i[A]=c}for(E=f.s.r+a;E<=f.e.r;++E)if(!(I[E]||{}).hidden){var O=Ihe(e,f,E,v,n,i,_,d);(O.isempty===!1||(n===1?d.blankrows!==!1:d.blankrows))&&(x[y++]=O.row)}return x.length=y,x}var V3=/"/g;function Phe(e,t,r,n,a,i,l,c){for(var f=!0,d=[],m="",p=yn(r),v=t.s.c;v<=t.e.c;++v)if(n[v]){var x=c.dense?(e[r]||[])[v]:e[n[v]+p];if(x==null)m="";else if(x.v!=null){f=!1,m=""+(c.rawNumbers&&x.t=="n"?x.v:pl(x,null,c));for(var y=0,b=0;y!==m.length;++y)if((b=m.charCodeAt(y))===a||b===i||b===34||c.forceQuotes){m='"'+m.replace(V3,'""')+'"';break}m=="ID"&&(m='"ID"')}else x.f!=null&&!x.F?(f=!1,m="="+x.f,m.indexOf(",")>=0&&(m='"'+m.replace(V3,'""')+'"')):m="";d.push(m)}return c.blankrows===!1&&f?null:d.join(l)}function LS(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=sr(e["!ref"]),i=n.FS!==void 0?n.FS:",",l=i.charCodeAt(0),c=n.RS!==void 0?n.RS:`
`,f=c.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),m="",p=[];n.dense=Array.isArray(e);for(var v=n.skipHidden&&e["!cols"]||[],x=n.skipHidden&&e["!rows"]||[],y=a.s.c;y<=a.e.c;++y)(v[y]||{}).hidden||(p[y]=tn(y));for(var b=0,_=a.s.r;_<=a.e.r;++_)(x[_]||{}).hidden||(m=Phe(e,a,_,p,l,f,i,n),m!=null&&(n.strip&&(m=m.replace(d,"")),(m||n.blankrows!==!1)&&r.push((b++?c:"")+m)));return delete n.dense,r.join("")}function b8(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=LS(e,t);return r}function Mhe(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=sr(e["!ref"]),i="",l=[],c,f=[],d=Array.isArray(e);for(c=a.s.c;c<=a.e.c;++c)l[c]=tn(c);for(var m=a.s.r;m<=a.e.r;++m)for(i=yn(m),c=a.s.c;c<=a.e.c;++c)if(t=l[c]+i,r=d?(e[m]||[])[c]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}f[f.length]=t+"="+n}return f}function w8(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},l=0,c=0;if(i&&n.origin!=null)if(typeof n.origin=="number")l=n.origin;else{var f=typeof n.origin=="string"?rn(n.origin):n.origin;l=f.r,c=f.c}var d,m={s:{c:0,r:0},e:{c,r:l+t.length-1+a}};if(i["!ref"]){var p=sr(i["!ref"]);m.e.c=Math.max(m.e.c,p.e.c),m.e.r=Math.max(m.e.r,p.e.r),l==-1&&(l=p.e.r+1,m.e.r=l+t.length-1+a)}else l==-1&&(l=0,m.e.r=t.length-1+a);var v=n.header||[],x=0;t.forEach(function(b,_){hn(b).forEach(function(E){(x=v.indexOf(E))==-1&&(v[x=v.length]=E);var A=b[E],T="z",k="",I=It({c:c+x,r:l+_+a});d=c0(i,I),A&&typeof A=="object"&&!(A instanceof Date)?i[I]=A:(typeof A=="number"?T="n":typeof A=="boolean"?T="b":typeof A=="string"?T="s":A instanceof Date?(T="d",n.cellDates||(T="n",A=Fn(A)),k=n.dateNF||Dt[14]):A===null&&n.nullError&&(T="e",A=0),d?(d.t=T,d.v=A,delete d.w,delete d.R,k&&(d.z=k)):i[I]=d={t:T,v:A},k&&(d.z=k))})}),m.e.c=Math.max(m.e.c,c+v.length-1);var y=yn(l);if(a)for(x=0;x<v.length;++x)i[tn(x+c)+y]={t:"s",v:v[x]};return i["!ref"]=Ut(m),i}function Rhe(e,t){return w8(null,e,t)}function c0(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=rn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?c0(e,It(t)):c0(e,It({r:t,c:r||0}))}function Fhe(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function BS(){return{SheetNames:[],Sheets:{}}}function US(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var l=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=l+a)!=-1;++a);}if(i8(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Lhe(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Fhe(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Bhe(e,t){return e.z=t,e}function _8(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Uhe(e,t,r){return _8(e,"#"+t,r)}function $he(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function zhe(e,t,r,n){for(var a=typeof t!="string"?t:sr(t),i=typeof t=="string"?t:Ut(t),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var f=c0(e,l,c);f.t="n",f.F=i,delete f.v,l==a.s.r&&c==a.s.c&&(f.f=r,n&&(f.D=!0))}return e}var jt={encode_col:tn,encode_row:yn,encode_cell:It,encode_range:Ut,decode_col:mS,decode_row:hS,split_cell:Zne,decode_cell:rn,decode_range:Ya,format_cell:pl,sheet_add_aoa:Y5,sheet_add_json:w8,sheet_add_dom:h8,aoa_to_sheet:mf,json_to_sheet:Rhe,table_to_sheet:m8,table_to_book:X0e,sheet_to_csv:LS,sheet_to_txt:b8,sheet_to_json:Jp,sheet_to_html:d8,sheet_to_formulae:Mhe,sheet_to_row_object_array:Jp,sheet_get_cell:c0,book_new:BS,book_append_sheet:US,book_set_sheet_visibility:Lhe,cell_set_number_format:Bhe,cell_set_hyperlink:_8,cell_set_internal_link:Uhe,cell_add_comment:$he,sheet_set_array_formula:zhe,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const Hhe=({onAddIssue:e,items:t,machines:r,locations:n,sectors:a,divisions:i,maintenancePlans:l,currentUser:c,bomRecords:f=[]})=>{const[d,m]=N.useState("single"),[p,v]=N.useState(""),[x,y]=N.useState(""),[b,_]=N.useState(""),[E,A]=N.useState(""),[T,k]=N.useState(""),[I,O]=N.useState(""),[j,B]=N.useState(!1),[U,Y]=N.useState(""),[te,V]=N.useState(""),[ge,be]=N.useState(""),[ve,z]=N.useState(""),[ue,se]=N.useState(""),[Q,re]=N.useState(""),[G,P]=N.useState(""),[W,F]=N.useState(""),[M,le]=N.useState(""),[pe,Ae]=N.useState(""),[oe,ae]=N.useState([]),[ze,q]=N.useState(!1),[Je,qe]=N.useState(null),[ot,Ke]=N.useState(""),[He,wt]=N.useState(!1),[mt,Ge]=N.useState(""),ut=N.useRef(null),ct=N.useRef(null),dt=N.useRef(null),at=N.useRef(null),Wt=N.useRef(!1),Oe=N.useRef(!1);N.useEffect(()=>{const C=localStorage.getItem("wf_issue_prefill");if(C){try{const J=JSON.parse(C);let xe=J.sectorId;if(!xe&&J.divisionId){const Ee=i.find(Ce=>Ce.id===J.divisionId);Ee&&(xe=Ee.sectorId)}if(J.locationId&&v(J.locationId),xe&&(Wt.current=!0,y(xe)),J.divisionId&&(Oe.current=!0,_(J.divisionId)),J.machineId){const Ee=r.find(Ce=>Ce.id===J.machineId);Ee&&(Y(Ee.category||""),V(Ee.brand||""),be(Ee.modelNo||""),z(Ee.machineLocalNo||""),se(Ee.chaseNo||""),A(J.machineId))}J.maintenancePlanId&&O(J.maintenancePlanId)}catch(J){console.error("Prefill error",J)}localStorage.removeItem("wf_issue_prefill")}},[i,r]);const st=N.useMemo(()=>t.find(C=>C.id===W),[t,W]),Fe=C=>{if(!C)return{local:0,other:0};const J=C.stockQuantity||0;if(C.quantitiesByLocation){const xe=C.quantitiesByLocation[p]||0;return{local:xe,other:J-xe}}return p==="WH-001"?{local:J,other:0}:{local:0,other:J}},nr=N.useMemo(()=>Fe(st),[st,p]);N.useEffect(()=>{le(st?st.fullName||st.name:"")},[W,st]),N.useEffect(()=>{if(Wt.current){Wt.current=!1;return}_(""),St()},[x]),N.useEffect(()=>{if(Oe.current){Oe.current=!1;return}},[b]);const St=()=>{Y(""),V(""),be(""),z(""),se(""),A(""),k("")};N.useEffect(()=>{const C=n.find(J=>J.id===p);if(C){const J=C.email||"";P(J),re(J)}else P(""),re("")},[p,n]);const Zt=()=>{if(!W||!pe||Number(pe)<=0)return;if(d==="multi"&&!T){alert("Please select a Machine for this item.");return}if(nr.local<Number(pe)&&!confirm(`Warning: Requested Quantity (${pe}) exceeds Local Stock (${nr.local}) for ${p}. 

Other locations have: ${nr.other}.

Continue?`))return;let C,J;if(d==="multi"){const Ee=r.find(Ce=>Ce.id===T);C=T,J=Ee?Ee.category?Ee.category:`Machine ${Ee.id}`:"Unknown"}const xe={itemId:W,itemName:M,unit:(st==null?void 0:st.unit)||"pcs",quantity:Number(pe),locationStock:nr.local,otherStock:nr.other,machineId:C,machineName:J};ae([...oe,xe]),F(""),le(""),Ae(""),d==="multi"&&k(""),setTimeout(()=>{var Ee;return(Ee=ut.current)==null?void 0:Ee.focus()},50)},mr=C=>{F(C.itemId),Ae(C.quantity),setTimeout(()=>{var J;return(J=ct.current)==null?void 0:J.focus()},100)},er=C=>{const J=[...oe];J.splice(C,1),ae(J)},ar=()=>{const C=jt.book_new(),J=jt.aoa_to_sheet([["Item Code","Quantity"],["ITM-001","5"],["ITM-002","10"]]);jt.book_append_sheet(C,J,"Template"),mi(C,"Item_Upload_Template.xlsx")},Yr=()=>{var C;(C=at.current)==null||C.click()},Tr=C=>{var Ee;const J=(Ee=C.target.files)==null?void 0:Ee[0];if(!J)return;const xe=new FileReader;xe.onload=Ce=>{var Qe;const Se=(Qe=Ce.target)==null?void 0:Qe.result;try{const Xe=is(Se,{type:"binary"}),Ye=Xe.SheetNames[0],pt=Xe.Sheets[Ye],Et=jt.sheet_to_json(pt,{header:1});if(Et.length<2){alert("File appears empty or missing headers.");return}const nt=Et[0].map(Ht=>String(Ht).toLowerCase().trim()),yt=nt.findIndex(Ht=>Ht.includes("code")||Ht.includes("item")||Ht.includes("part")),Rt=nt.findIndex(Ht=>Ht.includes("qty")||Ht.includes("quantity")||Ht.includes("count"));if(yt===-1||Rt===-1){alert("Could not find 'Item Code' or 'Quantity' columns in the first row.");return}const Vt=[];let Kt=0;for(let Ht=1;Ht<Et.length;Ht++){const Lt=Et[Ht];if(!Lt||Lt.length===0)continue;const Pr=Lt[yt],Fr=Lt[Rt];if(Pr&&Fr){const va=String(Pr).trim(),ie=Number(Fr),ce=t.find(rt=>rt.id===va);if(ce){const rt=Fe(ce);Vt.push({itemId:ce.id,itemName:ce.fullName||ce.name,unit:ce.unit||"pcs",quantity:ie,locationStock:rt.local,otherStock:rt.other,machineId:d==="multi"?E||"":void 0})}else Kt++}}if(Vt.length>0){ae(Lt=>[...Lt,...Vt]);let Ht=`Successfully added ${Vt.length} items from Excel.`;Kt>0&&(Ht+=`

 ${Kt} items were skipped because the Item Code was not found in Master Data.`),alert(Ht)}else alert("No valid items found in the file. Please check Item Codes against Master Data.")}catch(Xe){console.error(Xe),alert("Failed to parse Excel file.")}},xe.readAsBinaryString(J),C.target.value=""},Ba=async C=>{C.preventDefault(),Ge("");try{if(!p){alert("Please select a 'Warehouse Location'.");return}if(d==="single"&&!E){alert("Please select a 'Machine'.");return}if(oe.length===0){alert("Please add at least one item.");return}if(!I){alert("Please select a 'Maintenance Plan'.");return}if(!Q){alert("Please provide a Warehouse Email.");return}q(!0),Ke("Processing Request...");const J=a.find(nt=>nt.id===x),xe=i.find(nt=>nt.id===b),Ee=l.find(nt=>nt.id===I),Ce=new Date().toISOString(),Se=Date.now().toString().slice(-6),Qe=[];let Xe="Unknown Machine";if(d==="single"){const nt=r.find(yt=>yt.id===E);Xe=nt?nt.category?nt.category:`Machine ${nt.id}`:"Unknown"}for(let nt=0;nt<oe.length;nt++){const yt=oe[nt],Rt=t.find(Fr=>Fr.id===yt.itemId),Kt=((Rt==null?void 0:Rt.cost)||0)*Number(yt.quantity),Ht=Kt>1e5;let Lt="",Pr="";d==="single"?(Lt=E,Pr=Xe):(Lt=yt.machineId||"Unknown",Pr=yt.machineName||"Unknown Machine"),Qe.push({id:`REQ-${Se}-${nt+1}`,timestamp:Ce,locationId:p,itemId:yt.itemId,itemName:yt.itemName,quantity:yt.quantity,unit:yt.unit,machineId:Lt,machineName:Pr,sectorName:J?J.name:"",divisionName:xe?xe.name:"",maintenancePlan:Ee?Ee.name:"",maintenancePlanId:Ee?Ee.id:"",status:Ht?"Pending Manager Approval":"Pending",approvalStatus:Ht?"Pending":"Approved",calculatedTotalCost:Kt,warehouseEmail:Q,requesterEmail:G})}await new Promise(nt=>setTimeout(nt,800));const Ye=encodeURIComponent(`New Issue Request: ${Qe[0].id} - ${p}`),pt=encodeURIComponent(`Hello,

A new issue request has been submitted.

Request ID: ${Qe[0].id}
Location: ${p}
Total Items: ${Qe.length}

Please check the dashboard for details.

Sent from Daltex Maintenance.`);window.location.href=`mailto:${Q}?subject=${Ye}&body=${pt}`;const Et=localStorage.getItem("wf_script_url_v3")||oo;Et&&Promise.all(Qe.map(nt=>Bre(Et,nt))).catch(console.error),Qe.forEach(nt=>e(nt)),qe(Qe),Ke(`Opened email to: ${Q}`),St(),ae([]),O("")}catch(J){console.error("Submission Error:",J),alert("An unexpected error occurred.")}finally{q(!1)}},ga=()=>window.print(),$n=()=>{if(!Je||Je.length===0)return null;const C=["Request ID","Date","Location","Sector","Division","Machine","Maint. Plan","Item Number","Item Name","Unit","Quantity","Warehouse Email","Site Email"],J=Je.map(Ce=>[Ce.id,new Date(Ce.timestamp).toLocaleString(),Ce.locationId,Ce.sectorName||"",Ce.divisionName||"",Ce.machineName,Ce.maintenancePlan||"",Ce.itemId,Ce.itemName,Ce.unit||"pcs",Ce.quantity,Ce.warehouseEmail||"",Ce.requesterEmail||""]),xe=jt.book_new(),Ee=jt.aoa_to_sheet([C,...J]);return jt.book_append_sheet(xe,Ee,"RequestSlip"),xe},$r=()=>{const C=$n();!C||!Je||mi(C,`Request_Slip_${Je[0].id.split("-")[1]}.xlsx`)},ra=async()=>{const C=localStorage.getItem("wf_script_url_v3")||oo;if(Je){wt(!0);try{const J=$n();if(!J)throw new Error("No data");const xe=FS(J,{bookType:"xlsx",type:"base64"}),Ee=await $re(C,`Request_Slip_${Je[0].id.split("-")[1]}.xlsx`,xe);Ge(Ee||"saved"),Ee||alert("Saved to Drive folder.")}catch{alert("Failed to upload.")}finally{wt(!1)}}},zn=N.useMemo(()=>{if(!p)return a;const C=n.find(Ce=>Ce.id===p),J=C==null?void 0:C.name,xe=r.filter(Ce=>{const Se=String(Ce.locationId||""),Qe=String(p);return Se===Qe||Se===J}),Ee=new Set;return xe.forEach(Ce=>{if(Ce.sectorId&&Ee.add(Ce.sectorId),Ce.divisionId){const Se=i.find(Qe=>Qe.id===Ce.divisionId||Qe.name===Ce.divisionId);Se&&Ee.add(Se.sectorId)}}),a.filter(Ce=>Ee.has(Ce.id)||Ee.has(Ce.name))},[p,r,a,i,n]),pr=N.useMemo(()=>r.filter(C=>{if(p){const J=n.find(Ee=>Ee.id===p),xe=String(C.locationId||"");if(xe!==p&&xe!==(J==null?void 0:J.name))return!1}if(x){const J=a.find(Se=>Se.id===x),xe=J==null?void 0:J.name,Ee=C.sectorId===x||xe&&C.sectorId===xe;let Ce=!1;if(C.divisionId){const Se=i.find(Qe=>Qe.id===C.divisionId||Qe.name===C.divisionId);Se&&(Ce=Se.sectorId===x||xe&&Se.sectorId===xe)}if(!Ee&&!Ce)return!1}return!0}),[r,p,x,n,a,i]),Hn=N.useMemo(()=>{const C=new Set;return pr.forEach(J=>{J.category&&C.add(J.category)}),Array.from(C).sort().map(J=>({id:J,label:J}))},[pr]),lr=N.useMemo(()=>U?pr.filter(C=>C.category===U):pr,[pr,U]),wn=N.useMemo(()=>{const C=new Set;return lr.forEach(J=>{J.brand&&C.add(J.brand)}),Array.from(C).sort().map(J=>({id:J,label:J}))},[lr]),zr=N.useMemo(()=>te?lr.filter(C=>C.brand===te):lr,[lr,te]),na=N.useMemo(()=>{const C=new Set;return zr.forEach(J=>{J.modelNo&&C.add(J.modelNo)}),Array.from(C).sort().map(J=>({id:J,label:J}))},[zr]),gr=N.useMemo(()=>ge?zr.filter(C=>C.modelNo===ge):zr,[zr,ge]),Oa=N.useMemo(()=>{const C=new Set;return gr.forEach(J=>{J.machineLocalNo&&C.add(J.machineLocalNo)}),Array.from(C).sort((J,xe)=>J.localeCompare(xe,void 0,{numeric:!0})).map(J=>({id:J,label:J}))},[gr]),pn=N.useMemo(()=>ve?gr.filter(C=>C.machineLocalNo===ve):gr,[gr,ve]),Ue=N.useMemo(()=>{const C=new Set;return pn.forEach(J=>{J.chaseNo&&C.add(J.chaseNo)}),Array.from(C).sort().map(J=>({id:J,label:J}))},[pn]),Le=N.useMemo(()=>ue?pn.filter(C=>C.chaseNo===ue):pn,[pn,ue]),it=N.useMemo(()=>Le.map(C=>({id:C.id,label:`${C.id} ${C.category?`- ${C.category}`:""}`,subLabel:`Local: ${C.machineLocalNo||"-"} | Chase: ${C.chaseNo||"-"}`})),[Le]),Tt=N.useMemo(()=>!U||!ge?[]:f.filter(C=>C.machineCategory===U&&C.modelNo===ge),[f,U,ge]),R=C=>{Y(C),V(""),be(""),z(""),se(""),A(""),k("")},ee=C=>{V(C),be(""),z(""),se(""),A(""),k("")},K=C=>{be(C),z(""),se(""),A(""),k("")},H=C=>{if(z(C),se(""),A(""),k(""),!C)return;const J=lr.filter(xe=>xe.machineLocalNo===C);if(J.length>0){const xe=J[0];V(xe.brand||""),be(xe.modelNo||""),J.length===1&&(d==="single"?A(xe.id):k(xe.id),se(xe.chaseNo))}},Z=C=>{if(se(C),A(""),k(""),!C)return;const J=lr.filter(xe=>xe.chaseNo===C);if(J.length>0){const xe=J[0];V(xe.brand||""),be(xe.modelNo||""),z(xe.machineLocalNo||""),J.length===1&&(d==="single"?A(xe.id):k(xe.id))}},ne=C=>{d==="single"?A(C):k(C);const J=r.find(xe=>xe.id===C);J&&(Y(J.category||""),V(J.brand||""),be(J.modelNo||""),z(J.machineLocalNo||""),se(J.chaseNo||""))},L=N.useMemo(()=>n.map(C=>({id:C.id,label:C.name})),[n]),he=N.useMemo(()=>zn.map(C=>({id:C.id,label:C.name})),[zn]),fe=N.useMemo(()=>i.filter(C=>!x||C.sectorId===x).map(C=>({id:C.id,label:C.name})),[i,x]),de=N.useMemo(()=>t.map(C=>{let J="";const xe=C.stockQuantity||0;if(C.quantitiesByLocation){const Ce=C.quantitiesByLocation[p]||0;J=`Loc: ${Ce} | Other: ${xe-Ce}`}else p==="WH-001"?J=`Loc: ${xe} | Other: 0`:J=`Loc: 0 | Other: ${xe}`;const Ee=[C.partNumber?`PN: ${C.partNumber}`:"",C.modelNo?`Model: ${C.modelNo}`:"",J].filter(Boolean).join(" | ");return{id:C.id,label:C.id,subLabel:Ee?`${C.name} | ${Ee}`:C.name}}),[t,p]),we=N.useMemo(()=>t.map(C=>({id:C.id,label:C.fullName||C.name,subLabel:C.id})),[t]),Pe=C=>{C.key==="Enter"&&(C.preventDefault(),setTimeout(()=>{var J;W&&((J=ct.current)==null||J.focus())},100))},Re=C=>{C.key==="Enter"&&(C.preventDefault(),Zt())},Ve=c.role==="admin"?n:n.filter(C=>{var J;return(J=c.allowedLocationIds)==null?void 0:J.includes(C.id)});return u.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[Je&&u.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-lg w-full overflow-hidden animate-fade-in-up",children:[u.jsxs("div",{className:"bg-blue-600 p-6 text-white text-center",children:[u.jsx("h2",{className:"text-2xl font-bold",children:"Request Sent!"}),u.jsxs("p",{className:"opacity-90 mt-1",children:["Notification sent to ",Je[0].warehouseEmail]})]}),u.jsxs("div",{className:"p-8 space-y-3",children:[u.jsxs("button",{onClick:ga,className:"w-full py-3 bg-gray-900 text-white rounded-xl hover:bg-black font-bold flex items-center justify-center gap-3 shadow-lg",children:[u.jsx("span",{children:""})," Print Request Slip"]}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("button",{onClick:$r,className:"py-3 bg-green-100 text-green-800 rounded-xl hover:bg-green-200 font-semibold flex items-center justify-center gap-2 transition border border-green-200",children:[u.jsx("span",{children:""})," Excel"]}),mt&&mt!=="saved"?u.jsxs("a",{href:mt,target:"_blank",rel:"noopener noreferrer",className:"py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-bold flex items-center justify-center gap-2 transition shadow-md",children:[u.jsx("span",{children:""})," Open File "]}):u.jsx("button",{onClick:ra,disabled:He,className:`py-3 rounded-xl font-semibold flex items-center justify-center gap-2 transition border ${He?"bg-gray-100 text-gray-500":"bg-yellow-100 text-yellow-800 hover:bg-yellow-200"}`,children:He?"Saving...":"Save to Drive"})]})]}),u.jsx("div",{className:"bg-gray-50 p-4 border-t border-gray-100 text-center",children:u.jsx("button",{onClick:()=>qe(null),className:"text-gray-500 hover:text-gray-800 font-medium px-6 py-2",children:"Start New Request"})})]})}),u.jsx(Mre,{batch:Je||[]}),u.jsxs("div",{className:"bg-white p-4 md:p-8 rounded-xl shadow-sm border border-gray-200",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsxs("h2",{className:"text-xl md:text-2xl font-bold text-gray-800 flex items-center",children:[u.jsx("span",{className:"mr-3 p-2 bg-blue-100 text-blue-600 rounded-lg text-lg md:text-xl",children:""}),"Create New Request"]}),u.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[u.jsx("button",{type:"button",onClick:()=>{m("single"),ae([])},className:`px-4 py-2 rounded-md text-sm font-bold transition-all ${d==="single"?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Single Machine"}),u.jsx("button",{type:"button",onClick:()=>{m("multi"),ae([]),A("")},className:`px-4 py-2 rounded-md text-sm font-bold transition-all ${d==="multi"?"bg-white text-purple-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Multi-Machine"})]})]}),u.jsxs("form",{onSubmit:Ba,className:"space-y-6 md:space-y-8",children:[u.jsxs("div",{className:"bg-blue-50 p-4 md:p-5 rounded-lg border border-blue-100",children:[u.jsx("div",{className:"mb-2",children:u.jsx(Sr,{label:"1. Select Warehouse Location",required:!0,options:L,value:p,onChange:v,placeholder:"Start typing to search zone...",disabled:Ve.length===0})}),Ve.length===0&&u.jsx("p",{className:"text-xs text-red-500",children:"Permission denied."})]}),p&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"bg-white p-4 md:p-5 rounded-lg border border-gray-200 animate-fade-in-up",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[u.jsxs("h3",{className:"text-sm font-bold text-gray-500 uppercase tracking-wider",children:["2. ",d==="single"?"Select Machine (Single)":"Context Filter (Multi-Machine)"]}),u.jsx("button",{type:"button",onClick:()=>B(!j),className:"text-xs text-blue-600 hover:underline font-semibold",children:j?"Hide Filters":"Show Advanced Filters"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx(Sr,{label:"Sector",options:he,value:x,onChange:y,placeholder:"Select Sector...",inputRef:dt}),u.jsx(Sr,{label:"Division",disabled:!x,options:fe,value:b,onChange:_,placeholder:"Select Division..."})]}),j&&u.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded border border-gray-100 animate-fade-in",children:[u.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3",children:"Technical Filter (Hierarchy)"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[u.jsx(Sr,{label:"Equipment Name (Category)",options:Hn,value:U,onChange:R,placeholder:"e.g. Tractor, Conveyor..."}),u.jsx(Sr,{label:"Brand Name",options:wn,value:te,onChange:ee,placeholder:"Select Brand...",disabled:!U})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[u.jsx(Sr,{label:"Model Name",options:na,value:ge,onChange:K,placeholder:"Select Model...",disabled:!U}),u.jsx(Sr,{label:"Local Number",options:Oa,value:ve,onChange:H,placeholder:"Select Local No...",disabled:!U})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:u.jsx(Sr,{label:"Chase No",options:Ue,value:ue,onChange:Z,placeholder:"Select Chase...",disabled:!U})})]}),d==="single"&&u.jsx("div",{className:"mt-4",children:u.jsx(Sr,{label:"Asset ID / Code (Final Machine)",required:!0,options:it,value:E,onChange:ne,placeholder:it.length===0?"Select Filters above...":"Select Asset ID"})}),d==="multi"&&u.jsxs("div",{className:"mt-4 p-2 bg-purple-50 border border-purple-100 rounded text-xs text-purple-700",children:[" ",u.jsx("strong",{children:"Multi-Machine Mode:"})," Select the specific machine for each item in the section below. Use Sector/Division filters above to narrow down the machine list."]})]}),u.jsxs("div",{className:"bg-gray-50 p-4 md:p-5 rounded-lg border border-gray-200 shadow-sm relative animate-fade-in-up",children:[u.jsx("h3",{className:"text-sm font-bold text-gray-700 uppercase tracking-wider mb-4 border-b pb-2",children:"3. Scan / Enter Items"}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsx("h4",{className:"text-xs font-bold text-blue-600 uppercase bg-blue-50 inline-block px-2 py-1 rounded",children:"Option A: Manual / Scanner"}),d==="multi"&&u.jsx("div",{className:"p-3 bg-purple-100 rounded border border-purple-200 mb-2",children:u.jsx(Sr,{label:"Select Machine for Item",required:!0,options:it,value:T,onChange:ne,placeholder:it.length===0?"Filter machines in Section 2...":"Select Asset ID",compact:!0})}),u.jsxs("div",{className:"space-y-3",children:[u.jsx(Sr,{label:"Item Number (Scan Here)",options:de,value:W,onChange:F,placeholder:"Scan Item No...",inputRef:ut,onKeyDown:Pe}),u.jsx(Sr,{label:"Item Name",options:we,value:W,onChange:F,placeholder:"Search by name..."}),u.jsxs("div",{className:"flex gap-3 items-end",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Qty"}),u.jsx("input",{ref:ct,type:"number",min:"1",value:pe,onChange:C=>Ae(Number(C.target.value)),onKeyDown:Re,className:"w-full px-3 py-2 border border-gray-300 rounded-lg outline-none font-bold text-center h-[42px]"})]}),u.jsxs("div",{className:"w-24",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Unit"}),u.jsx("input",{type:"text",disabled:!0,value:(st==null?void 0:st.unit)||"",className:"w-full px-2 py-2 border border-gray-200 bg-gray-100 rounded-lg text-center text-gray-500 text-sm h-[42px]"})]}),u.jsx("button",{type:"button",onClick:Zt,disabled:!W||!pe,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 disabled:bg-gray-300 transition shadow-sm h-[42px] font-bold",children:"Add"})]}),st&&u.jsxs("div",{className:"text-xs flex items-center gap-3 bg-white border px-2 py-2 rounded w-fit",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-gray-500 font-bold",children:"LOC STOCK:"}),u.jsx("span",{className:nr.local<=0?"text-red-600 font-bold":"text-green-600 font-bold",children:nr.local})]}),u.jsx("div",{className:"w-px h-4 bg-gray-300"}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("span",{className:"text-gray-500 font-bold",children:"OTHER STOCK:"}),u.jsx("span",{className:"text-blue-600 font-bold",children:nr.other})]})]})]})]}),u.jsxs("div",{className:"space-y-4 border-l lg:pl-8 border-gray-200",children:[u.jsx("h4",{className:"text-xs font-bold text-green-600 uppercase bg-green-50 inline-block px-2 py-1 rounded",children:"Option B: Bulk Upload (Excel)"}),u.jsxs("div",{className:"p-4 border-2 border-dashed border-gray-300 rounded-lg bg-white text-center hover:bg-gray-50 transition-colors",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Upload a list of items"}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsx("button",{type:"button",onClick:ar,className:"text-xs text-blue-600 hover:underline",children:"Download Template"}),u.jsxs("button",{type:"button",onClick:Yr,className:"px-4 py-2 bg-green-100 text-green-700 font-bold rounded hover:bg-green-200 border border-green-200 flex items-center justify-center gap-2",children:[u.jsx("span",{children:""})," Select File"]}),u.jsx("input",{type:"file",ref:at,hidden:!0,accept:".xlsx,.xls,.csv",onChange:Tr})]}),u.jsx("p",{className:"text-[10px] text-gray-400 mt-2",children:"Columns: Item Code, Quantity"})]})]})]}),u.jsxs("div",{className:"mt-6 border-t pt-4",children:[u.jsxs("h4",{className:"text-sm font-bold text-gray-700 mb-2",children:["Request Items List (",oe.length,")"]}),oe.length>0?u.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200 bg-white",children:u.jsxs("table",{className:"w-full text-sm text-left",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 font-semibold",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-2",children:"Item Number"}),u.jsx("th",{className:"px-4 py-2",children:"Item Name"}),u.jsx("th",{className:"px-4 py-2",children:"Unit"}),d==="multi"&&u.jsx("th",{className:"px-4 py-2 bg-purple-50 text-purple-900",children:"Assigned Machine"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Qty"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Loc. Stock"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Other Stock"}),u.jsx("th",{className:"px-4 py-2 text-center",children:"Action"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:oe.map((C,J)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-2 font-mono text-gray-600 font-bold",children:C.itemId}),u.jsx("td",{className:"px-4 py-2",children:C.itemName}),u.jsx("td",{className:"px-4 py-2 text-sm text-gray-500",children:C.unit}),d==="multi"&&u.jsx("td",{className:"px-4 py-2 text-sm font-medium text-purple-700 bg-purple-50/30",children:C.machineName||"Unknown"}),u.jsx("td",{className:"px-4 py-2 text-center font-bold text-lg",children:C.quantity}),u.jsx("td",{className:"px-4 py-2 text-center font-mono text-gray-500",children:C.locationStock}),u.jsx("td",{className:"px-4 py-2 text-center font-mono text-blue-500",children:C.otherStock}),u.jsx("td",{className:"px-4 py-2 text-center",children:u.jsx("button",{type:"button",onClick:()=>er(J),className:"text-red-500 hover:text-red-700 font-medium",children:"Remove"})})]},J))})]})}):u.jsx("div",{className:"text-center py-4 text-gray-400 bg-gray-50 rounded border border-dashed text-xs",children:"No items added yet."})]}),Tt.length>0&&u.jsxs("div",{className:"mt-6 border-t pt-4",children:[u.jsxs("h4",{className:"text-sm font-bold text-blue-700 mb-2 flex items-center",children:[u.jsx("span",{className:"mr-1",children:""})," Recommended Spare Parts (BOM) for ",ge]}),u.jsx("div",{className:"overflow-x-auto rounded-lg border border-blue-100 bg-blue-50/50",children:u.jsxs("table",{className:"w-full text-xs text-left",children:[u.jsx("thead",{className:"bg-blue-100 text-blue-800",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-3 py-2",children:"Part No"}),u.jsx("th",{className:"px-3 py-2",children:"Item Code"}),u.jsx("th",{className:"px-3 py-2",children:"Full Name"}),u.jsx("th",{className:"px-3 py-2",children:"Std Qty"}),u.jsx("th",{className:"px-3 py-2",children:"Stock"}),u.jsx("th",{className:"px-3 py-2 w-20",children:"Action"})]})}),u.jsx("tbody",{className:"divide-y divide-blue-100",children:Tt.map(C=>{const J=t.find(xe=>xe.id===C.itemId);return J?u.jsxs("tr",{className:"hover:bg-blue-100/50",children:[u.jsx("td",{className:"px-3 py-2",children:J.partNumber||"-"}),u.jsx("td",{className:"px-3 py-2 font-mono font-semibold",children:C.itemId}),u.jsx("td",{className:"px-3 py-2",children:J.fullName||J.name}),u.jsxs("td",{className:"px-3 py-2 font-bold",children:[C.quantity," ",J.unit]}),u.jsx("td",{className:`px-3 py-2 font-bold ${(J.stockQuantity||0)>0?"text-green-600":"text-red-500"}`,children:J.stockQuantity||0}),u.jsx("td",{className:"px-3 py-2",children:u.jsx("button",{type:"button",onClick:()=>mr(C),className:"px-2 py-1 bg-blue-600 text-white rounded hover:bg-blue-700 text-[10px] font-bold shadow-sm",children:"+ Use"})})]},C.id):null})})]})})]})]}),u.jsxs("div",{className:"bg-orange-50 p-4 md:p-5 rounded-lg border border-orange-200 animate-fade-in-up",children:[u.jsx("h3",{className:"text-sm font-bold text-orange-800 uppercase tracking-wider mb-4 border-b border-orange-200 pb-2",children:"4. Maintenance Plan (Mandatory)"}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:l&&l.map(C=>u.jsxs("label",{className:`flex items-center space-x-3 p-3 rounded-lg border cursor-pointer transition-all ${I===C.id?"bg-orange-100 border-orange-500 ring-1 ring-orange-500":"bg-white border-gray-200 hover:bg-gray-50"}`,children:[u.jsx("input",{type:"radio",name:"maintenance_plan",value:C.id,checked:I===C.id,onChange:J=>O(J.target.value),className:"form-radio h-5 w-5 text-orange-600 focus:ring-orange-500"}),u.jsx("span",{className:`text-sm font-medium ${I===C.id?"text-orange-900":"text-gray-700"}`,children:C.name})]},C.id))})]}),u.jsx("div",{className:"bg-gray-50 p-4 md:p-5 rounded-lg border border-gray-200 animate-fade-in-up",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Warehouse Email (To)"}),u.jsx("input",{type:"email",required:!0,value:Q,onChange:C=>re(C.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Site Email (CC)"}),u.jsx("div",{className:"flex items-center px-4 py-2 border border-gray-200 rounded-lg bg-gray-100 text-gray-500 overflow-hidden text-ellipsis",children:G||"Select Location first"})]})]})}),u.jsx("div",{className:"pt-2 flex justify-end",children:u.jsx("button",{type:"submit",disabled:ze||Ve.length===0,className:`w-full md:w-auto px-8 py-4 rounded-xl text-white font-bold text-lg shadow-md transition-all flex items-center justify-center gap-2 ${ze||Ve.length===0?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 hover:shadow-lg transform hover:-translate-y-1"}`,children:ze?"Sending...":u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""})," Submit Request"]})})})]})]})]})]})},gb=50,qhe=({history:e,locations:t,items:r,machines:n,onBulkImport:a,onUpdateIssue:i})=>{const[l,c]=N.useState("requests"),[f,d]=N.useState(""),[m,p]=N.useState(""),[v,x]=N.useState(!1),[y,b]=N.useState(""),[_,E]=N.useState(!1),[A,T]=N.useState(1),[k,I]=N.useState(null),[O,j]=N.useState(""),B=N.useRef(null);N.useEffect(()=>{T(1)},[f,m,l]);const U=N.useMemo(()=>new Map(r.map(re=>[re.id,re])),[r]),Y=N.useMemo(()=>new Map(n.map(re=>[re.id,re])),[n]),te=N.useMemo(()=>new Map(t.map(re=>[re.id,re.name])),[t]),V=N.useMemo(()=>e.filter(re=>{const G=f.toLowerCase(),P=Y.get(re.machineId),W=U.get(re.itemId),F=te.get(re.locationId)||"",M=(re.id||"").toLowerCase().includes(G)||(re.itemId||"").toLowerCase().includes(G)||((W==null?void 0:W.name)||re.itemName||"").toLowerCase().includes(G)||((W==null?void 0:W.fullName)||"").toLowerCase().includes(G)||(re.machineId||"").toLowerCase().includes(G)||((P==null?void 0:P.category)||re.machineName||"").toLowerCase().includes(G)||(F||re.locationId||"").toLowerCase().includes(G)||(re.maintenancePlan||"").toLowerCase().includes(G),le=m?re.locationId===m:!0;return M&&le}),[e,f,m,U,Y,te]),ge=N.useMemo(()=>{const re=f.toLowerCase();return r.filter(G=>(G.name||"").toLowerCase().includes(re)||(G.id||"").toLowerCase().includes(re)||(G.category||"").toLowerCase().includes(re)||(G.partNumber||"").toLowerCase().includes(re)||(G.modelNo||"").toLowerCase().includes(re))},[r,f]),be=N.useMemo(()=>{const re=new Map;return V.forEach(G=>{const P=U.get(G.itemId);re.has(G.itemId)||re.set(G.itemId,{itemNumber:G.itemId,fullName:(P==null?void 0:P.fullName)||(P==null?void 0:P.name)||G.itemName,transUm:(P==null?void 0:P.unit)||"EA",sites:new Set,sumOfQnty:0,currentStock:(P==null?void 0:P.stockQuantity)||0});const W=re.get(G.itemId);W.sumOfQnty+=G.quantity,W.sites.add(G.locationId)}),Array.from(re.values()).map(G=>({...G,sitesDisplay:Array.from(G.sites).map(P=>te.get(P)||P).join(", ")}))},[V,U,te]),ve=()=>{const re=jt.book_new();let G="";if(l==="requests"){const P=["ID","Date","Location","Item ID","Item Name","Qty","Unit","Machine","Status","Maint. Plan"],W=V.map(M=>{const le=Y.get(M.machineId),pe=U.get(M.itemId);return[M.id,new Date(M.timestamp).toLocaleDateString(),te.get(M.locationId)||M.locationId,M.itemId,(pe==null?void 0:pe.fullName)||(pe==null?void 0:pe.name)||M.itemName,M.quantity,(pe==null?void 0:pe.unit)||M.unit||"pcs",(le==null?void 0:le.category)||M.machineName,M.status,M.maintenancePlan||""]}),F=jt.aoa_to_sheet([P,...W]);jt.book_append_sheet(re,F,"Issue Requests"),G=`Issue_Requests_${new Date().toISOString().slice(0,10)}.xlsx`}else if(l==="stock"){const P=["Item Number","Description","Category","Part No","Model No","Unit","Current Stock"],W=ge.map(M=>[M.id,M.name,M.category,M.partNumber||"",M.modelNo||"",M.unit,M.stockQuantity||0]),F=jt.aoa_to_sheet([P,...W]);jt.book_append_sheet(re,F,"Current Stock"),G=`Current_Stock_${new Date().toISOString().slice(0,10)}.xlsx`}else if(l==="tracking"){const P=["Item Number","Full Name","Trans UM","Sites","Sum of Transaction Qty","Current Stock"],W=be.map(M=>[M.itemNumber,M.fullName,M.transUm,M.sitesDisplay,M.sumOfQnty,M.currentStock]),F=jt.aoa_to_sheet([P,...W]);jt.book_append_sheet(re,F,"Tracking"),G=`Inventory_Tracking_${new Date().toISOString().slice(0,10)}.xlsx`}mi(re,G)},z=()=>{var re;if(l==="tracking"){alert("Import is not available for Tracking view. Please import data into 'Issue Requests' or 'Current Stock'.");return}(re=B.current)==null||re.click()},ue=re=>{var W;const G=(W=re.target.files)==null?void 0:W[0];if(!G)return;const P=new FileReader;P.onload=F=>{var le;const M=(le=F.target)==null?void 0:le.result;try{const pe=is(M,{type:"binary"}),Ae=pe.Sheets[pe.SheetNames[0]];if(!Ae){alert("Sheet not found.");return}const oe=jt.sheet_to_json(Ae,{header:1});let ae=0;for(let mt=0;mt<Math.min(oe.length,10);mt++)if((oe[mt]||[]).map(ct=>String(ct).toLowerCase().trim()).filter(ct=>["id","date","qty","item","machine","unit","status"].some(dt=>ct.includes(dt))).length>=2){ae=mt;break}const ze=oe.slice(ae+1),q=oe[ae],Je=[];if(ze.forEach(mt=>{const Ge={};q.forEach((ut,ct)=>{Ge[String(ut)]=mt[ct]}),Object.values(Ge).some(ut=>ut!=null&&ut!=="")&&Je.push(Ge)}),Je.length===0){alert("No valid data rows found.");return}const qe=(mt,Ge)=>{const ut=String(mt).trim(),ct=Ge.find(at=>at.id===ut);if(ct)return ct.id;const dt=Ge.find(at=>at.name.toLowerCase()===ut.toLowerCase());return dt?dt.id:ut},ot=mt=>{const Ge=String(mt).trim(),ut=n.find(dt=>dt.id===Ge);if(ut)return ut.id;const ct=n.find(dt=>(dt.category||"").toLowerCase()===Ge.toLowerCase());return ct?ct.id:"Unknown"},Ke=mt=>{if(!mt)return"";const Ge=String(mt).trim(),ut=r.find(dt=>dt.id===Ge);if(ut)return ut.id;const ct=r.find(dt=>(dt.name||"").toLowerCase()===Ge.toLowerCase()||(dt.fullName||"").toLowerCase()===Ge.toLowerCase());return ct?ct.id:""},He=[],wt=[];l==="requests"?(Je.forEach(mt=>{var at;const Ge={};Object.keys(mt).forEach(Wt=>{const Oe=Wt.toLowerCase().replace(/[\s-_.]/g,""),st=mt[Wt];Oe==="id"||Oe==="requestid"?Ge.id=String(st):Oe==="date"||Oe==="timestamp"?Ge.timestamp=new Date(st).toISOString():Oe==="location"||Oe==="locationid"||Oe==="warehouse"?Ge.locationId=String(st):Oe==="itemid"||Oe==="itemnumber"||Oe==="itemcode"||Oe==="partnumber"?Ge.itemId=String(st):Oe==="itemname"||Oe==="description"?Ge.itemName=String(st):Oe==="qty"||Oe==="quantity"||Oe==="count"?Ge.quantity=Number(st):Oe==="unit"?Ge.unit=String(st):Oe==="machine"||Oe==="machinename"||Oe==="equipment"?Ge.machineName=String(st):Oe==="machineid"||Oe==="assetid"?Ge.machineId=String(st):Oe==="status"?Ge.status=String(st):(Oe==="plan"||Oe==="maintplan"||Oe==="maintenanceplan")&&(Ge.maintenancePlan=String(st))});const ut=Ge.id||`IMP-${Date.now()}-${Math.random().toString(36).substr(2,5)}`,ct=Ge.itemId||"",dt=Ge.quantity||0;if(ct&&dt){const Wt=e.find(st=>st.id===ut),Oe={id:ut,timestamp:Ge.timestamp||new Date().toISOString(),locationId:qe(Ge.locationId||"Unknown",t),itemId:Ke(ct),itemName:Ge.itemName||((at=r.find(st=>st.id===ct))==null?void 0:at.name)||"Unknown Item",quantity:dt,unit:Ge.unit||"pcs",machineId:ot(Ge.machineId||Ge.machineName||"Unknown"),machineName:Ge.machineName||"Unknown",status:Ge.status||"Completed",maintenancePlan:Ge.maintenancePlan||""};if(!Oe.itemId||Oe.itemId===""){console.warn(`Skipping history row: Item ${ct} not found.`);return}if(Oe.machineId==="Unknown"){console.warn(`Skipping history row: Machine ID not found for ${Oe.machineName}.`);return}Wt?wt.push(Oe):He.push(Oe)}}),a("history",He,wt),alert(`Imported ${He.length} new requests, updated ${wt.length}.`)):l==="stock"&&(Je.forEach(mt=>{const Ge={};if(Object.keys(mt).forEach(ut=>{const ct=ut.toLowerCase().replace(/[\s-_.]/g,""),dt=mt[ut];ct==="id"||ct==="itemid"||ct==="itemnumber"||ct==="itemcode"||ct==="partnumber"?Ge.id=String(dt):ct==="name"||ct==="description"?Ge.name=String(dt):ct==="stockqty"||ct==="qty"||ct==="quantity"||ct==="count"?Ge.stockQuantity=Number(dt):ct==="unit"?Ge.unit=String(dt):ct==="category"&&(Ge.category=String(dt))}),Ge.id){const ut=r.find(ct=>ct.id===Ge.id);ut?wt.push({...ut,...Ge}):He.push({id:Ge.id,name:Ge.name||"New Item",stockQuantity:Ge.stockQuantity||0,unit:Ge.unit||"pcs",category:Ge.category||"General"})}}),a("items",He,wt),alert(`Imported ${He.length} new items, updated ${wt.length}.`))}catch(pe){console.error(pe),alert("Failed to process file.")}},P.readAsBinaryString(G),re.target.value=""},se=re=>{const G=(A-1)*gb;return re.slice(G,G+gb)},Q=re=>{const G=Math.ceil(re/gb);return G<=1?null:u.jsxs("div",{className:"flex justify-between items-center p-3 border-t bg-gray-50 text-xs mt-auto",children:[u.jsx("button",{disabled:A===1,onClick:()=>T(P=>P-1),className:"px-3 py-1 border rounded bg-white disabled:opacity-50",children:"Previous"}),u.jsxs("span",{children:["Page ",A," of ",G," (",re," records)"]}),u.jsx("button",{disabled:A===G,onClick:()=>T(P=>P+1),className:"px-3 py-1 border rounded bg-white disabled:opacity-50",children:"Next"})]})};return u.jsxs("div",{className:"space-y-4 font-cairo h-full flex flex-col",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-white p-4 rounded-xl border border-gray-200 shadow-sm shrink-0",children:[u.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg overflow-x-auto",children:[u.jsx("button",{onClick:()=>c("requests"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${l==="requests"?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Issue Requests"}),u.jsx("button",{onClick:()=>c("stock"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${l==="stock"?"bg-white text-green-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Current Stock"}),u.jsx("button",{onClick:()=>c("tracking"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${l==="tracking"?"bg-white text-orange-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Inventory Tracking"})]}),u.jsxs("div",{className:"flex flex-1 w-full md:w-auto gap-3",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx("span",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none text-gray-400",children:""}),u.jsx("input",{type:"text",placeholder:"Search items, ID, location...",value:f,onChange:re=>d(re.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),l!=="stock"&&u.jsxs("select",{value:m,onChange:re=>p(re.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white text-gray-700 max-w-[150px]",children:[u.jsx("option",{value:"",children:"All Sites"}),t.map(re=>u.jsx("option",{value:re.id,children:re.name},re.id))]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:ve,className:"px-3 py-2 bg-green-50 text-green-700 border border-green-200 rounded-lg text-sm font-bold hover:bg-green-100 flex items-center gap-2",children:[u.jsx("span",{children:""})," Export Excel"]}),l!=="tracking"&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:z,className:"px-3 py-2 bg-orange-50 text-orange-700 border border-orange-200 rounded-lg text-sm font-bold hover:bg-orange-100 flex items-center gap-2",children:[u.jsx("span",{children:""})," Import Excel"]}),u.jsx("input",{type:"file",ref:B,className:"hidden",accept:".xlsx,.csv",onChange:ue})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex-1 flex flex-col min-h-0",children:[l==="requests"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"overflow-auto flex-1",children:u.jsxs("table",{className:"w-full text-left text-xs text-gray-600 border-separate border-spacing-0 whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-50 text-gray-700 font-semibold sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Item Number"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Location"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Sector"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Division"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Local Number"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Date"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Full Name"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50 text-right",children:"Qty"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50 text-center",children:"Unit"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Machine"}),u.jsx("th",{className:"px-3 py-2 border-b border-gray-200 bg-gray-50",children:"Status"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:se(V).length>0?se(V).map(re=>{const G=te.get(re.locationId)||re.locationId,P=U.get(re.itemId),W=Y.get(re.machineId),F=(P==null?void 0:P.fullName)||(P==null?void 0:P.name)||re.itemName,M=(W==null?void 0:W.category)||re.machineName;return u.jsxs("tr",{className:"hover:bg-blue-50 transition",children:[u.jsx("td",{className:"px-3 py-2 font-mono font-bold text-gray-800 border-r border-gray-100",children:re.itemId}),u.jsx("td",{className:"px-3 py-2 text-gray-900 border-r border-gray-100",children:G}),u.jsx("td",{className:"px-3 py-2 text-gray-600 border-r border-gray-100",children:re.sectorName||(W==null?void 0:W.sectorId)||"-"}),u.jsx("td",{className:"px-3 py-2 text-gray-600 border-r border-gray-100",children:re.divisionName||(W==null?void 0:W.divisionId)||"-"}),u.jsx("td",{className:"px-3 py-2 text-gray-600 border-r border-gray-100 uppercase",children:(W==null?void 0:W.machineLocalNo)||"-"}),u.jsx("td",{className:"px-3 py-2 border-r border-gray-100",children:new Date(re.timestamp).toLocaleDateString()}),u.jsx("td",{className:"px-3 py-2 text-gray-800 border-r border-gray-100",children:F}),u.jsx("td",{className:"px-3 py-2 font-mono font-bold text-right text-blue-700 border-r border-gray-100",children:k===re.id?u.jsx("input",{type:"number",value:O,onChange:le=>j(Number(le.target.value)),onBlur:()=>{if(i&&O!==""&&O!==re.quantity){const le=Number(O),pe=r.find(oe=>oe.id===re.itemId),Ae=((pe==null?void 0:pe.cost)||0)*le;i({...re,quantity:le,calculatedTotalCost:Ae})}I(null)},onKeyDown:le=>{if(le.key==="Enter"){if(i&&O!==""&&O!==re.quantity){const pe=Number(O),Ae=r.find(ae=>ae.id===re.itemId),oe=((Ae==null?void 0:Ae.cost)||0)*pe;i({...re,quantity:pe,calculatedTotalCost:oe})}I(null)}},autoFocus:!0,className:"w-20 px-1 py-0.5 border border-blue-400 rounded text-right focus:outline-none focus:ring-2 focus:ring-blue-200"}):u.jsx("span",{onClick:()=>{I(re.id),j(re.quantity)},className:"cursor-pointer hover:bg-blue-100 px-1 rounded block",title:"Click to edit",children:re.quantity})}),u.jsx("td",{className:"px-3 py-2 text-center text-gray-500 border-r border-gray-100",children:re.unit||(P==null?void 0:P.unit)||"-"}),u.jsx("td",{className:"px-3 py-2 text-gray-600 border-r border-gray-100",children:M}),u.jsx("td",{className:"px-3 py-2",children:u.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-medium ${re.status==="Completed"||re.status==="Approved"?"bg-green-100 text-green-700":re.status==="Pending"?"bg-yellow-100 text-yellow-700":"bg-red-100 text-red-700"}`,children:re.status})})]},re.id)}):u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-400",children:"No requests found."})})})]})}),Q(V.length)]}),l==="stock"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"overflow-auto flex-1",children:u.jsxs("table",{className:"w-full text-left text-xs border-separate border-spacing-0 whitespace-nowrap",children:[u.jsx("thead",{className:"bg-green-50 text-green-900 font-bold sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-3 py-2 border-b border-green-100",children:"Item Number"}),u.jsx("th",{className:"px-3 py-2 border-b border-green-100",children:"Description"}),u.jsx("th",{className:"px-3 py-2 border-b border-green-100",children:"Category"}),u.jsx("th",{className:"px-3 py-2 border-b border-green-100",children:"Part No / Model"}),u.jsx("th",{className:"px-3 py-2 border-b border-green-100",children:"Location Availability"}),u.jsx("th",{className:"px-3 py-2 border-b border-green-100 text-right",children:"Total Stock"}),u.jsx("th",{className:"px-3 py-2 border-b border-green-100 text-center",children:"Unit"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:se(ge).length>0?se(ge).map(re=>u.jsxs("tr",{className:"hover:bg-green-50 transition",children:[u.jsx("td",{className:"px-3 py-2 font-mono font-bold text-gray-700 border-r border-gray-50",children:re.id}),u.jsx("td",{className:"px-3 py-2 text-gray-800 border-r border-gray-50",children:re.name}),u.jsx("td",{className:"px-3 py-2 text-gray-600 border-r border-gray-50",children:re.category}),u.jsxs("td",{className:"px-3 py-2 text-gray-500 border-r border-gray-50",children:[re.partNumber&&u.jsxs("span",{children:["PN: ",re.partNumber]}),re.partNumber&&re.modelNo&&u.jsx("span",{className:"mx-1",children:"|"}),re.modelNo&&u.jsxs("span",{children:["Model: ",re.modelNo]})]}),u.jsx("td",{className:"px-3 py-2 text-xs border-r border-gray-50",children:re.quantitiesByLocation?Object.entries(re.quantitiesByLocation).map(([G,P])=>u.jsxs("div",{className:"flex justify-between gap-2",children:[u.jsxs("span",{children:[te.get(G)||G,":"]}),u.jsx("span",{className:"font-bold text-blue-600",children:P})]},G)):u.jsx("span",{className:"text-gray-400 italic",children:"No distribution recorded"})}),u.jsx("td",{className:"px-3 py-2 text-right font-bold text-green-700 bg-green-50/30 border-r border-gray-50",children:re.stockQuantity||0}),u.jsx("td",{className:"px-3 py-2 text-center text-gray-500",children:re.unit})]},re.id)):u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:"No items found matching filter."})})})]})}),Q(ge.length)]}),l==="tracking"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"overflow-auto flex-1",children:u.jsxs("table",{className:"w-full text-left text-xs border-separate border-spacing-0 whitespace-nowrap",children:[u.jsx("thead",{className:"bg-orange-50 text-orange-900 font-bold sticky top-0 z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-3 py-2 border-b border-orange-100",children:"Item Number"}),u.jsx("th",{className:"px-3 py-2 border-b border-orange-100",children:"Sites"}),u.jsx("th",{className:"px-3 py-2 border-b border-orange-100",children:"G/L Date"}),u.jsx("th",{className:"px-3 py-2 border-b border-orange-100",children:"Full Name"}),u.jsx("th",{className:"px-3 py-2 border-b border-orange-100 text-right",children:"Sum of Transaction Qty"}),u.jsx("th",{className:"px-3 py-2 border-b border-orange-100 text-right",children:"Current Stock"}),u.jsx("th",{className:"px-3 py-2 border-b border-orange-100 text-right",children:"Trans UM"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:se(be).length>0?se(be).map((re,G)=>{var P;return u.jsxs("tr",{className:"hover:bg-orange-50 transition",children:[u.jsx("td",{className:"px-3 py-2 font-mono font-bold text-gray-700",children:re.itemNumber}),u.jsx("td",{className:"px-3 py-2 text-gray-600",children:re.sitesDisplay}),u.jsx("td",{className:"px-3 py-2 text-gray-500 italic",children:new Date(((P=V.find(W=>W.itemId===re.itemNumber))==null?void 0:P.timestamp)||Date.now()).toLocaleDateString()}),u.jsx("td",{className:"px-3 py-2 text-gray-800",children:re.fullName}),u.jsx("td",{className:"px-3 py-2 text-right font-bold text-gray-900",children:re.sumOfQnty}),u.jsx("td",{className:"px-3 py-2 text-right font-mono text-gray-600",children:re.currentStock}),u.jsx("td",{className:"px-3 py-2 text-right text-gray-500",children:re.transUm})]},G)}):u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:"No tracking data found."})})})]})}),Q(be.length),be.length>0&&u.jsx("div",{className:"bg-gray-50 font-bold border-t p-2 text-xs flex justify-end",children:u.jsxs("span",{children:["Total Quantity (All Pages): ",be.reduce((re,G)=>re+G.sumOfQnty,0)]})})]})]})]})},Whe=({history:e,locations:t,items:r,machines:n,onUpdateIssue:a})=>{const[i,l]=N.useState(""),[c,f]=N.useState({}),d=N.useMemo(()=>new Map(r.map(E=>[E.id,E])),[r]),m=N.useMemo(()=>new Map(n.map(E=>[E.id,E])),[n]),p=N.useMemo(()=>new Map(t.map(E=>[E.id,E.name])),[t]),v=N.useMemo(()=>e.filter(E=>{const A=E.status==="Pending",T=i?E.locationId===i:!0;return A&&T}),[e,i]),x=(E,A,T)=>c[E]&&c[E][A]!==void 0?c[E][A]:T,y=(E,A,T)=>{f(k=>{var j,B,U,Y;const I=((j=k[E])==null?void 0:j.quantity)??((B=v.find(te=>te.id===E))==null?void 0:B.quantity)??0,O=((U=k[E])==null?void 0:U.notes)??((Y=v.find(te=>te.id===E))==null?void 0:Y.notes)??"";return{...k,[E]:{quantity:A==="quantity"?Number(T):I,notes:A==="notes"?T:O}}})},b=(E,A)=>{const T=c[E.id],k=(T==null?void 0:T.quantity)??E.quantity,I=(T==null?void 0:T.notes)??E.notes??"";if(k<=0&&A==="Approved"){alert("Quantity must be greater than 0 to approve.");return}const O={...E,quantity:k,notes:I,status:A};a(O);const j={...c};delete j[E.id],f(j)},_=e.filter(E=>E.status==="Pending").length;return u.jsx("div",{className:"space-y-6",children:u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center mr-4",children:[u.jsx("span",{className:"mr-2 text-2xl",children:""})," Pending Approvals"]}),u.jsxs("span",{className:"px-3 py-1 bg-yellow-100 text-yellow-800 rounded-full text-sm font-medium",children:[_," Total Pending"]})]}),u.jsx("div",{className:"w-full md:w-64",children:u.jsxs("select",{value:i,onChange:E=>l(E.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white text-gray-700",children:[u.jsx("option",{value:"",children:"All Locations"}),t.map(E=>u.jsxs("option",{value:E.id,children:[E.name," (",E.id,")"]},E.id))]})})]}),v.length===0?u.jsxs("div",{className:"text-center py-12 text-gray-400 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[u.jsx("p",{className:"text-lg",children:"No pending requests found."}),i?u.jsx("p",{className:"text-sm",children:'Try selecting "All Locations" or a different warehouse zone.'}):u.jsx("p",{className:"text-sm",children:"All caught up! "})]}):u.jsx("div",{className:"overflow-auto max-h-[70vh] rounded-lg border border-gray-200",children:u.jsxs("table",{className:"w-full text-left border-separate border-spacing-0",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"bg-gray-50 text-sm uppercase text-gray-500 font-semibold tracking-wider",children:[u.jsx("th",{className:"sticky top-0 z-10 bg-gray-50 border-b border-gray-200 p-4 whitespace-nowrap",children:"Date / ID"}),u.jsx("th",{className:"sticky top-0 z-10 bg-gray-50 border-b border-gray-200 p-4 whitespace-nowrap",children:"Location / Machine"}),u.jsx("th",{className:"sticky top-0 z-10 bg-gray-50 border-b border-gray-200 p-4 whitespace-nowrap",children:"Item Details"}),u.jsx("th",{className:"sticky top-0 z-10 bg-gray-50 border-b border-gray-200 p-4 w-32 whitespace-nowrap",children:"Qty Request"}),u.jsx("th",{className:"sticky top-0 z-10 bg-gray-50 border-b border-gray-200 p-4 w-48 whitespace-nowrap",children:"Notes"}),u.jsx("th",{className:"sticky top-0 right-0 z-20 bg-gray-50 border-b border-l border-gray-200 p-4 text-center whitespace-nowrap shadow-sm",children:"Actions"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:v.map(E=>{const A=x(E.id,"quantity",E.quantity),T=x(E.id,"notes",E.notes||""),k=m.get(E.machineId),I=d.get(E.itemId),O=p.get(E.locationId)||E.locationId;return u.jsxs("tr",{className:"group hover:bg-blue-50 transition-colors",children:[u.jsxs("td",{className:"p-4 align-middle whitespace-nowrap border-b border-gray-50",children:[u.jsx("div",{className:"text-gray-900 font-medium",children:E.id}),u.jsx("div",{className:"text-xs text-gray-500",children:new Date(E.timestamp).toLocaleDateString()}),u.jsx("div",{className:"text-xs text-gray-400",children:new Date(E.timestamp).toLocaleTimeString()})]}),u.jsxs("td",{className:"p-4 align-middle whitespace-nowrap border-b border-gray-50",children:[u.jsx("div",{className:"text-sm font-medium text-gray-800",children:(k==null?void 0:k.category)||E.machineName}),u.jsx("div",{className:"text-xs text-gray-500",children:O})]}),u.jsxs("td",{className:"p-4 align-middle whitespace-nowrap border-b border-gray-50",children:[u.jsx("div",{className:"text-sm font-medium text-blue-700",children:(I==null?void 0:I.fullName)||(I==null?void 0:I.name)||E.itemName}),u.jsx("div",{className:"text-xs text-gray-500 font-mono",children:E.itemId})]}),u.jsxs("td",{className:"p-4 align-middle whitespace-nowrap border-b border-gray-50",children:[u.jsx("input",{type:"number",min:"0",value:A,onChange:j=>y(E.id,"quantity",j.target.value),className:"w-20 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none text-right font-bold text-gray-700"}),A<E.quantity&&u.jsx("div",{className:"text-xs text-orange-600 mt-1 font-medium",children:"Reduced"})]}),u.jsx("td",{className:"p-4 align-middle whitespace-nowrap border-b border-gray-50",children:u.jsx("textarea",{placeholder:"Add notes...",rows:2,value:T,onChange:j=>y(E.id,"notes",j.target.value),className:"w-full text-sm px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none resize-none"})}),u.jsxs("td",{className:"sticky right-0 z-10 p-4 align-middle text-center space-y-2 whitespace-nowrap border-b border-gray-50 border-l border-gray-100 shadow-sm bg-white group-hover:bg-blue-50",children:[u.jsxs("button",{onClick:()=>b(E,"Approved"),className:"w-full px-3 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700 shadow-sm transition flex items-center justify-center gap-1",children:[u.jsx("span",{children:""})," Approve"]}),u.jsxs("button",{onClick:()=>b(E,"Rejected"),className:"w-full px-3 py-1 bg-red-100 text-red-700 text-sm rounded hover:bg-red-200 border border-red-200 transition flex items-center justify-center gap-1",children:[u.jsx("span",{children:""})," Reject"]})]})]},E.id)})})]})})]})})},vb=80,xb={items:[{key:"id",label:"Item Number"},{key:"cost",label:"Cost"},{key:"stockQuantity",label:"Stock Qty"},{key:"thirdId",label:"3rd Item No"},{key:"name",label:"Description"},{key:"description2",label:"Desc Line 2"},{key:"fullName",label:"Full Name"},{key:"category",label:"Category"},{key:"brand",label:"Brand"},{key:"modelNo",label:"Model No ()"},{key:"oem",label:"OEM"},{key:"partNumber",label:"Part No"},{key:"unit",label:"UM"}],locations:[{key:"id",label:"ID"},{key:"name",label:"Name"},{key:"email",label:"Site Email"}],sectors:[{key:"id",label:"ID"},{key:"name",label:"Name"}],divisions:[{key:"id",label:"ID"},{key:"name",label:"Name"},{key:"sectorId",label:"Parent Sector"}],plans:[{key:"id",label:"ID"},{key:"name",label:"Plan Name"}],orgStructure:[{key:"id",label:"ID"},{key:"locationId",label:"Location"},{key:"sectorId",label:"Sector"},{key:"divisionId",label:"Division"}],failureTypes:[{key:"code",label:"Code"},{key:"name",label:"Failure Name"},{key:"definition",label:"Definition"},{key:"cause",label:"Cause"},{key:"action",label:"Action"},{key:"applicableAssetType",label:"Applicable Asset"},{key:"mandatory",label:"Mandatory?"},{key:"active",label:"Active?"}]},Vhe=({history:e,items:t,machines:r,locations:n,sectors:a,divisions:i,plans:l,orgStructures:c,failureTypes:f,onAddItem:d,onAddMachine:m,onAddLocation:p,onAddSector:v,onAddDivision:x,onAddPlan:y,onAddOrgStructure:b,onAddFailureType:_,onUpdateItem:E,onUpdateMachine:A,onUpdateLocation:T,onUpdateSector:k,onUpdateDivision:I,onUpdatePlan:O,onUpdateOrgStructure:j,onUpdateFailureType:B,onDeleteItems:U,onDeleteMachines:Y,onDeleteLocations:te,onDeleteSectors:V,onDeleteDivisions:ge,onDeletePlans:be,onDeleteOrgStructures:ve,onDeleteFailureTypes:z,onBulkImport:ue,onRestore:se})=>{var pn;const[Q,re]=N.useState("items"),[G,P]=N.useState(!1),[W,F]=N.useState(!1),[M,le]=N.useState({}),[pe,Ae]=N.useState(new Set),[oe,ae]=N.useState(null),ze=N.useRef(null),[q,Je]=N.useState(1),[qe,ot]=N.useState(""),[Ke,He]=N.useState(()=>{try{const Ue=localStorage.getItem("wf_sync_config_v2");if(Ue)return JSON.parse(Ue)}catch(Ue){console.error(Ue)}return{items:{sheetId:Wo,gid:Rre}}}),[wt,mt]=N.useState(localStorage.getItem("wf_script_url_v3")||oo),[Ge,ut]=N.useState(!1),[ct,dt]=N.useState(""),[at,Wt]=N.useState(()=>{const Ue={};Object.keys(xb).forEach(it=>{Ue[it]=xb[it].map(Tt=>({...Tt,visible:!0}))});const Le=localStorage.getItem("wf_column_settings");if(Le)try{const it=JSON.parse(Le),Tt={...Ue};return Object.keys(Ue).forEach(R=>{if(it[R]){const ee=new Set(it[R].map(Z=>Z.key)),K=it[R].map(Z=>{const ne=Ue[R].find(L=>L.key===Z.key);return ne?{...Z,label:ne.label}:Z}),H=Ue[R].filter(Z=>!ee.has(Z.key));Tt[R]=[...K,...H]}}),Tt}catch(it){console.error("Failed to load column settings",it)}return Ue}),Oe=N.useRef(null),st=N.useRef(null),Fe=N.useMemo(()=>{let Ue=[];switch(Q){case"items":Ue=t;break;case"locations":Ue=n;break;case"sectors":Ue=a;break;case"divisions":Ue=i;break;case"plans":Ue=l;break;case"orgStructure":Ue=c;break;case"failureTypes":Ue=f;break}if(qe){const Le=qe.toLowerCase();Ue=Ue.filter(it=>{if(Q==="items"){const R=it;return(R.id||"").toLowerCase().includes(Le)||(R.name||"").toLowerCase().includes(Le)||(R.partNumber||"").toLowerCase().includes(Le)||(R.modelNo||"").toLowerCase().includes(Le)||(R.fullName||"").toLowerCase().includes(Le)||(R.category||"").toLowerCase().includes(Le)}return Object.keys(it).some(R=>{const ee=it[R];return ee==null?!1:String(ee).toLowerCase().includes(Le)})})}return Ue},[Q,t,n,a,i,l,c,f,qe]);N.useEffect(()=>{localStorage.setItem("wf_sync_config_v2",JSON.stringify(Ke))},[Ke]),N.useEffect(()=>{localStorage.setItem("wf_script_url_v3",wt)},[wt]),N.useEffect(()=>{localStorage.setItem("wf_column_settings",JSON.stringify(at))},[at]),N.useEffect(()=>{Je(1),Ae(new Set),dt("")},[Q,qe]);const nr=Ue=>{const Le=Hm(Ue),it=Fre(Ue);He(Tt=>{const R=Tt[Q]||{sheetId:"",gid:""};return{...Tt,[Q]:{sheetId:Le||R.sheetId,gid:it||R.gid}}})},St=async()=>{var it;const Ue=((it=Ke[Q])==null?void 0:it.sheetId)||"";if(!Ue){dt("Error: Enter Sheet ID first.");return}const Le=Hm(Ue);if(confirm(`This will try to read the FIRST tab (GID=0) of the sheet to find GID mappings for ALL tabs.

Ensure your first tab has two columns:
Column A: Tab Name (e.g. 'items', 'machines')
Column B: GID (e.g. '123456')`)){ut(!0),dt("Reading Master Config (GID=0)...");try{const Tt=await Dw(Le,"0");if(!Tt||Tt.length===0)throw new Error("Config tab is empty or unreadable.");const R={...Ke};let ee=0;Tt.forEach(K=>{if(K.length<2)return;const H=K[0].toString().toLowerCase().trim(),Z=K[1].toString().trim();["items","machines","locations","sectors","divisions","plans","history","orgStructure","failureTypes"].includes(H)&&Z&&(R[H]={sheetId:Le,gid:Z},ee++)}),ee===0?dt("No valid config rows found. Check spelling in Column A."):(He(R),dt(`Success! Configured ${ee} tabs automatically.`))}catch(Tt){console.error(Tt),dt("Auto-Config Failed: "+Tt.message)}finally{ut(!1)}}},Zt=async()=>{if(!se){alert("Restore function not available.");return}if(!wt){dt("Error: Configure Web App URL first.");return}if(confirm(` RESTORE FROM CLOUD?

This will OVERWRITE all local data (Items, Machines, History, etc.) with the data currently in your Google Sheet.

Are you sure?`)){ut(!0),dt("Restoring all data from cloud...");try{await se(),dt(" Restore Complete! Page refreshing..."),setTimeout(()=>window.location.reload(),1500)}catch(Ue){console.error(Ue),dt(" Restore Failed: "+Ue.message),ut(!1)}}},mr=()=>{le({}),F(!1),P(!0)},er=Ue=>{le({...Ue}),F(!0),P(!0)},ar=Ue=>{confirm("Are you sure you want to remove this record?")&&Tr([Ue])},Yr=()=>{const Ue=Array.from(pe);Ue.length!==0&&confirm(`Are you sure you want to delete ${Ue.length} records? This cannot be undone.`)&&(Tr(Ue),Ae(new Set))},Tr=Ue=>{switch(Q){case"items":U(Ue);break;case"locations":te(Ue);break;case"sectors":V(Ue);break;case"divisions":ge(Ue);break;case"plans":be(Ue);break;case"orgStructure":ve(Ue);break;case"failureTypes":z(Ue);break}},Ba=Ue=>{const Le=new Set(pe);Le.has(Ue)?Le.delete(Ue):Le.add(Ue),Ae(Le)},ga=Ue=>{const Le=Ue.every(Tt=>pe.has(Tt.id)),it=new Set(pe);Le?Ue.forEach(Tt=>it.delete(Tt.id)):Ue.forEach(Tt=>it.add(Tt.id)),Ae(it)},$n=()=>{const Ue=Fe.map(Le=>String(Le.id));Ae(new Set(Ue))},$r=async(Ue=Q)=>{ut(!0),dt(`Fetching ${Ue} data...`);const Le=Ke[Ue]||{sheetId:"",gid:""};if(!Le.sheetId){dt(`Error: No Sheet ID for ${Ue}.`),ut(!1);return}try{const it=Hm(Le.sheetId),Tt=Le.gid||"0",R=await Dw(it,Tt);!R||R.length<2?dt(`No data found for ${Ue}. Check ID/GID.`):(Hn(R,Ue),dt(`${Ue} Sync Complete!`))}catch(it){dt(`Error syncing ${Ue}: `+it.message)}finally{Ue===Q&&ut(!1)}},ra=(Ue=!1)=>{let Le=[],it=[];const Tt=new Date().toISOString().slice(0,10);let R=[];switch(Q){case"items":R=t;break;case"locations":R=n;break;case"sectors":R=a;break;case"divisions":R=i;break;case"plans":R=l;break}if(Ue&&pe.size>0&&(R=R.filter(H=>pe.has(H.id))),R.length===0){alert("No data to export.");return}switch(Q){case"items":Le=["Item Number","Description","Category","Unit","3rd Item No","Desc Line 2","Full Name","Brand","OEM","Part No","Model No","Stock Qty"],it=R.map(H=>[H.id,H.name,H.category,H.unit,H.thirdId,H.description2,H.fullName,H.brand,H.oem,H.partNumber,H.modelNo,H.stockQuantity]);break;case"locations":Le=["ID","Name","Email"],it=R.map(H=>[H.id,H.name,H.email]);break;case"sectors":Le=["ID","Name"],it=R.map(H=>[H.id,H.name]);break;case"divisions":Le=["ID","Name","Sector ID"],it=R.map(H=>[H.id,H.name,H.sectorId]);break;case"plans":Le=["ID","Plan Name"],it=R.map(H=>[H.id,H.name]);break;case"orgStructure":Le=["ID","Location ID","Sector ID","Division ID"],it=R.map(H=>[H.id,H.locationId,H.sectorId,H.divisionId]);break;case"failureTypes":Le=["Code","Name","Definition","Cause","Action","Asset Type","Mandatory","Active"],it=R.map(H=>[H.code,H.name,H.definition,H.cause,H.action,H.applicableAssetType,H.mandatory,H.active]);break}const ee=jt.book_new(),K=jt.aoa_to_sheet([Le,...it]);jt.book_append_sheet(ee,K,"MasterData"),mi(ee,`WareFlow_${Q}_${Ue?"Selected":"All"}_${Tt}.xlsx`)},zn=()=>{var Ue;(Ue=ze.current)==null||Ue.click()},pr=Ue=>{var Tt;const Le=(Tt=Ue.target.files)==null?void 0:Tt[0];if(!Le)return;ae(`Reading ${Le.name}...`);const it=new FileReader;it.onload=R=>{setTimeout(()=>{var K;const ee=(K=R.target)==null?void 0:K.result;try{const H=is(ee,{type:"array"}),Z=H.SheetNames[0],ne=H.Sheets[Z],L=jt.sheet_to_json(ne,{header:1});L.length>2e3?ae(`Large file detected. Processing ${L.length} rows... this may take a moment.`):ae(`Analyzing ${L.length} rows...`),setTimeout(()=>{Hn(L,Q)},50)}catch(H){console.error("Error parsing file:",H),ae(null),alert("Error parsing file. Please check format.")}},50)},it.readAsArrayBuffer(Le),Ue.target.value=""},Hn=(Ue,Le)=>{if(!Ue||Ue.length<2){Le===Q&&(ae(null),oe&&alert("File/Sheet appears to be empty."));return}let it=-1;const Tt=Le==="history"?["id","date","location"]:["id","item number","item no","name","description"];for(let de=0;de<Math.min(Ue.length,10);de++){const we=Ue[de].join(" ").toLowerCase();if(Tt.some(Pe=>we.includes(Pe))){it=de;break}}it===-1&&(it=0);const R=Ue[it].map(de=>String(de).trim().toLowerCase()),ee=Ue.slice(it+1);let K={};Le==="items"?K={id:["item number","id","item no","code","item code"],name:["description","name","item name","desc","material name"],category:["category","cat","group"],unit:["unit","um","uom","measure"],thirdId:["3rd item no","3rd item","third item"],description2:["desc line 2","description 2","desc 2","spec"],fullName:["full name","fullname","long description"],brand:["brand","manufacturer","make"],oem:["oem"],partNumber:["part no","part number","pn","part num"],modelNo:["model no","model","model number",""],stockQuantity:["stock","qty","stock qty","quantity","balance"]}:Le==="locations"?K={id:["id","location id","zone id"],name:["name","location name","zone"],email:["email","site email","contact"]}:Le==="sectors"?K={id:["id"],name:["name","sector name"]}:Le==="divisions"?K={id:["id"],name:["name","division name"],sectorId:["sector id","sector"]}:Le==="plans"?K={id:["id"],name:["name","plan name","plan"]}:Le==="orgStructure"?K={id:["id"],locationId:["location id","location"],sectorId:["sector id","sector"],divisionId:["division id","division"]}:Le==="failureTypes"&&(K={code:["code","id"],name:["name","failure name"],definition:["definition","desc"],cause:["cause","failure cause"],action:["action","failure action"],applicableAssetType:["applicable asset","asset type"],mandatory:["mandatory"],active:["active"]});const H={};Object.keys(K).forEach(de=>{const we=K[de],Pe=R.findIndex(Re=>we.some(Ve=>Re===Ve));Pe!==-1&&(H[de]=Pe)});const Z=Le==="failureTypes"?"code":"id";if(H[Z]===void 0&&Le!=="history"){ae(null),Le===Q&&alert(`Could not find a column for '${Z}'. Checked headers: ${R.join(", ")}`);return}let ne=0,L=0;const he=[],fe=[];ee.forEach(de=>{if(!de||de.length===0)return;const we=J=>de[J]!==void 0&&de[J]!==null?String(de[J]).trim():"",Pe=H[Z]!==void 0?we(H[Z]):"";if(!Pe&&Le!=="history")return;let Re={};Object.keys(H).forEach(J=>{const xe=H[J];de[xe]!==void 0&&de[xe]!==null&&(Re[J]=String(de[xe]).trim())}),Le==="items"&&(Re.category||(Re.category="General"),Re.unit||(Re.unit="pcs"),Re.stockQuantity&&(Re.stockQuantity=Number(Re.stockQuantity)));const C=(Le==="items"?t:Le==="machines"?r:Le==="locations"?n:Le==="sectors"?a:Le==="divisions"?i:Le==="plans"?l:Le==="orgStructure"?c:Le==="failureTypes"?f:e).find(J=>J[Z]===(Re[Z]||Pe));C?(fe.push({...C,...Re}),L++):(he.push(Re),ne++)}),ue(Le,he,fe),ae(null),Le===Q&&oe&&setTimeout(()=>{alert(`Import Complete!

Total Processed: ${ee.length}
Added: ${ne}
Updated: ${L}`)},100)},lr=(Ue,Le)=>{Oe.current=Le},wn=(Ue,Le)=>{st.current=Le},zr=Ue=>{if(Oe.current===null||st.current===null)return;const Le=[...at[Q]],it=Le.filter(H=>H.visible),Tt=it[Oe.current],R=it[st.current],ee=Le.findIndex(H=>H.key===Tt.key),K=Le.findIndex(H=>H.key===R.key);Le.splice(ee,1),Le.splice(K,0,Tt),Oe.current=null,st.current=null,Wt(H=>({...H,[Q]:Le}))},na=Ue=>{Ue.preventDefault();const Le={...M};if(Q==="items"&&Le.stockQuantity&&(Le.stockQuantity=Number(Le.stockQuantity)),W)switch(Q){case"items":E(Le);break;case"locations":T(Le);break;case"sectors":k(Le);break;case"divisions":I(Le);break;case"plans":O(Le);break;case"orgStructure":j(Le);break;case"failureTypes":B(Le);break}else switch(Q){case"items":d(Le);break;case"locations":p(Le);break;case"sectors":v(Le);break;case"divisions":x(Le);break;case"plans":y(Le);break;case"orgStructure":b(Le);break;case"failureTypes":_(Le);break}P(!1)},gr=()=>{if(!G)return null;const Ue=xb[Q];return u.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh] animate-fade-in-up",children:[u.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[u.jsxs("h3",{className:"text-xl font-bold text-gray-800",children:[W?"Edit":"Add New"," ",Q.slice(0,-1)]}),u.jsx("button",{onClick:()=>P(!1),className:"text-gray-400 hover:text-gray-600 transition",children:""})]}),u.jsxs("form",{onSubmit:na,className:"flex-1 overflow-y-auto p-6",children:[u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Ue.map(Le=>{const it=M[Le.key],Tt=Array.isArray(it)?it.join(", "):it||"";return u.jsxs("div",{className:Le.key==="name"||Le.key==="fullName"?"md:col-span-2 space-y-1":"space-y-1",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700",children:Le.label}),u.jsx("input",{type:Le.key==="stockQuantity"?"number":"text",value:Tt,onChange:R=>le({...M,[Le.key]:R.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none transition",placeholder:`Enter ${Le.label}`,disabled:W&&Le.key==="id",required:Le.key==="id"})]},Le.key)})}),u.jsxs("div",{className:"pt-6 mt-6 border-t border-gray-100 flex justify-end gap-3 sticky bottom-0 bg-white",children:[u.jsx("button",{type:"button",onClick:()=>P(!1),className:"px-5 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium transition",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-sm font-medium transition",children:W?"Save Changes":"Create Record"})]})]})]})})},Oa=()=>{const Ue=Math.ceil(Fe.length/vb),Le=(q-1)*vb,it=Fe.slice(Le,Le+vb),Tt=at[Q].filter(R=>R.visible);return u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden flex flex-col h-full",children:[u.jsx("div",{className:"overflow-auto flex-1",children:u.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-50 text-gray-700 font-semibold border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 w-10 text-center",children:u.jsx("input",{type:"checkbox",checked:it.length>0&&it.every(R=>pe.has(R.id)),onChange:()=>ga(it),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),Tt.map((R,ee)=>u.jsx("th",{className:"px-4 py-3 cursor-move hover:bg-gray-100 select-none",draggable:!0,onDragStart:K=>lr(K,ee),onDragEnter:K=>wn(K,ee),onDragEnd:zr,onDragOver:K=>K.preventDefault(),children:R.label},R.key)),u.jsx("th",{className:"px-4 py-3 text-right bg-gray-50 sticky right-0 shadow-sm border-l",children:"Actions"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-100",children:[it.map(R=>{const ee=R,K=ee.id;return u.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[u.jsx("td",{className:"px-4 py-2 text-center",children:u.jsx("input",{type:"checkbox",checked:pe.has(K),onChange:()=>Ba(K),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),Tt.map(H=>u.jsx("td",{className:"px-4 py-2 text-gray-600",children:Array.isArray(ee[H.key])?ee[H.key].join(", "):ee[H.key]||"-"},H.key)),u.jsxs("td",{className:"px-4 py-2 text-right sticky right-0 bg-white group-hover:bg-blue-50 border-l border-gray-100 flex items-center justify-end gap-2",children:[u.jsx("button",{onClick:()=>er(R),className:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Edit",children:""}),u.jsx("button",{onClick:()=>ar(K),className:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete",children:""})]})]},K)}),it.length===0&&u.jsx("tr",{children:u.jsxs("td",{colSpan:Tt.length+2,className:"px-6 py-12 text-center text-gray-400",children:["No records found in ",Q,"."]})})]})]})}),Ue>1&&u.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex items-center justify-between",children:[u.jsx("button",{disabled:q===1,onClick:()=>Je(R=>R-1),className:"px-3 py-1 border rounded bg-white disabled:opacity-50 hover:bg-gray-100",children:"Previous"}),u.jsxs("span",{className:"text-sm text-gray-600",children:["Page ",q," of ",Ue," (",Fe.length," items)"]}),u.jsx("button",{disabled:q===Ue,onClick:()=>Je(R=>R+1),className:"px-3 py-1 border rounded bg-white disabled:opacity-50 hover:bg-gray-100",children:"Next"})]})]})};return u.jsxs("div",{className:"flex flex-col h-full space-y-4 font-sans animate-fade-in-up",children:[u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[u.jsx("div",{className:"flex overflow-x-auto w-full lg:w-auto pb-2 lg:pb-0 gap-2 scrollbar-hide",children:["items","locations","sectors","divisions","plans","orgStructure","failureTypes"].map(Ue=>u.jsx("button",{onClick:()=>re(Ue),className:`px-4 py-2 rounded-lg text-sm font-bold capitalize whitespace-nowrap transition-all ${Q===Ue?"bg-blue-600 text-white shadow-md transform scale-105":"bg-gray-50 text-gray-600 hover:bg-gray-100 border border-gray-100"}`,children:Ue},Ue))}),u.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 p-1.5 rounded-lg border border-blue-100 w-full lg:w-auto",children:[u.jsx("input",{type:"text",className:"text-xs bg-white border border-blue-200 rounded px-2 py-1.5 focus:ring-2 focus:ring-blue-400 focus:outline-none w-full lg:w-48 text-blue-800 placeholder-blue-300",placeholder:"Paste Sheet URL / ID for this tab...",value:((pn=Ke[Q])==null?void 0:pn.sheetId)||"",onChange:Ue=>nr(Ue.target.value)}),u.jsx("button",{onClick:()=>$r(),disabled:Ge,className:"p-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition shadow-sm disabled:opacity-50",title:`Sync ${Q} from Google Sheet`,children:Ge?u.jsx("span",{className:"animate-spin text-lg",children:""}):u.jsx("span",{children:""})}),u.jsx("button",{onClick:St,className:"p-1.5 bg-white text-blue-600 border border-blue-200 rounded hover:bg-blue-50 transition",title:"Auto-detect Config from Sheet (GID 0)",children:""})]})]}),u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center bg-white p-3 rounded-xl border border-gray-200 shadow-sm gap-3",children:[u.jsxs("div",{className:"flex gap-2 items-center w-full md:w-auto shrink-0",children:[u.jsxs("button",{onClick:mr,className:"flex-1 md:flex-none px-4 py-2 bg-green-600 text-white rounded-lg font-bold text-sm hover:bg-green-700 flex items-center justify-center gap-2 shadow-sm transition-transform active:scale-95",children:[u.jsx("span",{children:"+"})," Add New"]}),pe.size>0&&u.jsxs(u.Fragment,{children:[u.jsxs("button",{onClick:Yr,className:"flex-1 md:flex-none px-4 py-2 bg-red-50 text-red-600 rounded-lg font-bold text-sm hover:bg-red-100 border border-red-100 flex items-center justify-center gap-2",children:[u.jsx("span",{children:""})," Delete (",pe.size,")"]}),pe.size<Fe.length&&u.jsxs("button",{onClick:$n,className:"flex-1 md:flex-none px-4 py-2 bg-blue-50 text-blue-600 rounded-lg font-bold text-sm hover:bg-blue-100 border border-blue-100 flex items-center justify-center gap-2",children:[u.jsx("span",{children:""})," Select All ",Fe.length]})]})]}),u.jsxs("div",{className:"relative flex-1 w-full md:max-w-md mx-auto min-w-[200px]",children:[u.jsx("input",{type:"text",placeholder:Q==="items"?"Search Name or Code...":`Search ${Q}...`,value:qe,onChange:Ue=>ot(Ue.target.value),className:"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm"}),u.jsx("span",{className:"absolute left-2.5 top-2.5 text-gray-400 text-sm",children:""})]}),u.jsxs("div",{className:"flex gap-2 w-full md:w-auto overflow-x-auto pb-1 md:pb-0 shrink-0",children:[u.jsxs("button",{onClick:Zt,disabled:Ge,className:"whitespace-nowrap px-3 py-2 bg-yellow-50 text-yellow-700 rounded-lg text-xs font-bold hover:bg-yellow-100 border border-yellow-200 flex items-center gap-1",children:[u.jsx("span",{children:""})," Restore Cloud"]}),u.jsxs("button",{onClick:()=>ra(!1),className:"whitespace-nowrap px-3 py-2 bg-green-50 text-green-700 rounded-lg text-xs font-bold hover:bg-green-100 border border-green-200 flex items-center gap-1",children:[u.jsx("span",{children:""})," Export"]}),u.jsxs("button",{onClick:zn,className:"whitespace-nowrap px-3 py-2 bg-orange-50 text-orange-700 rounded-lg text-xs font-bold hover:bg-orange-100 border border-orange-200 flex items-center gap-1",children:[u.jsx("span",{children:""})," Import"]}),u.jsx("input",{type:"file",ref:ze,className:"hidden",accept:".xlsx,.csv",onChange:pr})]})]}),ct&&u.jsxs("div",{className:`text-xs px-4 py-3 rounded-lg border flex items-center gap-2 animate-fade-in ${ct.includes("Error")||ct.includes("Failed")?"bg-red-50 text-red-700 border-red-200":"bg-blue-50 text-blue-700 border-blue-200"}`,children:[u.jsx("span",{className:"text-lg",children:ct.includes("Error")?"":""}),ct]}),u.jsx("div",{className:"flex-1 overflow-hidden",children:Oa()}),gr()]})},Ghe=({transfers:e,machines:t,locations:r,currentUser:n,onAddTransfer:a,onUpdateTransfer:i})=>{var T;const[l,c]=N.useState(!1),[f,d]=N.useState(null),[m,p]=N.useState(""),[v,x]=N.useState({status:"Draft",transferType:"Internal",effectiveDate:new Date().toISOString().split("T")[0]}),y=["admin","maintenance_manager"].includes(n.role),b=k=>{k.preventDefault();const I={id:`TR-${Date.now()}`,machineId:v.machineId,currentLocationId:v.currentLocationId,targetLocationId:v.targetLocationId,transferType:v.transferType,requestedBy:n.username,reasonCode:v.reasonCode||"",effectiveDate:v.effectiveDate,status:"Draft",...v};a(I),c(!1),x({status:"Draft",transferType:"Internal",effectiveDate:new Date().toISOString().split("T")[0]})},_=()=>{!f||!m||(i({...f,status:"Draft",rejectionReason:m}),d(null),p(""))},E=(k,I)=>{if(I==="Approved"){if(!y){alert("Only Maintenance Manager or Admin can approve transfers.");return}if(k.transferType==="External maintenance"&&n.role!=="maintenance_manager"&&n.role!=="admin"){alert("External maintenance requires Maintenance Manager approval.");return}i({...k,status:"Approved",approvedBy:n.username,approvalTimestamp:new Date().toISOString()})}else if(I==="Executed"){if(k.status!=="Approved"){alert("Cannot execute a transfer that is not approved.");return}i({...k,status:"Executed"})}else I==="Submitted"?i({...k,status:"Submitted"}):I==="Closed"&&i({...k,status:"Closed"})},A=t.map(k=>({id:k.id,label:`${k.category} (${k.machineLocalNo})`,subLabel:k.id}));return r.map(k=>({id:k.id,label:k.name})),u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"p-4 border-b border-gray-100 flex justify-between bg-gray-50 items-center",children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Asset Transfers"}),u.jsx("button",{onClick:()=>c(!0),className:"px-4 py-2 bg-emerald-600 text-white rounded-lg text-xs font-bold hover:bg-emerald-700 transition shadow-sm",children:"+ New Transfer"})]}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsxs("table",{className:"w-full text-left text-xs whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0 border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-2",children:"ID"}),u.jsx("th",{className:"p-2",children:"Machine"}),u.jsx("th",{className:"p-2",children:"From"}),u.jsx("th",{className:"p-2",children:"To"}),u.jsx("th",{className:"p-2",children:"Type"}),u.jsx("th",{className:"p-2",children:"Date"}),u.jsx("th",{className:"p-2",children:"Status"}),u.jsx("th",{className:"p-2 text-right",children:"Actions"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-100",children:[e.map(k=>{const I=t.find(B=>B.id===k.machineId),O=r.find(B=>B.id===k.currentLocationId),j=r.find(B=>B.id===k.targetLocationId);return u.jsxs("tr",{className:"hover:bg-emerald-50",children:[u.jsx("td",{className:"p-2 font-mono text-gray-500",children:k.id}),u.jsx("td",{className:"p-2 font-bold",children:(I==null?void 0:I.category)||k.machineId}),u.jsx("td",{className:"p-2",children:(O==null?void 0:O.name)||k.currentLocationId}),u.jsx("td",{className:"p-2",children:(j==null?void 0:j.name)||k.targetLocationId}),u.jsx("td",{className:"p-2",children:k.transferType}),u.jsx("td",{className:"p-2",children:k.effectiveDate}),u.jsx("td",{className:"p-2",children:u.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] font-bold ${k.status==="Draft"?"bg-gray-100 text-gray-600":k.status==="Submitted"?"bg-blue-100 text-blue-600":k.status==="Approved"?"bg-green-100 text-green-600":k.status==="Executed"?"bg-emerald-100 text-emerald-600":"bg-gray-200 text-gray-700"}`,children:k.status})}),u.jsxs("td",{className:"p-2 text-right space-x-2",children:[k.status==="Draft"&&u.jsx("button",{onClick:()=>E(k,"Submitted"),className:"text-blue-600 hover:underline",children:"Submit"}),k.status==="Submitted"&&y&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>E(k,"Approved"),className:"text-green-600 hover:underline font-bold px-2",children:"Approve"}),u.jsx("button",{onClick:()=>d(k),className:"text-red-600 hover:underline px-2",children:"Reject"})]}),k.status==="Approved"&&(n.role==="admin"||n.username===k.requestedBy)&&u.jsx("button",{onClick:()=>E(k,"Executed"),className:"text-emerald-600 hover:underline font-bold",children:"Execute"}),k.status==="Executed"&&u.jsx("button",{onClick:()=>E(k,"Closed"),className:"text-gray-500 hover:underline",children:"Close"})]})]},k.id)}),e.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:8,className:"p-8 text-center text-gray-400",children:"No transfers found."})})]})]})}),f&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-[70] flex items-center justify-center p-4 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm p-4",children:[u.jsx("h4",{className:"font-bold text-gray-900 mb-2",children:"Rejection Reason"}),u.jsx("textarea",{className:"w-full border rounded p-2 text-sm mb-4",rows:3,placeholder:"Enter reason for rejection...",value:m,onChange:k=>p(k.target.value)}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>d(null),className:"px-3 py-1 text-xs text-gray-500 hover:bg-gray-100 rounded",children:"Cancel"}),u.jsx("button",{onClick:_,disabled:!m,className:"px-3 py-1 text-xs bg-red-600 text-white rounded font-bold disabled:opacity-50",children:" Confirm Rejection"})]})]})}),l&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"px-5 py-3 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"New Asset Transfer"}),u.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 hover:text-gray-600 p-1",children:""})]}),u.jsxs("form",{onSubmit:b,className:"p-4 space-y-4 overflow-y-auto",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Transfer Type"}),u.jsxs("select",{className:"w-full border rounded-lg p-2 text-sm",value:v.transferType,onChange:k=>x({...v,transferType:k.target.value}),children:[u.jsx("option",{value:"Internal",children:"Internal (between sites)"}),u.jsx("option",{value:"External maintenance",children:"External maintenance (supplier)"})]})]}),u.jsx(Sr,{label:"Machine / Serial No",options:A,value:v.machineId||"",onChange:k=>{const I=t.find(O=>O.id===k);x({...v,machineId:k,currentLocationId:I==null?void 0:I.locationId})}}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Current Location"}),u.jsx("input",{type:"text",className:"w-full border rounded-lg p-2 text-sm bg-gray-50",value:((T=r.find(k=>k.id===v.currentLocationId))==null?void 0:T.name)||v.currentLocationId||"",readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Target Location"}),u.jsxs("select",{className:"w-full border rounded-lg p-2 text-sm",value:v.targetLocationId,onChange:k=>x({...v,targetLocationId:k.target.value}),required:!0,children:[u.jsx("option",{value:"",children:"Select Location"}),r.map(k=>u.jsx("option",{value:k.id,children:k.name},k.id))]})]})]}),v.transferType==="External maintenance"&&u.jsxs("div",{className:"space-y-4 border-l-4 border-orange-400 pl-4 bg-orange-50/50 py-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Supplier Name *"}),u.jsx("input",{type:"text",className:"w-full border rounded-lg p-2 text-sm",value:v.supplierName||"",onChange:k=>x({...v,supplierName:k.target.value}),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Expected Return Date *"}),u.jsx("input",{type:"date",className:"w-full border rounded-lg p-2 text-sm",value:v.expectedReturnDate||"",onChange:k=>x({...v,expectedReturnDate:k.target.value}),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Work Scope Notes"}),u.jsx("textarea",{className:"w-full border rounded-lg p-2 text-sm",value:v.workScopeNotes||"",onChange:k=>x({...v,workScopeNotes:k.target.value}),rows:2})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Reason Code / Notes"}),u.jsx("input",{type:"text",className:"w-full border rounded-lg p-2 text-sm",value:v.reasonCode||"",onChange:k=>x({...v,reasonCode:k.target.value})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Effective Date"}),u.jsx("input",{type:"date",className:"w-full border rounded-lg p-2 text-sm",value:v.effectiveDate||"",onChange:k=>x({...v,effectiveDate:k.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Requested By"}),u.jsx("input",{type:"text",className:"w-full border rounded-lg p-2 text-sm bg-gray-50",value:n.name,readOnly:!0})]})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t sticky bottom-0 bg-white",children:[u.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-6 py-2 bg-emerald-600 text-white rounded-lg text-sm font-bold hover:bg-emerald-700 shadow-md",children:"Create Draft"})]})]})]})})]})},Khe=({history:e,machines:t,locations:r})=>{const[n,a]=N.useState(""),i=N.useMemo(()=>{let c=[...e].sort((f,d)=>new Date(d.date).getTime()-new Date(f.date).getTime());return n&&(c=c.filter(f=>f.machineId===n)),c},[e,n]),l=t.map(c=>({id:c.id,label:`${c.category} (${c.machineLocalNo})`}));return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-col sm:flex-row justify-between bg-gray-50 items-start sm:items-center gap-4",children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Machine Transfer History (Immutable Log)"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Filter by Machine:"}),u.jsxs("select",{className:"border rounded px-2 py-1 text-xs bg-white",value:n,onChange:c=>a(c.target.value),children:[u.jsx("option",{value:"",children:"All Machines"}),l.map(c=>u.jsx("option",{value:c.id,children:c.label},c.id))]})]})]}),u.jsx("div",{className:"flex-1 overflow-auto p-4",children:u.jsxs("div",{className:"relative border-l-2 border-amber-200 ml-4 pl-8 space-y-8",children:[i.map((c,f)=>{const d=t.find(v=>v.id===c.machineId),m=r.find(v=>v.id===c.fromLocationId),p=r.find(v=>v.id===c.toLocationId);return u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute -left-[41px] top-1 w-4 h-4 rounded-full bg-amber-500 border-2 border-white shadow-sm"}),u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 hover:shadow-md transition",children:[u.jsxs("div",{className:"flex justify-between items-start mb-2",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"text-sm font-bold text-gray-800",children:(d==null?void 0:d.category)||c.machineId}),u.jsx("span",{className:"text-[10px] px-2 py-0.5 bg-amber-100 text-amber-700 rounded-full font-bold",children:c.transferType})]}),u.jsx("span",{className:"text-xs text-gray-400 font-mono",children:c.date})]}),u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-4 text-xs mt-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400 mb-0.5",children:"From"}),u.jsx("p",{className:"font-semibold text-gray-700",children:(m==null?void 0:m.name)||c.fromLocationId})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400 mb-0.5",children:"To Target"}),u.jsx("p",{className:"font-semibold text-gray-700",children:(p==null?void 0:p.name)||c.toLocationId})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400 mb-0.5",children:"Requested By"}),u.jsx("p",{className:"font-semibold text-gray-700",children:c.requestedBy})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-400 mb-0.5",children:"Approved By"}),u.jsx("p",{className:"font-semibold text-gray-700",children:c.approvedBy||"-"})]})]}),c.notes&&u.jsxs("div",{className:"mt-3 p-2 bg-gray-50 rounded border border-gray-100 text-[11px] text-gray-600",children:[u.jsx("strong",{children:"Notes:"})," ",c.notes]}),u.jsxs("div",{className:"mt-2 text-[10px] text-gray-400 flex justify-between",children:[u.jsxs("span",{children:["Ref: ",c.referenceChangeId]}),u.jsxs("span",{children:["Audit ID: ",c.id]})]})]})]},c.id)}),i.length===0&&u.jsx("div",{className:"text-center py-20 text-gray-400",children:"No transfer history found for the selected machine."})]})})]})},Xhe=({warrantyRecords:e,warrantyReceiving:t,machines:r,currentUser:n,onAddWarranty:a,onAddWarrantyReceiving:i})=>{const[l,c]=N.useState(!1),[f,d]=N.useState(!1),[m,p]=N.useState(""),[v,x]=N.useState({warrantyStartDate:new Date().toISOString().split("T")[0],warrantyEndDate:new Date(new Date().setFullYear(new Date().getFullYear()+1)).toISOString().split("T")[0]}),[y,b]=N.useState({receivedDate:new Date().toISOString().split("T")[0],condition:"Good",operatingHours:0}),_=k=>{const I=new Date,O=new Date(k);return I<=O?{label:"Open Warranty",color:"text-green-600 bg-green-50 border-green-200"}:{label:"Warranty Done",color:"text-red-600 bg-red-50 border-red-200"}},E=k=>{k.preventDefault(),a({id:`W-${Date.now()}`,machineId:v.machineId,supplier:v.supplier,warrantyStartDate:v.warrantyStartDate,warrantyEndDate:v.warrantyEndDate,warrantyType:v.warrantyType,coverageNotes:v.coverageNotes}),c(!1)},A=k=>{k.preventDefault(),i({id:`WR-${Date.now()}`,machineId:y.machineId,receivedDate:y.receivedDate,condition:y.condition,referenceTransferId:y.referenceTransferId,operatingHours:Number(y.operatingHours),firstRunDateAfterReceipt:y.firstRunDateAfterReceipt}),d(!1)},T=r.map(k=>({id:k.id,label:`${k.category} (${k.machineLocalNo})`}));return u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-col sm:flex-row justify-between bg-gray-50 items-start sm:items-center gap-4",children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Warranty Management"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>d(!0),className:"px-3 py-1.5 bg-indigo-50 text-indigo-700 rounded-lg text-xs font-bold hover:bg-indigo-100 border border-indigo-200 shadow-sm",children:"Receiving Data"}),u.jsx("button",{onClick:()=>c(!0),className:"px-4 py-1.5 bg-purple-600 text-white rounded-lg text-xs font-bold hover:bg-purple-700 transition shadow-sm",children:"+ New Warranty"})]})]}),u.jsxs("div",{className:"flex-1 overflow-auto p-4 space-y-6",children:[u.jsxs("section",{children:[u.jsx("h4",{className:"text-xs font-black text-gray-400 uppercase tracking-wider mb-3",children:"Machine Warranties"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:[e.map(k=>{const I=r.find(j=>j.id===k.machineId),O=_(k.warrantyEndDate);return u.jsxs("div",{className:"bg-white border border-gray-100 rounded-xl p-4 shadow-sm hover:shadow-md transition",children:[u.jsxs("div",{className:"flex justify-between items-start mb-3",children:[u.jsxs("div",{children:[u.jsx("h5",{className:"font-bold text-gray-800",children:(I==null?void 0:I.category)||k.machineId}),u.jsxs("p",{className:"text-[10px] text-gray-400",children:["ID: ",k.machineId]})]}),u.jsx("div",{className:`px-2 py-1 rounded-lg text-[10px] font-black border uppercase ${O.color}`,children:O.label})]}),u.jsxs("div",{className:"space-y-2 text-xs",children:[u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-500",children:"Supplier:"}),u.jsx("span",{className:"font-semibold",children:k.supplier})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-500",children:"Period:"}),u.jsxs("span",{className:"font-semibold text-gray-600",children:[k.warrantyStartDate," to ",k.warrantyEndDate]})]}),u.jsxs("div",{className:"flex justify-between",children:[u.jsx("span",{className:"text-gray-500",children:"Type:"}),u.jsx("span",{className:"font-semibold text-purple-600",children:k.warrantyType})]})]}),k.coverageNotes&&u.jsx("div",{className:"mt-3 pt-2 border-t border-gray-50 text-[11px] text-gray-500 italic",children:k.coverageNotes})]},k.id)}),e.length===0&&u.jsx("div",{className:"col-span-full py-10 bg-gray-50 rounded-xl border-2 border-dashed border-gray-200 text-center text-gray-400 text-sm",children:"No warranty records yet."})]})]}),u.jsxs("section",{children:[u.jsx("h4",{className:"text-xs font-black text-gray-400 uppercase tracking-wider mb-3",children:"Receiving & Operation Data"}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden",children:u.jsxs("table",{className:"w-full text-left text-xs",children:[u.jsx("thead",{className:"bg-gray-50 text-gray-600 border-b",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3",children:"Rec. Date"}),u.jsx("th",{className:"p-3",children:"Machine"}),u.jsx("th",{className:"p-3",children:"Condition"}),u.jsx("th",{className:"p-3",children:"Op. Hours"}),u.jsx("th",{className:"p-3",children:"First Run"}),u.jsx("th",{className:"p-3",children:"Duration (Days)"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-50",children:[t.map(k=>{const I=r.find(j=>j.id===k.machineId),O=Math.floor((new Date().getTime()-new Date(k.firstRunDateAfterReceipt).getTime())/(1e3*3600*24));return u.jsxs("tr",{className:"hover:bg-indigo-50/30",children:[u.jsx("td",{className:"p-3",children:k.receivedDate}),u.jsx("td",{className:"p-3 font-bold",children:(I==null?void 0:I.category)||k.machineId}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] ${k.condition==="Good"?"bg-green-100 text-green-700":"bg-orange-100 text-orange-700"}`,children:k.condition})}),u.jsxs("td",{className:"p-3 font-mono",children:[k.operatingHours," h"]}),u.jsx("td",{className:"p-3",children:k.firstRunDateAfterReceipt}),u.jsxs("td",{className:"p-3 text-indigo-600 font-bold",children:[O<0?0:O," Days"]})]},k.id)}),t.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:"No receiving data found."})})]})]})})]})]}),l&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"px-5 py-3 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"New Machine Warranty"}),u.jsx("button",{onClick:()=>c(!1),className:"text-gray-400 p-1 hover:bg-gray-100 rounded",children:""})]}),u.jsxs("form",{onSubmit:E,className:"p-4 space-y-4 overflow-y-auto",children:[u.jsx(Sr,{label:"Machine ID",options:T,value:v.machineId||"",onChange:k=>x({...v,machineId:k})}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Supplier"}),u.jsx("input",{type:"text",className:"w-full border rounded-lg p-2 text-sm",value:v.supplier||"",onChange:k=>x({...v,supplier:k.target.value}),required:!0})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Start Date"}),u.jsx("input",{type:"date",className:"w-full border rounded-lg p-2 text-sm",value:v.warrantyStartDate||"",onChange:k=>x({...v,warrantyStartDate:k.target.value}),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"End Date"}),u.jsx("input",{type:"date",className:"w-full border rounded-lg p-2 text-sm",value:v.warrantyEndDate||"",onChange:k=>x({...v,warrantyEndDate:k.target.value}),required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Warranty Type"}),u.jsxs("select",{className:"w-full border rounded-lg p-2 text-sm",value:v.warrantyType||"",onChange:k=>x({...v,warrantyType:k.target.value}),required:!0,children:[u.jsx("option",{value:"",children:"Select Type"}),u.jsx("option",{value:"Manufacturer",children:"Manufacturer"}),u.jsx("option",{value:"Extended",children:"Extended"}),u.jsx("option",{value:"Service Contract",children:"Service Contract"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Coverage Notes"}),u.jsx("textarea",{className:"w-full border rounded-lg p-2 text-sm",value:v.coverageNotes||"",onChange:k=>x({...v,coverageNotes:k.target.value}),rows:3,placeholder:"What does this warranty cover?"})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t sticky bottom-0 bg-white",children:[u.jsx("button",{type:"button",onClick:()=>c(!1),className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-6 py-2 bg-purple-600 text-white rounded-lg text-sm font-bold shadow-md",children:"Save Warranty"})]})]})]})}),f&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-center justify-center p-4 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"px-5 py-3 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Warranty Receiving & Operation"}),u.jsx("button",{onClick:()=>d(!1),className:"text-gray-400 p-1 hover:bg-gray-100 rounded",children:""})]}),u.jsxs("form",{onSubmit:A,className:"p-4 space-y-4 overflow-y-auto",children:[u.jsx(Sr,{label:"Machine received from warranty",options:T,value:y.machineId||"",onChange:k=>b({...y,machineId:k})}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Received Date"}),u.jsx("input",{type:"date",className:"w-full border rounded-lg p-2 text-sm",value:y.receivedDate||"",onChange:k=>b({...y,receivedDate:k.target.value}),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Condition"}),u.jsxs("select",{className:"w-full border rounded-lg p-2 text-sm",value:y.condition||"",onChange:k=>b({...y,condition:k.target.value}),required:!0,children:[u.jsx("option",{value:"Good",children:"Good / Ready"}),u.jsx("option",{value:"Fair",children:"Fair / Needs Inspection"}),u.jsx("option",{value:"Poor",children:"Poor / Recalibrate"})]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Operating Hours"}),u.jsx("input",{type:"number",className:"w-full border rounded-lg p-2 text-sm",value:y.operatingHours||0,onChange:k=>b({...y,operatingHours:Number(k.target.value)}),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Reference Transfer ID"}),u.jsx("input",{type:"text",className:"w-full border rounded-lg p-2 text-sm",value:y.referenceTransferId||"",onChange:k=>b({...y,referenceTransferId:k.target.value}),placeholder:"TR-..."})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"First Run Date After Receipt"}),u.jsx("input",{type:"date",className:"w-full border rounded-lg p-2 text-sm",value:y.firstRunDateAfterReceipt||"",onChange:k=>b({...y,firstRunDateAfterReceipt:k.target.value}),required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t sticky bottom-0 bg-white",children:[u.jsx("button",{type:"button",onClick:()=>d(!1),className:"px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 rounded-lg",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-6 py-2 bg-indigo-600 text-white rounded-lg text-sm font-bold shadow-md",children:"Save Record"})]})]})]})})]})},yb=50,Yhe=({machines:e,items:t,bomRecords:r,locations:n,sectors:a,divisions:i,breakdowns:l,assetTransfers:c,transferHistory:f,warrantyRecords:d,warrantyReceiving:m,onAddMachine:p,onUpdateMachine:v,onDeleteMachines:x,onAddBreakdown:y,onUpdateBreakdown:b,onAddBOM:_,onUpdateBOM:E,onDeleteBOMs:A,onAddTransfer:T,onUpdateTransfer:k,onAddWarranty:I,onAddWarrantyReceiving:O,onBulkImport:j,setCurrentView:B,currentUser:U})=>{var H,Z,ne;const[Y,te]=N.useState("assets"),[V,ge]=N.useState(""),[be,ve]=N.useState(new Set),[z,ue]=N.useState(1),[se,Q]=N.useState(null),[re,G]=N.useState(""),[P,W]=N.useState("All"),[F,M]=N.useState("All"),[le,pe]=N.useState(""),[Ae,oe]=N.useState(""),[ae,ze]=N.useState(""),[q,Je]=N.useState(""),[qe,ot]=N.useState(()=>{try{const L=localStorage.getItem("wf_asset_sync_config");return L?JSON.parse(L):{machines:{sheetId:Wo},breakdowns:{sheetId:Wo},bom:{sheetId:Wo}}}catch{return{machines:{sheetId:Wo},breakdowns:{sheetId:Wo},bom:{sheetId:Wo}}}}),[Ke,He]=N.useState(localStorage.getItem("wf_script_url_v3")||oo),[wt,mt]=N.useState(!1),[Ge,ut]=N.useState(""),[ct,dt]=N.useState(!1),[at,Wt]=N.useState(!1),[Oe,st]=N.useState({}),Fe=N.useRef(null);N.useEffect(()=>{localStorage.setItem("wf_asset_sync_config",JSON.stringify(qe)),ve(new Set)},[qe,Y]),N.useEffect(()=>{He(localStorage.getItem("wf_script_url_v3")||oo)},[]),N.useEffect(()=>{ue(1),ve(new Set)},[Y,V,re,P,F,le,Ae,ae,q]);const nr=N.useMemo(()=>{const L=new Map;return t.forEach(he=>L.set(he.id,he)),L},[t]),St=N.useMemo(()=>new Map(n.map(L=>[L.id,L.name])),[n]),Zt=N.useMemo(()=>new Map(a.map(L=>[L.id,L.name])),[a]),mr=N.useMemo(()=>new Map(i.map(L=>[L.id,L.name])),[i]),er=L=>{let he="machines";Y==="breakdowns"&&(he="breakdowns"),Y==="bom"&&(he="bom"),ot(fe=>({...fe,[he]:{sheetId:L}}))},ar=async()=>{let L="machines";Y==="breakdowns"&&(L="breakdowns"),Y==="bom"&&(L="bom");const he=qe[L];if(!(he!=null&&he.sheetId)){ut("Please enter a Sheet ID/URL.");return}mt(!0),ut(`Syncing ${L}...`),t.length<=8&&L==="bom"&&console.warn("[Diagnostic] Item Master seems empty or contains only defaults (Count: "+t.length+"). Check Supabase connection.");try{const fe=Hm(he.sheetId),de=await Dw(fe,"0");de&&de.length>1?(Yr(de,L),ut("Sync success!")):ut("No data found or empty sheet.")}catch(fe){ut(`Error: ${fe.message}`)}finally{mt(!1)}},Yr=(L,he)=>{let fe=0;for(let Ee=0;Ee<Math.min(L.length,10);Ee++)if(L[Ee].map(Qe=>String(Qe).toLowerCase().trim()).filter(Qe=>["id","name","qty","machine","item","part","serial","brand","model"].some(Xe=>Qe.includes(Xe))).length>=2){fe=Ee;break}const de=L[fe].map(Ee=>String(Ee).toLowerCase().trim()),we=L.slice(fe+1),Pe=[],Re=[];let Ve=0;const C=[],J=(Ee,Ce)=>{if(!Ee)return null;const Se=String(Ee).trim();if(!Se)return null;const Qe=Ce.find(Ye=>Ye.id===Se);if(Qe)return Qe.id;const Xe=Ce.find(Ye=>(Ye.name||"").toLowerCase()===Se.toLowerCase());return Xe?Xe.id:null},xe=Ee=>{if(!Ee)return null;const Ce=String(Ee).trim().toLowerCase().replace(/['"]/g,"");if(!Ce)return null;const Se=t.find(pt=>String(pt.id).toLowerCase()===Ce);if(Se)return Se.id;const Qe=t.find(pt=>String(pt.partNumber||"").toLowerCase()===Ce);if(Qe)return Qe.id;const Xe=t.find(pt=>String(pt.secondId||"").toLowerCase()===Ce||String(pt.thirdId||"").toLowerCase()===Ce);if(Xe)return Xe.id;const Ye=t.find(pt=>{const Et=String(pt.name||"").toLowerCase(),nt=String(pt.fullName||"").toLowerCase();return Et===Ce||nt===Ce});if(Ye)return Ye.id;if(/^\d+$/.test(Ce)){const pt=t.find(Et=>{const nt=String(Et.id).replace(/\D/g,""),yt=String(Et.partNumber||"").replace(/\D/g,"");return nt===Ce||yt===Ce});if(pt)return pt.id}return null};if(we.forEach((Ee,Ce)=>{const Se={};if(he==="bom"&&(Se.sortOrder=Ce),de.forEach((Qe,Xe)=>{const Ye=Qe.replace(/[\s-_.]/g,"");if((Ye==="id"||Ye==="machineid"||Ye==="assetid"||Ye==="entryid")&&!Se.id?Se.id=String(Ee[Xe]).trim()||void 0:Ye.includes("name")||Ye.includes("description")||Ye.includes("category")||Ye==="equipment"||Ye==="machinename"?(he==="machines"&&(Se.category=String(Ee[Xe]).trim()),he==="breakdowns"&&(Se.machineName=String(Ee[Xe]).trim())):Ye==="status"?Se.status=String(Ee[Xe]).trim():Ye==="brand"||Ye==="make"||Ye==="manufacturer"?Se.brand=String(Ee[Xe]).trim():Ye==="model"||Ye==="modelno"||Ye==="modelnumber"||Ye==="type"?Se.modelNo=String(Ee[Xe]).trim():Ye==="chase"||Ye==="chassis"||Ye==="chaseno"||Ye==="chassisno"||Ye==="serial"||Ye==="serialno"||Ye==="sn"?Se.chassisNo=String(Ee[Xe]).trim():Ye.includes("division")?Se.divisionId=J(String(Ee[Xe]),i)||null:Ye.includes("sector")?Se.sectorId=J(String(Ee[Xe]),a)||null:Ye.includes("location")?Se.locationId=J(String(Ee[Xe]),n)||null:Ye==="maingroup"||Ye==="group"?Se.mainGroup=String(Ee[Xe]).trim():Ye==="subgroup"?Se.subGroup=String(Ee[Xe]).trim():(Ye==="localno"||Ye==="machinelocalno"||Ye==="assetno")&&(Se.machineLocalNo=String(Ee[Xe]).trim()),he==="bom"){if(Ye==="machinename"||Ye==="equipname"||Ye==="machine")Se.machineCategory=String(Ee[Xe]).trim();else if(Ye==="brand"||Ye==="make")Se.brand=String(Ee[Xe]).trim();else if(Ye==="modelno"||Ye==="modelnumber"||Ye==="model")Se.modelNo=String(Ee[Xe]).trim();else if(Ye==="itemid"||Ye==="itemcode"||Ye==="partnumber"||Ye==="code"||Ye==="item"){const pt=String(Ee[Xe]).trim();Se.itemId=xe(pt),!Se.itemId&&pt&&(console.log(`[BOM Import] Item match failed for: "${pt}"`),C.includes(pt)||C.push(pt))}else(Ye==="quantity"||Ye==="qty"||Ye==="count")&&(Se.quantity=Number(Ee[Xe])||0);Ye.includes("machine")&&!Se.machineCategory&&(Se.machineCategory=String(Ee[Xe]).trim()),Ye.includes("model")&&!Se.modelNo&&(Se.modelNo=String(Ee[Xe]).trim())}}),he==="bom"&&!Se.id&&Se.machineCategory&&(Se.itemId||Se.quantity!==void 0)){if(Se.itemId){const Qe=r.find(Xe=>Xe.machineCategory===Se.machineCategory&&(Xe.modelNo===(Se.modelNo||"")||Xe.modelNo===Se.modelNo)&&Xe.itemId===Se.itemId);Qe?Se.id=Qe.id:Se.id=`BOM-${Date.now()}-${Math.floor(Math.random()*1e4)}`}Se.modelNo===void 0&&(Se.modelNo="")}if(he==="machines"&&!Se.id){if(Se.chassisNo){const Qe=e.find(Xe=>Xe.chassisNo===Se.chassisNo);Qe&&(Se.id=Qe.id)}!Se.id&&Se.category&&(Se.id=`M-${Math.floor(Math.random()*9e5)+1e5}`)}if(Se.id){if(he==="machines")Se.category=Se.category||"Unknown Machine",Se.status=Se.status||"Working",Se.machineLocalNo=Se.machineLocalNo||"";else if(he==="breakdowns")Se.machineName=Se.machineName||"Unknown Machine",Se.status=Se.status||"Open";else if(he==="bom"&&(Se.machineCategory=Se.machineCategory||"Unknown",Se.modelNo=Se.modelNo||"",!Se.itemId)){console.warn(`Skipping BOM row: Item not found for machine ${Se.machineCategory}`);return}const Xe=(he==="machines"?e:he==="breakdowns"?l:r).find(Ye=>Ye.id===Se.id);Xe?Re.push({...Xe,...Se}):Pe.push(Se)}else Ve++}),j(he,Pe,Re),Pe.length+Re.length>0){let Ee=`Successfully processed ${Pe.length+Re.length} rows.`;Ve>0&&(Ee+=`

 ${Ve} rows were skipped.`),C.length>0&&(Ee+=`

 Failed to match these Item Codes: 
 ${C.slice(0,10).join(`
 `)}${C.length>10?`
...and `+(C.length-10)+" more":""}`,Ee+=`

Please ensure these codes exist in Master Data (Items).`),alert(Ee)}else{let Ee="No valid rows found. Please check your column headers and ensure Item Codes match your Master Data.";C.length>0&&(Ee+=`

 Items not found: ${C.join(", ")}`),alert(Ee)}},Tr=()=>{let L=[];Y==="assets"?L=e.map(de=>({ID:de.id,"Equipment Name":de.category||"","Local No":de.machineLocalNo||"",Status:de.status,Brand:de.brand||"","Model No":de.modelNo||"","Chassis No":de.chassisNo||"",Location:de.locationId?St.get(de.locationId)||de.locationId:"",Sector:de.sectorId?Zt.get(de.sectorId)||de.sectorId:"",Division:de.divisionId?mr.get(de.divisionId)||de.divisionId:"","Main Group":de.mainGroup||"","Sub Group":de.subGroup||""})):Y==="breakdowns"?L=l.map(de=>({...de,"Duration (Hrs)":de.durationMinutes?(de.durationMinutes/60).toFixed(2):""})):Y==="bom"&&(L=r.map(de=>{const we=nr.get(de.itemId);return{Machine:de.machineCategory,Model:de.modelNo,Brand:de.brand||"","Item Code":de.itemId,Description:(we==null?void 0:we.name)||"","Part No":(we==null?void 0:we.partNumber)||"",Qty:de.quantity,Unit:(we==null?void 0:we.unit)||"","Maint Type":de.maintenanceType||""}}));const he=jt.json_to_sheet(L),fe=jt.book_new();jt.book_append_sheet(fe,he,Y),mi(fe,`${Y}_export.xlsx`)},Ba=()=>{var L;(L=Fe.current)==null||L.click()},ga=L=>{var de;const he=(de=L.target.files)==null?void 0:de[0];if(!he)return;const fe=new FileReader;fe.onload=we=>{var Re;const Pe=(Re=we.target)==null?void 0:Re.result;try{const Ve=is(Pe,{type:"binary"}),C=Ve.SheetNames[0],J=Ve.Sheets[C],xe=jt.sheet_to_json(J,{header:1});let Ee="machines";Y==="breakdowns"&&(Ee="breakdowns"),Y==="bom"&&(Ee="bom"),Yr(xe,Ee)}catch(Ve){console.error(Ve),alert("Failed to parse file.")}},fe.readAsBinaryString(he),L.target.value=""},$n=()=>{if(be.size!==0&&confirm(`Delete ${be.size} records?`)){const L=Array.from(be);Y==="assets"&&x(L),Y==="bom"&&A(L),ve(new Set)}},$r=L=>{const he=(L==null?void 0:L.id)||`M-${Date.now().toString().slice(-6)}`;st(L||{id:he,status:"Working"}),Wt(!!L),dt(!0)},ra=L=>{st(L||{id:`BOM-${Date.now()}`,quantity:1}),Wt(!!L),dt(!0)},zn=L=>{if(L){let he="";if(L.startTime&&L.endTime){const de=new Date(L.startTime).getTime(),we=new Date(L.endTime).getTime();we>de&&(he=((we-de)/(1e3*60*60)).toFixed(2))}const fe=e.find(de=>de.id===L.machineId);st({...L,duration:he,machineLocalNo:L.machineLocalNo||(fe==null?void 0:fe.machineLocalNo)||""}),Wt(!0)}else st({id:`BD-${Date.now()}`,startTime:new Date().toISOString().slice(0,16),status:"Open",failureType:"Mechanical",operatorName:"",machineId:"",machineName:"",machineLocalNo:"",locationId:re||"",sectorId:"",divisionId:"",duration:""}),Wt(!1);dt(!0)},pr=L=>{if(L.preventDefault(),Y==="assets")at?v(Oe):p({...Oe,id:Oe.id||`M-${Date.now()}`});else if(Y==="bom")at?E(Oe):_({...Oe,id:Oe.id||`BOM-${Date.now()}`});else{if(Oe.startTime&&Oe.endTime){const Re=new Date(Oe.startTime);if(new Date(Oe.endTime)<Re){alert(" Error: End Time cannot be earlier than Start Time.");return}}if(Oe.startTime&&Oe.duration&&!Oe.endTime){const Re=new Date(Oe.startTime),Ve=parseFloat(Oe.duration);if(!isNaN(Ve)){const C=new Date(Re.getTime()+Ve*60*60*1e3);Oe.endTime=C.toISOString()}}const he=e.find(Re=>Re.id===Oe.machineId),{duration:fe,...de}=Oe;let we=0;if(Oe.startTime&&Oe.endTime){const Re=new Date(Oe.startTime).getTime();we=(new Date(Oe.endTime).getTime()-Re)/(1e3*60)}const Pe={...de,machineName:(he==null?void 0:he.category)||Oe.machineName||"Unknown",locationId:Oe.locationId||(he==null?void 0:he.locationId)||"Unknown",sectorId:Oe.sectorId||(he==null?void 0:he.sectorId)||"",divisionId:Oe.divisionId||(he==null?void 0:he.divisionId)||"",machineLocalNo:Oe.machineLocalNo||(he==null?void 0:he.machineLocalNo)||"",durationMinutes:we>0?we:void 0};if(at?b(Pe):y(Pe),he&&Pe.status){const Re=Pe.status==="Open"?"Not Working":"Working";he.status!==Re&&v({...he,status:Re})}}dt(!1)},Hn=()=>{if(!Oe.locationId||!Oe.machineId){alert("Please select Location and Machine first.");return}let L=Oe.sectorId;if(!L&&Oe.divisionId){const he=i.find(fe=>fe.id===Oe.divisionId);he&&(L=he.sectorId)}localStorage.setItem("wf_issue_prefill",JSON.stringify({locationId:Oe.locationId,sectorId:L,divisionId:Oe.divisionId,machineId:Oe.machineId,maintenancePlanId:"MP-003"})),dt(!1),B("issue-form")},lr=N.useMemo(()=>n.find(L=>L.id===re),[n,re]),wn=N.useMemo(()=>e.filter(L=>((L.category||"").toLowerCase().includes(V.toLowerCase())||(L.id||"").toLowerCase().includes(V.toLowerCase())||(L.brand||"").toLowerCase().includes(V.toLowerCase())||(L.chassisNo||"").toLowerCase().includes(V.toLowerCase())||(L.machineLocalNo||"").toLowerCase().includes(V.toLowerCase())||(L.mainGroup||"").toLowerCase().includes(V.toLowerCase()))&&(!re||L.locationId===re||lr&&L.locationId===lr.name)&&(F==="All"||L.status===F)&&(!le||L.machineLocalNo===le)&&(!Ae||L.category===Ae)),[e,V,re,lr,F,le,Ae]),zr=N.useMemo(()=>r.filter(L=>{const he=nr.get(L.itemId),fe=V.toLowerCase(),de=(L.machineCategory||"").toLowerCase().includes(fe)||(L.modelNo||"").toLowerCase().includes(fe)||(L.itemId||"").toLowerCase().includes(fe)||((he==null?void 0:he.name)||"").toLowerCase().includes(fe)||((he==null?void 0:he.partNumber)||"").toLowerCase().includes(fe),we=ae?L.machineCategory===ae:!0,Pe=q?L.modelNo===q:!0;return de&&we&&Pe}).sort((L,he)=>(L.sortOrder||0)-(he.sortOrder||0)),[r,nr,V,ae,q]),na=N.useMemo(()=>l.filter(L=>((L.machineName||"").toLowerCase().includes(V.toLowerCase())||(L.machineLocalNo||"").toLowerCase().includes(V.toLowerCase())||(L.id||"").toLowerCase().includes(V.toLowerCase()))&&(!re||L.locationId===re||lr&&L.locationId===lr.name)&&(P==="All"||L.status===P)).sort((L,he)=>new Date(he.startTime).getTime()-new Date(L.startTime).getTime()),[l,V,re,lr,P]),gr=L=>{const he=(z-1)*yb;return L.slice(he,he+yb)},Oa=L=>{const he=Math.ceil(L/yb);return he<=1?null:u.jsxs("div",{className:"flex justify-between items-center p-3 border-t bg-gray-50 text-xs",children:[u.jsx("button",{disabled:z===1,onClick:()=>ue(fe=>fe-1),className:"px-3 py-1 border rounded bg-white disabled:opacity-50",children:"Previous"}),u.jsxs("span",{children:["Page ",z," of ",he," (",L," records)"]}),u.jsx("button",{disabled:z===he,onClick:()=>ue(fe=>fe+1),className:"px-3 py-1 border rounded bg-white disabled:opacity-50",children:"Next"})]})},pn=N.useMemo(()=>Array.from(new Set(e.map(L=>L.category).filter(Boolean))).sort().map(L=>({id:String(L),label:String(L)})),[e]),Ue=N.useMemo(()=>{if(!Oe.machineCategory)return[];const L=e.filter(fe=>fe.category===Oe.machineCategory),he=new Set(L.map(fe=>fe.modelNo).filter(Boolean));return Array.from(he).sort().map(fe=>({id:String(fe),label:String(fe)}))},[e,Oe.machineCategory]),Le=N.useMemo(()=>{if(!ae)return[];const L=e.filter(fe=>fe.category===ae),he=new Set(L.map(fe=>fe.modelNo).filter(Boolean));return Array.from(he).sort().map(fe=>({id:String(fe),label:String(fe)}))},[e,ae]),it=N.useMemo(()=>t.map(L=>({id:L.id,label:L.id,subLabel:L.name})),[t]),Tt=L=>nr.get(L),R=Y==="assets"?wn:Y==="bom"?zr:[],ee=()=>{const L=R.map(he=>String(he.id));ve(new Set(L))},K=L=>{const he=L.every(de=>be.has(de.id)),fe=new Set(be);L.forEach(de=>he?fe.delete(de.id):fe.add(de.id)),ve(fe)};return u.jsxs("div",{className:"flex flex-col h-full space-y-4 animate-fade-in-up",children:[u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex flex-col xl:flex-row justify-between items-start xl:items-center gap-4",children:[u.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-lg shrink-0 overflow-x-auto",children:[u.jsx("button",{onClick:()=>te("assets"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${Y==="assets"?"bg-white text-orange-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Equipment"}),u.jsx("button",{onClick:()=>te("bom"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${Y==="bom"?"bg-white text-blue-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"BOM (Parts)"}),u.jsx("button",{onClick:()=>te("breakdowns"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${Y==="breakdowns"?"bg-white text-red-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Breakdowns"}),u.jsx("button",{onClick:()=>te("transfers"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${Y==="transfers"?"bg-white text-emerald-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Transfers"}),u.jsx("button",{onClick:()=>te("history"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${Y==="history"?"bg-white text-amber-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"History"}),u.jsx("button",{onClick:()=>te("warranty"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${Y==="warranty"?"bg-white text-purple-600 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Warranty"})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-2 w-full xl:w-auto",children:[u.jsx("input",{type:"file",ref:Fe,className:"hidden",accept:".xlsx,.csv",onChange:ga}),u.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 p-1 rounded-lg border border-blue-100",children:[u.jsx("input",{type:"text",className:"text-xs bg-white border border-blue-200 rounded px-2 py-1.5 focus:ring-2 focus:ring-blue-400 focus:outline-none w-32 xl:w-48 text-blue-800 placeholder-blue-300",placeholder:`ID or URL for ${Y}...`,value:((H=qe[Y==="assets"?"machines":Y==="bom"?"bom":"breakdowns"])==null?void 0:H.sheetId)||"",onChange:L=>er(L.target.value)}),u.jsx("button",{onClick:ar,disabled:wt,className:"px-2 py-1.5 bg-blue-600 text-white rounded hover:bg-blue-700 transition shadow-sm disabled:opacity-50 text-xs font-bold",title:"Fetch data",children:wt?u.jsx("span",{className:"animate-spin",children:""}):u.jsx("span",{children:""})})]}),u.jsxs("button",{onClick:Tr,className:"px-3 py-2 bg-green-50 text-green-700 rounded-lg text-xs font-bold hover:bg-green-100 border border-green-200 flex items-center justify-center gap-1 whitespace-nowrap",children:[u.jsx("span",{children:""})," Export"]}),u.jsxs("button",{onClick:Ba,className:"px-3 py-2 bg-orange-50 text-orange-700 rounded-lg text-xs font-bold hover:bg-orange-100 border border-orange-200 flex items-center justify-center gap-1 whitespace-nowrap",children:[u.jsx("span",{children:""})," Import"]}),u.jsxs("div",{className:"relative flex-1 xl:w-48 min-w-[150px]",children:[u.jsx("input",{type:"text",placeholder:"Search...",value:V,onChange:L=>ge(L.target.value),className:"w-full pl-8 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 text-sm"}),u.jsx("span",{className:"absolute left-2.5 top-2.5 text-gray-400 text-sm",children:""})]})]})]}),Ge&&u.jsxs("div",{className:`text-xs px-4 py-2 rounded-lg border flex items-center gap-2 ${Ge.includes("Failed")?"bg-red-50 text-red-700 border-red-200":"bg-blue-50 text-blue-700 border-blue-200"}`,children:[u.jsx("span",{className:"text-lg",children:Ge.includes("Failed")?"":""}),Ge]}),u.jsxs("div",{className:"flex-1 bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col",children:[Y==="assets"&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-col lg:flex-row justify-between bg-gray-50 items-start lg:items-end gap-4",children:[u.jsx("h3",{className:"font-bold text-gray-700 pb-2",children:"Machine List"}),u.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto items-end",children:[u.jsxs("select",{value:re,onChange:L=>G(L.target.value),className:"w-36 h-9 px-2 border border-gray-300 rounded text-sm bg-white",children:[u.jsx("option",{value:"",children:"All Locations"}),n.map(L=>u.jsx("option",{value:L.id,children:L.name},L.id))]}),u.jsx("div",{className:"w-40",children:u.jsx(Sr,{label:"",placeholder:"Machine Name",options:pn,value:Ae,onChange:oe,compact:!0})}),u.jsxs("div",{className:"flex gap-2",children:[be.size>0&&u.jsxs("button",{onClick:$n,className:"h-9 px-3 bg-red-100 text-red-600 rounded hover:bg-red-200 text-xs font-bold",children:["Delete (",be.size,")"]}),be.size<R.length&&u.jsxs("button",{onClick:ee,className:"h-9 px-3 bg-blue-100 text-blue-600 rounded hover:bg-blue-200 text-xs font-bold",children:["Select All ",R.length]}),u.jsx("button",{onClick:()=>$r(),className:"h-9 px-4 bg-green-600 text-white rounded hover:bg-green-700 text-xs font-bold whitespace-nowrap",children:"+ New"})]})]})]}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsxs("table",{className:"w-full text-left text-xs whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0 border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-2 w-10",children:u.jsx("input",{type:"checkbox",checked:gr(wn).length>0&&gr(wn).every(L=>be.has(L.id)),onChange:()=>K(gr(wn))})}),u.jsx("th",{className:"p-2",children:"ID"}),u.jsx("th",{className:"p-2",children:"Local No"}),u.jsx("th",{className:"p-2",children:"Equipment Name"}),u.jsx("th",{className:"p-2",children:"Status"}),u.jsx("th",{className:"p-2",children:"Brand"}),u.jsx("th",{className:"p-2",children:"Model"}),u.jsx("th",{className:"p-2",children:"Chassis"}),u.jsx("th",{className:"p-2",children:"Location"}),u.jsx("th",{className:"p-2 text-right",children:"Action"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:gr(wn).map(L=>{const he=r.filter(fe=>fe.machineCategory===L.category&&(fe.modelNo===L.modelNo||!fe.modelNo));return u.jsxs(t_.Fragment,{children:[u.jsxs("tr",{className:`hover:bg-orange-50 ${se===L.id?"bg-orange-50":""}`,children:[u.jsx("td",{className:"p-2",children:u.jsx("input",{type:"checkbox",checked:be.has(L.id),onChange:()=>{const fe=new Set(be);fe.has(L.id)?fe.delete(L.id):fe.add(L.id),ve(fe)}})}),u.jsx("td",{className:"p-2 font-mono",children:L.id}),u.jsx("td",{className:"p-2 font-mono text-blue-600",children:L.machineLocalNo}),u.jsx("td",{className:"p-2 font-bold",children:L.category}),u.jsx("td",{className:"p-2",children:u.jsx("span",{className:`px-2 py-0.5 rounded text-[10px] ${L.status==="Working"?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:L.status})}),u.jsx("td",{className:"p-2",children:L.brand}),u.jsx("td",{className:"p-2",children:L.modelNo}),u.jsx("td",{className:"p-2",children:L.chassisNo}),u.jsx("td",{className:"p-2",children:St.get(L.locationId)||L.locationId}),u.jsxs("td",{className:"p-2 text-right flex gap-2 justify-end",children:[u.jsx("button",{onClick:()=>Q(se===L.id?null:L.id),className:"text-gray-500 hover:text-blue-600 font-bold px-2 border rounded",children:se===L.id?"Hide BOM":"Show BOM"}),u.jsx("button",{onClick:()=>$r(L),className:"text-blue-600 hover:underline",children:"Edit"})]})]}),se===L.id&&u.jsx("tr",{children:u.jsx("td",{colSpan:10,className:"p-0 border-b-2 border-orange-100",children:u.jsxs("div",{className:"bg-gray-50 p-4 pl-12 shadow-inner",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsxs("h4",{className:"font-bold text-gray-700 text-sm flex items-center gap-2",children:[u.jsx("span",{children:""})," BOM / Spare Parts for ",L.category," (",he.length,")"]}),u.jsx("button",{onClick:()=>{te("bom"),ze(L.category||""),Je(L.modelNo||"")},className:"text-xs text-blue-600 hover:underline",children:"Manage in BOM Tab "})]}),he.length>0?u.jsxs("table",{className:"w-full text-left text-xs bg-white border rounded overflow-hidden",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-500",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-2",children:"Item Code"}),u.jsx("th",{className:"p-2",children:"Description"}),u.jsx("th",{className:"p-2",children:"Part No"}),u.jsx("th",{className:"p-2",children:"Qty"}),u.jsx("th",{className:"p-2",children:"Type"})]})}),u.jsx("tbody",{children:he.map(fe=>{const de=nr.get(fe.itemId);return u.jsxs("tr",{className:"border-t border-gray-50",children:[u.jsx("td",{className:"p-2 font-mono text-blue-600",children:fe.itemId}),u.jsx("td",{className:"p-2",children:de==null?void 0:de.name}),u.jsx("td",{className:"p-2 text-gray-500",children:de==null?void 0:de.partNumber}),u.jsx("td",{className:"p-2 font-bold",children:fe.quantity}),u.jsx("td",{className:"p-2",children:fe.maintenanceType})]},fe.id)})})]}):u.jsx("div",{className:"text-center p-4 text-gray-400 text-sm italic border rounded bg-white",children:"No specific parts mapped to this machine model."})]})})})]},L.id)})})]})}),Oa(wn.length)]}),Y==="bom"&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-col lg:flex-row justify-between bg-gray-50 items-start lg:items-end gap-4",children:[u.jsx("div",{className:"flex flex-col gap-1",children:u.jsx("h3",{className:"font-bold text-gray-700",children:"Bill of Materials (Spare Parts)"})}),u.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto items-end",children:[u.jsxs("div",{className:"w-48",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Filter by Machine Name"}),u.jsx(Sr,{label:"",placeholder:"All Machines",options:pn,value:ae,onChange:L=>{ze(L),Je("")},compact:!0})]}),u.jsxs("div",{className:"w-48",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Filter by Model"}),u.jsx(Sr,{label:"",placeholder:"All Models",options:Le,value:q,onChange:Je,compact:!0,disabled:!ae})]}),u.jsxs("div",{className:"flex gap-2 pb-0.5",children:[be.size>0&&u.jsxs("button",{onClick:$n,className:"h-9 px-3 bg-red-100 text-red-600 rounded hover:bg-red-200 text-xs font-bold",children:["Delete (",be.size,")"]}),u.jsx("button",{onClick:()=>ra(),className:"h-9 px-4 bg-green-600 text-white rounded hover:bg-green-700 text-xs font-bold whitespace-nowrap flex items-center",children:"+ New Part"})]})]})]}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsxs("table",{className:"w-full text-left text-xs whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0 border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-2 w-10",children:u.jsx("input",{type:"checkbox",checked:gr(zr).length>0&&gr(zr).every(L=>be.has(L.id)),onChange:()=>K(gr(zr))})}),u.jsx("th",{className:"p-2",children:"Machine Name"}),u.jsx("th",{className:"p-2",children:"Model No"}),u.jsx("th",{className:"p-2",children:"Brand"}),u.jsx("th",{className:"p-2",children:"Item Code"}),u.jsx("th",{className:"p-2",children:"Full Name"}),u.jsx("th",{className:"p-2",children:"Part No"}),u.jsx("th",{className:"p-2",children:"Std Qty"}),u.jsx("th",{className:"p-2",children:"Unit"}),u.jsx("th",{className:"p-2 text-right",children:"Action"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-100",children:[gr(zr).map(L=>{const he=Tt(L.itemId);return u.jsxs("tr",{className:"hover:bg-blue-50",children:[u.jsx("td",{className:"p-2",children:u.jsx("input",{type:"checkbox",checked:be.has(L.id),onChange:()=>{const fe=new Set(be);fe.has(L.id)?fe.delete(L.id):fe.add(L.id),ve(fe)}})}),u.jsx("td",{className:"p-2 font-bold",children:L.machineCategory}),u.jsx("td",{className:"p-2",children:L.modelNo}),u.jsx("td",{className:"p-2 text-gray-500",children:L.brand||"-"}),u.jsx("td",{className:"p-2 font-mono text-blue-700 font-semibold",children:L.itemId}),u.jsx("td",{className:"p-2",children:(he==null?void 0:he.fullName)||(he==null?void 0:he.name)||"-"}),u.jsx("td",{className:"p-2",children:(he==null?void 0:he.partNumber)||"-"}),u.jsx("td",{className:"p-2 font-bold text-center",children:L.quantity}),u.jsx("td",{className:"p-2 text-gray-500",children:(he==null?void 0:he.unit)||"-"}),u.jsx("td",{className:"p-2 text-right",children:u.jsx("button",{onClick:()=>ra(L),className:"text-blue-600 hover:underline",children:"Edit"})})]},L.id)}),zr.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:9,className:"p-8 text-center text-gray-400",children:"No BOM records found."})})]})]})}),Oa(zr.length)]}),Y==="breakdowns"&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-4 border-b border-gray-100 flex flex-col sm:flex-row justify-between bg-gray-50 items-start sm:items-center gap-4",children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Breakdown List"}),u.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[u.jsxs("select",{value:re,onChange:L=>G(L.target.value),className:"px-3 py-1.5 border border-gray-300 rounded text-sm bg-white w-full sm:w-48",children:[u.jsx("option",{value:"",children:"All Locations"}),n.map(L=>u.jsx("option",{value:L.id,children:L.name},L.id))]}),u.jsxs("select",{value:P,onChange:L=>W(L.target.value),className:"px-3 py-1.5 border border-gray-300 rounded text-sm bg-white w-full sm:w-32",children:[u.jsx("option",{value:"All",children:"All Status"}),u.jsx("option",{value:"Open",children:"Open"}),u.jsx("option",{value:"Closed",children:"Closed"})]}),u.jsx("button",{onClick:()=>zn(),className:"px-4 py-1.5 bg-red-600 text-white rounded hover:bg-red-700 text-xs font-bold transition whitespace-nowrap",children:"+ New Breakdown"})]})]}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsxs("table",{className:"w-full text-left text-xs whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0 border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-2",children:"ID"}),u.jsx("th",{className:"p-2",children:"Date"}),u.jsx("th",{className:"p-2",children:"Loc Name"}),u.jsx("th",{className:"p-2",children:"Machine"}),u.jsx("th",{className:"p-2",children:"Type"}),u.jsx("th",{className:"p-2",children:"Status"}),u.jsx("th",{className:"p-2 text-right",children:"Action"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:gr(na).map(L=>{var he;return u.jsxs("tr",{className:"hover:bg-red-50",children:[u.jsx("td",{className:"p-2 font-mono text-gray-500",children:L.id}),u.jsx("td",{className:"p-2",children:new Date(L.startTime).toLocaleDateString()}),u.jsx("td",{className:"p-2 font-bold",children:((he=n.find(fe=>fe.id===L.locationId))==null?void 0:he.name)||"-"}),u.jsx("td",{className:"p-2 font-bold",children:L.machineName}),u.jsx("td",{className:"p-2",children:L.failureType}),u.jsx("td",{className:"p-2",children:u.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] ${L.status==="Open"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-700"}`,children:L.status})}),u.jsx("td",{className:"p-2 text-right",children:u.jsx("button",{onClick:()=>zn(L),className:"text-blue-600 hover:underline",children:"Edit"})})]},L.id)})})]})}),Oa(na.length)]}),Y==="transfers"&&u.jsx(Ghe,{transfers:c,machines:e,locations:n,currentUser:U,onAddTransfer:T,onUpdateTransfer:k}),Y==="history"&&u.jsx(Khe,{history:f,machines:e,locations:n}),Y==="warranty"&&u.jsx(Xhe,{warrantyRecords:d,warrantyReceiving:m,machines:e,currentUser:U,onAddWarranty:I,onAddWarrantyReceiving:O})]}),ct&&u.jsx("div",{className:"fixed inset-0 bg-black/60 z-50 flex items-center justify-center p-4 backdrop-blur-sm",dir:Y==="breakdowns"?"rtl":"ltr",children:u.jsxs("div",{className:`bg-white rounded-lg shadow-2xl w-full ${Y==="breakdowns"?"max-w-6xl font-cairo":"max-w-lg"} overflow-hidden animate-fade-in-up flex flex-col max-h-[95vh]`,children:[u.jsxs("div",{className:"px-5 py-3 border-b border-gray-200 flex justify-between items-center bg-gray-50 sticky top-0 z-10 shrink-0",children:[u.jsx("div",{children:u.jsx("h3",{className:"text-lg font-bold text-gray-900",children:Y==="assets"?at?"Edit Asset":"New Asset":Y==="bom"?"BOM Record":at?"  (Edit)":"   (New Log)"})}),u.jsx("button",{onClick:()=>dt(!1),className:"text-gray-400 hover:text-gray-700 transition p-1.5 hover:bg-gray-200 rounded-full",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),u.jsxs("form",{onSubmit:pr,className:"flex-1 overflow-y-auto bg-gray-50/30 p-4",children:[Y==="assets"?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Equipment Name"}),u.jsx("input",{type:"text",className:"w-full border rounded p-2",value:Oe.category||"",onChange:L=>st({...Oe,category:L.target.value}),required:!0,placeholder:"e.g. Forklift, Generator..."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Local No"}),u.jsx("input",{type:"text",className:"w-full border rounded p-2",value:Oe.machineLocalNo||"",onChange:L=>st({...Oe,machineLocalNo:L.target.value}),placeholder:"e.g. L-101"})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand"}),u.jsx("input",{type:"text",className:"w-full border rounded p-2",value:Oe.brand||"",onChange:L=>st({...Oe,brand:L.target.value}),placeholder:"e.g. CAT"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model No"}),u.jsx("input",{type:"text",className:"w-full border rounded p-2",value:Oe.modelNo||"",onChange:L=>st({...Oe,modelNo:L.target.value}),placeholder:"e.g. X500"})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Chassis / Serial No"}),u.jsx("input",{type:"text",className:"w-full border rounded p-2",value:Oe.chassisNo||"",onChange:L=>st({...Oe,chassisNo:L.target.value}),placeholder:"Required for unique check"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),u.jsxs("select",{className:"w-full border rounded p-2",value:Oe.status||"Working",onChange:L=>st({...Oe,status:L.target.value}),children:[u.jsx("option",{value:"Working",children:"Working"}),u.jsx("option",{value:"Breakdown",children:"Breakdown"}),u.jsx("option",{value:"Outsource Maintenance",children:"Outsource Maintenance"}),u.jsx("option",{value:"Standby",children:"Standby"}),u.jsx("option",{value:"Not Working",children:"Not Working"})]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Location ",at&&u.jsx("span",{className:"text-xs text-red-500",children:"(Transfer to change)"})]}),u.jsxs("select",{className:"w-full border rounded p-2 disabled:bg-gray-100 disabled:text-gray-500",value:Oe.locationId||"",onChange:L=>st({...Oe,locationId:L.target.value}),disabled:at,children:[u.jsx("option",{value:"",children:"Select Location..."}),n.map(L=>u.jsx("option",{value:L.id,children:L.name},L.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Main Group"}),u.jsx("input",{type:"text",className:"w-full border rounded p-2",value:Oe.mainGroup||"",onChange:L=>st({...Oe,mainGroup:L.target.value})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1 uppercase tracking-wider",children:"Asset ID"}),u.jsx("input",{type:"text",className:"w-full border border-gray-200 bg-gray-100 rounded p-2 text-gray-500 font-mono",value:Oe.id||"",readOnly:!0,disabled:!0})]})]}):Y==="bom"?u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Machine Name"}),u.jsx(Sr,{label:"",options:pn,value:Oe.machineCategory||"",onChange:L=>st({...Oe,machineCategory:L,modelNo:""}),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Model No"}),u.jsx(Sr,{label:"",options:Ue,value:Oe.modelNo||"",onChange:L=>st({...Oe,modelNo:L}),disabled:!Oe.machineCategory,required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Brand"}),u.jsx("input",{type:"text",className:"w-full border rounded p-2",value:Oe.brand||"",onChange:L=>st({...Oe,brand:L.target.value}),placeholder:"e.g. CAT"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Item Code (Part)"}),u.jsx(Sr,{label:"",options:it,value:Oe.itemId||"",onChange:L=>st({...Oe,itemId:L}),required:!0})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Standard Qty"}),u.jsx("input",{type:"number",className:"w-full border rounded p-2",value:Oe.quantity||1,onChange:L=>st({...Oe,quantity:L.target.value}),required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Maintenance Type"}),u.jsxs("select",{className:"w-full border rounded p-2",value:Oe.maintenanceType||"Corrective",onChange:L=>st({...Oe,maintenanceType:L.target.value}),children:[u.jsx("option",{value:"Corrective",children:"Corrective"}),u.jsx("option",{value:"Preventive",children:"Preventive"}),u.jsx("option",{value:"Predictive",children:"Predictive"})]})]})]})]}):u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Equipment Name"}),u.jsx("input",{type:"text",className:"block w-full rounded border-gray-300 h-9 px-2 text-sm bg-gray-50",value:Oe.machineName,readOnly:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Failure Type"}),u.jsx("input",{type:"text",className:"block w-full rounded border-gray-300 h-9 px-2 text-sm",value:Oe.failureType,onChange:L=>st({...Oe,failureType:L.target.value}),list:"failure-types"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Start Time"}),u.jsx("input",{type:"datetime-local",className:"block w-full rounded border-gray-300 h-9 px-2 text-sm",value:(Z=Oe.startTime)==null?void 0:Z.slice(0,16),onChange:L=>st({...Oe,startTime:L.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"End Time"}),u.jsx("input",{type:"datetime-local",className:"block w-full rounded border-gray-300 h-9 px-2 text-sm",value:((ne=Oe.endTime)==null?void 0:ne.slice(0,16))||"",onChange:L=>st({...Oe,endTime:L.target.value})})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Duration (Hours)"}),u.jsx("input",{type:"number",step:"0.5",className:"block w-full rounded border-gray-300 h-9 px-2 text-sm",value:Oe.duration||"",onChange:L=>st({...Oe,duration:L.target.value}),placeholder:"Auto-calcs end time"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Status"}),u.jsxs("select",{className:"block w-full rounded border-gray-300 h-9 px-2 text-sm",value:Oe.status,onChange:L=>st({...Oe,status:L.target.value}),children:[u.jsx("option",{value:"Open",children:"Open (Not Working)"}),u.jsx("option",{value:"Closed",children:"Closed (Working)"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Action Taken / Root Cause"}),u.jsx("textarea",{className:"block w-full rounded border-gray-300 p-2 text-sm",rows:3,value:Oe.actionTaken,onChange:L=>st({...Oe,actionTaken:L.target.value})})]})]}),u.jsxs("div",{className:"mt-2 pt-3 border-t border-gray-200 sticky bottom-0 bg-white flex items-center justify-between gap-3 shrink-0",children:[u.jsx("button",{type:"button",onClick:()=>dt(!1),className:"px-5 py-2 border border-gray-300 text-gray-700 font-bold text-sm rounded hover:bg-gray-50 transition w-28",children:"Cancel"}),u.jsxs("div",{className:"flex gap-3",children:[Y==="breakdowns"&&u.jsx("button",{type:"button",onClick:Hn,className:"px-5 py-2 bg-blue-100 text-blue-700 font-bold text-sm rounded hover:bg-blue-200 transition",children:"Material Request"}),u.jsx("button",{type:"submit",className:`px-6 py-2 text-white font-bold text-sm rounded shadow-sm transition transform active:scale-95 w-40 ${Y==="breakdowns"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:"Save"})]})]})]})]})})]})},Qhe=({orders:e,onAddOrder:t,onUpdateOrder:r,onDeleteOrders:n,irrigationLogs:a,onAddIrrigationLog:i,onUpdateIrrigationLog:l,onDeleteIrrigationLogs:c,locations:f,machines:d})=>{const[m,p]=N.useState("agri"),[v,x]=N.useState(!1),[y,b]=N.useState({date:new Date().toISOString().slice(0,10),unitType:"",timeSpent:1,startCounter:0,endCounter:0,achievement:1,actualOrReturn:0,calculated:0,pivot:"",branch:"",tractor:"",machineLocalNo:"1",attached:"",attachedLocalNo:"1",driver:"",department:"",notes:""}),[_,E]=N.useState(null),[A,T]=N.useState({date:new Date().toISOString().slice(0,10),locationName:"",generatorModel:"",engineStart:0,engineEnd:0,totalHours:0,notes:""}),[k,I]=N.useState(null),O=["_"," _"," ","_"," "," "],j=["   ","   ","   ","    "," ","_"],B=["","",""],U=["1","2","3","4","5","6","7","8","9","10"];N.useEffect(()=>{const M=(y.endCounter||0)-(y.startCounter||0);M>0&&y.startCounter&&y.endCounter&&b(le=>({...le,calculated:M}))},[y.startCounter,y.endCounter]),N.useEffect(()=>{const M=(A.engineEnd||0)-(A.engineStart||0);M>0&&A.engineStart&&A.engineEnd&&T(le=>({...le,totalHours:parseFloat(M.toFixed(2))}))},[A.engineStart,A.engineEnd]);const Y=(M,le)=>{b(pe=>({...pe,[M]:le}))},te=()=>{if(!y.branch||!y.tractor){alert("Please fill required fields (Branch, Tractor)");return}const le={id:e.length>0?String(Math.max(...e.map(pe=>Number(pe.id)))+1):"1250",date:y.date||new Date().toISOString().slice(0,10),branch:y.branch||"",tractor:y.tractor||"",machineLocalNo:y.machineLocalNo||"",attached:y.attached||"",attachedLocalNo:y.attachedLocalNo||"",department:y.department||"",pivot:y.pivot||"",driver:y.driver||"",startCounter:Number(y.startCounter)||0,endCounter:Number(y.endCounter)||0,rowNumber:y.rowNumber||"",unitType:y.unitType||"",achievement:Number(y.achievement)||0,actualOrReturn:Number(y.actualOrReturn)||0,calculated:Number(y.calculated)||0,timeSpent:Number(y.timeSpent)||0,notes:y.notes||"",sector:" ",services:"532"};t(le),ge()},V=()=>{if(!_){alert("No record selected for update.");return}const M={...y,id:_};r(M),alert("Agri Record Updated"),ge()},ge=()=>{b({date:new Date().toISOString().slice(0,10),unitType:"",timeSpent:1,startCounter:0,endCounter:0,achievement:1,actualOrReturn:0,calculated:0,department:"",machineLocalNo:"1",attachedLocalNo:"1",pivot:"",branch:"",tractor:"",attached:"",driver:"",rowNumber:"",notes:""}),E(null)},be=()=>{_?confirm("Delete this record?")&&(n([_]),ge()):alert("Select a record first.")},ve=(M,le)=>{T(pe=>({...pe,[M]:le}))},z=()=>{if(!A.locationName||!A.generatorModel){alert("Please fill required fields (Location, Generator)");return}const le={id:a.length>0?String(Math.max(...a.map(pe=>Number(pe.id)))+1):"5000",date:A.date||new Date().toISOString().slice(0,10),locationName:A.locationName||"",generatorModel:A.generatorModel||"",engineStart:Number(A.engineStart)||0,engineEnd:Number(A.engineEnd)||0,totalHours:Number(A.totalHours)||0,notes:A.notes||""};i(le),se()},ue=()=>{if(!k){alert("No record selected for update.");return}const M={...A,id:k};l(M),alert("Irrigation Record Updated"),se()},se=()=>{T({date:new Date().toISOString().slice(0,10),locationName:"",generatorModel:"",engineStart:0,engineEnd:0,totalHours:0,notes:""}),I(null)},Q=()=>{k?confirm("Delete this record?")&&(c([k]),se()):alert("Select a record first.")},re=()=>{const M=jt.book_new();if(m==="agri"){const le=jt.json_to_sheet(e);jt.book_append_sheet(M,le,"AgriOrders"),mi(M,"AgriWorkOrders.xlsx")}else{const le=jt.json_to_sheet(a);jt.book_append_sheet(M,le,"IrrigationLogs"),mi(M,"IrrigationLogs.xlsx")}},G=async()=>{const M=localStorage.getItem("wf_script_url_v3")||oo;if(confirm("Back up Agri Orders & Irrigation Logs to Google Sheet? This will overwrite the tabs in the sheet.")){x(!0);try{if(e.length>0){const le=["ID","Date","Branch","Tractor","Local No","Attached","Attached Local","Pivot","Driver","Start","End","Row","Unit","Achievement","Actual/Return","Calculated","Time","Notes"],pe=["id","date","branch","tractor","machineLocalNo","attached","attachedLocalNo","pivot","driver","startCounter","endCounter","rowNumber","unitType","achievement","actualOrReturn","calculated","timeSpent","notes"],Ae=e.map(oe=>pe.map(ae=>oe[ae]||""));await R4(M,"agri_orders",[le,...Ae])}if(a.length>0){const le=["ID","Date","Location","Generator","Start","End","Total Hours","Notes"],pe=["id","date","locationName","generatorModel","engineStart","engineEnd","totalHours","notes"],Ae=a.map(oe=>pe.map(ae=>oe[ae]||""));await R4(M,"irrigation_logs",[le,...Ae])}alert("Backup Successful!")}catch(le){console.error(le),alert("Backup Failed. Check console.")}finally{x(!1)}}},P="bg-[#00695c] text-white font-bold text-sm flex items-center justify-center px-1 h-8 whitespace-nowrap min-w-[110px] border border-[#004d40] rounded-sm shadow-sm",W="border border-gray-400 px-2 h-8 text-right font-bold w-full text-gray-800 focus:outline-none focus:ring-1 focus:ring-teal-500 rounded-sm",F="flex items-center gap-2 mb-2";return u.jsxs("div",{className:"p-4 bg-gray-100 min-h-screen font-sans",children:[u.jsxs("div",{className:"flex gap-2 mb-6 border-b border-gray-300 pb-2",children:[u.jsx("button",{onClick:()=>p("agri"),className:`px-6 py-2 rounded-t-lg font-bold text-sm transition-all ${m==="agri"?"bg-[#00695c] text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-50"}`,children:"Agri Work Order"}),u.jsx("button",{onClick:()=>p("irrigation"),className:`px-6 py-2 rounded-t-lg font-bold text-sm transition-all ${m==="irrigation"?"bg-[#00695c] text-white shadow-md":"bg-white text-gray-600 hover:bg-gray-50"}`,children:"Irrigation Run Times"})]}),m==="agri"&&u.jsxs("div",{className:"animate-fade-in-up",dir:"rtl",children:[u.jsxs("div",{className:"flex flex-col lg:flex-row gap-6 items-start",children:[u.jsxs("div",{className:"w-full lg:w-48 flex flex-col gap-3 pt-6 lg:pt-8",children:[u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("input",{type:"number",className:W,value:y.endCounter,onChange:M=>Y("endCounter",M.target.value)}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("input",{type:"number",className:W,value:y.startCounter,onChange:M=>Y("startCounter",M.target.value)}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("input",{type:"text",className:W,value:y.rowNumber||"",onChange:M=>Y("rowNumber",M.target.value)}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:"flex items-center gap-1",children:[u.jsx("input",{type:"number",className:`${W} bg-pink-200 border-pink-300`}),u.jsx("div",{className:P,children:" "})]})]}),u.jsxs("div",{className:"flex-1 w-full bg-gray-50 p-2 rounded border border-gray-300 relative mt-4 lg:mt-0",children:[u.jsx("span",{className:"absolute -top-3 left-3 bg-gray-100 px-2 text-sm font-bold text-gray-700 border border-gray-300 rounded",children:"Enter Details"}),u.jsxs("div",{className:"flex flex-col lg:flex-row gap-4 pt-3",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:F,children:[u.jsx("div",{className:`${W} bg-white flex items-center justify-center`,children:y.date}),u.jsx("div",{className:P,children:""})]}),u.jsxs("div",{className:F,children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("span",{className:"font-bold text-sm text-gray-600",children:""}),u.jsx("input",{className:`${W} w-20`,value:y.timeSpent,onChange:M=>Y("timeSpent",M.target.value)})]}),u.jsxs("div",{className:"flex-1 flex justify-end gap-1",children:[u.jsx("select",{className:`${W} w-24`,value:y.machineLocalNo,onChange:M=>Y("machineLocalNo",M.target.value),children:[1,2,3,4,5,6,7,8,9].map(M=>u.jsx("option",{value:M,children:M},M))}),u.jsx("div",{className:P,children:" "})]})]}),u.jsx("div",{className:F,children:u.jsxs("div",{className:"flex-1 flex justify-end gap-1",children:[u.jsx("select",{className:`${W} w-24`,value:y.attachedLocalNo,onChange:M=>Y("attachedLocalNo",M.target.value),children:[1,2,3,4,5,6,7,8,9].map(M=>u.jsx("option",{value:M,children:M},M))}),u.jsx("div",{className:P,children:" "})]})}),u.jsx("div",{className:F,children:u.jsxs("div",{className:"flex-1 flex gap-1",children:[u.jsx("select",{className:`${W} bg-yellow-50 w-24 text-center`,value:y.unitType,onChange:M=>Y("unitType",M.target.value),children:B.map(M=>u.jsx("option",{value:M,children:M},M))}),u.jsx("input",{className:W,value:y.achievement,onChange:M=>Y("achievement",M.target.value)}),u.jsx("div",{className:P,children:" "})]})}),u.jsx("div",{className:F,children:u.jsxs("div",{className:"flex-1 flex gap-1",children:[u.jsx("input",{className:`${W} bg-yellow-50 w-24`,disabled:!0,value:0}),u.jsx("input",{className:W,value:y.actualOrReturn,onChange:M=>Y("actualOrReturn",M.target.value)}),u.jsx("div",{className:P,children:"  "})]})})]}),u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:F,children:[u.jsxs("select",{className:W,value:y.branch,onChange:M=>Y("branch",M.target.value),children:[u.jsx("option",{value:"",children:" ..."}),f.map(M=>u.jsx("option",{value:M.name,children:M.name},M.id))]}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:F,children:[u.jsxs("select",{className:W,value:y.tractor,onChange:M=>Y("tractor",M.target.value),children:[u.jsx("option",{value:"",children:"  ..."}),d.filter(M=>{var le;return((le=M.category)==null?void 0:le.includes(""))||!0}).map(M=>u.jsx("option",{value:M.category||M.id,children:M.category||M.id},M.id))]}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:F,children:[u.jsxs("select",{className:W,value:y.attached,onChange:M=>Y("attached",M.target.value),children:[u.jsx("option",{value:"",children:" ..."}),O.map(M=>u.jsx("option",{value:M,children:M},M))]}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:F,children:[u.jsxs("select",{className:W,value:y.pivot,onChange:M=>Y("pivot",M.target.value),children:[u.jsx("option",{value:"",children:" ..."}),U.map(M=>u.jsx("option",{value:M,children:M},M))]}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:F,children:[u.jsxs("select",{className:W,value:y.driver,onChange:M=>Y("driver",M.target.value),children:[u.jsx("option",{value:"",children:" ..."}),j.map(M=>u.jsx("option",{value:M,children:M},M))]}),u.jsx("div",{className:P,children:" "})]})]})]}),u.jsxs("div",{className:"flex gap-1 mt-2",children:[u.jsx("input",{className:`${W} border-purple-300`,placeholder:"",value:y.notes,onChange:M=>Y("notes",M.target.value)}),u.jsx("div",{className:P,children:""})]})]}),u.jsxs("div",{className:"w-full lg:w-48 bg-white p-2 border border-gray-300 rounded shadow-sm",children:[u.jsx("div",{className:"text-center font-bold text-gray-600 mb-2 border-b pb-1",children:"Data Out"}),u.jsxs("div",{className:"space-y-2 text-sm",children:[u.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-1",children:[u.jsx("span",{className:"text-gray-500",children:""}),u.jsx("span",{className:"font-bold",children:y.services||"532"})]}),u.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-1",children:[u.jsx("span",{className:"text-gray-500",children:""}),u.jsx("span",{className:"font-bold",children:y.department})]}),u.jsxs("div",{className:"flex justify-between border-b border-gray-100 pb-1",children:[u.jsx("span",{className:"text-gray-500",children:""}),u.jsx("span",{className:"font-bold",children:y.sector||" "})]})]})]})]}),u.jsxs("div",{className:"flex justify-center gap-4 mt-6 py-4 border-t border-b bg-white rounded shadow-sm",children:[u.jsxs("button",{onClick:te,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:ge,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:V,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:be,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:re,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:G,disabled:v,className:"flex flex-col items-center text-indigo-700 hover:text-indigo-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-indigo-600 flex items-center justify-center mb-1 group-hover:bg-indigo-50",children:v?u.jsx("span",{className:"animate-spin text-sm",children:""}):u.jsx("span",{className:"text-lg",children:""})}),u.jsx("span",{className:"text-sm font-bold",children:" "})]})]}),u.jsxs("div",{className:"bg-white border border-gray-300 rounded relative shadow-sm mt-4 overflow-hidden",children:[u.jsxs("div",{className:"bg-gray-100 px-3 py-2 border-b font-bold text-gray-700 flex justify-between items-center",children:[u.jsx("span",{children:"Database"}),u.jsxs("span",{className:"text-xs text-gray-400 font-normal",children:[e.length," Records"]})]}),u.jsx("div",{className:"overflow-x-auto h-64",children:u.jsxs("table",{className:"w-full text-right text-sm border-collapse",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0",children:u.jsx("tr",{children:["","",""," ",""," ","2",""," ","","","","",""].map(M=>u.jsx("th",{className:"border p-2 font-bold whitespace-nowrap text-gray-700",children:M},M))})}),u.jsx("tbody",{children:e.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:14,className:"text-center p-4 text-gray-400",children:"No records found"})}):e.map(M=>u.jsxs("tr",{onClick:()=>{b(M),E(M.id)},className:`cursor-pointer hover:bg-yellow-50 transition-colors ${_===M.id?"bg-blue-100 text-blue-900 font-bold":""}`,children:[u.jsx("td",{className:"border p-1",children:M.id}),u.jsx("td",{className:"border p-1",children:M.date}),u.jsx("td",{className:"border p-1",children:M.branch}),u.jsx("td",{className:"border p-1",children:M.tractor}),u.jsx("td",{className:"border p-1",children:M.machineLocalNo}),u.jsx("td",{className:"border p-1",children:M.attached}),u.jsx("td",{className:"border p-1",children:M.attachedLocalNo}),u.jsx("td",{className:"border p-1",children:M.pivot}),u.jsx("td",{className:"border p-1",children:M.driver}),u.jsx("td",{className:"border p-1",children:M.calculated}),u.jsx("td",{className:"border p-1",children:M.actualOrReturn}),u.jsx("td",{className:"border p-1",children:M.achievement}),u.jsx("td",{className:"border p-1",children:M.unitType}),u.jsx("td",{className:"border p-1",children:M.timeSpent})]},M.id))})]})})]})]}),m==="irrigation"&&u.jsxs("div",{className:"animate-fade-in-up",dir:"rtl",children:[u.jsxs("div",{className:"bg-gray-50 p-6 rounded border border-gray-300 relative mt-4",children:[u.jsx("span",{className:"absolute -top-3 left-3 bg-gray-100 px-2 text-sm font-bold text-gray-700 border border-gray-300 rounded",children:"Run Times Log"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pt-2",children:[u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:F,children:[u.jsx("input",{type:"date",className:W,value:A.date,onChange:M=>ve("date",M.target.value)}),u.jsx("div",{className:P,children:""})]}),u.jsxs("div",{className:F,children:[u.jsxs("select",{className:W,value:A.locationName,onChange:M=>ve("locationName",M.target.value),children:[u.jsx("option",{value:"",children:" ..."}),f.map(M=>u.jsx("option",{value:M.name,children:M.name},M.id))]}),u.jsx("div",{className:P,children:""})]}),u.jsxs("div",{className:F,children:[u.jsxs("select",{className:W,value:A.generatorModel,onChange:M=>ve("generatorModel",M.target.value),children:[u.jsx("option",{value:"",children:" ..."}),d.map(M=>u.jsx("option",{value:M.category||M.id,children:M.category||M.id},M.id))]}),u.jsx("div",{className:P,children:" "})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:F,children:[u.jsx("input",{type:"number",className:W,value:A.engineStart,onChange:M=>ve("engineStart",M.target.value)}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:F,children:[u.jsx("input",{type:"number",className:W,value:A.engineEnd,onChange:M=>ve("engineEnd",M.target.value)}),u.jsx("div",{className:P,children:" "})]}),u.jsxs("div",{className:F,children:[u.jsx("input",{type:"number",className:`${W} bg-yellow-50`,disabled:!0,value:A.totalHours}),u.jsx("div",{className:P,children:" "})]})]}),u.jsx("div",{className:"space-y-3",children:u.jsx("div",{className:"flex flex-col h-full",children:u.jsx("textarea",{className:`${W} h-full py-2 resize-none text-right`,placeholder:"...",value:A.notes,onChange:M=>ve("notes",M.target.value)})})})]})]}),u.jsxs("div",{className:"flex justify-center gap-4 mt-6 py-4 border-t border-b bg-white rounded shadow-sm",children:[u.jsxs("button",{onClick:z,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:se,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:ue,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:Q,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:re,className:"flex flex-col items-center text-green-700 hover:text-green-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-green-600 flex items-center justify-center mb-1 group-hover:bg-green-50",children:u.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),u.jsx("span",{className:"text-sm font-bold",children:""})]}),u.jsxs("button",{onClick:G,disabled:v,className:"flex flex-col items-center text-indigo-700 hover:text-indigo-900 group",children:[u.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-indigo-600 flex items-center justify-center mb-1 group-hover:bg-indigo-50",children:v?u.jsx("span",{className:"animate-spin text-sm",children:""}):u.jsx("span",{className:"text-lg",children:""})}),u.jsx("span",{className:"text-sm font-bold",children:" "})]})]}),u.jsxs("div",{className:"bg-white border border-gray-300 rounded relative shadow-sm mt-4 overflow-hidden",children:[u.jsxs("div",{className:"bg-gray-100 px-3 py-2 border-b font-bold text-gray-700 flex justify-between items-center",children:[u.jsx("span",{children:"Database"}),u.jsxs("span",{className:"text-xs text-gray-400 font-normal",children:[a.length," Records"]})]}),u.jsx("div",{className:"overflow-x-auto h-64",children:u.jsxs("table",{className:"w-full text-right text-sm border-collapse",children:[u.jsx("thead",{className:"bg-gray-50 sticky top-0",children:u.jsx("tr",{children:["","","","","",""," ",""].map(M=>u.jsx("th",{className:"border p-2 font-bold whitespace-nowrap text-gray-700",children:M},M))})}),u.jsx("tbody",{children:a.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:8,className:"text-center p-4 text-gray-400",children:"No records found"})}):a.map(M=>u.jsxs("tr",{onClick:()=>{T(M),I(M.id)},className:`cursor-pointer hover:bg-yellow-50 transition-colors ${k===M.id?"bg-blue-100 text-blue-900 font-bold":""}`,children:[u.jsx("td",{className:"border p-1",children:M.id}),u.jsx("td",{className:"border p-1",children:M.date}),u.jsx("td",{className:"border p-1",children:M.locationName}),u.jsx("td",{className:"border p-1",children:M.generatorModel}),u.jsx("td",{className:"border p-1",children:M.engineStart}),u.jsx("td",{className:"border p-1",children:M.engineEnd}),u.jsx("td",{className:"border p-1",children:M.totalHours}),u.jsx("td",{className:"border p-1",children:M.notes})]},M.id))})]})})]})]})]})},pd=50,Jhe=({items:e,locations:t,sectors:r,divisions:n,history:a,machines:i,bomRecords:l,forecastPeriods:c,onAddPeriod:f,onUpdatePeriod:d,forecastRecords:m,onUpdateForecast:p,currentUser:v,onBulkImport:x})=>{const[y,b]=N.useState("entry"),[_,E]=N.useState("planned"),[A,T]=N.useState(""),[k,I]=N.useState(""),[O,j]=N.useState(""),[B,U]=N.useState(""),[Y,te]=N.useState(""),[V,ge]=N.useState(""),[be,ve]=N.useState(""),[z,ue]=N.useState(""),[se,Q]=N.useState(""),[re,G]=N.useState({}),[P,W]=N.useState(new Set),[F,M]=N.useState(()=>{try{const C=localStorage.getItem("wf_adhoc_config");if(C)return JSON.parse(C);const J=localStorage.getItem("wf_adhoc_ids");return J?JSON.parse(J).map(Ee=>({id:`migrated-${Ee}-${Date.now()}`,itemId:Ee,sectorId:"",divisionId:""})):[]}catch{return[]}});N.useEffect(()=>{localStorage.setItem("wf_adhoc_config",JSON.stringify(F))},[F]);const[le,pe]=N.useState(1),[Ae,oe]=N.useState(""),[ae,ze]=N.useState(""),[q,Je]=N.useState(""),[qe,ot]=N.useState(""),[Ke,He]=N.useState(""),[wt,mt]=N.useState(1),[Ge,ut]=N.useState(""),[ct,dt]=N.useState(""),[at,Wt]=N.useState({status:"Open"}),[Oe,st]=N.useState(""),[Fe,nr]=N.useState(""),[St,Zt]=N.useState(""),[mr,er]=N.useState(""),ar=N.useRef(null),Yr=N.useRef(null),Tr=N.useRef(null),Ba=N.useRef(null);N.useEffect(()=>{pe(1)},[A,k,O,B,Y,_]),N.useEffect(()=>{mt(1)},[Ae,ae,q,qe,Ke,y,Ge,ct]);const ga=c.find(C=>C.id===B),$n=(ga==null?void 0:ga.status)==="Closed",$r=v.role==="admin"||!$n&&!!B,ra=N.useMemo(()=>n.filter(C=>C.sectorId===k),[n,k]),zn=N.useMemo(()=>n.filter(C=>C.sectorId===q),[n,q]),pr=N.useMemo(()=>!A||!k||!O||!B?[]:m.filter(C=>C.locationId===A&&C.sectorId===k&&C.divisionId===O&&C.periodId===B),[m,A,k,O,B]),Hn=N.useMemo(()=>{if(!z||!se||!A)return new Map;const C=new Date(z).getTime(),J=new Date(se).getTime()+1440*60*1e3-1,xe=new Map;return a.forEach(Ee=>{if(Ee.locationId!==A)return;const Ce=new Date(Ee.timestamp).getTime();if(Ce>=C&&Ce<=J){const Se=xe.get(Ee.itemId)||0;xe.set(Ee.itemId,Se+Ee.quantity)}}),xe},[a,A,z,se]),lr=N.useMemo(()=>{if(!A)return new Set;const C=i.filter(Ce=>{var Xe,Ye,pt;const Se=(Xe=t.find(Et=>Et.id===A))==null?void 0:Xe.name;if(!(Ce.locationId===A||Ce.locationId===Se))return!1;if(k&&Ce.sectorId!==k){const Et=(Ye=r.find(nt=>nt.id===k))==null?void 0:Ye.name;if(Ce.sectorId!==Et)return!1}if(O&&Ce.divisionId!==O){const Et=(pt=n.find(nt=>nt.id===O))==null?void 0:pt.name;if(Ce.divisionId!==Et)return!1}return!0}),J=new Set(C.map(Ce=>Ce.modelNo).filter(Boolean)),xe=new Set(C.map(Ce=>Ce.category).filter(Boolean)),Ee=new Set;return l.forEach(Ce=>{(J.has(Ce.modelNo)||xe.has(Ce.machineCategory))&&Ee.add(Ce.itemId)}),Ee},[i,A,k,O,t,r,n,l]),wn=N.useMemo(()=>{let C=[];if(_==="planned")C=e.filter(J=>lr.has(J.id));else{const J=new Set;F.forEach(xe=>{const Ee=!xe.sectorId||xe.sectorId===k,Ce=!xe.divisionId||xe.divisionId===O;Ee&&Ce&&J.add(xe.itemId)}),Y?C=e.filter(xe=>!lr.has(xe.id)):C=e.filter(xe=>{if(lr.has(xe.id))return!1;const Ee=pr.some(Qe=>Qe.itemId===xe.id),Ce=P.has(xe.id),Se=J.has(xe.id);return Ee||Ce||Se})}if(Y){const J=Y.toLowerCase();C=C.filter(xe=>(xe.name||"").toLowerCase().includes(J)||(xe.id||"").toLowerCase().includes(J))}return C.map(J=>{const xe=pr.find(Et=>Et.itemId===J.id),Ee=Hn.get(J.id)||0;let Ce="-",Se="-",Qe="-",Xe=0,Ye=0;const pt=l.find(Et=>Et.itemId===J.id&&i.some(nt=>{var yt;return nt.modelNo===Et.modelNo&&(nt.locationId===A||nt.locationId===((yt=t.find(Rt=>Rt.id===A))==null?void 0:yt.name))}))||l.find(Et=>Et.itemId===J.id);if(pt){Ce=pt.machineCategory,Qe=pt.modelNo,Xe=pt.quantity;const Et=i.filter(nt=>{var yt;return(nt.locationId===A||nt.locationId===((yt=t.find(Rt=>Rt.id===A))==null?void 0:yt.name))&&(nt.modelNo===pt.modelNo||nt.category===pt.machineCategory)});if(Et.length>0)Se=Et[0].brand||"-",Ye=Et.length;else{const nt=i.find(yt=>yt.modelNo===pt.modelNo);nt&&(Se=nt.brand||"-")}}return{...J,forecastQty:re[J.id]??(xe==null?void 0:xe.quantity)??0,referenceQty:Ee,machineName:Ce,brandName:Se,modelNo:Qe,pcsPerMachine:Xe,machineCount:Ye}})},[e,Y,pr,re,Hn,l,i,A,k,O,P,_,lr,F]),zr=N.useMemo(()=>{const C=(le-1)*pd;return wn.slice(C,C+pd)},[wn,le]),na=N.useMemo(()=>{let C=F;if(mr){const J=mr.toLowerCase();C=C.filter(xe=>{const Ee=e.find(Ce=>Ce.id===xe.itemId);return Ee?Ee.name.toLowerCase().includes(J)||Ee.id.toLowerCase().includes(J):!1})}return C.map(J=>{const xe=e.find(Se=>Se.id===J.itemId),Ee=r.find(Se=>Se.id===J.sectorId),Ce=n.find(Se=>Se.id===J.divisionId);return{...J,sectorName:Ee?Ee.name:J.sectorId?J.sectorId:"All Sectors",divisionName:Ce?Ce.name:J.divisionId?J.divisionId:"All Divisions",itemCode:J.itemId,itemName:(xe==null?void 0:xe.name)||"Unknown Item",itemUnit:(xe==null?void 0:xe.unit)||"-",partNo:(xe==null?void 0:xe.partNumber)||"-"}})},[F,e,r,n,mr]),gr=(C,J)=>{const xe=parseInt(J)||0;G(Ee=>({...Ee,[C]:xe}))},Oa=()=>{V&&(W(C=>new Set(C).add(V)),be!==""&&Number(be)>=0&&G(C=>({...C,[V]:Number(be)})),ge(""),ve(""),lr.has(V)||E("manual"))},pn=()=>{if(!A||!k||!O||!B){alert("Please select Location, Sector, Division, and Period.");return}const C=new Date().toISOString(),J=new Map(pr.map(Ce=>[Ce.itemId,Ce]));Object.keys(re).forEach(Ce=>{const Se=re[Ce];if(Se>0){const Qe=`${A}-${O}-${Ce}-${B}`;J.set(Ce,{id:Qe,locationId:A,sectorId:k,divisionId:O,periodId:B,itemId:Ce,quantity:Se,lastUpdated:C,updatedBy:v.username})}else J.delete(Ce)});const xe=Array.from(J.values()),Ee=m.filter(Ce=>!(Ce.locationId===A&&Ce.divisionId===O&&Ce.periodId===B));p([...Ee,...xe]),G({}),alert("Forecast Saved Successfully!")},Ue=()=>{if(!at.id||!at.name||!at.startDate||!at.endDate){alert("Fill all period fields");return}f(at),Wt({status:"Open"})},Le=()=>{const C=jt.json_to_sheet(c),J=jt.book_new();jt.book_append_sheet(J,C,"Forecast_Periods"),mi(J,"Forecast_Periods.xlsx")},it=C=>{var Ee;const J=(Ee=C.target.files)==null?void 0:Ee[0];if(!J)return;const xe=new FileReader;xe.onload=Ce=>{var Qe;const Se=(Qe=Ce.target)==null?void 0:Qe.result;try{const Xe=is(Se,{type:"binary"}),Ye=Xe.Sheets[Xe.SheetNames[0]],pt=jt.sheet_to_json(Ye);if(pt.length===0){alert("File is empty.");return}const Et=[],nt=[];pt.forEach(yt=>{const Rt=String(yt.ID||yt.id||"").trim(),Vt=String(yt.Name||yt.name||"").trim(),Kt=String(yt.startDate||yt["Start Date"]||"").trim(),Ht=String(yt.endDate||yt["End Date"]||"").trim(),Lt=String(yt.status||yt.Status||"Open").trim();if(Rt&&Vt&&Kt&&Ht){const Pr={id:Rt,name:Vt,startDate:Kt,endDate:Ht,status:Lt==="Closed"?"Closed":"Open"};c.find(va=>va.id===Rt)?nt.push(Pr):Et.push(Pr)}}),Et.length>0||nt.length>0?(x("periods",Et,nt),alert(`Processed ${Et.length+nt.length} periods.`)):alert("No valid period rows found.")}catch(Xe){console.error(Xe),alert("Failed to process file.")}},xe.readAsBinaryString(J),C.target.value=""},Tt=()=>{if(!St)return;const C={id:`${Date.now()}-${Math.random()}`,itemId:St,sectorId:Oe,divisionId:Fe};if(F.some(xe=>xe.itemId===C.itemId&&xe.sectorId===C.sectorId&&xe.divisionId===C.divisionId)){alert("This item is already configured for this Sector/Division scope.");return}M(xe=>[...xe,C]),Zt("")},R=C=>{M(J=>J.filter(xe=>xe.id!==C))},ee=()=>{const C=jt.book_new(),J=jt.aoa_to_sheet([["Sector ID","Division ID","Item Code"],["SEC-001","DIV-001","ITM-005"],["","","ITM-007"]]);jt.book_append_sheet(C,J,"Adhoc_Template"),mi(C,"Adhoc_Items_Template.xlsx")},K=C=>{var Ee;const J=(Ee=C.target.files)==null?void 0:Ee[0];if(!J)return;const xe=new FileReader;xe.onload=Ce=>{var Qe;const Se=(Qe=Ce.target)==null?void 0:Qe.result;try{const Xe=is(Se,{type:"binary"}),Ye=Xe.Sheets[Xe.SheetNames[0]],pt=jt.sheet_to_json(Ye);if(pt.length===0){alert("File is empty.");return}let Et=0;const nt=[];pt.forEach(yt=>{const Rt={};Object.keys(yt).forEach(Lt=>Rt[Lt.toLowerCase().replace(/[\s-_]/g,"")]=yt[Lt]);const Vt=String(Rt.sectorid||Rt.sector||"").trim(),Kt=String(Rt.divisionid||Rt.division||"").trim(),Ht=String(Rt.itemcode||Rt.itemid||Rt.item||"").trim();Ht&&e.some(Pr=>Pr.id===Ht)&&(nt.push({id:`${Date.now()}-${Math.random()}`,itemId:Ht,sectorId:Vt,divisionId:Kt}),Et++)}),M(yt=>[...yt,...nt]),alert(`Imported ${Et} ad-hoc items.`)}catch(Xe){console.error(Xe),alert("Failed to process file.")}},xe.readAsBinaryString(J),C.target.value=""},H=()=>{const C=jt.book_new(),J=jt.aoa_to_sheet([["Item Code","Quantity","Item Name (Ref Only)"],["ITM-001",100,"Ball Bearing"],["ITM-002",50,"Hydraulic Fluid"]]);jt.book_append_sheet(C,J,"Forecast_Template"),mi(C,"Forecast_Entry_Template.xlsx")},Z=C=>{var Ee;if(!$r){alert("Period is closed or not selected. Cannot upload.");return}const J=(Ee=C.target.files)==null?void 0:Ee[0];if(!J)return;const xe=new FileReader;xe.onload=Ce=>{var Qe;const Se=(Qe=Ce.target)==null?void 0:Qe.result;try{const Xe=is(Se,{type:"binary"}),Ye=Xe.SheetNames[0],pt=Xe.Sheets[Ye],Et=jt.sheet_to_json(pt,{header:1});if(Et.length<2){alert("File appears empty.");return}const nt=Et[0].map(Lt=>String(Lt).toLowerCase().trim()),yt=nt.findIndex(Lt=>Lt.includes("item")||Lt.includes("code")),Rt=nt.findIndex(Lt=>Lt.includes("qty")||Lt.includes("quantity"));if(yt===-1||Rt===-1){alert("Could not find 'Item Code' or 'Quantity' columns.");return}const Vt={...re};let Kt=0,Ht=0;for(let Lt=1;Lt<Et.length;Lt++){const Pr=Et[Lt];if(!Pr||Pr.length===0)continue;const Fr=Pr[yt],va=Pr[Rt];if(Fr!==void 0&&va!==void 0){const ie=String(Fr).trim(),ce=Number(va);e.some(rt=>rt.id===ie)?ce>=0&&(Vt[ie]=ce,Kt++,W(rt=>new Set(rt).add(ie))):Ht++}}G(Vt),alert(`Import Successful!
Updated ${Kt} items.
${Ht>0?`Skipped ${Ht} items not found in Master Data.`:""}`)}catch(Xe){console.error(Xe),alert("Failed to parse Excel file.")}},xe.readAsBinaryString(J),C.target.value=""},ne=()=>{const C=jt.book_new(),J=jt.aoa_to_sheet([["Period ID","Location ID","Sector ID","Division ID","Item Code","Quantity"],["2025-P1","WH-001","SEC-001","DIV-001","ITM-001",100],["2025-P1","WH-001","SEC-001","DIV-001","ITM-002",50]]);jt.book_append_sheet(C,J,"Bulk_Forecast"),mi(C,"Bulk_Forecast_Upload_Template.xlsx")},L=C=>{var Ee;const J=(Ee=C.target.files)==null?void 0:Ee[0];if(!J)return;const xe=new FileReader;xe.onload=Ce=>{var Qe;const Se=(Qe=Ce.target)==null?void 0:Qe.result;try{const Xe=is(Se,{type:"binary"}),Ye=Xe.Sheets[Xe.SheetNames[0]],pt=jt.sheet_to_json(Ye);if(pt.length===0){alert("File is empty.");return}const Et=[],nt=new Date().toISOString();let yt=0,Rt=0;pt.forEach(Vt=>{const Kt={};Object.keys(Vt).forEach(ce=>Kt[ce.toLowerCase().replace(/[\s-_]/g,"")]=Vt[ce]);const Ht=String(Kt.periodid||Kt.period||"").trim(),Lt=String(Kt.locationid||Kt.location||"").trim(),Pr=String(Kt.sectorid||Kt.sector||"").trim(),Fr=String(Kt.divisionid||Kt.division||"").trim(),va=String(Kt.itemcode||Kt.itemid||"").trim(),ie=Number(Kt.quantity||Kt.qty||0);if(Ht&&Lt&&Pr&&Fr&&va&&ie>=0){const ce=e.some(Ar=>Ar.id===va),rt=t.some(Ar=>Ar.id===Lt);ce&&rt?(Et.push({id:`${Lt}-${Fr}-${va}-${Ht}`,periodId:Ht,locationId:Lt,sectorId:Pr,divisionId:Fr,itemId:va,quantity:ie,lastUpdated:nt,updatedBy:v.username}),yt++):Rt++}else Rt++}),yt>0?(p(Et),alert(`Bulk Import Successful!
Imported/Updated: ${yt} records.
Skipped/Invalid: ${Rt}`)):alert("No valid records found. Check IDs and try again.")}catch(Xe){console.error(Xe),alert("Failed to process file.")}},xe.readAsBinaryString(J),C.target.value=""},he=N.useMemo(()=>{const C=m.filter(Se=>!(ae&&Se.locationId!==ae||q&&Se.sectorId!==q||qe&&Se.divisionId!==qe)),J=new Map;a.forEach(Se=>{if(ae&&Se.locationId!==ae)return;const Qe=`${Se.locationId}|${Se.itemId}`;J.has(Qe)||J.set(Qe,[]),J.get(Qe).push(Se)});const xe=new Map;C.forEach(Se=>{const Qe=`${Se.locationId}|${Se.itemId}`;xe.set(Qe,(xe.get(Qe)||0)+Se.quantity)});const Ee=new Map;return C.forEach(Se=>{const Qe=`${Se.locationId}|${Se.itemId}|${Se.periodId}`,Xe=Ee.get(Qe)||{key:Qe,locationId:Se.locationId,periodId:Se.periodId,itemId:Se.itemId,forecastQty:0};Xe.forecastQty+=Se.quantity,Ee.set(Qe,Xe)}),Array.from(Ee.values()).map(Se=>{const Qe=c.find(Vt=>Vt.id===Se.periodId);let Xe=0;if(Qe){let Vt=new Date(Qe.startDate).getTime(),Kt=new Date(Qe.endDate).getTime();Ge&&ct&&(Vt=new Date(Ge).getTime(),Kt=new Date(ct).getTime(),Kt+=1440*60*1e3-1),Xe=(J.get(`${Se.locationId}|${Se.itemId}`)||[]).reduce((Lt,Pr)=>{const Fr=new Date(Pr.timestamp).getTime();return Fr>=Vt&&Fr<=Kt?Lt+Pr.quantity:Lt},0)}const Ye=Se.forecastQty-Xe;let pt="Exact Issue";const Et=Date.now(),nt=Qe?Et>new Date(Qe.endDate).getTime():!1;Xe===0&&nt?pt="No Issue":Xe>Se.forecastQty?pt="Over-Issue":Xe<Se.forecastQty&&(pt="Under-Issue");const yt=e.find(Vt=>Vt.id===Se.itemId),Rt=xe.get(`${Se.locationId}|${Se.itemId}`)||0;return{...Se,itemName:(yt==null?void 0:yt.name)||"Unknown",itemUnit:(yt==null?void 0:yt.unit)||"",issuedQty:Xe,variance:Ye,status:pt,grandTotal:Rt}})},[m,a,c,e,ae,q,qe,Ge,ct]),fe=N.useMemo(()=>he.filter(C=>{if(Ae&&C.periodId!==Ae)return!1;if(Ke){const J=Ke.toLowerCase();return C.itemId.toLowerCase().includes(J)||C.itemName.toLowerCase().includes(J)}return!0}),[he,Ae,Ke]),de=N.useMemo(()=>{const C=(wt-1)*pd;return fe.slice(C,C+pd)},[fe,wt]),we=()=>{const C=jt.json_to_sheet(fe),J=jt.book_new();jt.book_append_sheet(J,C,"Forecast_Variance"),mi(J,"Forecast_Variance_Analysis.xlsx")},Pe=(C,J,xe)=>{const Ee=Math.ceil(C/pd);return Ee<=1?null:u.jsxs("div",{className:"flex justify-between items-center p-3 border-t bg-gray-50 text-xs mt-auto sticky bottom-0",children:[u.jsx("button",{disabled:J===1,onClick:()=>xe(J-1),className:"px-3 py-1 border rounded bg-white disabled:opacity-50 hover:bg-gray-100",children:"Previous"}),u.jsxs("span",{children:["Page ",J," of ",Ee," (",C," records)"]}),u.jsx("button",{disabled:J===Ee,onClick:()=>xe(J+1),className:"px-3 py-1 border rounded bg-white disabled:opacity-50 hover:bg-gray-100",children:"Next"})]})},Re=N.useMemo(()=>e.map(C=>({id:C.id,label:C.id,subLabel:C.name})),[e]),Ve=N.useMemo(()=>n.filter(C=>!Oe||C.sectorId===Oe),[n,Oe]);return u.jsxs("div",{className:"flex flex-col min-h-full space-y-4 animate-fade-in-up font-cairo",children:[u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex justify-between items-center shrink-0",children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[u.jsx("span",{children:""})," Material Forecasting"]}),u.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg overflow-x-auto",children:[u.jsx("button",{onClick:()=>b("entry"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${y==="entry"?"bg-white text-teal-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Entry Form"}),u.jsx("button",{onClick:()=>b("hub"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${y==="hub"?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Aggregation Hub"}),u.jsx("button",{onClick:()=>b("analytics"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${y==="analytics"?"bg-white text-purple-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Variance Analysis"}),v.role==="admin"&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>b("admin"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${y==="admin"?"bg-white text-orange-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Period Settings"}),u.jsx("button",{onClick:()=>b("config"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${y==="config"?"bg-white text-indigo-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Ad-hoc Config"})]})]})]}),y==="entry"&&u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex flex-col flex-1",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-4 shrink-0",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"1. Location"}),u.jsxs("select",{value:A,onChange:C=>T(C.target.value),className:"w-full border rounded p-2 text-sm",children:[u.jsx("option",{value:"",children:"Select Location"}),t.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"2. Sector"}),u.jsxs("select",{value:k,onChange:C=>{I(C.target.value),j("")},className:"w-full border rounded p-2 text-sm",children:[u.jsx("option",{value:"",children:"Select Sector"}),r.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"3. Division"}),u.jsxs("select",{value:O,onChange:C=>j(C.target.value),disabled:!k,className:"w-full border rounded p-2 text-sm",children:[u.jsx("option",{value:"",children:"Select Division"}),ra.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"4. Forecast Period"}),u.jsxs("select",{value:B,onChange:C=>U(C.target.value),className:"w-full border rounded p-2 text-sm font-bold text-blue-700",children:[u.jsx("option",{value:"",children:"Select Slot"}),c.map(C=>u.jsxs("option",{value:C.id,children:[C.name," (",C.status,")"]},C.id))]})]})]}),B&&u.jsx("div",{className:`p-2 mb-4 rounded text-center text-sm font-bold shrink-0 ${$n?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:$n?" PERIOD CLOSED - Read Only":" PERIOD OPEN - Editing Enabled"}),u.jsxs("div",{className:"flex gap-4 border-b border-gray-200 mb-4 shrink-0",children:[u.jsx("button",{onClick:()=>E("planned"),className:`pb-2 px-1 text-sm font-bold border-b-2 transition ${_==="planned"?"border-teal-600 text-teal-700":"border-transparent text-gray-500 hover:text-gray-700"}`,children:" Planned Items (BOM)"}),u.jsx("button",{onClick:()=>E("manual"),className:`pb-2 px-1 text-sm font-bold border-b-2 transition ${_==="manual"?"border-teal-600 text-teal-700":"border-transparent text-gray-500 hover:text-gray-700"}`,children:" Other Items (Ad-hoc)"})]}),u.jsxs("div",{className:"mb-4 p-4 bg-gray-50 border border-gray-200 rounded shrink-0 space-y-4",children:[u.jsxs("div",{className:"flex flex-col md:flex-row gap-3 items-end",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Add Item to Forecast"}),u.jsx(Sr,{label:"",placeholder:"Search Item Code or Name...",options:Re,value:V,onChange:ge,disabled:!$r,compact:!0})]}),u.jsxs("div",{className:"w-32",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-600 mb-1",children:"Forecast Qty"}),u.jsx("input",{type:"number",min:"0",value:be,onChange:C=>ve(Number(C.target.value)),disabled:!$r,className:"w-full px-2 py-1.5 border border-gray-300 rounded text-sm h-[38px]"})]}),u.jsx("button",{onClick:Oa,disabled:!$r||!V,className:"px-4 py-2 bg-blue-600 text-white font-bold rounded hover:bg-blue-700 text-sm h-[38px] disabled:bg-gray-300",children:"+ Add Row"})]}),u.jsxs("div",{className:"flex flex-wrap items-center gap-2 pt-2 border-t border-gray-200",children:[u.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase tracking-wide",children:"Actuals Reference:"}),u.jsx("input",{type:"date",value:z,onChange:C=>ue(C.target.value),className:"border rounded px-2 py-1 text-xs text-gray-700"}),u.jsx("span",{className:"text-gray-400",children:""}),u.jsx("input",{type:"date",value:se,onChange:C=>Q(C.target.value),className:"border rounded px-2 py-1 text-xs text-gray-700"}),(z||se)&&u.jsx("button",{onClick:()=>{ue(""),Q("")},className:"text-xs text-red-600 hover:underline font-bold ml-auto",children:"Clear Dates"})]})]}),u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 mb-2 shrink-0",children:[u.jsx("div",{className:"w-full md:flex-1",children:u.jsx("input",{type:"text",placeholder:`Filter ${_} list...`,value:Y,onChange:C=>te(C.target.value),className:"w-full p-2 border rounded text-sm focus:ring-2 focus:ring-blue-500 outline-none"})}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:H,className:"px-3 py-2 bg-gray-100 text-gray-700 rounded text-xs font-bold hover:bg-gray-200 border border-gray-300 flex items-center gap-1",children:[u.jsx("span",{children:""})," Template"]}),u.jsxs("button",{onClick:()=>{var C;return(C=ar.current)==null?void 0:C.click()},disabled:!$r,className:`px-3 py-2 bg-green-50 text-green-700 rounded text-xs font-bold hover:bg-green-100 border border-green-200 flex items-center gap-1 ${$r?"":"opacity-50 cursor-not-allowed"}`,children:[u.jsx("span",{children:""})," Upload Excel"]}),u.jsx("input",{type:"file",ref:ar,hidden:!0,accept:".xlsx,.xls,.csv",onChange:Z})]})]}),u.jsx("div",{className:"flex-1 overflow-auto border rounded relative min-h-[600px]",children:u.jsxs("table",{className:"w-full text-left text-xs whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-50 text-gray-700 sticky top-0 z-10 shadow-sm font-bold uppercase",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3 border-b",children:"Item Code"}),u.jsx("th",{className:"p-3 border-b",children:"Part No"}),u.jsx("th",{className:"p-3 border-b",children:"Description"}),u.jsx("th",{className:"p-3 border-b text-center text-gray-500",children:"Unit"}),u.jsx("th",{className:"p-3 border-b bg-blue-50 text-blue-800",children:"Machine Name"}),u.jsx("th",{className:"p-3 border-b bg-blue-50 text-blue-800",children:"Brand"}),u.jsx("th",{className:"p-3 border-b bg-blue-50 text-blue-800",children:"Model"}),u.jsx("th",{className:"p-3 border-b bg-blue-50 text-blue-800 text-center",children:"Pcs/Mach"}),u.jsx("th",{className:"p-3 border-b bg-orange-50 text-orange-800 text-center",children:"Mach Count"}),u.jsx("th",{className:`p-3 border-b text-center ${z&&se?"bg-yellow-50 text-yellow-800":"text-gray-400"}`,children:"Actuals (Ref)"}),u.jsx("th",{className:"p-3 border-b text-center bg-green-50 text-green-800 font-extrabold text-sm border-l-2 border-green-200",children:"Forecast Qty"})]})}),u.jsx("tbody",{children:!A||!O||!B?u.jsx("tr",{children:u.jsx("td",{colSpan:11,className:"p-8 text-center text-gray-400",children:"Select all hierarchy fields above to load items."})}):zr.length===0?u.jsx("tr",{children:u.jsxs("td",{colSpan:11,className:"p-8 text-center text-gray-400",children:["No items found in ",_," list."]})}):zr.map(C=>u.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-100",children:[u.jsx("td",{className:"p-3 font-mono text-gray-600 font-bold",children:C.id}),u.jsx("td",{className:"p-3 font-mono text-gray-600",children:C.partNumber||"-"}),u.jsx("td",{className:"p-3 font-medium text-gray-800",children:C.name}),u.jsx("td",{className:"p-3 text-center text-gray-500",children:C.unit||"-"}),u.jsx("td",{className:"p-3 text-gray-600 bg-blue-50/20",children:C.machineName!=="-"?C.machineName:""}),u.jsx("td",{className:"p-3 text-gray-600 bg-blue-50/20",children:C.brandName!=="-"?C.brandName:""}),u.jsx("td",{className:"p-3 text-gray-600 bg-blue-50/20",children:C.modelNo!=="-"?C.modelNo:""}),u.jsx("td",{className:"p-3 text-center text-gray-600 bg-blue-50/20",children:C.pcsPerMachine>0?C.pcsPerMachine:"-"}),u.jsx("td",{className:"p-3 text-center font-bold text-orange-700 bg-orange-50/20",children:C.machineCount>0?C.machineCount:"-"}),u.jsx("td",{className:`p-3 text-center font-bold border-l border-r ${z&&se?"bg-yellow-50 text-gray-700":"text-gray-300"}`,children:C.referenceQty}),u.jsx("td",{className:"p-2 text-center bg-green-50/30 border-l-2 border-green-100",children:u.jsx("input",{type:"number",min:"0",disabled:!$r,value:C.forecastQty,onChange:J=>gr(C.id,J.target.value),className:"w-24 p-1.5 border border-green-200 rounded text-center font-bold text-lg focus:ring-2 focus:ring-green-500 outline-none"})})]},C.id))})]})}),Pe(wn.length,le,pe),u.jsx("div",{className:"pt-4 border-t mt-4 flex justify-end shrink-0",children:u.jsx("button",{onClick:pn,disabled:!$r||Object.keys(re).length===0,className:"px-6 py-2 bg-blue-600 text-white font-bold rounded shadow hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition",children:"Save Changes"})})]}),(y==="hub"||y==="analytics")&&u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex flex-col flex-1 overflow-hidden min-h-0",children:[u.jsxs("div",{className:"flex flex-col xl:flex-row justify-between items-start xl:items-end mb-4 gap-4 shrink-0",children:[u.jsxs("div",{className:"flex-1 w-full",children:[u.jsx("h3",{className:"font-bold text-gray-700 mb-3",children:y==="hub"?"Aggregated Demand (Hub)":"Forecast vs. Actuals"}),u.jsxs("div",{className:"flex flex-wrap gap-2 items-center",children:[u.jsxs("select",{value:Ae,onChange:C=>oe(C.target.value),className:"border rounded p-2 text-sm bg-gray-50 w-32",children:[u.jsx("option",{value:"",children:"All Periods"}),c.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]}),u.jsxs("select",{value:ae,onChange:C=>ze(C.target.value),className:"border rounded p-2 text-sm bg-gray-50 w-36",children:[u.jsx("option",{value:"",children:"All Locations"}),t.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]}),u.jsxs("select",{value:q,onChange:C=>{Je(C.target.value),ot("")},className:"border rounded p-2 text-sm bg-gray-50 w-36",children:[u.jsx("option",{value:"",children:"All Sectors"}),r.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]}),u.jsxs("select",{value:qe,onChange:C=>ot(C.target.value),disabled:!q,className:"border rounded p-2 text-sm bg-gray-50 w-36",children:[u.jsx("option",{value:"",children:"All Divisions"}),zn.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]}),u.jsx("input",{type:"text",placeholder:"Filter items...",value:Ke,onChange:C=>He(C.target.value),className:"border rounded p-2 text-sm w-40"})]}),y==="analytics"&&u.jsxs("div",{className:"mt-3 flex items-center gap-2 bg-yellow-50 p-2 rounded border border-yellow-200 w-fit",children:[u.jsx("span",{className:"text-xs font-bold text-yellow-800 uppercase",children:"Override Actuals Date Range:"}),u.jsx("input",{type:"date",value:Ge,onChange:C=>ut(C.target.value),className:"border rounded px-2 py-1 text-xs",title:"Start Date"}),u.jsx("span",{className:"text-gray-400",children:""}),u.jsx("input",{type:"date",value:ct,onChange:C=>dt(C.target.value),className:"border rounded px-2 py-1 text-xs",title:"End Date"}),(Ge||ct)&&u.jsx("button",{onClick:()=>{ut(""),dt("")},className:"text-xs text-red-600 font-bold hover:underline ml-2",children:"Clear"})]})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:ne,className:"px-3 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded text-sm font-bold hover:bg-blue-100 whitespace-nowrap",title:"Download Bulk Template",children:" Template"}),u.jsx("button",{onClick:()=>{var C;return(C=Yr.current)==null?void 0:C.click()},className:"px-3 py-1 bg-orange-50 text-orange-700 border border-orange-200 rounded text-sm font-bold hover:bg-orange-100 whitespace-nowrap",children:" Upload Data"}),u.jsx("input",{type:"file",ref:Yr,hidden:!0,accept:".xlsx,.xls,.csv",onChange:L}),u.jsx("button",{onClick:we,className:"px-3 py-1 bg-green-50 text-green-700 border border-green-200 rounded text-sm font-bold hover:bg-green-100 whitespace-nowrap",children:"Export Excel"})]})]}),u.jsx("div",{className:"flex-1 overflow-auto border rounded relative",children:u.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0 z-10 shadow-sm",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3 border-b",children:"Period"}),u.jsx("th",{className:"p-3 border-b",children:"Location"}),u.jsx("th",{className:"p-3 border-b",children:"Item Code"}),u.jsx("th",{className:"p-3 border-b",children:"Description"}),u.jsx("th",{className:"p-3 border-b text-center",children:"Unit"}),u.jsx("th",{className:"p-3 border-b text-right",children:"Period Forecast"}),u.jsx("th",{className:"p-3 border-b text-right bg-gray-50 border-l border-gray-200",children:"Total All Periods"}),y==="analytics"&&u.jsxs(u.Fragment,{children:[u.jsxs("th",{className:`p-3 border-b text-right ${Ge&&ct?"bg-yellow-100 text-yellow-900 border-yellow-200":""}`,children:["Issued Qty ",Ge&&ct?"(Custom Range)":""]}),u.jsx("th",{className:"p-3 border-b text-right",children:"Variance"}),u.jsx("th",{className:"p-3 border-b text-center",children:"Status"})]})]})}),u.jsxs("tbody",{children:[de.map((C,J)=>{var xe;return u.jsxs("tr",{className:"hover:bg-gray-50 border-b border-gray-100",children:[u.jsx("td",{className:"p-3",children:C.periodId}),u.jsx("td",{className:"p-3",children:((xe=t.find(Ee=>Ee.id===C.locationId))==null?void 0:xe.name)||C.locationId}),u.jsx("td",{className:"p-3 font-mono",children:C.itemId}),u.jsx("td",{className:"p-3",children:C.itemName}),u.jsx("td",{className:"p-3 text-center text-gray-500",children:C.itemUnit}),u.jsx("td",{className:"p-3 text-right font-bold text-blue-700",children:C.forecastQty}),u.jsx("td",{className:"p-3 text-right font-bold text-gray-600 bg-gray-50 border-l border-gray-200",children:C.grandTotal}),y==="analytics"&&u.jsxs(u.Fragment,{children:[u.jsx("td",{className:`p-3 text-right font-bold ${Ge&&ct?"bg-yellow-50 text-yellow-800":"text-blue-700"}`,children:C.issuedQty}),u.jsx("td",{className:`p-3 text-right font-bold ${C.variance<0?"text-red-600":"text-green-600"}`,children:C.variance}),u.jsx("td",{className:"p-3 text-center",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold 
                                                    ${C.status==="Over-Issue"?"bg-red-100 text-red-800":C.status==="Under-Issue"?"bg-yellow-100 text-yellow-800":C.status==="No Issue"?"bg-gray-200 text-gray-600":"bg-green-100 text-green-800"}`,children:C.status})})]})]},J)}),fe.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:10,className:"p-8 text-center text-gray-400",children:"No data found matching filters."})})]})]})}),Pe(fe.length,wt,mt)]}),y==="config"&&u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex flex-col flex-1 overflow-hidden min-h-0",children:[u.jsxs("div",{className:"flex justify-between items-start mb-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-gray-700 mb-1",children:"Ad-hoc Items Configuration"}),u.jsx("p",{className:"text-sm text-gray-500",children:'Define items that should always appear in the "Other Items" list for specific sectors/divisions.'})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:ee,className:"px-3 py-1 bg-blue-50 text-blue-700 border border-blue-200 rounded text-sm font-bold hover:bg-blue-100",children:" Template"}),u.jsx("button",{onClick:()=>{var C;return(C=Tr.current)==null?void 0:C.click()},className:"px-3 py-1 bg-orange-50 text-orange-700 border border-orange-200 rounded text-sm font-bold hover:bg-orange-100",children:" Upload Excel"}),u.jsx("input",{type:"file",ref:Tr,hidden:!0,accept:".xlsx,.xls,.csv",onChange:K})]})]}),u.jsxs("div",{className:"flex flex-wrap gap-2 items-end bg-gray-50 p-3 rounded-lg border border-gray-200 mb-4 shrink-0",children:[u.jsxs("div",{className:"w-48",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Scope: Sector (Optional)"}),u.jsxs("select",{className:"w-full border rounded p-1.5 text-sm",value:Oe,onChange:C=>{st(C.target.value),nr("")},children:[u.jsx("option",{value:"",children:"All Sectors (Global)"}),r.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]})]}),u.jsxs("div",{className:"w-48",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Scope: Division (Optional)"}),u.jsxs("select",{className:"w-full border rounded p-1.5 text-sm",value:Fe,onChange:C=>nr(C.target.value),disabled:!Oe,children:[u.jsx("option",{value:"",children:"All Divisions"}),Ve.map(C=>u.jsx("option",{value:C.id,children:C.name},C.id))]})]}),u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Select Item to Add"}),u.jsx(Sr,{label:"",placeholder:"Search item...",options:Re,value:St,onChange:Zt,compact:!0})]}),u.jsx("button",{onClick:Tt,disabled:!St,className:"px-4 py-1.5 bg-green-600 text-white font-bold rounded hover:bg-green-700 text-sm h-[36px] disabled:bg-gray-300",children:"+ Add Configuration"})]}),u.jsxs("div",{className:"flex-1 overflow-auto border rounded relative",children:[u.jsx("div",{className:"absolute top-0 right-0 p-2 z-10",children:u.jsx("input",{className:"border rounded p-1 text-xs w-48 shadow-sm",placeholder:"Filter table...",value:mr,onChange:C=>er(C.target.value)})}),u.jsxs("table",{className:"w-full text-left text-xs whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0 shadow-sm",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3 border-b",children:"Scope: Sector"}),u.jsx("th",{className:"p-3 border-b",children:"Scope: Division"}),u.jsx("th",{className:"p-3 border-b",children:"Item Code"}),u.jsx("th",{className:"p-3 border-b",children:"Description"}),u.jsx("th",{className:"p-3 border-b",children:"Part No"}),u.jsx("th",{className:"p-3 border-b text-center",children:"Unit"}),u.jsx("th",{className:"p-3 border-b text-center",children:"Action"})]})}),u.jsxs("tbody",{children:[na.map(C=>u.jsxs("tr",{className:"hover:bg-blue-50 border-b border-gray-50",children:[u.jsx("td",{className:"p-3 font-medium text-gray-600",children:C.sectorName}),u.jsx("td",{className:"p-3 text-gray-500",children:C.divisionName}),u.jsx("td",{className:"p-3 font-mono font-bold text-blue-700",children:C.itemCode}),u.jsx("td",{className:"p-3",children:C.itemName}),u.jsx("td",{className:"p-3 font-mono",children:C.partNo}),u.jsx("td",{className:"p-3 text-center",children:C.itemUnit}),u.jsx("td",{className:"p-3 text-center",children:u.jsx("button",{onClick:()=>R(C.id),className:"text-red-500 hover:bg-red-50 p-1 rounded font-bold px-2",children:"Delete"})})]},C.id)),na.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"p-8 text-center text-gray-400",children:"No ad-hoc configurations found."})})]})]})]})]}),y==="admin"&&u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex flex-col flex-1 overflow-hidden min-h-0",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 shrink-0",children:[u.jsx("h3",{className:"font-bold text-gray-700",children:"Period Management"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:Le,className:"px-3 py-1 bg-green-50 text-green-700 border border-green-200 rounded text-sm font-bold hover:bg-green-100 flex items-center gap-1",children:[u.jsx("span",{children:""})," Export"]}),u.jsxs("button",{onClick:()=>{var C;return(C=Ba.current)==null?void 0:C.click()},className:"px-3 py-1 bg-orange-50 text-orange-700 border border-orange-200 rounded text-sm font-bold hover:bg-orange-100 flex items-center gap-1",children:[u.jsx("span",{children:""})," Import"]}),u.jsx("input",{type:"file",ref:Ba,hidden:!0,accept:".xlsx,.xls,.csv",onChange:it})]})]}),u.jsxs("div",{className:"grid grid-cols-5 gap-3 mb-6 bg-gray-50 p-4 rounded border shrink-0",children:[u.jsx("input",{className:"border p-2 rounded text-sm",placeholder:"ID (e.g. 2025-P1)",value:at.id||"",onChange:C=>Wt({...at,id:C.target.value})}),u.jsx("input",{className:"border p-2 rounded text-sm",placeholder:"Name (e.g. Oct-Jan)",value:at.name||"",onChange:C=>Wt({...at,name:C.target.value})}),u.jsx("input",{type:"date",className:"border p-2 rounded text-sm",value:at.startDate||"",onChange:C=>Wt({...at,startDate:C.target.value})}),u.jsx("input",{type:"date",className:"border p-2 rounded text-sm",value:at.endDate||"",onChange:C=>Wt({...at,endDate:C.target.value})}),u.jsx("button",{onClick:Ue,className:"bg-green-600 text-white rounded font-bold text-sm",children:"Add Period"})]}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsxs("table",{className:"w-full text-left text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3",children:"ID"}),u.jsx("th",{className:"p-3",children:"Name"}),u.jsx("th",{className:"p-3",children:"Start Date"}),u.jsx("th",{className:"p-3",children:"End Date"}),u.jsx("th",{className:"p-3",children:"Status"}),u.jsx("th",{className:"p-3",children:"Action"})]})}),u.jsx("tbody",{children:c.map(C=>u.jsxs("tr",{className:"border-b",children:[u.jsx("td",{className:"p-3 font-mono",children:C.id}),u.jsx("td",{className:"p-3",children:C.name}),u.jsx("td",{className:"p-3",children:u.jsx("input",{type:"date",value:C.startDate,onChange:J=>d({...C,startDate:J.target.value}),className:"border rounded p-1 text-xs"})}),u.jsx("td",{className:"p-3",children:u.jsx("input",{type:"date",value:C.endDate,onChange:J=>d({...C,endDate:J.target.value}),className:"border rounded p-1 text-xs"})}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs ${C.status==="Open"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:C.status})}),u.jsx("td",{className:"p-3",children:u.jsx("button",{onClick:()=>d({...C,status:C.status==="Open"?"Closed":"Open"}),className:"text-blue-600 hover:underline text-xs font-bold",children:C.status==="Open"?"Close Period":"Re-open"})})]},C.id))})]})})]})]})},Zhe=()=>{const[e,t]=N.useState(""),[r,n]=N.useState(""),[a,i]=N.useState(!1),l=async()=>{if(e.trim()){i(!0),n("");try{const c=await SB(e);n(c)}catch{n("Error generating response.")}finally{i(!1)}}};return u.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"p-3 bg-indigo-100 rounded-lg text-indigo-600",children:u.jsx("span",{className:"text-2xl",children:""})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"AI Assistant"}),u.jsx("p",{className:"text-gray-500 text-sm",children:"Generate text, draft emails, or ask questions about warehouse operations."})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"What would you like to generate?"}),u.jsx("textarea",{value:e,onChange:c=>t(c.target.value),placeholder:"e.g., Write a safety memo for the forklift team, or summarize standard procedure for receiving goods...",className:"w-full h-32 p-4 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 outline-none resize-none"})]}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{onClick:l,disabled:a||!e.trim(),className:`px-6 py-2 rounded-lg font-medium text-white shadow-sm transition-all flex items-center space-x-2 ${a||!e.trim()?"bg-gray-400 cursor-not-allowed":"bg-indigo-600 hover:bg-indigo-700 hover:shadow-md"}`,children:a?u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),u.jsx("span",{children:"Generating..."})]}):u.jsxs(u.Fragment,{children:[u.jsx("span",{children:""}),u.jsx("span",{children:"Generate Text"})]})})})]})]}),r&&u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 animate-fade-in-up",children:[u.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center",children:[u.jsx("span",{className:"text-indigo-600 mr-2",children:""})," Generated Response"]}),u.jsx("div",{className:"bg-gray-50 p-6 rounded-lg border border-gray-100 prose max-w-none",children:u.jsx("div",{className:"whitespace-pre-wrap text-gray-800 leading-relaxed font-sans",children:r})}),u.jsx("div",{className:"mt-4 flex justify-end",children:u.jsxs("button",{onClick:()=>{navigator.clipboard.writeText(r),alert("Copied to clipboard!")},className:"text-indigo-600 text-sm font-medium hover:text-indigo-800 flex items-center space-x-1",children:[u.jsx("span",{children:""})," ",u.jsx("span",{children:"Copy to Clipboard"})]})})]})]})},bb=100,eme=({items:e,onUpdateItem:t,purchaseOrders:r,onAddPO:n,machines:a,locations:i})=>{const[l,c]=N.useState("master"),[f,d]=N.useState(""),[m,p]=N.useState(null),[v,x]=N.useState(1),[y,b]=N.useState({status:"Open"}),[_,E]=N.useState(""),A=N.useMemo(()=>e.filter(z=>z.id.toLowerCase().includes(f.toLowerCase())||z.name.toLowerCase().includes(f.toLowerCase())),[e,f]);N.useMemo(()=>{x(1)},[f]);const T=N.useMemo(()=>{const z=(v-1)*bb;return A.slice(z,z+bb)},[A,v]),k=Math.ceil(A.length/bb),I=()=>k<=1?null:u.jsxs("div",{className:"flex justify-between items-center p-3 border-t bg-gray-50 text-xs mt-auto shrink-0",children:[u.jsx("button",{disabled:v===1,onClick:()=>x(z=>Math.max(1,z-1)),className:"px-3 py-1 border rounded bg-white disabled:opacity-50 hover:bg-gray-100 transition",children:"Previous"}),u.jsxs("span",{className:"font-semibold text-gray-600",children:["Page ",v," of ",k," (",A.length," items)"]}),u.jsx("button",{disabled:v===k,onClick:()=>x(z=>Math.min(k,z+1)),className:"px-3 py-1 border rounded bg-white disabled:opacity-50 hover:bg-gray-100 transition",children:"Next"})]}),O=N.useMemo(()=>e.map(ue=>{const se=r.filter(M=>M.itemId===ue.id&&M.status==="Open").reduce((M,le)=>M+le.orderedQuantity,0),Q=ue.stockQuantity||0,re=Q+se,G=ue.reorderPoint||0,P=ue.maxStock||0;let W="OK",F=0;return G>0&&re<=G?(W="Reorder",F=P>0?P-re:G*2-re,F<0&&(F=0)):P>0&&Q>P&&(W="Excess"),{...ue,inTransit:se,availableStock:re,status:W,suggestedOrder:F}}),[e,r]),j=O.filter(z=>z.status==="Reorder"),B=O.filter(z=>z.status==="Excess"),U=()=>{const z=[...e].map(re=>({...re,usageValue:(re.annualUsage||0)*(re.unitCost||0)})).sort((re,G)=>G.usageValue-re.usageValue),ue=z.reduce((re,G)=>re+G.usageValue,0);let se=0;z.map(re=>{se+=re.usageValue;const G=ue>0?se/ue*100:0;let P="C";return G<=80?P="A":G<=95?P="B":P="C",{...re,abcClass:P}}).forEach(re=>{const G=e.find(P=>P.id===re.id);G&&G.abcClass!==re.abcClass&&t(re)}),alert("ABC Classification Recalculated based on Annual Usage Value.")},Y=z=>{z.preventDefault(),m&&(t(m),p(null))},te=()=>{if(!y.supplier||!y.itemId||!y.orderedQuantity){alert("Fill required fields");return}const z={id:`PO-${Date.now()}`,supplier:y.supplier,itemId:y.itemId,orderedQuantity:Number(y.orderedQuantity),expectedDeliveryDate:y.expectedDeliveryDate||new Date().toISOString().slice(0,10),status:"Open"};n(z),b({status:"Open"})},V=()=>{const z=j.map(Q=>({"Item Code":Q.id,Description:Q.name,Supplier:Q.preferredSupplier,"Current Stock":Q.stockQuantity,"In Transit":Q.inTransit,"Reorder Point":Q.reorderPoint,"Max Stock":Q.maxStock,"Suggested Qty":Q.suggestedOrder})),ue=jt.book_new(),se=jt.json_to_sheet(z);jt.book_append_sheet(ue,se,"Reorder Report"),mi(ue,"MRO_Reorder_Report.xlsx")},ge=()=>u.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 shrink-0",children:[u.jsxs("div",{className:"relative w-64",children:[u.jsx("input",{type:"text",placeholder:"Search items...",className:"w-full pl-8 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:f,onChange:z=>d(z.target.value)}),u.jsx("span",{className:"absolute left-2.5 top-2.5 text-gray-400",children:""})]}),u.jsxs("div",{className:"flex gap-2 text-sm text-gray-500 items-center",children:[u.jsxs("span",{children:["Displaying ",T.length," of ",A.length," items"]}),u.jsx("button",{onClick:U,className:"px-4 py-2 bg-purple-100 text-purple-700 rounded-lg font-bold hover:bg-purple-200 text-sm ml-2",children:" Recalc ABC"})]})]}),u.jsx("div",{className:"flex-1 overflow-auto border rounded-lg bg-gray-50",children:u.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0 shadow-sm z-10",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3 border-b",children:"Item Code"}),u.jsx("th",{className:"p-3 border-b",children:"Description"}),u.jsx("th",{className:"p-3 border-b",children:"Category"}),u.jsx("th",{className:"p-3 text-center border-b",children:"Min"}),u.jsx("th",{className:"p-3 text-center border-b",children:"Max"}),u.jsx("th",{className:"p-3 text-center border-b",children:"Reorder Pt"}),u.jsx("th",{className:"p-3 text-center border-b",children:"Stock"}),u.jsx("th",{className:"p-3 text-center border-b",children:"Pipeline"}),u.jsx("th",{className:"p-3 text-center border-b",children:"Annual Usage"}),u.jsx("th",{className:"p-3 border-b",children:"ABC"}),u.jsx("th",{className:"p-3 border-b",children:"Criticality"}),u.jsx("th",{className:"p-3 text-right border-b",children:"Action"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-100 bg-white",children:[T.map(z=>{const ue=O.find(se=>se.id===z.id)||{inTransit:0};return u.jsxs("tr",{className:"hover:bg-blue-50 transition-colors",children:[u.jsx("td",{className:"p-3 font-mono font-bold text-gray-600 border-r",children:z.id}),u.jsx("td",{className:"p-3 border-r max-w-xs truncate",title:z.name,children:z.name}),u.jsx("td",{className:"p-3 text-gray-500 border-r",children:z.category}),u.jsx("td",{className:"p-3 text-center text-xs border-r",children:z.minStock||0}),u.jsx("td",{className:"p-3 text-center text-xs border-r",children:z.maxStock||0}),u.jsx("td",{className:"p-3 text-center font-bold text-orange-600 border-r",children:z.reorderPoint||"-"}),u.jsx("td",{className:"p-3 text-center font-bold border-r",children:z.stockQuantity}),u.jsx("td",{className:"p-3 text-center text-blue-600 font-bold border-r",children:ue.inTransit||0}),u.jsx("td",{className:"p-3 text-center text-gray-500 border-r",children:z.annualUsage||0}),u.jsx("td",{className:"p-3 text-center border-r",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${z.abcClass==="A"?"bg-green-100 text-green-800":z.abcClass==="B"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-600"}`,children:z.abcClass||"-"})}),u.jsx("td",{className:"p-3 border-r",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs ${z.criticality==="High"?"bg-red-100 text-red-800":"text-gray-600"}`,children:z.criticality||"-"})}),u.jsx("td",{className:"p-3 text-right",children:u.jsx("button",{onClick:()=>p(z),className:"text-blue-600 hover:underline text-xs font-bold",children:"Edit"})})]},z.id)}),T.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:12,className:"p-8 text-center text-gray-400",children:"No items found."})})]})]})}),I(),m&&u.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden flex flex-col animate-fade-in-up",children:[u.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[u.jsxs("h3",{className:"font-bold text-lg",children:["Edit MRO Data: ",m.id]}),u.jsx("button",{onClick:()=>p(null),className:"text-gray-500 hover:text-gray-800",children:""})]}),u.jsxs("form",{onSubmit:Y,className:"p-6 overflow-y-auto grid grid-cols-2 gap-4",children:[u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Description"}),u.jsx("input",{className:"w-full border rounded p-2",value:m.name,onChange:z=>p({...m,name:z.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Category"}),u.jsx("input",{className:"w-full border rounded p-2",value:m.category,onChange:z=>p({...m,category:z.target.value})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Min Stock"}),u.jsx("input",{type:"number",className:"w-full border rounded p-2",value:m.minStock||"",onChange:z=>p({...m,minStock:Number(z.target.value)})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Max Stock"}),u.jsx("input",{type:"number",className:"w-full border rounded p-2",value:m.maxStock||"",onChange:z=>p({...m,maxStock:Number(z.target.value)})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Reorder Point"}),u.jsx("input",{type:"number",className:"w-full border rounded p-2 bg-orange-50",value:m.reorderPoint||"",onChange:z=>p({...m,reorderPoint:Number(z.target.value)})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Preferred Supplier"}),u.jsx("input",{className:"w-full border rounded p-2",value:m.preferredSupplier||"",onChange:z=>p({...m,preferredSupplier:z.target.value})})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Related Machine"}),u.jsxs("select",{className:"w-full border rounded p-2",value:m.relatedMachineId||"",onChange:z=>p({...m,relatedMachineId:z.target.value}),children:[u.jsx("option",{value:"",children:"None"}),a.map(z=>u.jsxs("option",{value:z.id,children:[z.category," (",z.id,")"]},z.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Location / Aisle"}),u.jsx("input",{className:"w-full border rounded p-2",value:m.locationZone||"",onChange:z=>p({...m,locationZone:z.target.value})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Criticality"}),u.jsxs("select",{className:"w-full border rounded p-2",value:m.criticality||"Low",onChange:z=>p({...m,criticality:z.target.value}),children:[u.jsx("option",{value:"Low",children:"Low"}),u.jsx("option",{value:"Medium",children:"Medium"}),u.jsx("option",{value:"High",children:"High"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"ABC Class"}),u.jsxs("select",{className:"w-full border rounded p-2",value:m.abcClass||"C",onChange:z=>p({...m,abcClass:z.target.value}),children:[u.jsx("option",{value:"A",children:"A"}),u.jsx("option",{value:"B",children:"B"}),u.jsx("option",{value:"C",children:"C"})]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Unit Cost ($)"}),u.jsx("input",{type:"number",className:"w-full border rounded p-2",value:m.unitCost||"",onChange:z=>p({...m,unitCost:Number(z.target.value)})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Annual Usage"}),u.jsx("input",{type:"number",className:"w-full border rounded p-2",value:m.annualUsage||"",onChange:z=>p({...m,annualUsage:Number(z.target.value)})})]})]})]}),u.jsxs("div",{className:"col-span-2 pt-4 border-t flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>p(null),className:"px-4 py-2 border rounded",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded font-bold",children:"Save Changes"})]})]})]})})]}),be=()=>u.jsxs("div",{className:"flex flex-col h-full gap-4",children:[u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border flex flex-wrap gap-3 items-end",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Supplier"}),u.jsx("input",{className:"border rounded p-2 text-sm w-48",placeholder:"Supplier Name",value:y.supplier||"",onChange:z=>b({...y,supplier:z.target.value})})]}),u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Item"}),u.jsx(Sr,{label:"",placeholder:"Select Item...",options:e.map(z=>({id:z.id,label:z.id,subLabel:z.name})),value:y.itemId||"",onChange:z=>b({...y,itemId:z}),compact:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Qty"}),u.jsx("input",{type:"number",className:"border rounded p-2 text-sm w-24",value:y.orderedQuantity||"",onChange:z=>b({...y,orderedQuantity:Number(z.target.value)})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Expected Date"}),u.jsx("input",{type:"date",className:"border rounded p-2 text-sm",value:y.expectedDeliveryDate||"",onChange:z=>b({...y,expectedDeliveryDate:z.target.value})})]}),u.jsx("button",{onClick:te,className:"bg-green-600 text-white px-4 py-2 rounded text-sm font-bold h-[38px]",children:"+ Create PO"})]}),u.jsx("div",{className:"flex-1 overflow-auto border rounded-lg",children:u.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-50 text-gray-700 sticky top-0 shadow-sm",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3",children:"PO Number"}),u.jsx("th",{className:"p-3",children:"Supplier"}),u.jsx("th",{className:"p-3",children:"Item"}),u.jsx("th",{className:"p-3",children:"Ordered Qty"}),u.jsx("th",{className:"p-3",children:"Expected Date"}),u.jsx("th",{className:"p-3",children:"Status"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-100",children:[r.map(z=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"p-3 font-mono",children:z.id}),u.jsx("td",{className:"p-3",children:z.supplier}),u.jsx("td",{className:"p-3 font-bold",children:z.itemId}),u.jsx("td",{className:"p-3",children:z.orderedQuantity}),u.jsx("td",{className:"p-3",children:z.expectedDeliveryDate}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs",children:z.status})})]},z.id)),r.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:"No open Purchase Orders."})})]})]})})]}),ve=()=>u.jsxs("div",{className:"flex flex-col h-full gap-4 overflow-y-auto",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 shrink-0 h-64",children:[u.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[u.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"ABC Classification Summary"}),u.jsx(nc,{width:"100%",height:"100%",children:u.jsxs(Cw,{children:[u.jsxs(Pp,{data:[{name:"A (High Value)",value:O.filter(z=>z.abcClass==="A").length},{name:"B (Medium)",value:O.filter(z=>z.abcClass==="B").length},{name:"C (Low Value)",value:O.filter(z=>z.abcClass==="C").length}],cx:"50%",cy:"50%",innerRadius:40,outerRadius:80,fill:"#8884d8",dataKey:"value",label:!0,children:[u.jsx(oi,{fill:"#10B981"})," ",u.jsx(oi,{fill:"#FBBF24"})," ",u.jsx(oi,{fill:"#9CA3AF"})]}),u.jsx(sc,{}),u.jsx(A_,{})]})})]}),u.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:[u.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Inventory Health"}),u.jsx(nc,{width:"100%",height:"100%",children:u.jsxs(Xg,{data:[{name:"Reorder Needed",value:j.length},{name:"Healthy",value:O.filter(z=>z.status==="OK").length},{name:"Excess Stock",value:B.length}],children:[u.jsx(P0,{strokeDasharray:"3 3"}),u.jsx(F0,{dataKey:"name",tick:{fontSize:10}}),u.jsx(L0,{}),u.jsx(sc,{}),u.jsxs(R0,{dataKey:"value",fill:"#8884d8",children:[u.jsx(oi,{fill:"#EF4444"})," ",u.jsx(oi,{fill:"#10B981"})," ",u.jsx(oi,{fill:"#F59E0B"})]})]})})]})]}),u.jsxs("div",{className:"flex-1 bg-white border rounded-lg flex flex-col min-h-[300px]",children:[u.jsxs("div",{className:"p-3 bg-red-50 border-b border-red-100 flex justify-between items-center",children:[u.jsxs("h3",{className:"font-bold text-red-800 flex items-center gap-2",children:[u.jsx("span",{children:""})," Reorder Requirements (",j.length,")"]}),u.jsx("button",{onClick:V,className:"px-3 py-1 bg-white border border-red-200 text-red-700 rounded text-xs font-bold hover:bg-red-50",children:" Export Report"})]}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsxs("table",{className:"w-full text-left text-sm",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0 shadow-sm",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3",children:"Item Code"}),u.jsx("th",{className:"p-3",children:"Description"}),u.jsx("th",{className:"p-3 text-center",children:"In Transit"}),u.jsx("th",{className:"p-3 text-center",children:"Total Available"}),u.jsx("th",{className:"p-3 text-center text-red-600",children:"Reorder Pt"}),u.jsx("th",{className:"p-3 text-center text-gray-500",children:"Max Stock"}),u.jsx("th",{className:"p-3 text-center font-bold bg-green-50 text-green-800 border-l border-green-200",children:"Suggested Order"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-100",children:[j.map(z=>u.jsxs("tr",{className:"hover:bg-red-50",children:[u.jsx("td",{className:"p-3 font-mono font-bold",children:z.id}),u.jsx("td",{className:"p-3",children:z.name}),u.jsx("td",{className:"p-3 text-center",children:z.inTransit}),u.jsx("td",{className:"p-3 text-center font-bold",children:z.availableStock}),u.jsx("td",{className:"p-3 text-center text-red-600 font-bold",children:z.reorderPoint}),u.jsx("td",{className:"p-3 text-center text-gray-500",children:z.maxStock}),u.jsx("td",{className:"p-3 text-center font-extrabold text-green-700 bg-green-50 border-l border-green-200",children:z.suggestedOrder})]},z.id)),j.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"p-8 text-center text-green-600 font-bold",children:"All stock levels are healthy! No reorders needed."})})]})]})})]})]});return u.jsxs("div",{className:"flex flex-col h-full space-y-4 animate-fade-in-up font-cairo",children:[u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex justify-between items-center shrink-0",children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[u.jsx("span",{children:""})," MRO Management"]}),u.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg",children:[u.jsx("button",{onClick:()=>c("master"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all ${l==="master"?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Master Data"}),u.jsx("button",{onClick:()=>c("open-po"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all ${l==="open-po"?"bg-white text-green-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Open PO / In Transit"}),u.jsx("button",{onClick:()=>c("analysis"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all ${l==="analysis"?"bg-white text-red-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Analysis & Reorder"})]})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex-1 overflow-hidden min-h-0",children:[l==="master"&&ge(),l==="open-po"&&be(),l==="analysis"&&ve()]})]})},tme=({tasks:e,onAddTask:t,schedules:r,onAddSchedule:n,workOrders:a,onUpdateWorkOrder:i,machines:l,items:c,locations:f})=>{const[d,m]=N.useState("work-orders"),[p,v]=N.useState({status:"Active",type:"Preventive",priority:"Medium"}),[x,y]=N.useState({status:"Planned",frequency:"Monthly",checkMroAvailability:!0}),[b,_]=N.useState("All"),[E,A]=N.useState(""),[T,k]=N.useState(new Date),I=N.useMemo(()=>new Map(e.map(se=>[se.id,se])),[e]),O=N.useMemo(()=>new Map(l.map(se=>[se.id,se])),[l]);N.useMemo(()=>new Map(f.map(se=>[se.id,se.name])),[f]);const j=se=>{var Q;return((Q=O.get(se))==null?void 0:Q.category)||se},B=se=>{var Q;return((Q=I.get(se))==null?void 0:Q.description)||se},U=se=>{const Q=e.find(G=>G.id===se.taskId);if(!Q||!Q.requiredMroItems||Q.requiredMroItems.length===0)return{status:"OK",missing:[]};const re=[];return Q.requiredMroItems.forEach(G=>{const P=c.find(F=>F.id===G.itemId),W=(P==null?void 0:P.stockQuantity)||0;W<G.quantity&&re.push(`${G.itemId} (Need ${G.quantity}, Have ${W})`)}),{status:re.length>0?"Shortage":"Available",missing:re}},Y=()=>{if(!p.description||!p.machineId)return alert("Fill required fields");const se=l.find(re=>re.id===p.machineId),Q={id:`TSK-${Date.now()}`,description:p.description,type:p.type||"Preventive",machineId:p.machineId,machineName:(se==null?void 0:se.category)||"Unknown",requiredMroItems:p.requiredMroItems||[],standardDurationHours:Number(p.standardDurationHours)||1,requiredSkills:p.requiredSkills||"General",priority:p.priority||"Medium",defaultLocationId:(se==null?void 0:se.locationId)||"WH-001",status:"Active"};t(Q),v({status:"Active",type:"Preventive",priority:"Medium"})},te=()=>{if(!x.taskId||!x.plannedStartDate)return alert("Fill required fields");const se=e.find(re=>re.id===x.taskId),Q={id:`SCH-${Date.now()}`,taskId:x.taskId,machineId:(se==null?void 0:se.machineId)||"",locationId:(se==null?void 0:se.defaultLocationId)||"",plannedStartDate:x.plannedStartDate,plannedEndDate:x.plannedStartDate,frequency:x.frequency||"Monthly",assignedTechnician:x.assignedTechnician||"",checkMroAvailability:!0,status:"Planned"};n(Q),y({status:"Planned",frequency:"Monthly",checkMroAvailability:!0})},V=se=>{const Q=U(se);Q.status==="Shortage"&&!confirm(` MRO SHORTAGE DETECTED:
${Q.missing.join(`
`)}

Do you want to force release this Work Order?`)||i({...se,status:"Released"})},ge=()=>u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 p-4 rounded border flex flex-wrap gap-3 items-end",children:[u.jsxs("div",{className:"flex-1 min-w-[200px]",children:[u.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Description"}),u.jsx("input",{className:"w-full border rounded p-2 text-sm",value:p.description||"",onChange:se=>v({...p,description:se.target.value})})]}),u.jsxs("div",{className:"w-48",children:[u.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Machine"}),u.jsx(Sr,{label:"",options:l.map(se=>({id:se.id,label:se.category||se.id})),value:p.machineId||"",onChange:se=>v({...p,machineId:se}),compact:!0})]}),u.jsxs("div",{className:"w-32",children:[u.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Type"}),u.jsxs("select",{className:"w-full border rounded p-2 text-sm h-[38px]",value:p.type,onChange:se=>v({...p,type:se.target.value}),children:[u.jsx("option",{children:"Preventive"}),u.jsx("option",{children:"Corrective"}),u.jsx("option",{children:"Predictive"})]})]}),u.jsxs("div",{className:"w-24",children:[u.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Hours"}),u.jsx("input",{type:"number",className:"w-full border rounded p-2 text-sm",value:p.standardDurationHours||"",onChange:se=>v({...p,standardDurationHours:Number(se.target.value)})})]}),u.jsx("button",{onClick:Y,className:"bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold h-[38px]",children:"+ Add Task"})]}),u.jsx("div",{className:"overflow-auto border rounded-lg",children:u.jsxs("table",{className:"w-full text-left text-sm",children:[u.jsx("thead",{className:"bg-gray-100 font-bold",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3",children:"ID"}),u.jsx("th",{className:"p-3",children:"Description"}),u.jsx("th",{className:"p-3",children:"Machine"}),u.jsx("th",{className:"p-3",children:"Type"}),u.jsx("th",{className:"p-3",children:"Priority"}),u.jsx("th",{className:"p-3",children:"Duration"})]})}),u.jsx("tbody",{children:e.map(se=>u.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[u.jsx("td",{className:"p-3 font-mono",children:se.id}),u.jsx("td",{className:"p-3",children:se.description}),u.jsx("td",{className:"p-3",children:se.machineName}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:"bg-blue-50 text-blue-700 px-2 py-1 rounded text-xs",children:se.type})}),u.jsx("td",{className:"p-3",children:se.priority}),u.jsxs("td",{className:"p-3",children:[se.standardDurationHours," hrs"]})]},se.id))})]})})]}),be=()=>u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-gray-50 p-4 rounded border flex flex-wrap gap-3 items-end",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Task"}),u.jsx(Sr,{label:"",options:e.map(se=>({id:se.id,label:se.description})),value:x.taskId||"",onChange:se=>y({...x,taskId:se}),compact:!0})]}),u.jsxs("div",{className:"w-40",children:[u.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Start Date"}),u.jsx("input",{type:"date",className:"w-full border rounded p-2 text-sm",value:x.plannedStartDate||"",onChange:se=>y({...x,plannedStartDate:se.target.value})})]}),u.jsxs("div",{className:"w-32",children:[u.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Frequency"}),u.jsxs("select",{className:"w-full border rounded p-2 text-sm h-[38px]",value:x.frequency,onChange:se=>y({...x,frequency:se.target.value}),children:[u.jsx("option",{children:"Daily"}),u.jsx("option",{children:"Weekly"}),u.jsx("option",{children:"Monthly"}),u.jsx("option",{children:"Quarterly"})]})]}),u.jsx("button",{onClick:te,className:"bg-green-600 text-white px-4 py-2 rounded text-sm font-bold h-[38px]",children:"Schedule"})]}),u.jsx("div",{className:"overflow-auto border rounded-lg",children:u.jsxs("table",{className:"w-full text-left text-sm",children:[u.jsx("thead",{className:"bg-gray-100 font-bold",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3",children:"Schedule ID"}),u.jsx("th",{className:"p-3",children:"Task"}),u.jsx("th",{className:"p-3",children:"Machine"}),u.jsx("th",{className:"p-3",children:"Planned Date"}),u.jsx("th",{className:"p-3",children:"Frequency"}),u.jsx("th",{className:"p-3",children:"Status"})]})}),u.jsx("tbody",{children:r.map(se=>u.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[u.jsx("td",{className:"p-3 font-mono",children:se.id}),u.jsx("td",{className:"p-3",children:B(se.taskId)}),u.jsx("td",{className:"p-3",children:j(se.machineId)}),u.jsx("td",{className:"p-3",children:new Date(se.plannedStartDate).toLocaleDateString()}),u.jsx("td",{className:"p-3",children:se.frequency}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:"bg-yellow-50 text-yellow-700 px-2 py-1 rounded text-xs",children:se.status})})]},se.id))})]})})]}),ve=()=>{const se=a.filter(Q=>!(b!=="All"&&Q.status!==b||E&&Q.locationId!==E));return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex gap-2 mb-2",children:[u.jsxs("select",{className:"border rounded p-2 text-sm",value:b,onChange:Q=>_(Q.target.value),children:[u.jsx("option",{value:"All",children:"All Status"}),u.jsx("option",{children:"Draft"}),u.jsx("option",{children:"Released"}),u.jsx("option",{children:"In Progress"}),u.jsx("option",{children:"Completed"})]}),u.jsxs("select",{className:"border rounded p-2 text-sm",value:E,onChange:Q=>A(Q.target.value),children:[u.jsx("option",{value:"",children:"All Locations"}),f.map(Q=>u.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]}),u.jsx("div",{className:"overflow-auto border rounded-lg",children:u.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 font-bold",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3",children:"WO #"}),u.jsx("th",{className:"p-3",children:"Type"}),u.jsx("th",{className:"p-3",children:"Task / Description"}),u.jsx("th",{className:"p-3",children:"Machine"}),u.jsx("th",{className:"p-3",children:"Date"}),u.jsx("th",{className:"p-3",children:"Status"}),u.jsx("th",{className:"p-3",children:"MRO Status"}),u.jsx("th",{className:"p-3 text-right",children:"Action"})]})}),u.jsx("tbody",{children:se.map(Q=>{const re=U(Q);return u.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[u.jsx("td",{className:"p-3 font-mono font-bold",children:Q.id}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs ${Q.type==="Corrective"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:Q.type})}),u.jsx("td",{className:"p-3",children:B(Q.taskId)}),u.jsx("td",{className:"p-3",children:j(Q.machineId)}),u.jsx("td",{className:"p-3",children:new Date(Q.plannedDate).toLocaleDateString()}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs font-bold ${Q.status==="Completed"?"bg-green-100 text-green-800":Q.status==="Released"?"bg-purple-100 text-purple-800":"bg-gray-200"}`,children:Q.status})}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:`px-2 py-1 rounded text-xs ${re.status==="Shortage"?"bg-red-100 text-red-700":"bg-green-50 text-green-700"}`,children:re.status})}),u.jsxs("td",{className:"p-3 text-right",children:[Q.status==="Draft"&&u.jsx("button",{onClick:()=>V(Q),className:"text-blue-600 font-bold hover:underline text-xs",children:"Release"}),Q.status==="Released"&&u.jsx("button",{onClick:()=>i({...Q,status:"Completed"}),className:"text-green-600 font-bold hover:underline text-xs",children:"Complete"})]})]},Q.id)})})]})})]})},z=()=>{const se=T.getFullYear(),Q=T.getMonth(),re=new Date(se,Q,1).getDay(),G=new Date(se,Q+1,0).getDate(),P=[];for(let F=0;F<re;F++)P.push(null);for(let F=1;F<=G;F++)P.push(new Date(se,Q,F));const W=["January","February","March","April","May","June","July","August","September","October","November","December"];return u.jsxs("div",{className:"h-full flex flex-col",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsxs("h3",{className:"text-lg font-bold text-gray-800",children:[W[Q]," ",se]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>k(new Date(se,Q-1,1)),className:"px-3 py-1 bg-gray-100 rounded hover:bg-gray-200",children:" Prev"}),u.jsx("button",{onClick:()=>k(new Date),className:"px-3 py-1 bg-blue-50 text-blue-600 rounded hover:bg-blue-100",children:"Today"}),u.jsx("button",{onClick:()=>k(new Date(se,Q+1,1)),className:"px-3 py-1 bg-gray-100 rounded hover:bg-gray-200",children:"Next "})]})]}),u.jsxs("div",{className:"grid grid-cols-7 gap-1 font-bold text-center text-gray-500 text-sm mb-2",children:[u.jsx("div",{children:"Sun"}),u.jsx("div",{children:"Mon"}),u.jsx("div",{children:"Tue"}),u.jsx("div",{children:"Wed"}),u.jsx("div",{children:"Thu"}),u.jsx("div",{children:"Fri"}),u.jsx("div",{children:"Sat"})]}),u.jsx("div",{className:"grid grid-cols-7 gap-1 flex-1 auto-rows-fr",children:P.map((F,M)=>{if(!F)return u.jsx("div",{className:"bg-gray-50 rounded"},M);const le=a.filter(pe=>{const Ae=new Date(pe.plannedDate);return Ae.getDate()===F.getDate()&&Ae.getMonth()===Q&&Ae.getFullYear()===se});return u.jsxs("div",{className:"bg-white border rounded p-1 min-h-[80px] hover:bg-gray-50 transition relative overflow-hidden group",children:[u.jsx("span",{className:`text-xs font-bold p-1 rounded-full ${F.toDateString()===new Date().toDateString()?"bg-blue-600 text-white":"text-gray-700"}`,children:F.getDate()}),u.jsx("div",{className:"mt-1 space-y-1 overflow-y-auto max-h-[100px]",children:le.map(pe=>u.jsxs("div",{className:`text-[10px] p-1 rounded truncate border-l-2 cursor-pointer ${pe.type==="Corrective"?"bg-red-50 border-red-500 text-red-800":"bg-blue-50 border-blue-500 text-blue-800"}`,title:`${pe.id}: ${B(pe.taskId)}`,children:[pe.type==="Corrective"?"":""," ",j(pe.machineId)]},pe.id))})]},M)})})]})},ue=()=>{const se=a.length,Q=a.filter(W=>W.status==="Completed").length,re=se>0?Q/se*100:0,G={};a.filter(W=>W.type==="Corrective").forEach(W=>{const F=j(W.machineId);G[F]=(G[F]||0)+1});const P=Object.entries(G).map(([W,F])=>({name:W,value:F})).slice(0,5);return u.jsxs("div",{className:"space-y-6 overflow-y-auto h-full",children:[u.jsxs("div",{className:"grid grid-cols-4 gap-4",children:[u.jsxs("div",{className:"bg-white p-4 rounded border shadow-sm",children:[u.jsx("h4",{className:"text-gray-500 text-xs uppercase font-bold",children:"Schedule Compliance"}),u.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:[re.toFixed(1),"%"]})]}),u.jsxs("div",{className:"bg-white p-4 rounded border shadow-sm",children:[u.jsx("h4",{className:"text-gray-500 text-xs uppercase font-bold",children:"Open Work Orders"}),u.jsx("p",{className:"text-2xl font-bold text-orange-600",children:a.filter(W=>W.status!=="Completed"&&W.status!=="Cancelled").length})]}),u.jsxs("div",{className:"bg-white p-4 rounded border shadow-sm",children:[u.jsx("h4",{className:"text-gray-500 text-xs uppercase font-bold",children:"Corrective vs Preventive"}),u.jsxs("p",{className:"text-2xl font-bold text-gray-800",children:[a.filter(W=>W.type==="Corrective").length," / ",a.filter(W=>W.type==="Preventive").length]})]}),u.jsxs("div",{className:"bg-white p-4 rounded border shadow-sm",children:[u.jsx("h4",{className:"text-gray-500 text-xs uppercase font-bold",children:"MRO Shortage Risks"}),u.jsx("p",{className:"text-2xl font-bold text-red-600",children:a.filter(W=>U(W).status==="Shortage").length})]})]}),u.jsxs("div",{className:"bg-white p-4 rounded border shadow-sm h-80",children:[u.jsx("h4",{className:"text-sm font-bold text-gray-700 mb-4",children:"Top Machines by Breakdown Frequency"}),u.jsx(nc,{width:"100%",height:"100%",children:u.jsxs(Xg,{data:P,children:[u.jsx(P0,{strokeDasharray:"3 3"}),u.jsx(F0,{dataKey:"name",tick:{fontSize:10}}),u.jsx(L0,{}),u.jsx(sc,{}),u.jsx(R0,{dataKey:"value",fill:"#EF4444"})]})})]})]})};return u.jsxs("div",{className:"flex flex-col h-full space-y-4 animate-fade-in-up font-cairo",children:[u.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-200 flex flex-wrap justify-between items-center shrink-0",children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[u.jsx("span",{children:""})," Maintenance Planning"]}),u.jsxs("div",{className:"flex gap-2 bg-gray-100 p-1 rounded-lg overflow-x-auto",children:[u.jsx("button",{onClick:()=>m("work-orders"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${d==="work-orders"?"bg-white text-blue-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Work Orders"}),u.jsx("button",{onClick:()=>m("calendar"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${d==="calendar"?"bg-white text-purple-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Calendar"}),u.jsx("button",{onClick:()=>m("schedule"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${d==="schedule"?"bg-white text-teal-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Scheduling"}),u.jsx("button",{onClick:()=>m("tasks"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${d==="tasks"?"bg-white text-orange-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Task Master"}),u.jsx("button",{onClick:()=>m("analysis"),className:`px-4 py-2 rounded-md text-sm font-bold transition-all whitespace-nowrap ${d==="analysis"?"bg-white text-red-700 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:"Analysis"})]})]}),u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200 flex-1 overflow-hidden min-h-0",children:[d==="tasks"&&ge(),d==="schedule"&&be(),d==="work-orders"&&ve(),d==="calendar"&&z(),d==="analysis"&&ue()]})]})},rme=({periods:e,entries:t,locations:r,sectors:n,divisions:a,items:i,machines:l,onAddPeriod:c,onUpdatePeriod:f,onUpdateEntry:d,onDeleteEntry:m,currentUser:p,onBulkImport:v})=>{const[x,y]=N.useState("entry"),[b,_]=N.useState(""),[E,A]=N.useState(""),[T,k]=N.useState(""),[I,O]=N.useState(""),[j,B]=N.useState(""),[U,Y]=N.useState(""),[te,V]=N.useState(1),[ge,be]=N.useState(0),[ve,z]=N.useState(0),[ue,se]=N.useState("");N.useMemo(()=>e.filter(F=>F.status==="Open"),[e]),N.useMemo(()=>e.find(F=>F.id===b),[e,b]);const Q=N.useMemo(()=>t.filter(F=>{const M=b?F.periodId===b:!0,le=E?F.locationId===E:!0;return M&&le}),[t,b,E]),re=()=>{const F=prompt("Enter Period Name (e.g. 2025-Q1):");if(!F)return;const M={id:`PER-${Date.now()}`,name:F,startDate:new Date().toISOString().split("T")[0],endDate:new Date().toISOString().split("T")[0],status:"Open"};c(M),_(M.id)},G=()=>{if(!b){alert("Please select a Period first.");return}if(!E){alert("Please select a Location.");return}if(!T){alert("Please select an Item.");return}const F=i.find(Ae=>Ae.id===T),M=(F==null?void 0:F.stockQuantity)||0,le=ve>0?ve:ge*te,pe={id:`PLAN-${Date.now()}`,periodId:b,locationId:E,sectorId:"",divisionId:"",itemId:T,machineCount:ge,actualQuantity:M,forecastQuantity:le,notes:ue,updatedBy:p.username,lastUpdated:new Date().toISOString()};d(pe),k(""),be(0),z(0),se("")},P=F=>{var pe;const M=(pe=F.target.files)==null?void 0:pe[0];if(!M)return;const le=new FileReader;le.onload=Ae=>{var ot;const oe=(ot=Ae.target)==null?void 0:ot.result,ae=is(oe,{type:"binary"}),ze=ae.SheetNames[0],q=ae.Sheets[ze],Je=jt.sheet_to_json(q);if(!b){alert("Please select a target Period first.");return}const qe=[];Je.forEach(Ke=>{const He=r.find(mt=>mt.name===Ke.Location||mt.id===Ke.Location),wt=i.find(mt=>mt.id===Ke.ItemCode||mt.name===Ke.ItemName);He&&wt&&qe.push({id:`PLAN-${Date.now()}-${Math.random().toString(36).substr(2,5)}`,periodId:b,locationId:He.id,sectorId:"",divisionId:"",itemId:wt.id,machineCount:Number(Ke.MachineCount)||0,actualQuantity:wt.stockQuantity||0,forecastQuantity:Number(Ke.Forecast)||0,notes:Ke.Notes||"Imported",updatedBy:p.username,lastUpdated:new Date().toISOString()})}),qe.length>0?(v("issuePlanEntries",qe,[]),qe.forEach(Ke=>d(Ke)),alert(`Imported ${qe.length} entries.`)):alert("No valid entries found. Check column names: Location, ItemCode, MachineCount, Forecast")},le.readAsBinaryString(M)},W=N.useMemo(()=>{const F={};return Q.forEach(M=>{const le=`${M.locationId}-${M.itemId}`;if(!F[le]){const pe=i.find(oe=>oe.id===M.itemId),Ae=r.find(oe=>oe.id===M.locationId);F[le]={locationName:(Ae==null?void 0:Ae.name)||"Unknown",itemName:(pe==null?void 0:pe.name)||"Unknown",itemCode:(pe==null?void 0:pe.id)||"",totalForecast:0,totalActual:0,count:0}}F[le].totalForecast+=Number(M.forecastQuantity),F[le].totalActual+=Number(M.actualQuantity),F[le].count++}),Object.values(F)},[Q,i,r]);return u.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center bg-white p-4 rounded-xl shadow-sm border border-gray-200 gap-4",children:[u.jsxs("div",{children:[u.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center",children:[u.jsx(Tre,{className:"mr-2 h-6 w-6 text-teal-600"})," Issue Planning"]}),u.jsx("p",{className:"text-sm text-gray-500",children:"Plan material requirements per machine and location."})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("select",{className:"h-10 border border-gray-300 rounded-lg px-3 focus:ring-2 focus:ring-teal-500 outline-none",value:b,onChange:F=>_(F.target.value),children:[u.jsx("option",{value:"",children:"Select Period..."}),e.map(F=>u.jsxs("option",{value:F.id,children:[F.name," (",F.status,")"]},F.id))]}),u.jsx("button",{onClick:re,className:"p-2 bg-gray-100 rounded-lg hover:bg-gray-200 text-gray-600",title:"New Period",children:u.jsx(jre,{className:"h-5 w-5"})})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 min-h-[600px] flex flex-col",children:[u.jsxs("div",{className:"flex border-b border-gray-200",children:[u.jsx("button",{onClick:()=>y("entry"),className:`px-6 py-3 text-sm font-medium transition-colors ${x==="entry"?"border-b-2 border-teal-500 text-teal-700 bg-teal-50":"text-gray-500 hover:text-gray-700"}`,children:"Data Entry"}),u.jsx("button",{onClick:()=>y("aggregation"),className:`px-6 py-3 text-sm font-medium transition-colors ${x==="aggregation"?"border-b-2 border-teal-500 text-teal-700 bg-teal-50":"text-gray-500 hover:text-gray-700"}`,children:"Aggregation Hub"}),u.jsx("button",{onClick:()=>y("analysis"),className:`px-6 py-3 text-sm font-medium transition-colors ${x==="analysis"?"border-b-2 border-teal-500 text-teal-700 bg-teal-50":"text-gray-500 hover:text-gray-700"}`,children:"Variance Analysis"})]}),u.jsxs("div",{className:"p-6 flex-1",children:[x==="entry"&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"w-full md:w-64",children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Target Location"}),u.jsxs("select",{className:"w-full h-10 border border-gray-300 rounded-lg px-3 bg-white",value:E,onChange:F=>A(F.target.value),children:[u.jsx("option",{value:"",children:"Select Location..."}),r.map(F=>u.jsx("option",{value:F.id,children:F.name},F.id))]})]}),u.jsx("div",{className:"flex-1 flex items-end justify-end",children:u.jsxs("label",{className:"flex items-center px-4 py-2 bg-green-600 text-white rounded-lg cursor-pointer hover:bg-green-700 transition shadow-sm",children:[u.jsx(Ire,{className:"h-4 w-4 mr-2"}),u.jsx("span",{children:"Import Excel"}),u.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",onChange:P})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 p-4 border border-gray-200 rounded-lg border-dashed",children:[u.jsx("div",{className:"col-span-1 md:col-span-2",children:u.jsx(Sr,{label:"Item (Description/Code)",options:i.map(F=>({id:F.id,label:`${F.id} - ${F.name}`})),value:T,onChange:k,placeholder:"Search Item..."})}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Machine Count"}),u.jsx("input",{type:"number",className:"w-full h-10 border border-gray-300 rounded-lg px-3",value:ge,onChange:F=>be(Number(F.target.value))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Forecast Qty"}),u.jsx("input",{type:"number",className:"w-full h-10 border border-gray-300 rounded-lg px-3",value:ve,onChange:F=>z(Number(F.target.value))})]}),u.jsx("div",{className:"flex items-end",children:u.jsx("button",{onClick:G,className:"w-full h-10 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-medium",children:"Add Entry"})})]}),u.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:u.jsxs("table",{className:"w-full text-sm text-left",children:[u.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3",children:"Location"}),u.jsx("th",{className:"px-4 py-3",children:"Item"}),u.jsx("th",{className:"px-4 py-3 text-center",children:"Machine Count"}),u.jsx("th",{className:"px-4 py-3 text-center",children:"Forecast"}),u.jsx("th",{className:"px-4 py-3 text-center",children:"Actual (Stock)"}),u.jsx("th",{className:"px-4 py-3",children:"Notes"}),u.jsx("th",{className:"px-4 py-3 w-16"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:Q.length===0?u.jsx("tr",{children:u.jsx("td",{colSpan:7,className:"text-center py-8 text-gray-400",children:"No entries for this period/location."})}):Q.map(F=>{const M=r.find(pe=>pe.id===F.locationId),le=i.find(pe=>pe.id===F.itemId);return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-3 font-medium text-gray-800",children:(M==null?void 0:M.name)||F.locationId}),u.jsxs("td",{className:"px-4 py-3",children:[u.jsx("div",{className:"font-medium text-gray-900",children:le==null?void 0:le.name}),u.jsx("div",{className:"text-xs text-gray-500",children:le==null?void 0:le.id})]}),u.jsx("td",{className:"px-4 py-3 text-center",children:F.machineCount}),u.jsx("td",{className:"px-4 py-3 text-center font-bold text-teal-600",children:F.forecastQuantity}),u.jsx("td",{className:"px-4 py-3 text-center text-gray-600",children:F.actualQuantity}),u.jsx("td",{className:"px-4 py-3 text-gray-500 truncate max-w-xs",children:F.notes}),u.jsx("td",{className:"px-4 py-3 text-right",children:u.jsx("button",{onClick:()=>m(F.id),className:"text-red-400 hover:text-red-600",children:u.jsx(Cre,{className:"h-4 w-4"})})})]},F.id)})})]})})]}),x==="aggregation"&&u.jsx("div",{className:"overflow-x-auto border border-gray-200 rounded-lg",children:u.jsxs("table",{className:"w-full text-sm text-left",children:[u.jsx("thead",{className:"bg-gray-50 text-gray-600 font-medium border-b border-gray-200",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3",children:"Location"}),u.jsx("th",{className:"px-4 py-3",children:"Item Code"}),u.jsx("th",{className:"px-4 py-3",children:"Item Name"}),u.jsx("th",{className:"px-4 py-3 text-right",children:"Total Forecast"}),u.jsx("th",{className:"px-4 py-3 text-right",children:"Total Stored (Actual)"}),u.jsx("th",{className:"px-4 py-3 text-right",children:"Balance"})]})}),u.jsx("tbody",{className:"divide-y divide-gray-100",children:W.map((F,M)=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-4 py-3",children:F.locationName}),u.jsx("td",{className:"px-4 py-3 font-mono text-gray-500",children:F.itemCode}),u.jsx("td",{className:"px-4 py-3 font-medium",children:F.itemName}),u.jsx("td",{className:"px-4 py-3 text-right font-bold text-teal-700",children:F.totalForecast}),u.jsx("td",{className:"px-4 py-3 text-right text-gray-700",children:F.totalActual}),u.jsx("td",{className:`px-4 py-3 text-right font-bold ${F.totalActual>=F.totalForecast?"text-green-600":"text-red-600"}`,children:F.totalActual-F.totalForecast})]},M))})]})}),x==="analysis"&&u.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-gray-400",children:[u.jsx(m5,{className:"h-16 w-16 mb-4 text-gray-300"}),u.jsx("h3",{className:"text-lg font-medium text-gray-600",children:"Variance Analysis"}),u.jsx("p",{className:"max-w-md text-center mt-2",children:"This module will provide detailed charts comparing Actual vs. Forecasted consumption over time. Currently under development."})]})]})]})]})},nme=({onBackup:e,onRestore:t,users:r,onAddUser:n,onUpdateUser:a,onDeleteUsers:i})=>{const[l,c]=N.useState("general"),[f,d]=N.useState(""),[m,p]=N.useState(""),[v,x]=N.useState("hourly"),[y,b]=N.useState(!1),[_,E]=N.useState(!1),[A,T]=N.useState(!1),[k,I]=N.useState(""),[O,j]=N.useState("neutral"),[B,U]=N.useState(""),Y=N.useRef(null),[te,V]=N.useState(!1),[ge,be]=N.useState(null),[ve,z]=N.useState({}),[ue,se]=N.useState("");N.useEffect(()=>{const ae=localStorage.getItem("wf_script_url_v3"),ze=localStorage.getItem("wf_logo_url"),q=localStorage.getItem("wf_backup_frequency");d(ae||oo),p(ze||""),x(q||"hourly")},[]);const Q=()=>{if(!f){j("error"),I("Please enter a Web App URL.");return}localStorage.setItem("wf_script_url_v3",f),localStorage.setItem("wf_backup_frequency",v),m?localStorage.setItem("wf_logo_url",m):localStorage.removeItem("wf_logo_url"),j("success"),I("Settings Saved Successfully!"),setTimeout(()=>{I(""),window.location.reload()},1500)},re=ae=>{var Je;const ze=(Je=ae.target.files)==null?void 0:Je[0];if(!ze)return;if(ze.size>500*1024){alert("File is too large. Please upload an image smaller than 500KB.");return}const q=new FileReader;q.onloadend=()=>{const qe=q.result;p(qe)},q.readAsDataURL(ze)},G=()=>{p(""),Y.current&&(Y.current.value="")},P=ae=>ae?ae.includes("script.google.com")?ae.endsWith("/exec")?!0:(j("error"),I(' Invalid Ending. URL must end with "/exec". (Did you copy the Editor link?)'),!1):(j("error"),I(' Invalid Domain. Must be "script.google.com".'),!1):(j("error"),I("Please enter a URL first."),!1),W=async()=>{if(P(f)){b(!0),I("Testing connection to Google..."),j("neutral");try{const ae=await zre(f);ae&&!ae.error?(j("success"),I(' Connection Successful! Found "WareFlow Reports" folder.')):(j("error"),I(` Script Error: ${(ae==null?void 0:ae.error)||"Unknown error"}`))}catch(ae){j("error"),ae.message==="Failed to fetch"?I(' Connection Blocked. Check Deploy Settings: "Who has access" MUST be "Anyone".'):I(` Network Error: ${ae.message}`)}finally{b(!1)}}},F=async()=>{if(t&&confirm(` DANGER: This will OVERWRITE all local data (Items, History, Machines, etc.) with data from the cloud.

Are you sure?`)){T(!0);try{await t(),alert("Restore Complete! Page will reload."),window.location.reload()}catch(ae){alert(`Restore Failed: ${ae.message}

Please check script permissions.`)}finally{T(!1)}}},M=()=>{navigator.clipboard.writeText(F4),U("Code copied to clipboard!"),setTimeout(()=>U(""),3e3)},le=ae=>{ae.preventDefault();const ze={...ve};["allowedLocationIds","allowedSectorIds","allowedDivisionIds","allowedMenus"].forEach(q=>{typeof ze[q]=="string"&&(ze[q]=ze[q].split(",").map(Je=>Je.trim()).filter(Boolean))}),ge?a(ze):n(ze),V(!1)},pe=ae=>{ae?(be(ae),z({...ae})):(be(null),z({role:"user",name:"",username:"",email:"",password:""})),V(!0)},Ae=ae=>{confirm(`Delete user '${ae}'?`)&&i([ae])},oe=r.filter(ae=>ae.name.toLowerCase().includes(ue.toLowerCase())||ae.username.toLowerCase().includes(ue.toLowerCase()));return u.jsx("div",{className:"max-w-4xl mx-auto space-y-6 animate-fade-in-up",children:u.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[u.jsxs("div",{className:"flex gap-4 border-b border-gray-100 mb-6 pb-2",children:[u.jsx("button",{onClick:()=>c("general"),className:`pb-2 px-1 text-sm font-bold border-b-2 transition ${l==="general"?"border-blue-600 text-blue-700":"border-transparent text-gray-500 hover:text-gray-700"}`,children:" General Configuration"}),u.jsx("button",{onClick:()=>c("users"),className:`pb-2 px-1 text-sm font-bold border-b-2 transition ${l==="users"?"border-blue-600 text-blue-700":"border-transparent text-gray-500 hover:text-gray-700"}`,children:" Users & Roles"})]}),l==="general"&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"space-y-4 pb-6 border-b border-gray-100",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Company Logo"}),u.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[u.jsx("div",{className:"w-32 h-32 bg-gray-50 rounded-lg border border-gray-200 flex items-center justify-center overflow-hidden shrink-0 relative group",children:m?u.jsx("img",{src:m,alt:"Logo Preview",className:"w-full h-full object-contain p-2"}):u.jsx("span",{className:"text-gray-400 text-xs text-center px-2",children:"Default Logo"})}),u.jsxs("div",{className:"flex-1 space-y-3",children:[u.jsx("label",{className:"block text-sm font-bold text-gray-700",children:"Upload New Logo"}),u.jsx("input",{ref:Y,type:"file",accept:"image/*",onChange:re,className:`block w-full text-sm text-gray-500
                                    file:mr-4 file:py-2 file:px-4
                                    file:rounded-full file:border-0
                                    file:text-sm file:font-semibold
                                    file:bg-blue-50 file:text-blue-700
                                    hover:file:bg-blue-100
                                `}),u.jsx("p",{className:"text-xs text-gray-500",children:"Supported formats: PNG, JPG, GIF. Max size: 500KB."}),m&&u.jsx("button",{onClick:G,className:"text-sm text-red-600 hover:text-red-800 font-medium underline",children:"Remove Custom Logo (Reset to Default)"})]})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-800",children:"Cloud Connection"}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:["Google Apps Script Web App URL",u.jsx("span",{className:"ml-2 font-normal text-gray-500",children:"(Required for Drive Backup & Sheets Sync)"})]}),u.jsx("div",{className:"flex flex-col gap-2",children:u.jsx("input",{type:"text",value:f,onChange:ae=>d(ae.target.value),placeholder:"https://script.google.com/macros/s/.../exec",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-mono text-sm"})})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Automatic Backup Frequency"}),u.jsxs("select",{value:v,onChange:ae=>x(ae.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none bg-white text-sm",children:[u.jsx("option",{value:"disabled",children:"Disabled"}),u.jsx("option",{value:"30min",children:"Every 30 Minutes"}),u.jsx("option",{value:"hourly",children:"Hourly (Default)"}),u.jsx("option",{value:"daily",children:"Daily (Every 24 Hours)"}),u.jsx("option",{value:"weekly",children:"Weekly (Every 7 Days)"})]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Data is saved to the configured Google Sheet."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-1",children:"Manual Actions"}),u.jsx("div",{className:"flex gap-2",children:u.jsxs("button",{onClick:F,disabled:A,className:"flex-1 py-3 bg-red-50 text-red-700 border border-red-200 rounded-lg hover:bg-red-100 font-bold text-sm flex items-center justify-center gap-2",children:[A?u.jsx("span",{className:"animate-spin",children:""}):u.jsx("span",{children:""}),"Restore All"]})}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Restore overwrites local data with cloud data."})]})]}),u.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-4 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"text-sm text-gray-600 flex-1 mr-4",children:[u.jsxs("p",{children:["Status: ",u.jsx("span",{className:`font-bold ${O==="success"?"text-green-600":O==="error"?"text-red-600":"text-gray-800"}`,children:k||"Ready to Save"})]}),k.includes("Connection Blocked")&&u.jsxs("p",{className:"text-xs text-red-500 mt-1",children:[" Fix: Go to Script > Deploy > Manage Deployments > Edit > Set ",u.jsx("strong",{children:"Who has access"})," to ",u.jsx("strong",{children:"Anyone"}),"."]}),k.includes("Saved Successfully")&&u.jsx("p",{className:"text-xs text-green-600 mt-1",children:"Application will reload shortly to apply changes..."})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("button",{onClick:W,disabled:y,className:"px-4 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition text-sm font-medium flex items-center gap-2 whitespace-nowrap",children:[y?u.jsx("span",{className:"animate-spin",children:""}):u.jsx("span",{children:""}),"Test"]}),u.jsx("button",{onClick:Q,className:"px-6 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition shadow-sm",children:"Save Settings"})]})]})]}),u.jsxs("div",{className:"pt-6 border-t border-gray-100",children:[u.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-2",children:"Backend Script Code"}),u.jsx("p",{className:"text-sm text-gray-600 mb-4",children:'If you are seeing "Script is outdated" or "Restore Failed", you must update your script below.'}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"bg-slate-900 rounded-lg p-4 overflow-x-auto max-h-64",children:u.jsx("pre",{className:"text-xs text-green-400 font-mono whitespace-pre-wrap",children:F4})}),u.jsx("button",{onClick:M,className:"absolute top-2 right-2 px-3 py-1 bg-white/10 hover:bg-white/20 text-white text-xs rounded border border-white/20 backdrop-blur-sm transition",children:B||"Copy Code"})]})]})]}),l==="users"&&u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center bg-gray-50 p-3 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"relative w-64",children:[u.jsx("input",{type:"text",placeholder:"Search users...",value:ue,onChange:ae=>se(ae.target.value),className:"w-full pl-8 pr-4 py-2 border rounded-lg text-sm"}),u.jsx("span",{className:"absolute left-2.5 top-2.5 text-gray-400",children:""})]}),u.jsx("div",{className:"flex gap-2",children:u.jsx("button",{onClick:()=>pe(),className:"px-4 py-2 bg-green-600 text-white rounded text-sm font-bold hover:bg-green-700",children:"+ Add User"})})]}),u.jsx("div",{className:"overflow-auto border rounded-lg",children:u.jsxs("table",{className:"w-full text-left text-sm whitespace-nowrap",children:[u.jsx("thead",{className:"bg-gray-100 text-gray-700 sticky top-0",children:u.jsxs("tr",{children:[u.jsx("th",{className:"p-3",children:"Username"}),u.jsx("th",{className:"p-3",children:"Full Name"}),u.jsx("th",{className:"p-3",children:"Role"}),u.jsx("th",{className:"p-3",children:"Email"}),u.jsx("th",{className:"p-3",children:"Permissions (Loc/Sec/Div)"}),u.jsx("th",{className:"p-3 text-right",children:"Actions"})]})}),u.jsxs("tbody",{className:"divide-y divide-gray-100",children:[oe.map(ae=>{var ze,q,Je,qe,ot,Ke;return u.jsxs("tr",{className:"hover:bg-blue-50",children:[u.jsx("td",{className:"p-3 font-bold",children:ae.username}),u.jsx("td",{className:"p-3",children:ae.name}),u.jsx("td",{className:"p-3",children:u.jsx("span",{className:"bg-gray-200 px-2 py-1 rounded text-xs",children:ae.role})}),u.jsx("td",{className:"p-3 text-gray-500",children:ae.email}),u.jsxs("td",{className:"p-3 text-xs text-gray-500 max-w-xs truncate",title:`L:${((ze=ae.allowedLocationIds)==null?void 0:ze.join(","))||"-"} S:${((q=ae.allowedSectorIds)==null?void 0:q.join(","))||"-"} D:${((Je=ae.allowedDivisionIds)==null?void 0:Je.join(","))||"-"}`,children:["L: ",((qe=ae.allowedLocationIds)==null?void 0:qe.length)||0," | S: ",((ot=ae.allowedSectorIds)==null?void 0:ot.length)||0," | D: ",((Ke=ae.allowedDivisionIds)==null?void 0:Ke.length)||0]}),u.jsxs("td",{className:"p-3 text-right space-x-2",children:[u.jsx("button",{onClick:()=>pe(ae),className:"text-blue-600 hover:underline",children:"Edit"}),u.jsx("button",{onClick:()=>Ae(ae.username),className:"text-red-600 hover:underline",children:"Delete"})]})]},ae.username)}),oe.length===0&&u.jsx("tr",{children:u.jsx("td",{colSpan:6,className:"p-8 text-center text-gray-400",children:"No users found."})})]})]})})]}),te&&u.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:u.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[u.jsxs("div",{className:"p-4 border-b bg-gray-50 flex justify-between items-center",children:[u.jsx("h3",{className:"font-bold",children:ge?"Edit User":"New User"}),u.jsx("button",{onClick:()=>V(!1),children:""})]}),u.jsxs("form",{onSubmit:le,className:"p-6 overflow-y-auto space-y-3",children:[u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Username"}),u.jsx("input",{required:!0,disabled:!!ge,className:"w-full border rounded p-2",value:ve.username||"",onChange:ae=>z({...ve,username:ae.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Full Name"}),u.jsx("input",{required:!0,className:"w-full border rounded p-2",value:ve.name||"",onChange:ae=>z({...ve,name:ae.target.value})})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Role"}),u.jsxs("select",{className:"w-full border rounded p-2",value:ve.role||"user",onChange:ae=>z({...ve,role:ae.target.value}),children:[u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"warehouse_manager",children:"Warehouse Manager"}),u.jsx("option",{value:"warehouse_supervisor",children:"Warehouse Supervisor"}),u.jsx("option",{value:"maintenance_manager",children:"Maintenance Manager"}),u.jsx("option",{value:"maintenance_engineer",children:"Maintenance Engineer"}),u.jsx("option",{value:"user",children:"User (Operator)"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Email"}),u.jsx("input",{type:"email",className:"w-full border rounded p-2",value:ve.email||"",onChange:ae=>z({...ve,email:ae.target.value})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Password"}),u.jsx("input",{type:"text",className:"w-full border rounded p-2",placeholder:ge?"(Unchanged)":"Enter password",value:ve.password||"",onChange:ae=>z({...ve,password:ae.target.value}),required:!ge})]}),u.jsxs("div",{className:"pt-2 border-t",children:[u.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-2",children:"Permissions (Comma Separated IDs)"}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-gray-500",children:"Allowed Locations"}),u.jsx("input",{className:"w-full border rounded p-2 text-sm",placeholder:"e.g. WH-001, WH-002",value:Array.isArray(ve.allowedLocationIds)?ve.allowedLocationIds.join(", "):ve.allowedLocationIds||"",onChange:ae=>z({...ve,allowedLocationIds:ae.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-gray-500",children:"Allowed Sectors"}),u.jsx("input",{className:"w-full border rounded p-2 text-sm",placeholder:"e.g. SEC-001",value:Array.isArray(ve.allowedSectorIds)?ve.allowedSectorIds.join(", "):ve.allowedSectorIds||"",onChange:ae=>z({...ve,allowedSectorIds:ae.target.value})})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-xs text-gray-500",children:"Allowed Divisions"}),u.jsx("input",{className:"w-full border rounded p-2 text-sm",placeholder:"e.g. DIV-001",value:Array.isArray(ve.allowedDivisionIds)?ve.allowedDivisionIds.join(", "):ve.allowedDivisionIds||"",onChange:ae=>z({...ve,allowedDivisionIds:ae.target.value})})]})]}),u.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mt-4 mb-2",children:"Sidebar Menu Visibility"}),u.jsx("div",{className:"grid grid-cols-2 gap-2 bg-gray-50 p-3 rounded border",children:Ob.map(ae=>{const ze=(ve.allowedMenus||[]).includes(ae.id);return u.jsxs("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 p-1 rounded transition",children:[u.jsx("input",{type:"checkbox",checked:ze,onChange:q=>{const Je=ve.allowedMenus||[],qe=q.target.checked?[...Je,ae.id]:Je.filter(ot=>ot!==ae.id);z({...ve,allowedMenus:qe})}}),u.jsxs("span",{className:"text-xs truncate",children:[ae.icon," ",ae.label]})]},ae.id)})})]}),u.jsxs("div",{className:"pt-4 flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>V(!1),className:"px-4 py-2 border rounded",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded font-bold",children:"Save User"})]})]})]})})]})})};class ame extends N.Component{constructor(){super(...arguments),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Uncaught error:",t,r)}render(){var t;return this.state.hasError?u.jsxs("div",{className:"p-8 bg-red-50 border border-red-200 rounded-xl m-4 text-center",children:[u.jsx("h2",{className:"text-xl font-bold text-red-700 mb-2",children:"Something went wrong"}),u.jsx("p",{className:"text-red-600 mb-4",children:"The application encountered an error while rendering this view."}),u.jsxs("details",{className:"text-xs text-left bg-white p-4 rounded border border-red-100 overflow-auto max-h-48 mb-4",children:[u.jsx("summary",{className:"cursor-pointer font-bold mb-1",children:"Error Details"}),(t=this.state.error)==null?void 0:t.toString()]}),u.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",children:"Reload Application"})]}):this.props.children}}const ime="WareFlowDB",mo="keyval",sme=1,$S=()=>new Promise((e,t)=>{if(!("indexedDB"in window)){t(new Error("IndexedDB not supported"));return}const r=indexedDB.open(ime,sme);r.onupgradeneeded=n=>{const a=n.target.result;a.objectStoreNames.contains(mo)||a.createObjectStore(mo)},r.onsuccess=()=>e(r.result),r.onerror=()=>t(r.error)}),lme=async e=>{try{const t=await $S();return new Promise((r,n)=>{const l=t.transaction(mo,"readonly").objectStore(mo).get(e);l.onsuccess=()=>r(l.result||null),l.onerror=()=>n(l.error)})}catch(t){return console.error(`Error reading ${e} from DB:`,t),null}},G3=async(e,t)=>{try{const r=await $S();return new Promise((n,a)=>{const c=r.transaction(mo,"readwrite").objectStore(mo).put(t,e);c.onsuccess=()=>n(),c.onerror=()=>a(c.error)})}catch(r){console.error(`Error writing ${e} to DB:`,r)}},ome=async e=>{try{const t=await $S();return new Promise((r,n)=>{const l=t.transaction(mo,"readwrite").objectStore(mo).delete(e);l.onsuccess=()=>r(),l.onerror=()=>n(l.error)})}catch(t){console.error(`Error removing ${e} from DB:`,t)}};function iv(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r}function cme(e,t,r,n){function a(i){return i instanceof r?i:new r(function(l){l(i)})}return new(r||(r=Promise))(function(i,l){function c(m){try{d(n.next(m))}catch(p){l(p)}}function f(m){try{d(n.throw(m))}catch(p){l(p)}}function d(m){m.done?i(m.value):a(m.value).then(c,f)}d((n=n.apply(e,t||[])).next())})}const ume=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class zS extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class fme extends zS{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class K3 extends zS{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class X3 extends zS{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var qw;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(qw||(qw={}));class dme{constructor(t,{headers:r={},customFetch:n,region:a=qw.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=ume(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return cme(this,arguments,void 0,function*(r,n={}){var a;let i,l;try{const{headers:c,method:f,body:d,signal:m,timeout:p}=n;let v={},{region:x}=n;x||(x=this.region);const y=new URL(`${this.url}/${r}`);x&&x!=="any"&&(v["x-region"]=x,y.searchParams.set("forceFunctionRegion",x));let b;d&&(c&&!Object.prototype.hasOwnProperty.call(c,"Content-Type")||!c)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(v["Content-Type"]="application/octet-stream",b=d):typeof d=="string"?(v["Content-Type"]="text/plain",b=d):typeof FormData<"u"&&d instanceof FormData?b=d:(v["Content-Type"]="application/json",b=JSON.stringify(d)):d&&typeof d!="string"&&!(typeof Blob<"u"&&d instanceof Blob)&&!(d instanceof ArrayBuffer)&&!(typeof FormData<"u"&&d instanceof FormData)?b=JSON.stringify(d):b=d;let _=m;p&&(l=new AbortController,i=setTimeout(()=>l.abort(),p),m?(_=l.signal,m.addEventListener("abort",()=>l.abort())):_=l.signal);const E=yield this.fetch(y.toString(),{method:f||"POST",headers:Object.assign(Object.assign(Object.assign({},v),this.headers),c),body:b,signal:_}).catch(I=>{throw new fme(I)}),A=E.headers.get("x-relay-error");if(A&&A==="true")throw new K3(E);if(!E.ok)throw new X3(E);let T=((a=E.headers.get("Content-Type"))!==null&&a!==void 0?a:"text/plain").split(";")[0].trim(),k;return T==="application/json"?k=yield E.json():T==="application/octet-stream"||T==="application/pdf"?k=yield E.blob():T==="text/event-stream"?k=E:T==="multipart/form-data"?k=yield E.formData():k=yield E.text(),{data:k,error:null,response:E}}catch(c){return{data:null,error:c,response:c instanceof X3||c instanceof K3?c.context:void 0}}finally{i&&clearTimeout(i)}})}}var hme=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},mme=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{let l=null,c=null,f=null,d=i.status,m=i.statusText;if(i.ok){var p,v;if(r.method!=="HEAD"){var x;const E=await i.text();E===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((x=r.headers.get("Accept"))===null||x===void 0)&&x.includes("application/vnd.pgrst.plan+text"))?c=E:c=JSON.parse(E))}const b=(p=r.headers.get("Prefer"))===null||p===void 0?void 0:p.match(/count=(exact|planned|estimated)/),_=(v=i.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");b&&_&&_.length>1&&(f=parseInt(_[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(c)&&(c.length>1?(l={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,f=null,d=406,m="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{var y;const b=await i.text();try{l=JSON.parse(b),Array.isArray(l)&&i.status===404&&(c=[],l=null,d=200,m="OK")}catch{i.status===404&&b===""?(d=204,m="No Content"):l={message:b}}if(l&&r.isMaybeSingle&&(!(l==null||(y=l.details)===null||y===void 0)&&y.includes("0 rows"))&&(l=null,d=200,m="OK"),l&&r.shouldThrowOnError)throw new hme(l)}return{error:l,data:c,count:f,status:d,statusText:m}});return this.shouldThrowOnError||(a=a.catch(i=>{var l;let c="";const f=i==null?void 0:i.cause;if(f){var d,m,p,v;const y=(d=f==null?void 0:f.message)!==null&&d!==void 0?d:"",b=(m=f==null?void 0:f.code)!==null&&m!==void 0?m:"";c=`${(p=i==null?void 0:i.name)!==null&&p!==void 0?p:"FetchError"}: ${i==null?void 0:i.message}`,c+=`

Caused by: ${(v=f==null?void 0:f.name)!==null&&v!==void 0?v:"Error"}: ${y}`,b&&(c+=` (${b})`),f!=null&&f.stack&&(c+=`
${f.stack}`)}else{var x;c=(x=i==null?void 0:i.stack)!==null&&x!==void 0?x:""}return{error:{message:`${(l=i==null?void 0:i.name)!==null&&l!==void 0?l:"FetchError"}: ${i==null?void 0:i.message}`,details:c,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),a.then(e,t)}returns(){return this}overrideTypes(){return this}},pme=class extends mme{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:a=n}={}){const i=a?`${a}.order`:"order",l=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${l?`${l},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"offset":`${n}.offset`,i=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:a=!1,format:i="text"}={}){var l;const c=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,a?"wal":null].filter(Boolean).join("|"),f=(l=this.headers.get("Accept"))!==null&&l!==void 0?l:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${f}"; options=${c};`),i==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const Y3=new RegExp("[,()]");var Au=class extends pme{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Y3.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&Y3.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let a="";n==="plain"?a="pl":n==="phrase"?a="ph":n==="websearch"&&(a="w");const i=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},gme=class{constructor(e,{headers:t={},schema:r,fetch:n}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},a=r?"HEAD":"GET";let i=!1;const l=(e??"*").split("").map(d=>/\s/.test(d)&&!i?"":(d==='"'&&(i=!i),d)).join(""),{url:c,headers:f}=this.cloneRequestState();return c.searchParams.set("select",l),n&&f.append("Prefer",`count=${n}`),new Au({method:a,url:c,headers:f,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const a="POST",{url:i,headers:l}=this.cloneRequestState();if(t&&l.append("Prefer",`count=${t}`),r||l.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((f,d)=>f.concat(Object.keys(d)),[]);if(c.length>0){const f=[...new Set(c)].map(d=>`"${d}"`);i.searchParams.set("columns",f.join(","))}}return new Au({method:a,url:i,headers:l,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:a=!0}={}){var i;const l="POST",{url:c,headers:f}=this.cloneRequestState();if(f.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&c.searchParams.set("on_conflict",t),n&&f.append("Prefer",`count=${n}`),a||f.append("Prefer","missing=default"),Array.isArray(e)){const d=e.reduce((m,p)=>m.concat(Object.keys(p)),[]);if(d.length>0){const m=[...new Set(d)].map(p=>`"${p}"`);c.searchParams.set("columns",m.join(","))}}return new Au({method:l,url:c,headers:f,schema:this.schema,body:e,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}update(e,{count:t}={}){var r;const n="PATCH",{url:a,headers:i}=this.cloneRequestState();return t&&i.append("Prefer",`count=${t}`),new Au({method:n,url:a,headers:i,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:a}=this.cloneRequestState();return e&&a.append("Prefer",`count=${e}`),new Au({method:r,url:n,headers:a,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch})}},vme=class S8{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new gme(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new S8(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:i}={}){var l;let c;const f=new URL(`${this.url}/rpc/${t}`);let d;const m=x=>x!==null&&typeof x=="object"&&(!Array.isArray(x)||x.some(m)),p=n&&Object.values(r).some(m);p?(c="POST",d=r):n||a?(c=n?"HEAD":"GET",Object.entries(r).filter(([x,y])=>y!==void 0).map(([x,y])=>[x,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([x,y])=>{f.searchParams.append(x,y)})):(c="POST",d=r);const v=new Headers(this.headers);return p?v.set("Prefer",i?`count=${i},return=minimal`:"return=minimal"):i&&v.set("Prefer",`count=${i}`),new Au({method:c,url:f,headers:v,schema:this.schemaName,body:d,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}};class xme{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const a=n.node,i=parseInt(a.replace(/^v/,"").split(".")[0]);return i>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${i} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${i} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const yme="2.91.1",bme=`realtime-js/${yme}`,wme="1.0.0",E8="2.0.0",Q3=E8,Ww=1e4,_me=1e3,Sme=100;var Zl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Zl||(Zl={}));var In;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(In||(In={}));var Zi;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Zi||(Zi={}));var Vw;(function(e){e.websocket="websocket"})(Vw||(Vw={}));var Ko;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Ko||(Ko={}));class Eme{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,a)}_encodeJsonUserBroadcastPush(t){var r,n;const a=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},l=new TextEncoder().encode(JSON.stringify(a)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,l)}_encodeUserBroadcastPush(t,r,n){var a,i;const l=t.topic,c=(a=t.ref)!==null&&a!==void 0?a:"",f=(i=t.join_ref)!==null&&i!==void 0?i:"",d=t.payload.event,m=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},p=Object.keys(m).length===0?"":JSON.stringify(m);if(f.length>255)throw new Error(`joinRef length ${f.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`ref length ${c.length} exceeds maximum of 255`);if(l.length>255)throw new Error(`topic length ${l.length} exceeds maximum of 255`);if(d.length>255)throw new Error(`userEvent length ${d.length} exceeds maximum of 255`);if(p.length>255)throw new Error(`metadata length ${p.length} exceeds maximum of 255`);const v=this.USER_BROADCAST_PUSH_META_LENGTH+f.length+c.length+l.length+d.length+p.length,x=new ArrayBuffer(this.HEADER_LENGTH+v);let y=new DataView(x),b=0;y.setUint8(b++,this.KINDS.userBroadcastPush),y.setUint8(b++,f.length),y.setUint8(b++,c.length),y.setUint8(b++,l.length),y.setUint8(b++,d.length),y.setUint8(b++,p.length),y.setUint8(b++,r),Array.from(f,E=>y.setUint8(b++,E.charCodeAt(0))),Array.from(c,E=>y.setUint8(b++,E.charCodeAt(0))),Array.from(l,E=>y.setUint8(b++,E.charCodeAt(0))),Array.from(d,E=>y.setUint8(b++,E.charCodeAt(0))),Array.from(p,E=>y.setUint8(b++,E.charCodeAt(0)));var _=new Uint8Array(x.byteLength+n.byteLength);return _.set(new Uint8Array(x),0),_.set(new Uint8Array(n),x.byteLength),_.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[a,i,l,c,f]=n;return r({join_ref:a,ref:i,topic:l,event:c,payload:f})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),a=new TextDecoder;switch(n){case this.KINDS.userBroadcast:return this._decodeUserBroadcast(t,r,a)}}_decodeUserBroadcast(t,r,n){const a=r.getUint8(1),i=r.getUint8(2),l=r.getUint8(3),c=r.getUint8(4);let f=this.HEADER_LENGTH+4;const d=n.decode(t.slice(f,f+a));f=f+a;const m=n.decode(t.slice(f,f+i));f=f+i;const p=n.decode(t.slice(f,f+l));f=f+l;const v=t.slice(f,t.byteLength),x=c===this.JSON_ENCODING?JSON.parse(n.decode(v)):v,y={type:this.BROADCAST_EVENT,event:m,payload:x};return l>0&&(y.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST_EVENT,payload:y}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t==null?void 0:t.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}class N8{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Lr;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(Lr||(Lr={}));const J3=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((i,l)=>(i[l]=Nme(l,e,t,a),i),{}):{}},Nme=(e,t,r,n)=>{const a=t.find(c=>c.name===e),i=a==null?void 0:a.type,l=r[e];return i&&!n.includes(i)?k8(i,l):Gw(l)},k8=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return jme(t,r)}switch(e){case Lr.bool:return kme(t);case Lr.float4:case Lr.float8:case Lr.int2:case Lr.int4:case Lr.int8:case Lr.numeric:case Lr.oid:return Tme(t);case Lr.json:case Lr.jsonb:return Ame(t);case Lr.timestamp:return Ome(t);case Lr.abstime:case Lr.date:case Lr.daterange:case Lr.int4range:case Lr.int8range:case Lr.money:case Lr.reltime:case Lr.text:case Lr.time:case Lr.timestamptz:case Lr.timetz:case Lr.tsrange:case Lr.tstzrange:return Gw(t);default:return Gw(t)}},Gw=e=>e,kme=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Tme=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},Ame=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},jme=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let i;const l=e.slice(1,r);try{i=JSON.parse("["+l+"]")}catch{i=l?l.split(","):[]}return i.map(c=>k8(t,c))}return e},Ome=e=>typeof e=="string"?e.replace(" ","T"):e,T8=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class wb{constructor(t,r,n={},a=Ww){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var Z3;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(Z3||(Z3={}));class Dd{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Dd.syncState(this.state,a,i,l),this.pendingDiffs.forEach(f=>{this.state=Dd.syncDiff(this.state,f,i,l)}),this.pendingDiffs=[],c()}),this.channel._on(n.diff,{},a=>{const{onJoin:i,onLeave:l,onSync:c}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Dd.syncDiff(this.state,a,i,l),c())}),this.onJoin((a,i,l)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:i,newPresences:l})}),this.onLeave((a,i,l)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:i,leftPresences:l})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const i=this.cloneDeep(t),l=this.transformState(r),c={},f={};return this.map(i,(d,m)=>{l[d]||(f[d]=m)}),this.map(l,(d,m)=>{const p=i[d];if(p){const v=m.map(_=>_.presence_ref),x=p.map(_=>_.presence_ref),y=m.filter(_=>x.indexOf(_.presence_ref)<0),b=p.filter(_=>v.indexOf(_.presence_ref)<0);y.length>0&&(c[d]=y),b.length>0&&(f[d]=b)}else c[d]=m}),this.syncDiff(i,{joins:c,leaves:f},n,a)}static syncDiff(t,r,n,a){const{joins:i,leaves:l}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(i,(c,f)=>{var d;const m=(d=t[c])!==null&&d!==void 0?d:[];if(t[c]=this.cloneDeep(f),m.length>0){const p=t[c].map(x=>x.presence_ref),v=m.filter(x=>p.indexOf(x.presence_ref)<0);t[c].unshift(...v)}n(c,m,f)}),this.map(l,(c,f)=>{let d=t[c];if(!d)return;const m=f.map(p=>p.presence_ref);d=d.filter(p=>m.indexOf(p.presence_ref)<0),t[c]=d,a(c,d,f),d.length===0&&delete t[c]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var eD;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(eD||(eD={}));var Id;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Id||(Id={}));var Qs;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Qs||(Qs={}));class Pu{constructor(t,r={config:{}},n){var a,i;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=In.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new wb(this,Zi.join,this.params,this.timeout),this.rejoinTimer=new N8(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=In.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(l=>l.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=In.closed,this.socket._remove(this)}),this._onError(l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=In.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=In.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",l=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,l),this.state=In.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Zi.reply,{},(l,c)=>{this._trigger(this._replyEventName(c),l)}),this.presence=new Dd(this),this.broadcastEndpointURL=T8(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(a=this.params.config)===null||a===void 0?void 0:a.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,a,i;if(this.socket.isConnected()||this.socket.connect(),this.state==In.closed){const{config:{broadcast:l,presence:c,private:f}}=this.params,d=(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(x=>x.filter))!==null&&a!==void 0?a:[],m=!!this.bindings[Id.PRESENCE]&&this.bindings[Id.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,p={},v={broadcast:l,presence:Object.assign(Object.assign({},c),{enabled:m}),postgres_changes:d,private:f};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(x=>t==null?void 0:t(Qs.CHANNEL_ERROR,x)),this._onClose(()=>t==null?void 0:t(Qs.CLOSED)),this.updateJoinPayload(Object.assign({config:v},p)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:x})=>{var y;if(this.socket._isManualToken()||this.socket.setAuth(),x===void 0){t==null||t(Qs.SUBSCRIBED);return}else{const b=this.bindings.postgres_changes,_=(y=b==null?void 0:b.length)!==null&&y!==void 0?y:0,E=[];for(let A=0;A<_;A++){const T=b[A],{filter:{event:k,schema:I,table:O,filter:j}}=T,B=x&&x[A];if(B&&B.event===k&&Pu.isFilterValueEqual(B.schema,I)&&Pu.isFilterValueEqual(B.table,O)&&Pu.isFilterValueEqual(B.filter,j))E.push(Object.assign(Object.assign({},T),{id:B.id}));else{this.unsubscribe(),this.state=In.errored,t==null||t(Qs.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=E,t&&t(Qs.SUBSCRIBED);return}}).receive("error",x=>{this.state=In.errored,t==null||t(Qs.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(x).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Qs.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===In.joined&&t===Id.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var a;if(r==null)return Promise.reject("Payload is required for httpSend()");const i={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(i.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:i,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(a=n.timeout)!==null&&a!==void 0?a:this.timeout);if(c.status===202)return{success:!0};let f=c.statusText;try{const d=await c.json();f=d.error||d.message||f}catch{}return Promise.reject(new Error(f))}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:l}=t,c={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(c.Authorization=`Bearer ${this.socket.accessTokenValue}`);const f={method:"POST",headers:c,body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:l,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,f,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=d.body)===null||a===void 0?void 0:a.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var l,c,f;const d=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((f=(c=(l=this.params)===null||l===void 0?void 0:l.config)===null||c===void 0?void 0:c.broadcast)===null||f===void 0)&&f.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=In.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Zi.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(a=>{n=new wb(this,Zi.leave,{},t),n.receive("ok",()=>{r(),a("ok")}).receive("timeout",()=>{r(),a("timed out")}).receive("error",()=>{a("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n==null||n.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=In.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const a=new AbortController,i=setTimeout(()=>a.abort(),n),l=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(i),l}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new wb(this,t,r,n);return this._canPush()?a.send():this._addToPushBuffer(a),a}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>Sme){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,i;const l=t.toLocaleLowerCase(),{close:c,error:f,leave:d,join:m}=Zi;if(n&&[c,f,d,m].indexOf(l)>=0&&n!==this._joinRef())return;let v=this._onMessage(l,r,n);if(r&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(l)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(x=>{var y,b,_;return((y=x.filter)===null||y===void 0?void 0:y.event)==="*"||((_=(b=x.filter)===null||b===void 0?void 0:b.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===l}).map(x=>x.callback(v,n)):(i=this.bindings[l])===null||i===void 0||i.filter(x=>{var y,b,_,E,A,T,k,I;if(["broadcast","presence","postgres_changes"].includes(l))if("id"in x){const O=x.id,j=(y=x.filter)===null||y===void 0?void 0:y.event;return O&&((b=r.ids)===null||b===void 0?void 0:b.includes(O))&&(j==="*"||(j==null?void 0:j.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))&&(!(!((E=x.filter)===null||E===void 0)&&E.table)||x.filter.table===((A=r.data)===null||A===void 0?void 0:A.table))}else{const O=(k=(T=x==null?void 0:x.filter)===null||T===void 0?void 0:T.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return O==="*"||O===((I=r==null?void 0:r.event)===null||I===void 0?void 0:I.toLocaleLowerCase())}else return x.type.toLocaleLowerCase()===l}).map(x=>{if(typeof v=="object"&&"ids"in v){const y=v.data,{schema:b,table:_,commit_timestamp:E,type:A,errors:T}=y;v=Object.assign(Object.assign({},{schema:b,table:_,commit_timestamp:E,eventType:A,new:{},old:{},errors:T}),this._getPayloadRecords(y))}x.callback(v,n)})}_isClosed(){return this.state===In.closed}_isJoined(){return this.state===In.joined}_isJoining(){return this.state===In.joining}_isLeaving(){return this.state===In.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),i={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(i):this.bindings[a]=[i],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(a=>{var i;return!(((i=a.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===n&&Pu.isEqual(a.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Zi.close,{},t)}_onError(t){this._on(Zi.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=In.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=J3(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=J3(t.columns,t.old_record)),r}}const _b=()=>{},Im={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},Cme=[1e3,2e3,5e3,1e4],Dme=1e4,Ime=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class Pme{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Ww,this.transport=null,this.heartbeatIntervalMs=Im.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=_b,this.ref=0,this.reconnectTimer=null,this.vsn=Q3,this.logger=_b,this.conn=null,this.sendBuffer=[],this.serializer=new Eme,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=a=>a?(...i)=>a(...i):(...i)=>fetch(...i),!(!((n=r==null?void 0:r.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Vw.websocket}`,this.httpEndpoint=T8(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r==null?void 0:r.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=xme.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Zl.connecting:return Ko.Connecting;case Zl.open:return Ko.Open;case Zl.closing:return Ko.Closing;default:return Ko.Closed}}isConnected(){return this.connectionState()===Ko.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,a=this.getChannels().find(i=>i.topic===n);if(a)return a;{const i=new Pu(`realtime:${t}`,r,this);return this.channels.push(i),i}}push(t){const{topic:r,event:n,payload:a,ref:i}=t,l=()=>{this.encode(t,c=>{var f;(f=this.conn)===null||f===void 0||f.send(c)})};this.log("push",`${r} ${n} (${i})`,a),this.isConnected()?l():this.sendBuffer.push(l)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(_me,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Im.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const d=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",d)}catch(m){this.log("error","error in heartbeat callback",m)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:a,payload:i,ref:l}=r,c=l?`(${l})`:"",f=i.status||"";this.log("receive",`${f} ${n} ${a} ${c}`.trim(),i),this.channels.filter(d=>d._isMember(n)).forEach(d=>d._trigger(a,i,l)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Zl.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Zl.open||this.conn.readyState===Zl.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Zi.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([Ime],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(a){this.log("error","Error fetching access token from callback",a),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(a=>{const i={access_token:r,version:bme};r&&a.updateJoinPayload(i),a.joinedOnce&&a._isJoined()&&a._push(Zi.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(a){this.log("error",`error in ${t} callback`,a)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new N8(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Im.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,a,i,l,c,f,d,m,p,v,x;switch(this.transport=(r=t==null?void 0:t.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t==null?void 0:t.timeout)!==null&&n!==void 0?n:Ww,this.heartbeatIntervalMs=(a=t==null?void 0:t.heartbeatIntervalMs)!==null&&a!==void 0?a:Im.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(l=t==null?void 0:t.accessToken)!==null&&l!==void 0?l:null,this.heartbeatCallback=(c=t==null?void 0:t.heartbeatCallback)!==null&&c!==void 0?c:_b,this.vsn=(f=t==null?void 0:t.vsn)!==null&&f!==void 0?f:Q3,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=t==null?void 0:t.reconnectAfterMs)!==null&&d!==void 0?d:(y=>Cme[y-1]||Dme),this.vsn){case wme:this.encode=(m=t==null?void 0:t.encode)!==null&&m!==void 0?m:((y,b)=>b(JSON.stringify(y))),this.decode=(p=t==null?void 0:t.decode)!==null&&p!==void 0?p:((y,b)=>b(JSON.parse(y)));break;case E8:this.encode=(v=t==null?void 0:t.encode)!==null&&v!==void 0?v:this.serializer.encode.bind(this.serializer),this.decode=(x=t==null?void 0:t.decode)!==null&&x!==void 0?x:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}var u0=class extends Error{constructor(e,t){var r;super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&((r=t.icebergType)==null?void 0:r.includes("CommitState"))===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function Mme(e,t,r){const n=new URL(t,e);if(r)for(const[a,i]of Object.entries(r))i!==void 0&&n.searchParams.set(a,i);return n.toString()}async function Rme(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function Fme(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:a,body:i,headers:l}){const c=Mme(e.baseUrl,n,a),f=await Rme(e.auth),d=await t(c,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...f,...l},body:i?JSON.stringify(i):void 0}),m=await d.text(),p=(d.headers.get("content-type")||"").includes("application/json"),v=p&&m?JSON.parse(m):m;if(!d.ok){const x=p?v:void 0,y=x==null?void 0:x.error;throw new u0((y==null?void 0:y.message)??`Request failed with status ${d.status}`,{status:d.status,icebergType:y==null?void 0:y.type,icebergCode:y==null?void 0:y.code,details:x})}return{status:d.status,headers:d.headers,data:v}}}}function Pm(e){return e.join("")}var Lme=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Pm(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t==null?void 0:t.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Pm(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Pm(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Pm(e.namespace)}`}),!0}catch(t){if(t instanceof u0&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof u0&&r.status===409)return;throw r}}};function bu(e){return e.join("")}var Bme=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bu(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bu(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${bu(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${bu(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String((t==null?void 0:t.purge)??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${bu(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${bu(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof u0&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof u0&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},Ume=class{constructor(e){var n;let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=Fme({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=(n=e.accessDelegation)==null?void 0:n.join(","),this.namespaceOps=new Lme(this.client,t),this.tableOps=new Bme(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},sv=class extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}};function en(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var $me=class extends sv{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Kw=class extends sv{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}};const HS=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),zme=()=>Response,Xw=e=>{if(Array.isArray(e))return e.map(r=>Xw(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[a]=Xw(n)}),t},Hme=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},qme=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function f0(e){"@babel/helpers - typeof";return f0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},f0(e)}function Wme(e,t){if(f0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(f0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Vme(e){var t=Wme(e,"string");return f0(t)=="symbol"?t:t+""}function Gme(e,t,r){return(t=Vme(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function tD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ct(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tD(Object(r),!0).forEach(function(n){Gme(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Sb=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Kme=async(e,t,r)=>{e instanceof await zme()&&!(r!=null&&r.noResolveJson)?e.json().then(n=>{const a=e.status||500,i=(n==null?void 0:n.statusCode)||a+"";t(new $me(Sb(n),a,i))}).catch(n=>{t(new Kw(Sb(n),n))}):t(new Kw(Sb(e),e))},Xme=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!n?a:(Hme(n)?(a.headers=Ct({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,t!=null&&t.duplex&&(a.duplex=t.duplex),Ct(Ct({},a),r))};async function G0(e,t,r,n,a,i){return new Promise((l,c)=>{e(r,Xme(t,n,a,i)).then(f=>{if(!f.ok)throw f;return n!=null&&n.noResolveJson?f:f.json()}).then(f=>l(f)).catch(f=>Kme(f,c,n))})}async function d0(e,t,r,n){return G0(e,"GET",t,r,n)}async function Ji(e,t,r,n,a){return G0(e,"POST",t,n,a,r)}async function Yw(e,t,r,n,a){return G0(e,"PUT",t,n,a,r)}async function Yme(e,t,r,n){return G0(e,"HEAD",t,Ct(Ct({},r),{},{noResolveJson:!0}),n)}async function qS(e,t,r,n,a){return G0(e,"DELETE",t,n,a,r)}var Qme=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(en(t))return{data:null,error:t};throw t}}};let A8;A8=Symbol.toStringTag;var Jme=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[A8]="BlobDownloadBuilder",this.promise=null}asStream(){return new Qme(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(en(t))return{data:null,error:t};throw t}}};const Zme={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},rD={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var epe=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=HS(n)}throwOnError(){return this.shouldThrowOnError=!0,this}async uploadOrUpdate(e,t,r,n){var a=this;try{let i;const l=Ct(Ct({},rD),n);let c=Ct(Ct({},a.headers),e==="POST"&&{"x-upsert":String(l.upsert)});const f=l.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",l.cacheControl),f&&i.append("metadata",a.encodeMetadata(f)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.has("cacheControl")||i.append("cacheControl",l.cacheControl),f&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(f))):(i=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType,f&&(c["x-metadata"]=a.toBase64(a.encodeMetadata(f))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!l.duplex&&(l.duplex="half")),n!=null&&n.headers&&(c=Ct(Ct({},c),n.headers));const d=a._removeEmptyFolders(t),m=a._getFinalPath(d),p=await(e=="PUT"?Yw:Ji)(a.fetch,`${a.url}/object/${m}`,i,Ct({headers:c},l!=null&&l.duplex?{duplex:l.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(i){if(a.shouldThrowOnError)throw i;if(en(i))return{data:null,error:i};throw i}}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var a=this;const i=a._removeEmptyFolders(e),l=a._getFinalPath(i),c=new URL(a.url+`/object/upload/sign/${l}`);c.searchParams.set("token",t);try{let f;const d=Ct({upsert:rD.upsert},n),m=Ct(Ct({},a.headers),{"x-upsert":String(d.upsert)});return typeof Blob<"u"&&r instanceof Blob?(f=new FormData,f.append("cacheControl",d.cacheControl),f.append("",r)):typeof FormData<"u"&&r instanceof FormData?(f=r,f.append("cacheControl",d.cacheControl)):(f=r,m["cache-control"]=`max-age=${d.cacheControl}`,m["content-type"]=d.contentType),{data:{path:i,fullPath:(await Yw(a.fetch,c.toString(),f,{headers:m})).Key},error:null}}catch(f){if(a.shouldThrowOnError)throw f;if(en(f))return{data:null,error:f};throw f}}async createSignedUploadUrl(e,t){var r=this;try{let n=r._getFinalPath(e);const a=Ct({},r.headers);t!=null&&t.upsert&&(a["x-upsert"]="true");const i=await Ji(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:a}),l=new URL(r.url+i.url),c=l.searchParams.get("token");if(!c)throw new sv("No token returned by API");return{data:{signedUrl:l.toString(),path:e,token:c},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;try{return{data:await Ji(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers}),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}}async copy(e,t,r){var n=this;try{return{data:{path:(await Ji(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r==null?void 0:r.destinationBucket},{headers:n.headers})).Key},error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}}async createSignedUrl(e,t,r){var n=this;try{let a=n._getFinalPath(e),i=await Ji(n.fetch,`${n.url}/object/sign/${a}`,Ct({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:n.headers});const l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${n.url}${i.signedURL}${l}`)},{data:i,error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}}async createSignedUrls(e,t,r){var n=this;try{const a=await Ji(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:a.map(l=>Ct(Ct({},l),{},{signedUrl:l.signedURL?encodeURI(`${n.url}${l.signedURL}${i}`):null})),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",n=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=n?`?${n}`:"",i=this._getFinalPath(e),l=()=>d0(this.fetch,`${this.url}/${r}/${i}${a}`,{headers:this.headers,noResolveJson:!0});return new Jme(l,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);try{return{data:Xw(await d0(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})),error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Yme(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(en(n)&&n instanceof Kw){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],a=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&n.push(a);const i=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});l!==""&&n.push(l);let c=n.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${c}`)}}}async remove(e){var t=this;try{return{data:await qS(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}}async list(e,t,r){var n=this;try{const a=Ct(Ct(Ct({},Zme),t),{},{prefix:e||""});return{data:await Ji(n.fetch,`${n.url}/object/list/${n.bucketId}`,a,{headers:n.headers},r),error:null}}catch(a){if(n.shouldThrowOnError)throw a;if(en(a))return{data:null,error:a};throw a}}async listV2(e,t){var r=this;try{const n=Ct({},e);return{data:await Ji(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const j8="2.91.1",O8={"X-Client-Info":`storage-js/${j8}`};var tpe=class{constructor(e,t={},r,n){this.shouldThrowOnError=!1;const a=new URL(e);n!=null&&n.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Ct(Ct({},O8),t),this.fetch=HS(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async listBuckets(e){var t=this;try{const r=t.listBucketOptionsToQueryString(e);return{data:await d0(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await d0(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}}async createBucket(e,t={public:!1}){var r=this;try{return{data:await Ji(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}}async updateBucket(e,t){var r=this;try{return{data:await Yw(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(en(n))return{data:null,error:n};throw n}}async emptyBucket(e){var t=this;try{return{data:await Ji(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await qS(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},rpe=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ct(Ct({},O8),t),this.fetch=HS(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await Ji(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}}async listBuckets(e){var t=this;try{const r=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&r.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&r.set("sortOrder",e.sortOrder),e!=null&&e.search&&r.set("search",e.search);const n=r.toString(),a=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return{data:await d0(t.fetch,a,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await qS(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(en(r))return{data:null,error:r};throw r}}from(e){var t=this;if(!qme(e))throw new sv("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new Ume({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(a,i){const l=a[i];return typeof l!="function"?l:async(...c)=>{try{return{data:await l.apply(a,c),error:null}}catch(f){if(n)throw f;return{data:null,error:f}}}}})}};const WS={"X-Client-Info":`storage-js/${j8}`,"Content-Type":"application/json"};var C8=class extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function pi(e){return typeof e=="object"&&e!==null&&"__isStorageVectorsError"in e}var Eb=class extends C8{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},npe=class extends C8{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}};const VS=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),ape=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},nD=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ipe=async(e,t,r)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!(r!=null&&r.noResolveJson)){const n=e.status||500,a=e;if(typeof a.json=="function")a.json().then(i=>{const l=(i==null?void 0:i.statusCode)||(i==null?void 0:i.code)||n+"";t(new Eb(nD(i),n,l))}).catch(()=>{const i=n+"";t(new Eb(a.statusText||`HTTP ${n} error`,n,i))});else{const i=n+"";t(new Eb(a.statusText||`HTTP ${n} error`,n,i))}}else t(new npe(nD(e),e))},spe=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return n?(ape(n)?(a.headers=Ct({"Content-Type":"application/json"},t==null?void 0:t.headers),a.body=JSON.stringify(n)):a.body=n,Ct(Ct({},a),r)):a};async function lpe(e,t,r,n,a,i){return new Promise((l,c)=>{e(r,spe(t,n,a,i)).then(f=>{if(!f.ok)throw f;if(n!=null&&n.noResolveJson)return f;const d=f.headers.get("content-type");return!d||!d.includes("application/json")?{}:f.json()}).then(f=>l(f)).catch(f=>ipe(f,c,n))})}async function gi(e,t,r,n,a){return lpe(e,"POST",t,n,a,r)}var ope=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ct(Ct({},WS),t),this.fetch=VS(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createIndex(e){var t=this;try{return{data:await gi(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async getIndex(e,t){var r=this;try{return{data:await gi(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}),error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(pi(n))return{data:null,error:n};throw n}}async listIndexes(e){var t=this;try{return{data:await gi(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async deleteIndex(e,t){var r=this;try{return{data:await gi(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{},error:null}}catch(n){if(r.shouldThrowOnError)throw n;if(pi(n))return{data:null,error:n};throw n}}},cpe=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ct(Ct({},WS),t),this.fetch=VS(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async putVectors(e){var t=this;try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:await gi(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async getVectors(e){var t=this;try{return{data:await gi(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async listVectors(e){var t=this;try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:await gi(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async queryVectors(e){var t=this;try{return{data:await gi(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async deleteVectors(e){var t=this;try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:await gi(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}},upe=class{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Ct(Ct({},WS),t),this.fetch=VS(r)}throwOnError(){return this.shouldThrowOnError=!0,this}async createBucket(e){var t=this;try{return{data:await gi(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async getBucket(e){var t=this;try{return{data:await gi(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async listBuckets(e={}){var t=this;try{return{data:await gi(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}async deleteBucket(e){var t=this;try{return{data:await gi(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{},error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(pi(r))return{data:null,error:r};throw r}}},fpe=class extends upe{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new dpe(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},dpe=class extends ope{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ct(Ct({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ct(Ct({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new hpe(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},hpe=class extends cpe{constructor(e,t,r,n,a){super(e,t,a),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ct(Ct({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ct(Ct({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ct(Ct({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ct(Ct({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ct(Ct({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},mpe=class extends tpe{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new epe(this.url,this.headers,e,this.fetch)}get vectors(){return new fpe(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new rpe(this.url+"/iceberg",this.headers,this.fetch)}};const D8="2.91.1",ju=30*1e3,Qw=3,Nb=Qw*ju,ppe="http://localhost:9999",gpe="supabase.auth.token",vpe={"X-Client-Info":`gotrue-js/${D8}`},Jw="X-Supabase-Api-Version",I8={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},xpe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,ype=600*1e3;class h0 extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function _t(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class bpe extends h0{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function wpe(e){return _t(e)&&e.name==="AuthApiError"}class Xo extends h0{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class kl extends h0{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class li extends kl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function _pe(e){return _t(e)&&e.name==="AuthSessionMissingError"}class wu extends kl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mm extends kl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Rm extends kl{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function Spe(e){return _t(e)&&e.name==="AuthImplicitGrantRedirectError"}class aD extends kl{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Epe extends kl{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Zw extends kl{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function kb(e){return _t(e)&&e.name==="AuthRetryableFetchError"}class iD extends kl{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class e_ extends kl{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Zp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),sD=` 	
\r=`.split(""),Npe=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<sD.length;t+=1)e[sD[t].charCodeAt(0)]=-2;for(let t=0;t<Zp.length;t+=1)e[Zp[t].charCodeAt(0)]=t;return e})();function lD(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Zp[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Zp[n]),t.queuedBits-=6}}function P8(e,t,r){const n=Npe[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function oD(e){const t=[],r=l=>{t.push(String.fromCodePoint(l))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=l=>{Ape(l,n,r)};for(let l=0;l<e.length;l+=1)P8(e.charCodeAt(l),a,i);return t.join("")}function kpe(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function Tpe(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}kpe(n,t)}}function Ape(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function $u(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)P8(e.charCodeAt(a),r,n);return new Uint8Array(t)}function jpe(e){const t=[];return Tpe(e,r=>t.push(r)),new Uint8Array(t)}function tc(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};return e.forEach(a=>lD(a,r,n)),lD(null,r,n),t.join("")}function Ope(e){return Math.round(Date.now()/1e3)+e}function Cpe(){return Symbol("auth-callback")}const ua=()=>typeof window<"u"&&typeof document<"u",Uo={tested:!1,writable:!1},M8=()=>{if(!ua())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Uo.tested)return Uo.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Uo.tested=!0,Uo.writable=!0}catch{Uo.tested=!0,Uo.writable=!1}return Uo.writable};function Dpe(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,i)=>{t[i]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const R8=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Ipe=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Ou=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},$o=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},oa=async(e,t)=>{await e.removeItem(t)};class lv{constructor(){this.promise=new lv.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}lv.promiseConstructor=Promise;function Tb(e){const t=e.split(".");if(t.length!==3)throw new e_("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!xpe.test(t[n]))throw new e_("JWT not in base64url format");return{header:JSON.parse(oD(t[0])),payload:JSON.parse(oD(t[1])),signature:$u(t[2]),raw:{header:t[0],payload:t[1]}}}async function Ppe(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function Mpe(e,t){return new Promise((n,a)=>{(async()=>{for(let i=0;i<1/0;i++)try{const l=await e(i);if(!t(i,null,l)){n(l);return}}catch(l){if(!t(i,l)){a(l);return}}})()})}function Rpe(e){return("0"+e.toString(16)).substr(-2)}function Fpe(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let i=0;i<56;i++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,Rpe).join("")}async function Lpe(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(i=>String.fromCharCode(i)).join("")}async function Bpe(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await Lpe(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function _u(e,t,r=!1){const n=Fpe();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await Ou(e,`${t}-code-verifier`,a);const i=await Bpe(n);return[i,n===i?"plain":"s256"]}const Upe=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function $pe(e){const t=e.headers.get(Jw);if(!t||!t.match(Upe))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function zpe(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Hpe(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const qpe=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Su(e){if(!qpe.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Ab(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function Wpe(e,t){return new Proxy(e,{get:(r,n,a)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const i=n.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,a)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,a)}})}function cD(e){return JSON.parse(JSON.stringify(e))}const Vo=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Vpe=[502,503,504];async function uD(e){var t;if(!Ipe(e))throw new Zw(Vo(e),0);if(Vpe.includes(e.status))throw new Zw(Vo(e),e.status);let r;try{r=await e.json()}catch(i){throw new Xo(Vo(i),i)}let n;const a=$pe(e);if(a&&a.getTime()>=I8["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new iD(Vo(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new li}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((i,l)=>i&&typeof l=="string",!0))throw new iD(Vo(r),e.status,r.weak_password.reasons);throw new bpe(Vo(r),e.status||500,n)}const Gpe=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ot(e,t,r,n){var a;const i=Object.assign({},n==null?void 0:n.headers);i[Jw]||(i[Jw]=I8["2024-01-01"].name),n!=null&&n.jwt&&(i.Authorization=`Bearer ${n.jwt}`);const l=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(l.redirect_to=n.redirectTo);const c=Object.keys(l).length?"?"+new URLSearchParams(l).toString():"",f=await Kpe(e,t,r+c,{headers:i,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(f):{data:Object.assign({},f),error:null}}async function Kpe(e,t,r,n,a,i){const l=Gpe(t,n,a,i);let c;try{c=await e(r,Object.assign({},l))}catch(f){throw console.error(f),new Zw(Vo(f),0)}if(c.ok||await uD(c),n!=null&&n.noResolveJson)return c;try{return await c.json()}catch(f){await uD(f)}}function Qi(e){var t;let r=null;Qpe(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=Ope(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function fD(e){const t=Qi(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function to(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Xpe(e){return{data:e,error:null}}function Ype(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i}=e,l=iv(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),c={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:i},f=Object.assign({},l);return{data:{properties:c,user:f},error:null}}function dD(e){return e}function Qpe(e){return e.access_token&&e.refresh_token&&e.expires_in}const jb=["global","local","others"];class Jpe{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=R8(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=jb[0]){if(jb.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${jb.join(", ")}`);try{return await Ot(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(_t(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ot(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:to})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=iv(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Ot(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:Ype,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(_t(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ot(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:to})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,i,l,c,f;try{const d={nextPage:null,lastPage:0,total:0},m=await Ot(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:dD});if(m.error)throw m.error;const p=await m.json(),v=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(f=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&f!==void 0?f:[];return x.length>0&&(x.forEach(y=>{const b=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(y.split(";")[1].split("=")[1]);d[`${_}Page`]=b}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(_t(d))return{data:{users:[]},error:d};throw d}}async getUserById(t){Su(t);try{return await Ot(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:to})}catch(r){if(_t(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Su(t);try{return await Ot(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:to})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Su(t);try{return await Ot(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:to})}catch(n){if(_t(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Su(t.userId);try{const{data:r,error:n}=await Ot(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(_t(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Su(t.userId),Su(t.id);try{return{data:await Ot(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,a,i,l,c,f;try{const d={nextPage:null,lastPage:0,total:0},m=await Ot(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(i=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&i!==void 0?i:""},xform:dD});if(m.error)throw m.error;const p=await m.json(),v=(l=m.headers.get("x-total-count"))!==null&&l!==void 0?l:0,x=(f=(c=m.headers.get("link"))===null||c===void 0?void 0:c.split(","))!==null&&f!==void 0?f:[];return x.length>0&&(x.forEach(y=>{const b=parseInt(y.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(y.split(";")[1].split("=")[1]);d[`${_}Page`]=b}),d.total=parseInt(v)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(_t(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(t){try{return await Ot(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(_t(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Ot(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(_t(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Ot(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(_t(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Ot(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(_t(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Ot(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(_t(r))return{data:null,error:r};throw r}}}function hD(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const Eu={debug:!!(globalThis&&M8()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class F8 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Zpe extends F8{}async function ege(e,t,r){Eu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),Eu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){Eu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{Eu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw Eu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Zpe(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Eu.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}function tge(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function L8(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function rge(e){return parseInt(e,16)}function nge(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function age(e){var t;const{chainId:r,domain:n,expirationTime:a,issuedAt:i=new Date,nonce:l,notBefore:c,requestId:f,resources:d,scheme:m,uri:p,version:v}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(l&&l.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${l}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(v!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${v}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const x=L8(e.address),y=m?`${m}://${n}`:n,b=e.statement?`${e.statement}
`:"",_=`${y} wants you to sign in with your Ethereum account:
${x}

${b}`;let E=`URI: ${p}
Version: ${v}
Chain ID: ${r}${l?`
Nonce: ${l}`:""}
Issued At: ${i.toISOString()}`;if(a&&(E+=`
Expiration Time: ${a.toISOString()}`),c&&(E+=`
Not Before: ${c.toISOString()}`),f&&(E+=`
Request ID: ${f}`),d){let A=`
Resources:`;for(const T of d){if(!T||typeof T!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${T}`);A+=`
- ${T}`}E+=A}return`${_}
${E}`}class jn extends Error{constructor({message:t,code:r,cause:n,name:a}){var i;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(i=a??(n instanceof Error?n.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=r}}class eg extends jn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function ige({error:e,options:t}){var r,n,a;const{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new jn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new jn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=i.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new jn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((a=i.authenticatorSelection)===null||a===void 0?void 0:a.userVerification)==="required")return new jn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new jn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new jn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return i.pubKeyCredParams.filter(c=>c.type==="public-key").length===0?new jn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new jn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const l=window.location.hostname;if(B8(l)){if(i.rp.id!==l)return new jn({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new jn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new jn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new jn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new jn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function sge({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new jn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new jn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(B8(n)){if(r.rpId!==n)return new jn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new jn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new jn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new jn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class lge{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const oge=new lge;function cge(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,a=iv(e,["challenge","user","excludeCredentials"]),i=$u(t).buffer,l=Object.assign(Object.assign({},r),{id:$u(r.id).buffer}),c=Object.assign(Object.assign({},a),{challenge:i,user:l});if(n&&n.length>0){c.excludeCredentials=new Array(n.length);for(let f=0;f<n.length;f++){const d=n[f];c.excludeCredentials[f]=Object.assign(Object.assign({},d),{id:$u(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return c}function uge(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=iv(e,["challenge","allowCredentials"]),a=$u(t).buffer,i=Object.assign(Object.assign({},n),{challenge:a});if(r&&r.length>0){i.allowCredentials=new Array(r.length);for(let l=0;l<r.length;l++){const c=r[l];i.allowCredentials[l]=Object.assign(Object.assign({},c),{id:$u(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return i}function fge(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:tc(new Uint8Array(e.response.attestationObject)),clientDataJSON:tc(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function dge(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),a=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:tc(new Uint8Array(a.authenticatorData)),clientDataJSON:tc(new Uint8Array(a.clientDataJSON)),signature:tc(new Uint8Array(a.signature)),userHandle:a.userHandle?tc(new Uint8Array(a.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function B8(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function mD(){var e,t;return!!(ua()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator==null?void 0:navigator.credentials)===null||t===void 0?void 0:t.get)=="function")}async function hge(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new eg("Browser returned unexpected credential type",t)}:{data:null,error:new eg("Empty credential response",t)}}catch(t){return{data:null,error:ige({error:t,options:e})}}}async function mge(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new eg("Browser returned unexpected credential type",t)}:{data:null,error:new eg("Empty credential response",t)}}catch(t){return{data:null,error:sge({error:t,options:e})}}}const pge={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},gge={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function tg(...e){const t=a=>a!==null&&typeof a=="object"&&!Array.isArray(a),r=a=>a instanceof ArrayBuffer||ArrayBuffer.isView(a),n={};for(const a of e)if(a)for(const i in a){const l=a[i];if(l!==void 0)if(Array.isArray(l))n[i]=l;else if(r(l))n[i]=l;else if(t(l)){const c=n[i];t(c)?n[i]=tg(c,l):n[i]=tg(l)}else n[i]=l}return n}function vge(e,t){return tg(pge,e,t||{})}function xge(e,t){return tg(gge,e,t||{})}class yge{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:a},i){try{const{data:l,error:c}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!l)return{data:null,error:c};const f=a??oge.createNewAbortSignal();if(l.webauthn.type==="create"){const{user:d}=l.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${n}`),d.displayName||(d.displayName=d.name)}switch(l.webauthn.type){case"create":{const d=vge(l.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:m,error:p}=await hge({publicKey:d,signal:f});return m?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:p}}case"request":{const d=xge(l.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:m,error:p}=await mge(Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:d,signal:f}));return m?{data:{factorId:t,challengeId:l.id,webauthn:{type:l.webauthn.type,credential_response:m}},error:null}:{data:null,error:p}}}}catch(l){return _t(l)?{data:null,error:l}:{data:null,error:new Xo("Unexpected error in challenge",l)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new h0("rpId is required for WebAuthn authentication")};try{if(!mD())return{data:null,error:new Xo("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:a},{request:i});if(!l)return{data:null,error:c};const{webauthn:f}=l;return this._verify({factorId:t,challengeId:l.challengeId,webauthn:{type:f.type,rpId:r,rpOrigins:n,credential_response:f.credential_response}})}catch(l){return _t(l)?{data:null,error:l}:{data:null,error:new Xo("Unexpected error in authenticate",l)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:a}={}},i){if(!r)return{data:null,error:new h0("rpId is required for WebAuthn registration")};try{if(!mD())return{data:null,error:new Xo("Browser does not support WebAuthn",null)};const{data:l,error:c}=await this._enroll({friendlyName:t});if(!l)return await this.client.mfa.listFactors().then(m=>{var p;return(p=m.data)===null||p===void 0?void 0:p.all.find(v=>v.factor_type==="webauthn"&&v.friendly_name===t&&v.status!=="unverified")}).then(m=>m?this.client.mfa.unenroll({factorId:m==null?void 0:m.id}):void 0),{data:null,error:c};const{data:f,error:d}=await this._challenge({factorId:l.id,friendlyName:l.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:a},{create:i});return f?this._verify({factorId:l.id,challengeId:f.challengeId,webauthn:{rpId:r,rpOrigins:n,type:f.webauthn.type,credential_response:f.webauthn.credential_response}}):{data:null,error:d}}catch(l){return _t(l)?{data:null,error:l}:{data:null,error:new Xo("Unexpected error in register",l)}}}}tge();const bge={url:ppe,storageKey:gpe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vpe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function pD(e,t,r){return await r()}const Nu={};class m0{get jwks(){var t,r;return(r=(t=Nu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Nu[this.storageKey]=Object.assign(Object.assign({},Nu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Nu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Nu[this.storageKey]=Object.assign(Object.assign({},Nu[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,a;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},bge),t);if(this.storageKey=i.storageKey,this.instanceID=(r=m0.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,m0.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&ua()){const l=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(l),this.logDebugMessages&&console.trace(l)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new Jpe({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=R8(i.fetch),this.lock=i.lock||pD,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,this.lockAcquireTimeout=i.lockAcquireTimeout,i.lock?this.lock=i.lock:this.persistSession&&ua()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=ege:this.lock=pD,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new yge(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:M8()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=hD(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=hD(this.memoryStorage)),ua()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(a=this.broadcastChannel)===null||a===void 0||a.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${D8}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(ua()&&(r=Dpe(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),ua()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:i}=await this._getSessionFromURL(r,n);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),Spe(i)){const f=(t=i.details)===null||t===void 0?void 0:t.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:i}}return{error:i}}const{session:l,redirectType:c}=a;return this._debug("#_initialize()","detected session in URL",l,"redirect type",c),await this._saveSession(l),setTimeout(async()=>{c==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",l):await this._notifyAllSubscribers("SIGNED_IN",l)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return _t(r)?this._returnResult({error:r}):this._returnResult({error:new Xo("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const i=await Ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Qi}),{data:l,error:c}=i;if(c||!l)return this._returnResult({data:{user:null,session:null},error:c});const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(i){if(_t(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(t){var r,n,a;try{let i;if("email"in t){const{email:m,password:p,options:v}=t;let x=null,y=null;this.flowType==="pkce"&&([x,y]=await _u(this.storage,this.storageKey)),i=await Ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:m,password:p,data:(r=v==null?void 0:v.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:x,code_challenge_method:y},xform:Qi})}else if("phone"in t){const{phone:m,password:p,options:v}=t;i=await Ot(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:p,data:(n=v==null?void 0:v.data)!==null&&n!==void 0?n:{},channel:(a=v==null?void 0:v.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:Qi})}else throw new Mm("You must provide either an email or phone number and a password");const{data:l,error:c}=i;if(c||!l)return await oa(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:c});const f=l.session,d=l.user;return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(i){if(await oa(this.storage,`${this.storageKey}-code-verifier`),_t(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(t){try{let r;if("email"in t){const{email:i,password:l,options:c}=t;r=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:fD})}else if("phone"in t){const{phone:i,password:l,options:c}=t;r=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:l,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken}},xform:fD})}else throw new Mm("You must provide either an email or phone number and a password");const{data:n,error:a}=r;if(a)return this._returnResult({data:{user:null,session:null},error:a});if(!n||!n.session||!n.user){const i=new wu;return this._returnResult({data:{user:null,session:null},error:i})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(_t(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,a,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,a,i,l,c,f,d,m,p,v;let x,y;if("message"in t)x=t.message,y=t.signature;else{const{chain:b,wallet:_,statement:E,options:A}=t;let T;if(ua())if(typeof _=="object")T=_;else{const U=window;if("ethereum"in U&&typeof U.ethereum=="object"&&"request"in U.ethereum&&typeof U.ethereum.request=="function")T=U.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(A!=null&&A.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");T=_}const k=new URL((r=A==null?void 0:A.url)!==null&&r!==void 0?r:window.location.href),I=await T.request({method:"eth_requestAccounts"}).then(U=>U).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!I||I.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const O=L8(I[0]);let j=(n=A==null?void 0:A.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!j){const U=await T.request({method:"eth_chainId"});j=rge(U)}const B={domain:k.host,address:O,statement:E,uri:k.href,version:"1",chainId:j,nonce:(a=A==null?void 0:A.signInWithEthereum)===null||a===void 0?void 0:a.nonce,issuedAt:(l=(i=A==null?void 0:A.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&l!==void 0?l:new Date,expirationTime:(c=A==null?void 0:A.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(f=A==null?void 0:A.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(d=A==null?void 0:A.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(m=A==null?void 0:A.signInWithEthereum)===null||m===void 0?void 0:m.resources};x=age(B),y=await T.request({method:"personal_sign",params:[nge(x),O]})}try{const{data:b,error:_}=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:x,signature:y},!((p=t.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(v=t.options)===null||v===void 0?void 0:v.captchaToken}}:null),xform:Qi});if(_)throw _;if(!b||!b.session||!b.user){const E=new wu;return this._returnResult({data:{user:null,session:null},error:E})}return b.session&&(await this._saveSession(b.session),await this._notifyAllSubscribers("SIGNED_IN",b.session)),this._returnResult({data:Object.assign({},b),error:_})}catch(b){if(_t(b))return this._returnResult({data:{user:null,session:null},error:b});throw b}}async signInWithSolana(t){var r,n,a,i,l,c,f,d,m,p,v,x;let y,b;if("message"in t)y=t.message,b=t.signature;else{const{chain:_,wallet:E,statement:A,options:T}=t;let k;if(ua())if(typeof E=="object")k=E;else{const O=window;if("solana"in O&&typeof O.solana=="object"&&("signIn"in O.solana&&typeof O.solana.signIn=="function"||"signMessage"in O.solana&&typeof O.solana.signMessage=="function"))k=O.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof E!="object"||!(T!=null&&T.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=E}const I=new URL((r=T==null?void 0:T.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const O=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},T==null?void 0:T.signInWithSolana),{version:"1",domain:I.host,uri:I.href}),A?{statement:A}:null));let j;if(Array.isArray(O)&&O[0]&&typeof O[0]=="object")j=O[0];else if(O&&typeof O=="object"&&"signedMessage"in O&&"signature"in O)j=O;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in j&&"signature"in j&&(typeof j.signedMessage=="string"||j.signedMessage instanceof Uint8Array)&&j.signature instanceof Uint8Array)y=typeof j.signedMessage=="string"?j.signedMessage:new TextDecoder().decode(j.signedMessage),b=j.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");y=[`${I.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...A?["",A,""]:[""],"Version: 1",`URI: ${I.href}`,`Issued At: ${(a=(n=T==null?void 0:T.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&a!==void 0?a:new Date().toISOString()}`,...!((i=T==null?void 0:T.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${T.signInWithSolana.notBefore}`]:[],...!((l=T==null?void 0:T.signInWithSolana)===null||l===void 0)&&l.expirationTime?[`Expiration Time: ${T.signInWithSolana.expirationTime}`]:[],...!((c=T==null?void 0:T.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${T.signInWithSolana.chainId}`]:[],...!((f=T==null?void 0:T.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${T.signInWithSolana.nonce}`]:[],...!((d=T==null?void 0:T.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${T.signInWithSolana.requestId}`]:[],...!((p=(m=T==null?void 0:T.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||p===void 0)&&p.length?["Resources",...T.signInWithSolana.resources.map(j=>`- ${j}`)]:[]].join(`
`);const O=await k.signMessage(new TextEncoder().encode(y),"utf8");if(!O||!(O instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");b=O}}try{const{data:_,error:E}=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:y,signature:tc(b)},!((v=t.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(x=t.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Qi});if(E)throw E;if(!_||!_.session||!_.user){const A=new wu;return this._returnResult({data:{user:null,session:null},error:A})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:E})}catch(_){if(_t(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(t){const r=await $o(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new Epe;const{data:i,error:l}=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Qi});if(await oa(this.storage,`${this.storageKey}-code-verifier`),l)throw l;if(!i||!i.session||!i.user){const c=new wu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:c})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:a??null}),error:l})}catch(i){if(await oa(this.storage,`${this.storageKey}-code-verifier`),_t(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:i,nonce:l}=t,c=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:i,nonce:l,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Qi}),{data:f,error:d}=c;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!f||!f.session||!f.user){const m=new wu;return this._returnResult({data:{user:null,session:null},error:m})}return f.session&&(await this._saveSession(f.session),await this._notifyAllSubscribers("SIGNED_IN",f.session)),this._returnResult({data:f,error:d})}catch(r){if(_t(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,a,i,l;try{if("email"in t){const{email:c,options:f}=t;let d=null,m=null;this.flowType==="pkce"&&([d,m]=await _u(this.storage,this.storageKey));const{error:p}=await Ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},create_user:(n=f==null?void 0:f.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:d,code_challenge_method:m},redirectTo:f==null?void 0:f.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in t){const{phone:c,options:f}=t,{data:d,error:m}=await Ot(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(a=f==null?void 0:f.data)!==null&&a!==void 0?a:{},create_user:(i=f==null?void 0:f.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},channel:(l=f==null?void 0:f.channel)!==null&&l!==void 0?l:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:m})}throw new Mm("You must provide either an email or phone number.")}catch(c){if(await oa(this.storage,`${this.storageKey}-code-verifier`),_t(c))return this._returnResult({data:{user:null,session:null},error:c});throw c}}async verifyOtp(t){var r,n;try{let a,i;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,i=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:l,error:c}=await Ot(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:a,xform:Qi});if(c)throw c;if(!l)throw new Error("An error occurred on token verification.");const f=l.session,d=l.user;return f!=null&&f.access_token&&(await this._saveSession(f),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),this._returnResult({data:{user:d,session:f},error:null})}catch(a){if(_t(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithSSO(t){var r,n,a,i,l;try{let c=null,f=null;this.flowType==="pkce"&&([c,f]=await _u(this.storage,this.storageKey));const d=await Ot(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:c,code_challenge_method:f}),headers:this.headers,xform:Xpe});return!((i=d.data)===null||i===void 0)&&i.url&&ua()&&!(!((l=t.options)===null||l===void 0)&&l.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(c){if(await oa(this.storage,`${this.storageKey}-code-verifier`),_t(c))return this._returnResult({data:null,error:c});throw c}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new li;const{error:a}=await Ot(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:a})})}catch(t){if(_t(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:i}=t,{error:l}=await Ot(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:l})}else if("phone"in t){const{phone:n,type:a,options:i}=t,{data:l,error:c}=await Ot(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:l==null?void 0:l.message_id},error:c})}throw new Mm("You must provide either an email or phone number and a type")}catch(r){if(_t(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await $o(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Nb:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const l=await $o(this.userStorage,this.storageKey+"-user");l!=null&&l.user?t.user=l.user:t.user=Ab()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const l={value:this.suppressGetSessionWarning};t.user=Wpe(t.user,l),l.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:to}):await this._useSession(async r=>{var n,a,i;const{data:l,error:c}=r;if(c)throw c;return!(!((n=l.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new li}:await Ot(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(a=l.session)===null||a===void 0?void 0:a.access_token)!==null&&i!==void 0?i:void 0,xform:to})})}catch(r){if(_t(r))return _pe(r)&&(await this._removeSession(),await oa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:i}=n;if(i)throw i;if(!a.session)throw new li;const l=a.session;let c=null,f=null;this.flowType==="pkce"&&t.email!=null&&([c,f]=await _u(this.storage,this.storageKey));const{data:d,error:m}=await Ot(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:c,code_challenge_method:f}),jwt:l.access_token,xform:to});if(m)throw m;return l.user=d.user,await this._saveSession(l),await this._notifyAllSubscribers("USER_UPDATED",l),this._returnResult({data:{user:l.user},error:null})})}catch(n){if(await oa(this.storage,`${this.storageKey}-code-verifier`),_t(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new li;const r=Date.now()/1e3;let n=r,a=!0,i=null;const{payload:l}=Tb(t.access_token);if(l.exp&&(n=l.exp,a=n<=r),a){const{data:c,error:f}=await this._callRefreshToken(t.refresh_token);if(f)return this._returnResult({data:{user:null,session:null},error:f});if(!c)return{data:{user:null,session:null},error:null};i=c}else{const{data:c,error:f}=await this._getUser(t.access_token);if(f)throw f;i={access_token:t.access_token,refresh_token:t.refresh_token,user:c.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(r){if(_t(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:l,error:c}=r;if(c)throw c;t=(n=l.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new li;const{data:a,error:i}=await this._callRefreshToken(t.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):a?this._returnResult({data:{user:a.user,session:a},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(_t(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ua())throw new Rm("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Rm(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new aD("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Rm("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new aD("No code detected.");const{data:A,error:T}=await this._exchangeCodeForSession(t.code);if(T)throw T;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:A.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:i,refresh_token:l,expires_in:c,expires_at:f,token_type:d}=t;if(!i||!c||!l||!d)throw new Rm("No session defined in URL");const m=Math.round(Date.now()/1e3),p=parseInt(c);let v=m+p;f&&(v=parseInt(f));const x=v-m;x*1e3<=ju&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${p}s`);const y=v-p;m-y>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",y,v,m):m-y<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",y,v,m);const{data:b,error:_}=await this._getUser(i);if(_)throw _;const E={provider_token:n,provider_refresh_token:a,access_token:i,expires_in:p,expires_at:v,refresh_token:l,token_type:d,user:b.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:E,redirectType:t.type},error:null})}catch(n){if(_t(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await $o(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({error:i});const l=(n=a.session)===null||n===void 0?void 0:n.access_token;if(l){const{error:c}=await this.admin.signOut(l,t);if(c&&!(wpe(c)&&(c.status===404||c.status===401||c.status===403)))return this._returnResult({error:c})}return t!=="others"&&(await this._removeSession(),await oa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=Cpe(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:i},error:l}=r;if(l)throw l;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await _u(this.storage,this.storageKey,!0));try{return await Ot(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(i){if(await oa(this.storage,`${this.storageKey}-code-verifier`),_t(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:a}=await this._useSession(async i=>{var l,c,f,d,m;const{data:p,error:v}=i;if(v)throw v;const x=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(l=t.options)===null||l===void 0?void 0:l.redirectTo,scopes:(c=t.options)===null||c===void 0?void 0:c.scopes,queryParams:(f=t.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return await Ot(this.fetch,"GET",x,{headers:this.headers,jwt:(m=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&m!==void 0?m:void 0})});if(a)throw a;return ua()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),this._returnResult({data:{provider:t.provider,url:n==null?void 0:n.url},error:null})}catch(n){if(_t(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:a,data:{session:i}}=r;if(a)throw a;const{options:l,provider:c,token:f,access_token:d,nonce:m}=t,p=await Ot(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=i==null?void 0:i.access_token)!==null&&n!==void 0?n:void 0,body:{provider:c,id_token:f,access_token:d,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:Qi}),{data:v,error:x}=p;return x?this._returnResult({data:{user:null,session:null},error:x}):!v||!v.session||!v.user?this._returnResult({data:{user:null,session:null},error:new wu}):(v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("USER_UPDATED",v.session)),this._returnResult({data:v,error:x}))}catch(a){if(await oa(this.storage,`${this.storageKey}-code-verifier`),_t(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:l}=r;if(l)throw l;return await Ot(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=i.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await Mpe(async a=>(a>0&&await Ppe(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ot(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Qi})),(a,i)=>{const l=200*Math.pow(2,a);return i&&kb(i)&&Date.now()+l-n<ju})}catch(n){if(this._debug(r,"error",n),_t(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ua()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const a=await $o(this.storage,this.storageKey);if(a&&this.userStorage){let l=await $o(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!l&&(l={user:a.user},await Ou(this.userStorage,this.storageKey+"-user",l)),a.user=(t=l==null?void 0:l.user)!==null&&t!==void 0?t:Ab()}else if(a&&!a.user&&!a.user){const l=await $o(this.storage,this.storageKey+"-user");l&&(l!=null&&l.user)?(a.user=l.user,await oa(this.storage,this.storageKey+"-user"),await Ou(this.storage,this.storageKey,a)):a.user=Ab()}if(this._debug(n,"session from storage",a),!this._isValidSession(a)){this._debug(n,"session is not valid"),a!==null&&await this._removeSession();return}const i=((r=a.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Nb;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Nb}s`),i){if(this.autoRefreshToken&&a.refresh_token){const{error:l}=await this._callRefreshToken(a.refresh_token);l&&(console.error(l),kb(l)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",l),await this._removeSession()))}}else if(a.user&&a.user.__isUserNotAvailableProxy===!0)try{const{data:l,error:c}=await this._getUser(a.access_token);!c&&(l!=null&&l.user)?(a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(l){console.error("Error getting user data:",l),this._debug(n,"error getting user data, skipping SIGNED_IN notification",l)}else await this._notifyAllSubscribers("SIGNED_IN",a)}catch(a){this._debug(n,"error",a),console.error(a);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new li;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new lv;const{data:i,error:l}=await this._refreshAccessToken(t);if(l)throw l;if(!i.session)throw new li;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const c={data:i.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(i){if(this._debug(a,"error",i),_t(i)){const l={data:null,error:i};return kb(i)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(l),l}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(i),i}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const i=[],l=Array.from(this.stateChangeEmitters.values()).map(async c=>{try{await c.callback(t,r)}catch(f){i.push(f)}});if(await Promise.all(l),i.length>0){for(let c=0;c<i.length;c+=1)console.error(i[c]);throw i[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await oa(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Ou(this.userStorage,this.storageKey+"-user",{user:r.user});const a=Object.assign({},r);delete a.user;const i=cD(a);await Ou(this.storage,this.storageKey,i)}else{const a=cD(r);await Ou(this.storage,this.storageKey,a)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await oa(this.storage,this.storageKey),await oa(this.storage,this.storageKey+"-code-verifier"),await oa(this.storage,this.storageKey+"-user"),this.userStorage&&await oa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ua()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),ju);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/ju);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${ju}ms, refresh threshold is ${Qw} ticks`),a<=Qw&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof F8)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ua()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[i,l]=await _u(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(l)}`});a.push(c.toString())}if(n!=null&&n.queryParams){const i=new URLSearchParams(n.queryParams);a.push(i.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;return i?this._returnResult({data:null,error:i}):await Ot(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:i,error:l}=r;if(l)return this._returnResult({data:null,error:l});const c=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:f,error:d}=await Ot(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(n=i==null?void 0:i.session)===null||n===void 0?void 0:n.access_token});return d?this._returnResult({data:null,error:d}):(t.factorType==="totp"&&f.type==="totp"&&(!((a=f==null?void 0:f.totp)===null||a===void 0)&&a.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),this._returnResult({data:f,error:null}))})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?fge(t.webauthn.credential_response):dge(t.webauthn.credential_response)})}:{code:t.code}),{data:c,error:f}=await Ot(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:l,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return f?this._returnResult({data:null,error:f}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),this._returnResult({data:c,error:f}))})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:i}=r;if(i)return this._returnResult({data:null,error:i});const l=await Ot(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});if(l.error)return l;const{data:c}=l;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:cge(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:uge(c.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const a={all:[],phone:[],totp:[],webauthn:[]};for(const i of(t=r==null?void 0:r.factors)!==null&&t!==void 0?t:[])a.all.push(i),i.status==="verified"&&a[i.factor_type].push(i);return{data:a,error:null}}async _getAuthenticatorAssuranceLevel(){var t,r;const{data:{session:n},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!n)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=Tb(n.access_token);let l=null;i.aal&&(l=i.aal);let c=l;((r=(t=n.user.factors)===null||t===void 0?void 0:t.filter(m=>m.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=i.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?await Ot(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new li})})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new li});const l=await Ot(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"approve"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&ua()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(_t(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:a},error:i}=n;if(i)return this._returnResult({data:null,error:i});if(!a)return this._returnResult({data:null,error:new li});const l=await Ot(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:a.access_token,body:{action:"deny"},xform:c=>({data:c,error:null})});return l.data&&l.data.redirect_url&&ua()&&!(r!=null&&r.skipBrowserRedirect)&&window.location.assign(l.data.redirect_url),l})}catch(n){if(_t(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Ot(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new li})})}catch(t){if(_t(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:a}=r;return a?this._returnResult({data:null,error:a}):n?(await Ot(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new li})})}catch(r){if(_t(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(c=>c.kid===t);if(n)return n;const a=Date.now();if(n=this.jwks.keys.find(c=>c.kid===t),n&&this.jwks_cached_at+ype>a)return n;const{data:i,error:l}=await Ot(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(l)throw l;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=a,n=i.keys.find(c=>c.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:x,error:y}=await this.getSession();if(y||!x.session)return this._returnResult({data:null,error:y});n=x.session.access_token}const{header:a,payload:i,signature:l,raw:{header:c,payload:f}}=Tb(n);r!=null&&r.allowExpired||zpe(i.exp);const d=!a.alg||a.alg.startsWith("HS")||!a.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(a.kid,r!=null&&r.keys?{keys:r.keys}:r==null?void 0:r.jwks);if(!d){const{error:x}=await this.getUser(n);if(x)throw x;return{data:{claims:i,header:a,signature:l},error:null}}const m=Hpe(a.alg),p=await crypto.subtle.importKey("jwk",d,m,!0,["verify"]);if(!await crypto.subtle.verify(m,p,l,jpe(`${c}.${f}`)))throw new e_("Invalid JWT signature");return{data:{claims:i,header:a,signature:l},error:null}}catch(n){if(_t(n))return this._returnResult({data:null,error:n});throw n}}}m0.nextInstanceID={};const wge=m0,_ge="2.91.1";let _d="";typeof Deno<"u"?_d="deno":typeof document<"u"?_d="web":typeof navigator<"u"&&navigator.product==="ReactNative"?_d="react-native":_d="node";const Sge={"X-Client-Info":`supabase-js-${_d}/${_ge}`},Ege={headers:Sge},Nge={schema:"public"},kge={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Tge={};function p0(e){"@babel/helpers - typeof";return p0=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p0(e)}function Age(e,t){if(p0(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(p0(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jge(e){var t=Age(e,"string");return p0(t)=="symbol"?t:t+""}function Oge(e,t,r){return(t=jge(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gD(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function on(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gD(Object(r),!0).forEach(function(n){Oge(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gD(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const Cge=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),Dge=()=>Headers,Ige=(e,t,r)=>{const n=Cge(r),a=Dge();return async(i,l)=>{var c;const f=(c=await t())!==null&&c!==void 0?c:e;let d=new a(l==null?void 0:l.headers);return d.has("apikey")||d.set("apikey",e),d.has("Authorization")||d.set("Authorization",`Bearer ${f}`),n(i,on(on({},l),{},{headers:d}))}};function Pge(e){return e.endsWith("/")?e:e+"/"}function Mge(e,t){var r,n;const{db:a,auth:i,realtime:l,global:c}=e,{db:f,auth:d,realtime:m,global:p}=t,v={db:on(on({},f),a),auth:on(on({},d),i),realtime:on(on({},m),l),storage:{},global:on(on(on({},p),c),{},{headers:on(on({},(r=p==null?void 0:p.headers)!==null&&r!==void 0?r:{}),(n=c==null?void 0:c.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?v.accessToken=e.accessToken:delete v.accessToken,v}function Rge(e){const t=e==null?void 0:e.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(Pge(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var Fge=class extends wge{constructor(e){super(e)}},Lge=class{constructor(e,t,r){var n,a;this.supabaseUrl=e,this.supabaseKey=t;const i=Rge(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",i),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",i),this.storageUrl=new URL("storage/v1",i),this.functionsUrl=new URL("functions/v1",i);const l=`sb-${i.hostname.split(".")[0]}-auth-token`,c={db:Nge,realtime:Tge,auth:on(on({},kge),{},{storageKey:l}),global:Ege},f=Mge(r??{},c);if(this.storageKey=(n=f.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(a=f.global.headers)!==null&&a!==void 0?a:{},f.accessToken)this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(m,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}});else{var d;this.auth=this._initSupabaseAuthClient((d=f.auth)!==null&&d!==void 0?d:{},this.headers,f.global.fetch)}this.fetch=Ige(t,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(on({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(m=>this.realtime.setAuth(m)).catch(m=>console.warn("Failed to set initial Realtime auth token:",m)),this.rest=new vme(new URL("rest/v1",i).href,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),this.storage=new mpe(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),f.accessToken||this._listenForAuthEvents()}get functions(){return new dme(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,storageKey:i,flowType:l,lock:c,debug:f,throwOnError:d},m,p){const v={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Fge({url:this.authUrl.href,headers:on(on({},v),m),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:a,flowType:l,lock:c,debug:f,throwOnError:d,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(x=>x.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new Pme(this.realtimeUrl.href,on(on({},e),{},{params:on(on({},{apikey:this.supabaseKey}),e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t==null?void 0:t.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const Bge=(e,t,r)=>new Lge(e,t,r);function Uge(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}Uge()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const U8="https://zrpbpijowrlwhhagloif.supabase.co".trim().replace(/["']/g,""),$8="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InpycGJwaWpvd3Jsd2hoYWdsb2lmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk0Nzc5MTIsImV4cCI6MjA4NTA1MzkxMn0.WD5ZpjOYxoWqTUtnlMkdjfA9hWKuiDv5Yia7Zzh9rKI".trim().replace(/["']/g,"");(!U8||!$8)&&console.warn("Supabase credentials missing. Please check your environment variables (VITE_SUPABASE_URL, VITE_SUPABASE_ANON_KEY).");const ov=Bge(U8,$8),cv={items:"items",machines:"machines",locations:"locations",sectors:"sectors",divisions:"divisions",plans:"maintenance_plans",users:"users",history:"issues",breakdowns:"breakdowns",bomRecords:"bom",agriOrders:"agri_orders",irrigationLogs:"irrigation_logs",forecastPeriods:"forecast_periods",forecastRecords:"forecast_records",tasks:"maintenance_tasks",schedules:"maintenance_schedules",workOrders:"maintenance_work_orders",assetTransfers:"asset_transfers",machineTransferHistory:"machine_transfer_history",warrantyManagement:"warranty_records",warrantyReceiving:"warranty_receivings",orgStructure:"org_structure",failureTypes:"failure_types",issuePlanPeriods:"issue_plan_periods",issuePlanEntries:"issue_plan_entries"},$ge=e=>e.replace(/[A-Z]/g,t=>`_${t.toLowerCase()}`),zge=e=>e.replace(/([-_][a-z])/g,t=>t.toUpperCase().replace("-","").replace("_","")),z8=(e,t)=>{const r={};for(const n in e){let a=e[n];const i=$ge(n);Array.isArray(a)&&["allowedLocationIds","allowedSectorIds","allowedDivisionIds","allowedMenus"].includes(n)&&(a=a.join(",")),r[i]=a}return r},Hge=e=>{const t={};for(const r in e){const n=zge(r);let a=e[r];["allowedLocationIds","allowedSectorIds","allowedDivisionIds","allowedMenus"].includes(n)&&typeof a=="string"?t[n]=a?a.split(","):[]:t[n]=a}return t},vD=async()=>{const e={};try{const t=Object.entries(cv).map(async([n,a])=>{const{data:i,error:l}=await ov.from(a).select("*");return l?(console.error(`Error fetching ${a}:`,l),{[n]:[]}):{[n]:i.map(Hge)}});return(await Promise.all(t)).forEach(n=>{Object.assign(e,n)}),e}catch(t){return console.error("Supabase fetch failed:",t),null}},bt=async(e,t)=>{const r=cv[e];if(!r)return console.error(`Unknown table: ${e}`),{status:"error",message:"Unknown table"};try{const n=z8(t,r),a=e==="users"?"username":"id",{error:i}=await ov.from(r).upsert(n,{onConflict:a});if(i)throw i;return{status:"success"}}catch(n){return console.error(`Failed to upsert to ${r}:`,n.message),{status:"error",message:n.message}}},si=async(e,t)=>{const r=cv[e];if(!r)return console.error(`Unknown table: ${e}`),{status:"error",message:"Unknown table"};try{const n=e==="users"?"username":"id",{error:a}=await ov.from(r).delete().eq(n,t);if(a)throw a;return{status:"success"}}catch(n){return console.error(`Failed to delete from ${r}:`,n.message),{status:"error",message:n.message}}},qge=async(e,t,r)=>{const n=cv[e];if(!n)return console.error(`Unknown table: ${e}`),{status:"error",message:"Unknown table"};if(!t||t.length===0)return{status:"success",count:0};const a=100,i=3;let l=0,c=[];console.log(`[Bulk Upload] Starting upload of ${t.length} records to ${n}`);try{const f=Math.ceil(t.length/a);for(let m=0;m<t.length;m+=a){const p=t.slice(m,m+a),v=p.map(E=>z8(E,n)),x=Math.floor(m/a)+1;console.log(`[Batch ${x}/${f}] Uploading ${p.length} records...`),r&&r(l,t.length,x,f);const y=e==="users"?"username":"id";let b=0,_=!1;for(;b<i&&!_;)try{const{data:E,error:A}=await ov.from(n).upsert(v,{onConflict:y}).select();if(A)throw new Error(A.message);E&&(l+=E.length,_=!0,console.log(`[Batch ${x}/${f}]  Success (${E.length} records)`),r&&r(l,t.length,x,f))}catch(E){b++,b<i?(console.warn(`[Batch ${x}] Retry ${b}/${i} after error:`,E.message),await new Promise(A=>setTimeout(A,1e3*b))):(console.error(`[Batch ${x}] Failed after ${i} retries:`,E.message),c.push({batchNum:x,error:E.message}))}m+a<t.length&&await new Promise(E=>setTimeout(E,200))}const d=`Uploaded ${l}/${t.length} records to ${n}`;return console.log(`[Bulk Upload Complete] ${d}`),r&&r(l,t.length,f,f),c.length>0?(console.error(`[Failed Batches] ${c.length} batches failed:`,c),{status:"partial",count:l,message:`${l}/${t.length} uploaded. ${c.length} batches failed.`}):{status:"success",count:l}}catch(f){return console.error(`[Bulk Upload Failed] ${f.message}`),{status:"error",message:f.message,count:l}}},Wge=()=>{const[e,t]=N.useState(null),[r,n]=N.useState(RT),[a,i]=N.useState("dashboard"),[l,c]=N.useState(!1),[f,d]=N.useState(mB),[m,p]=N.useState(hB),[v,x]=N.useState(cB),[y,b]=N.useState(uB),[_,E]=N.useState(fB),[A,T]=N.useState(dB),[k,I]=N.useState(gB),[O,j]=N.useState(vB),[B,U]=N.useState([]),[Y,te]=N.useState([]),[V,ge]=N.useState([]),[be,ve]=N.useState([]),[z,ue]=N.useState([]),[se,Q]=N.useState(pB),[re,G]=N.useState(xB),[P,W]=N.useState(yB),[F,M]=N.useState(bB),[le,pe]=N.useState([]),[Ae,oe]=N.useState([]),[ae,ze]=N.useState([]),[q,Je]=N.useState([]),[qe,ot]=N.useState([]),[Ke,He]=N.useState([]),[wt,mt]=N.useState([]),[Ge,ut]=N.useState([]),[ct,dt]=N.useState(!0),[at,Wt]=N.useState(null),[Oe,st]=N.useState(!0);N.useEffect(()=>{(async()=>{try{const ce=await vD();if(ce){if(ce.items&&d(ce.items),ce.machines&&p(ce.machines),ce.locations&&x(ce.locations),ce.sectors&&b(ce.sectors),ce.divisions&&E(ce.divisions),ce.plans&&T(ce.plans),ce.users){const Ar=ce.users,vr=RT.find(tt=>tt.username==="admin");vr&&!Ar.some(tt=>tt.username==="admin")&&(Ar.push(vr),bt("users",vr)),n(Ar)}ce.history&&I(ce.history),ce.breakdowns&&j(ce.breakdowns),ce.bomRecords&&U(ce.bomRecords),ce.agriOrders&&te(ce.agriOrders),ce.irrigationLogs&&ge(ce.irrigationLogs),ce.forecastPeriods&&ve(ce.forecastPeriods),ce.forecastRecords&&ue(ce.forecastRecords),ce.tasks&&G(ce.tasks),ce.schedules&&W(ce.schedules),ce.workOrders&&M(ce.workOrders),pe(ce.assetTransfers||[]),oe(ce.machineTransferHistory||[]),ze(ce.warrantyRecords||[]),Je(ce.warrantyReceivings||[]),ot(ce.issuePlanPeriods||[]),He(ce.issuePlanEntries||[]),mt(ce.orgStructures||[]),ut(ce.failureTypes||[])}else console.warn("Supabase data load returned no data, using defaults."),dt(!1);const rt=await lme("user");if(rt)if(ce&&ce.users){const Ar=ce.users.find(vr=>vr.username===rt.username);Ar?(console.log("Syncing user session with fresh DB data:",Ar.username),t(Ar),G3("user",Ar)):t(rt)}else t(rt)}catch(ce){console.error("Failed to load data from Supabase",ce),dt(!1)}finally{st(!1)}})()},[]);const Fe=(ie,ce,rt)=>{rt(ce),G3(ie,ce)},nr=ie=>{Fe("user",ie,t),i("dashboard")},St=()=>{t(null),ome("user")},Zt=ie=>{Fe("items",[...f,ie],d),bt("items",ie)},mr=ie=>{Fe("items",f.map(ce=>ce.id===ie.id?ie:ce),d),bt("items",ie)},er=ie=>{Fe("items",f.filter(ce=>!ie.includes(ce.id)),d),ie.forEach(ce=>si("items",ce))},ar=ie=>{Fe("machines",[...m,ie],p),bt("machines",ie)},Yr=ie=>{Fe("machines",m.map(ce=>ce.id===ie.id?ie:ce),p),bt("machines",ie)},Tr=ie=>{Fe("machines",m.filter(ce=>!ie.includes(ce.id)),p),ie.forEach(ce=>si("machines",ce))},Ba=ie=>{Fe("locations",[...v,ie],x),bt("locations",ie)},ga=ie=>{Fe("locations",v.map(ce=>ce.id===ie.id?ie:ce),x),bt("locations",ie)},$n=ie=>{Fe("locations",v.filter(ce=>!ie.includes(ce.id)),x),ie.forEach(ce=>si("locations",ce))},$r=ie=>{Fe("sectors",[...y,ie],b),bt("sectors",ie)},ra=ie=>{Fe("sectors",y.map(ce=>ce.id===ie.id?ie:ce),b),bt("sectors",ie)},zn=ie=>{Fe("sectors",y.filter(ce=>!ie.includes(ce.id)),b),ie.forEach(ce=>si("sectors",ce))},pr=ie=>{Fe("divisions",[..._,ie],E),bt("divisions",ie)},Hn=ie=>{Fe("divisions",_.map(ce=>ce.id===ie.id?ie:ce),E),bt("divisions",ie)},lr=ie=>{Fe("divisions",_.filter(ce=>!ie.includes(ce.id)),E),ie.forEach(ce=>si("divisions",ce))},wn=ie=>{Fe("plans",[...A,ie],T),bt("plans",ie)},zr=ie=>{Fe("plans",A.map(ce=>ce.id===ie.id?ie:ce),T),bt("plans",ie)},na=ie=>{Fe("plans",A.filter(ce=>!ie.includes(ce.id)),T),ie.forEach(ce=>si("plans",ce))},gr=ie=>{Fe("orgStructures",[...wt,ie],mt),bt("orgStructure",ie)},Oa=ie=>{Fe("orgStructures",wt.map(ce=>ce.id===ie.id?ie:ce),mt),bt("orgStructure",ie)},pn=ie=>{Fe("orgStructures",wt.filter(ce=>!ie.includes(ce.id)),mt),ie.forEach(ce=>si("orgStructure",ce))},Ue=ie=>{Fe("failureTypes",[...Ge,ie],ut),bt("failureTypes",ie)},Le=ie=>{Fe("failureTypes",Ge.map(ce=>ce.code===ie.code?ie:ce),ut),bt("failureTypes",ie)},it=ie=>{Fe("failureTypes",Ge.filter(ce=>!ie.includes(ce.code)),ut),ie.forEach(ce=>si("failureTypes",ce))},Tt=ie=>{Fe("users",[...r,ie],n),bt("users",ie)},R=ie=>{Fe("users",r.map(ce=>ce.username===ie.username?ie:ce),n),bt("users",ie)},ee=ie=>{Fe("users",r.filter(ce=>!ie.includes(ce.username)),n),ie.forEach(ce=>si("users",ce))},K=ie=>{Fe("history",[ie,...k],I),bt("history",ie);const ce=f.find(rt=>rt.id===ie.itemId);if(ce&&ce.stockQuantity!==void 0){const rt=Math.max(0,ce.stockQuantity-ie.quantity),Ar={...ce,stockQuantity:rt};mr(Ar)}},H=ie=>{Fe("history",k.map(ce=>ce.id===ie.id?ie:ce),I),bt("history",ie)},Z=ie=>{Fe("breakdowns",[ie,...O],j),bt("breakdowns",ie)},ne=ie=>{Fe("breakdowns",O.map(ce=>ce.id===ie.id?ie:ce),j),bt("breakdowns",ie)},L=ie=>{Fe("bomRecords",[...B,ie],U),bt("bomRecords",ie)},he=ie=>{Fe("bomRecords",B.map(ce=>ce.id===ie.id?ie:ce),U),bt("bomRecords",ie)},fe=ie=>{Fe("bomRecords",B.filter(ce=>!ie.includes(ce.id)),U),ie.forEach(ce=>si("bomRecords",ce))},de=ie=>{Fe("agriOrders",[...Y,ie],te),bt("agriOrders",ie)},we=ie=>{Fe("agriOrders",Y.map(ce=>ce.id===ie.id?ie:ce),te),bt("agriOrders",ie)},Pe=ie=>{Fe("agriOrders",Y.filter(ce=>!ie.includes(ce.id)),te),ie.forEach(ce=>si("agriOrders",ce))},Re=ie=>{Fe("irrigationLogs",[...V,ie],ge),bt("irrigationLogs",ie)},Ve=ie=>{Fe("irrigationLogs",V.map(ce=>ce.id===ie.id?ie:ce),ge),bt("irrigationLogs",ie)},C=ie=>{Fe("irrigationLogs",V.filter(ce=>!ie.includes(ce.id)),ge),ie.forEach(ce=>si("irrigationLogs",ce))},J=ie=>{Fe("forecastPeriods",[...be,ie],ve),bt("forecastPeriods",ie)},xe=ie=>{Fe("forecastPeriods",be.map(ce=>ce.id===ie.id?ie:ce),ve),bt("forecastPeriods",ie)},Ee=ie=>{Fe("forecastRecords",ie,ue),ie.forEach(ce=>bt("forecastRecords",ce))},Ce=ie=>{Fe("purchaseOrders",[...se,ie],Q)},Se=ie=>{Fe("maintenanceTasks",[...re,ie],G),bt("tasks",ie)},Qe=ie=>{Fe("maintenanceTasks",re.map(ce=>ce.id===ie.id?ie:ce),G),bt("tasks",ie)},Xe=ie=>{Fe("maintenanceSchedules",[...P,ie],W),bt("schedules",ie)},Ye=ie=>{Fe("maintenanceSchedules",P.map(ce=>ce.id===ie.id?ie:ce),W),bt("schedules",ie)},pt=ie=>{Fe("maintenanceWorkOrders",[...F,ie],M),bt("workOrders",ie)},Et=ie=>{Fe("maintenanceWorkOrders",F.map(ce=>ce.id===ie.id?ie:ce),M),bt("workOrders",ie)},nt=ie=>{Fe("assetTransfers",[ie,...le],pe),bt("assetTransfers",ie)},yt=ie=>{Fe("assetTransfers",le.map(ce=>ce.id===ie.id?ie:ce),pe),bt("assetTransfers",ie),ie.status==="Executed"&&(async()=>{const rt=await vD();rt&&(rt.machines&&p(rt.machines),rt.transferHistory&&oe(rt.transferHistory))})()},Rt=ie=>{Fe("warrantyRecords",[...ae,ie],ze),bt("warrantyManagement",ie)},Vt=ie=>{Fe("warrantyReceiving",[...q,ie],Je),bt("warrantyReceiving",ie)},Kt=ie=>{Fe("issuePlanPeriods",[...qe,ie],ot),bt("issuePlanPeriods",ie)},Ht=ie=>{Fe("issuePlanPeriods",qe.map(ce=>ce.id===ie.id?ie:ce),ot),bt("issuePlanPeriods",ie)},Lt=ie=>{const rt=Ke.find(Ar=>Ar.id===ie.id)?Ke.map(Ar=>Ar.id===ie.id?ie:Ar):[...Ke,ie];Fe("issuePlanEntries",rt,He),bt("issuePlanEntries",ie)},Pr=ie=>{Fe("issuePlanEntries",Ke.filter(ce=>ce.id!==ie),He),si("issuePlanEntries",ie)},Fr=async(ie,ce,rt)=>{if(ie==="items"){const tt=[...f];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("items",tt,d)}else if(ie==="machines"){const tt=[...m];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("machines",tt,p)}else if(ie==="bom"){const tt=[...B];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("bomRecords",tt,U)}else if(ie==="breakdowns"){const tt=[...O];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("breakdowns",tt,j)}else if(ie==="locations"){const tt=[...v];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("locations",tt,x)}else if(ie==="sectors"){const tt=[...y];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("sectors",tt,b)}else if(ie==="divisions"){const tt=[..._];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("divisions",tt,E)}else if(ie==="plans"){const tt=[...A];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("plans",tt,T)}else if(ie==="users"){const tt=[...r];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.username===lt.username);Mt>-1&&(tt[Mt]=lt)}),Fe("users",tt,n)}else if(ie==="periods"){const tt=[...be];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("forecastPeriods",tt,ve)}else if(ie==="history"){const tt=[...k];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("history",tt,I)}else if(ie==="orgStructure"){const tt=[...wt];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.id===lt.id);Mt>-1&&(tt[Mt]=lt)}),Fe("orgStructures",tt,mt)}else if(ie==="failureTypes"){const tt=[...Ge];ce.forEach(lt=>{tt.push(lt)}),rt.forEach(lt=>{const Mt=tt.findIndex(xr=>xr.code===lt.code);Mt>-1&&(tt[Mt]=lt)}),Fe("failureTypes",tt,ut)}const Ar=[...ce,...rt];let vr="";if(ie==="items"?vr="items":ie==="machines"?vr="machines":ie==="bom"?vr="bomRecords":ie==="breakdowns"?vr="breakdowns":ie==="locations"?vr="locations":ie==="sectors"?vr="sectors":ie==="divisions"?vr="divisions":ie==="plans"?vr="plans":ie==="users"?vr="users":ie==="periods"?vr="forecastPeriods":ie==="history"?vr="history":ie==="orgStructure"?vr="orgStructure":ie==="failureTypes"&&(vr="failureTypes"),vr&&Ar.length>0)try{Wt({isUploading:!0,current:0,total:Ar.length,batchNum:0,totalBatches:Math.ceil(Ar.length/100),tableName:ie,isCancelled:!1});const tt=await qge(vr,Ar,(lt,Mt,xr,K0)=>{Wt({isUploading:!0,current:lt,total:Mt,batchNum:xr,totalBatches:K0,tableName:ie})});Wt(null),tt.status==="error"?(console.error("Bulk Upsert Error:",tt.message),tt.message.toLowerCase().includes("fetch")?alert("Network Error: Failed to connect to database. Please check your internet connection or if Supabase is reachable. (URL: https://zrpbpijowrlwhhagloif.supabase.co)"):alert(`Save Failed: ${tt.message}`)):console.log(`Successfully saved ${tt.count} records to ${vr}`)}catch(tt){if(Wt(null),tt.message==="Upload cancelled by user"){console.log("Upload cancelled by user");return}console.error("Unexpected Error saving data:",tt);const lt=tt.message||"";lt.toLowerCase().includes("fetch")?alert("Connectivity Error: The application cannot reach the server. Please check your network."):alert(`Unexpected Error: ${lt}`)}},va=async()=>{const ie=localStorage.getItem("wf_script_url_v3")||oo,ce=await Ure(ie);ce&&(ce.items&&(Fe("items",ce.items,d),ce.items.forEach(rt=>bt("items",rt))),ce.machines&&(Fe("machines",ce.machines,p),ce.machines.forEach(rt=>bt("machines",rt))),ce.history&&(Fe("history",ce.history,I),ce.history.forEach(rt=>bt("history",rt))),ce.locations&&(Fe("locations",ce.locations,x),ce.locations.forEach(rt=>bt("locations",rt))),ce.sectors&&(Fe("sectors",ce.sectors,b),ce.sectors.forEach(rt=>bt("sectors",rt))),ce.divisions&&(Fe("divisions",ce.divisions,E),ce.divisions.forEach(rt=>bt("divisions",rt))),ce.users&&(Fe("users",ce.users,n),ce.users.forEach(rt=>bt("users",rt))),ce.plans&&(Fe("plans",ce.plans,T),ce.plans.forEach(rt=>bt("plans",rt))),ce.breakdowns&&(Fe("breakdowns",ce.breakdowns,j),ce.breakdowns.forEach(rt=>bt("breakdowns",rt))),ce.bom&&(Fe("bomRecords",ce.bom,U),ce.bom.forEach(rt=>bt("bomRecords",rt))),ce.agri_orders&&(Fe("agriOrders",ce.agri_orders,te),ce.agri_orders.forEach(rt=>bt("agriOrders",rt))),ce.irrigation_logs&&(Fe("irrigationLogs",ce.irrigation_logs,ge),ce.irrigation_logs.forEach(rt=>bt("irrigationLogs",rt))),ce.forecasts&&(Fe("forecastRecords",ce.forecasts,ue),ce.forecasts.forEach(rt=>bt("forecastRecords",rt))),ce.org_structure&&(Fe("orgStructures",ce.org_structure,mt),ce.org_structure.forEach(rt=>bt("orgStructure",rt))),ce.failure_types&&(Fe("failureTypes",ce.failure_types,ut),ce.failure_types.forEach(rt=>bt("failureTypes",rt))))};return Oe?u.jsx("div",{className:"flex h-screen items-center justify-center",children:"Loading..."}):e?u.jsx(ame,{children:u.jsxs("div",{className:"flex min-h-screen bg-gray-100 font-sans",children:[u.jsx(wB,{currentView:a,setCurrentView:i,currentUser:e,onLogout:St,isOpen:l,onClose:()=>c(!1),isDbConnected:ct}),u.jsxs("div",{className:"flex-1 flex flex-col min-w-0 h-screen overflow-hidden",children:[u.jsxs("header",{className:"bg-white shadow-sm z-20 md:hidden flex items-center justify-between p-4",children:[u.jsx("button",{onClick:()=>c(!0),className:"text-gray-600",children:u.jsx("span",{className:"text-2xl",children:""})}),u.jsx("h1",{className:"font-bold text-gray-800",children:"Daltex Maintenance"}),u.jsx("div",{className:"w-8"})]}),u.jsx("main",{className:"flex-1 p-4 md:p-6 scroll-smooth overflow-auto",children:(()=>{switch(a){case"dashboard":return u.jsx(wm,{history:k,items:f,machines:m,locations:v,breakdowns:O,setCurrentView:i,currentUser:e});case"issue-form":return u.jsx(Hhe,{onAddIssue:K,items:f,machines:m,locations:v,sectors:y,divisions:_,maintenancePlans:A,bomRecords:B,currentUser:e});case"history":return u.jsx(qhe,{history:k,locations:v,items:f,machines:m,onBulkImport:Fr,onUpdateIssue:H});case"stock-approval":return["admin","warehouse_manager","warehouse_supervisor"].includes(e.role)?u.jsx(Whe,{history:k,locations:v,items:f,machines:m,onUpdateIssue:H}):u.jsx(wm,{history:k,items:f,machines:m,locations:v,breakdowns:O,setCurrentView:i,currentUser:e});case"master-data":return e.role!=="admin"?u.jsx(wm,{history:k,items:f,machines:m,locations:v,breakdowns:O,setCurrentView:i,currentUser:e}):u.jsx(Vhe,{history:k,items:f,machines:m,locations:v,sectors:y,divisions:_,plans:A,orgStructures:wt,failureTypes:Ge,onAddItem:Zt,onAddMachine:ar,onAddLocation:Ba,onAddSector:$r,onAddDivision:pr,onAddPlan:wn,onAddOrgStructure:gr,onAddFailureType:Ue,onUpdateItem:mr,onUpdateMachine:Yr,onUpdateLocation:ga,onUpdateSector:ra,onUpdateDivision:Hn,onUpdatePlan:zr,onUpdateOrgStructure:Oa,onUpdateFailureType:Le,onDeleteItems:er,onDeleteMachines:Tr,onDeleteLocations:$n,onDeleteSectors:zn,onDeleteDivisions:lr,onDeletePlans:na,onDeleteOrgStructures:pn,onDeleteFailureTypes:it,onBulkImport:Fr,onRestore:va});case"asset-management":return u.jsx(Yhe,{machines:m,items:f,bomRecords:B,locations:v,sectors:y,divisions:_,failureTypes:Ge,breakdowns:O,assetTransfers:le,transferHistory:Ae,warrantyRecords:ae,warrantyReceiving:q,onAddMachine:ar,onUpdateMachine:Yr,onDeleteMachines:Tr,onAddBreakdown:Z,onUpdateBreakdown:ne,onAddBOM:L,onUpdateBOM:he,onDeleteBOMs:fe,onAddTransfer:nt,onUpdateTransfer:yt,onAddWarranty:Rt,onAddWarrantyReceiving:Vt,onBulkImport:Fr,setCurrentView:i,currentUser:e});case"agri-work-order":return u.jsx(Qhe,{orders:Y,onAddOrder:de,onUpdateOrder:we,onDeleteOrders:Pe,irrigationLogs:V,onAddIrrigationLog:Re,onUpdateIrrigationLog:Ve,onDeleteIrrigationLogs:C,locations:v,machines:m});case"material-forecast":return u.jsx(Jhe,{items:f,locations:v,sectors:y,divisions:_,history:k,machines:m,bomRecords:B,forecastPeriods:be,onAddPeriod:J,onUpdatePeriod:xe,forecastRecords:z,onUpdateForecast:Ee,currentUser:e,onBulkImport:Fr});case"mro-management":return u.jsx(eme,{items:f,onUpdateItem:mr,purchaseOrders:se,onAddPO:Ce,machines:m,locations:v});case"maintenance-planning":return u.jsx(tme,{tasks:re,schedules:P,workOrders:F,machines:m,locations:v,items:f,onAddTask:Se,onUpdateTask:Qe,onAddSchedule:Xe,onUpdateSchedule:Ye,onAddWorkOrder:pt,onUpdateWorkOrder:Et,currentUser:e});case"issue-planning":return u.jsx(rme,{periods:qe,entries:Ke,locations:v,sectors:y,divisions:_,items:f,machines:m,onAddPeriod:Kt,onUpdatePeriod:Ht,onUpdateEntry:Lt,onDeleteEntry:Pr,currentUser:e,onBulkImport:Fr});case"ai-assistant":return u.jsx(Zhe,{});case"settings":return u.jsx(nme,{onRestore:va,users:r,onAddUser:Tt,onUpdateUser:R,onDeleteUsers:ee});default:return u.jsx(wm,{history:k,items:f,machines:m,locations:v,breakdowns:O,setCurrentView:i,currentUser:e})}})()})]}),at&&u.jsx("div",{className:"fixed inset-0 bg-black/70 z-50 flex items-center justify-center backdrop-blur-sm",children:u.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-fade-in-up relative",children:u.jsxs("div",{className:"text-center",children:[u.jsxs("div",{className:"mb-6",children:[u.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4",children:u.jsxs("svg",{className:"w-8 h-8 text-blue-600 animate-spin",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),u.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Uploading Data"}),u.jsxs("p",{className:"text-sm text-gray-600",children:["Please wait while we save your ",at.tableName,"..."]})]}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex justify-between text-sm font-medium text-gray-700 mb-2",children:[u.jsx("span",{children:"Progress"}),u.jsxs("span",{children:[Math.round(at.current/at.total*100),"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:u.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 h-3 rounded-full transition-all duration-300 ease-out",style:{width:`${at.current/at.total*100}%`}})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[u.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Records"}),u.jsxs("div",{className:"font-bold text-gray-900",children:[at.current.toLocaleString()," / ",at.total.toLocaleString()]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[u.jsx("div",{className:"text-gray-500 text-xs mb-1",children:"Batch"}),u.jsxs("div",{className:"font-bold text-gray-900",children:[at.batchNum," / ",at.totalBatches]})]})]}),u.jsx("div",{className:"mt-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx("span",{className:"text-yellow-600 text-lg",children:""}),u.jsxs("p",{className:"text-xs text-yellow-800 text-left",children:[u.jsx("strong",{children:"To terminate the loading, please refresh this page."}),u.jsx("br",{}),"Upload will stop if the page is refreshed or closed."]})]})})]})})})]})}):u.jsx(oB,{onLogin:nr,users:r})},H8=document.getElementById("root");if(!H8)throw new Error("Could not find root element to mount to");const Vge=lB.createRoot(H8);Vge.render(u.jsx(t_.StrictMode,{children:u.jsx(Wge,{})}));
